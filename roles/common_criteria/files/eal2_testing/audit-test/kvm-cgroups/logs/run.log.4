Testcase                                                                                                                                                                                                   Result
--------                                                                                                                                                                                                   ------
[4] cgroup_device devices_subgroup_devices_deny_parent                                                                                                                                                  ERROR (2)
        Control groups not ready
--- begin output -----------------------------------------------------------
rotate_audit_logs: Attempting to rotate using USR1
+ source functions_cgroup_device.bash
++ source testcase.bash
+++ source functions.bash
++++ [[ -z '' ]]
++++ _FUNCTIONS_BASH=1
++++ shopt -s extglob
++++ unset auditd_conf audit_log
++++ auditd_conf=/etc/audit/auditd.conf
++++ audit_log=/var/log/audit/audit.log
++++ unset zero
++++ zero=test_cgroup_device.bash
++++ [[ capp == lspp ]]
+++ [[ -n '' ]]
++++ mktemp -p /usr/local/eal4_testing/audit-test
+++ localtmp=/usr/local/eal4_testing/audit-test/tmp.h8yymWs08w
++++ mktemp
+++ tmp1=/tmp/tmp.6q5aW7muQ9
++++ mktemp
+++ tmp2=/tmp/tmp.w9rOVGuSla
+++ trap 'test_cleanup; exit' 0 1 2 15
++ dom1=guest1
++ img_path=/var/lib/libvirt/images
++ cgroup_block_device=/dev/ram0
+++ /usr/bin/stat -c %t:%T /dev/ram0
++ cgroup_block_device_major_minor=0:0
++ cgroup_block_device_list_entry='b 0:0 rwm'
++ cgroup_char_device=/dev/null
+++ /usr/bin/stat -c %t:%T /dev/null
++ cgroup_char_device_major_minor=1:3
++ cgroup_char_device_list_entry='c 1:3 rwm'
++ mnt_test_point=/mnt/block_device_test
+ scenario=devices_subgroup_devices_deny_parent
+ pkg_list='libvirt libvirt-client libcgroup'
+ '[' -z devices_subgroup_devices_deny_parent ']'
+ check_installed_packages libvirt libvirt-client libcgroup
+ /bin/rpm -q libvirt libvirt-client libcgroup
libvirt-4.5.0-33.el7_8.1.x86_64
libvirt-client-4.5.0-33.el7_8.1.x86_64
libcgroup-0.41-21.el7.x86_64
+ return 0
+ check_cgroups_availability
+ /sbin/service cgconfig status
Redirecting to /bin/systemctl status cgconfig.service
‚óè cgconfig.service - Control Group configuration service
   Loaded: loaded (/usr/lib/systemd/system/cgconfig.service; enabled; vendor preset: disabled)
   Active: active (exited) since Thu 2021-06-10 16:25:07 CEST; 17h ago
  Process: 17186 ExecStop=/usr/sbin/cgclear -l /etc/cgconfig.conf -L /etc/cgconfig.d -e (code=exited, status=0/SUCCESS)
  Process: 17188 ExecStart=/usr/sbin/cgconfigparser -l /etc/cgconfig.conf -L /etc/cgconfig.d -s 1664 (code=exited, status=0/SUCCESS)
 Main PID: 17188 (code=exited, status=0/SUCCESS)
    Tasks: 0
   Memory: 0B
   CGroup: /system.slice/cgconfig.service

Jun 10 16:25:07 rhv.atsec.com systemd[1]: Starting Control Group configuration service...
Jun 10 16:25:07 rhv.atsec.com systemd[1]: Started Control Group configuration service.
+ /bin/cat /proc/cgroups
#subsys_name	hierarchy	num_cgroups	enabled
cpuset	7	2	1
cpu	5	99	1
cpuacct	5	99	1
memory	6	99	1
devices	3	99	1
freezer	8	2	1
net_cls	9	2	1
blkio	2	99	1
perf_event	11	2	1
hugetlb	4	1	1
pids	10	99	1
net_prio	9	2	1
+ check_cgroup_hierarchy ''
+ '[' -d /cgroup/cpu/libvirt/qemu/ ']'
+ return 1
+ return 1
+ exit_error 'Control groups not ready'
+ declare status
+ [[ -n Control groups not ready ]]
+ [[ Control groups not ready != *[!0-9]* ]]
+ status=2
+ [[ -n Control groups not ready ]]
+ printf '\nexit_error: %s\n' 'Control groups not ready'

exit_error: Control groups not ready
+ exit 2
+ test_cleanup
+ rm -f /tmp/tmp.6q5aW7muQ9 /tmp/tmp.w9rOVGuSla /usr/local/eal4_testing/audit-test/tmp.h8yymWs08w
+ exit
--- end output -------------------------------------------------------------

