Log file started Fri Jun 11 09:48:32 CEST 2021
Adding group testuser
Adding user testuser
Adding group testadmin
Adding user testadmin
Testcase                                                                                                                                                                                                   Result
--------                                                                                                                                                                                                   ------
[0] cgroup_device basic_sanity                                                                                                                                                                              FAIL 
        creating domain
--- begin output -----------------------------------------------------------
++ run_test cgroup_device basic_sanity
++ declare status x=cgroup_device
++ shift
++ rotate_audit_logs
++ declare tmp num_logs
++ [[ -f /var/log/audit/audit.log ]]
++ pushd /var/log/audit
+++ mktemp /var/log/audit/rotating.XXXXXX
++ tmp=/var/log/audit/rotating.OSHOSk
++ ln -f audit.log /var/log/audit/rotating.OSHOSk
++ echo 'rotate_audit_logs: Attempting to rotate using USR1'
rotate_audit_logs: Attempting to rotate using USR1
++ pidof auditd
++ killall -USR1 auditd
++ sleep 0.1
++ [[ audit.log -ef /var/log/audit/rotating.OSHOSk ]]
++ rm -f /var/log/audit/rotating.OSHOSk
++ popd
++ pidof auditd
++ ./test_cgroup_device.bash basic_sanity
+ source functions_cgroup_device.bash
++ source testcase.bash
+++ source functions.bash
++++ [[ -z '' ]]
++++ _FUNCTIONS_BASH=1
++++ shopt -s extglob
++++ unset auditd_conf audit_log
++++ auditd_conf=/etc/audit/auditd.conf
++++ audit_log=/var/log/audit/audit.log
++++ unset zero
++++ zero=test_cgroup_device.bash
++++ [[ capp == lspp ]]
+++ [[ -n '' ]]
++++ mktemp -p /usr/local/eal4_testing/audit-test
+++ localtmp=/usr/local/eal4_testing/audit-test/tmp.y65CPkwe6u
++++ mktemp
+++ tmp1=/tmp/tmp.6GQfKlGUDn
++++ mktemp
+++ tmp2=/tmp/tmp.mvwBSSUCvg
+++ trap 'test_cleanup; exit' 0 1 2 15
++ dom1=guest1
++ img_path=/var/lib/libvirt/images
++ cgroup_block_device=/dev/ram0
+++ /usr/bin/stat -c %t:%T /dev/ram0
++ cgroup_block_device_major_minor=0:0
++ cgroup_block_device_list_entry='b 0:0 rwm'
++ cgroup_char_device=/dev/null
+++ /usr/bin/stat -c %t:%T /dev/null
++ cgroup_char_device_major_minor=1:3
++ cgroup_char_device_list_entry='c 1:3 rwm'
++ mnt_test_point=/mnt/block_device_test
+ scenario=basic_sanity
+ pkg_list='libvirt libvirt-client libcgroup'
+ '[' -z basic_sanity ']'
+ check_installed_packages libvirt libvirt-client libcgroup
+ /bin/rpm -q libvirt libvirt-client libcgroup
libvirt-4.5.0-33.el7_8.1.x86_64
libvirt-client-4.5.0-33.el7_8.1.x86_64
libcgroup-0.41-21.el7.x86_64
+ return 0
+ check_cgroups_availability
+ /sbin/service cgconfig status
Redirecting to /bin/systemctl status cgconfig.service
● cgconfig.service - Control Group configuration service
   Loaded: loaded (/usr/lib/systemd/system/cgconfig.service; enabled; vendor preset: disabled)
   Active: active (exited) since Thu 2021-06-10 16:25:07 CEST; 17h ago
  Process: 17186 ExecStop=/usr/sbin/cgclear -l /etc/cgconfig.conf -L /etc/cgconfig.d -e (code=exited, status=0/SUCCESS)
  Process: 17188 ExecStart=/usr/sbin/cgconfigparser -l /etc/cgconfig.conf -L /etc/cgconfig.d -s 1664 (code=exited, status=0/SUCCESS)
 Main PID: 17188 (code=exited, status=0/SUCCESS)
    Tasks: 0
   Memory: 0B
   CGroup: /system.slice/cgconfig.service

Jun 10 16:25:07 rhv.atsec.com systemd[1]: Starting Control Group configuration service...
Jun 10 16:25:07 rhv.atsec.com systemd[1]: Started Control Group configuration service.
+ /bin/cat /proc/cgroups
#subsys_name	hierarchy	num_cgroups	enabled
cpuset	7	2	1
cpu	5	99	1
cpuacct	5	99	1
memory	6	99	1
devices	3	99	1
freezer	8	2	1
net_cls	9	2	1
blkio	2	99	1
perf_event	11	2	1
hugetlb	4	1	1
pids	10	99	1
net_prio	9	2	1
+ check_cgroup_hierarchy ''
+ return 0
+ return 0
+ generate_block_dev_file
+ /bin/cat
+ append_cleanup '/bin/rm -f block_dev.xml'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp"
	/bin/rm -f block_dev.xml
    }'
+ prepare_guest_domain
+ /bin/dd if=/dev/zero of=/var/lib/libvirt/images/guest1.img bs=1M count=1
1+0 records in
1+0 records out
1048576 bytes (1.0 MB) copied, 0.00187068 s, 561 MB/s
+ /usr/bin/chcon system_u:object_r:svirt_image_t:s0:c50,c70 /var/lib/libvirt/images/guest1.img
+ append_cleanup '/bin/rm -f /var/lib/libvirt/images/guest1.img'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    /bin/rm -f block_dev.xml
	/bin/rm -f /var/lib/libvirt/images/guest1.img
    }'
+ prepare_block_device
+ /bin/dd if=/dev/zero of=/dev/ram0 bs=1K count=16K
16384+0 records in
16384+0 records out
16777216 bytes (17 MB) copied, 0.0515633 s, 325 MB/s
+ /sbin/mkfs.ext4 /dev/ram0
mke2fs 1.42.9 (28-Dec-2013)
/dev/ram0 is not a block special device.
Proceed anyway? (y,n) + append_cleanup restorecon -RvvF /dev/ram0
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    /bin/rm -f block_dev.xml;
    /bin/rm -f /var/lib/libvirt/images/guest1.img
	restorecon -RvvF /dev/ram0
    }'
+ /usr/bin/chcon system_u:object_r:svirt_image_t:s0:c50,c70 /dev/ram0
++ type -t test_basic_sanity
+ '[' function == function ']'
+ test_basic_sanity
+ start_guest guest1
+ create_guest_domain guest1
+ /bin/sed '/CGROUP_DEV_CONFIG/ {r block_dev.xml
    d}' guest1-template.xml
+ append_cleanup '/bin/rm -f guest1.xml'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    /bin/rm -f block_dev.xml;
    /bin/rm -f /var/lib/libvirt/images/guest1.img;
    restorecon -RvvF /dev/ram0
	/bin/rm -f guest1.xml
    }'
+ prepend_cleanup '/usr/bin/virsh destroy guest1'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	/usr/bin/virsh destroy guest1
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    /bin/rm -f block_dev.xml;
    /bin/rm -f /var/lib/libvirt/images/guest1.img;
    restorecon -RvvF /dev/ram0;
    /bin/rm -f guest1.xml
    }'
+ /usr/bin/virsh create guest1.xml
Please enter your authentication name: Please enter your password: error: failed to connect to the hypervisor
error: authentication failed: authentication failed

+ return 1
+ exit_fail 'creating domain'
+ [[ -n creating domain ]]
+ printf '\nexit_fail: %s\n' 'creating domain'

exit_fail: creating domain
+ exit 1
+ test_cleanup
+ /usr/bin/virsh destroy guest1
Please enter your authentication name: Please enter your password: error: failed to connect to the hypervisor
error: authentication failed: Failed to start SASL negotiation: -1 (SASL(-1): generic failure: All-whitespace username.)

+ rm -f /tmp/tmp.6GQfKlGUDn /tmp/tmp.mvwBSSUCvg /usr/local/eal4_testing/audit-test/tmp.y65CPkwe6u
+ /bin/rm -f block_dev.xml
+ /bin/rm -f /var/lib/libvirt/images/guest1.img
+ restorecon -RvvF /dev/ram0
restorecon reset /dev/ram0 context system_u:object_r:svirt_image_t:s0:c50,c70->system_u:object_r:device_t:s0
+ /bin/rm -f guest1.xml
+ exit
++ status=1
++ [[ 1 == 1 ]]
++ echo

++ echo augrok output
augrok output
++ echo -------------
-------------
++ augrok 'type!=DAEMON_ROTATE'
Argument "enabled 1\nfailure 1\npid 931\nrate_limit 0\nbacklog_lim..." isn't numeric in numeric eq (==) at /usr/local/eal4_testing/audit-test/utils/augrok line 1209.
++ return 1
--- end output -------------------------------------------------------------

