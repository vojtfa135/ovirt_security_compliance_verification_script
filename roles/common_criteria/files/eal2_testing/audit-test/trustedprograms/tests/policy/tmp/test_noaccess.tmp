#line 1 "/usr/share/selinux/devel/include/support/file_patterns.spt"
#
# Directory patterns (dir)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. directory type
#
#line 12


#line 17


#line 22


#line 27


#line 32


#line 37


#line 42


#line 47


#line 52


#line 57


#line 62


#line 67


#line 72


#line 77


#
# Regular file patterns (file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 90


#line 95


#line 100


#line 105


#line 112


#line 117


#line 122


#line 127


#line 132


#line 137


#line 142


#line 147


#line 152


#line 157


#line 162


#line 167


#line 172


#line 177


#
# Symbolic link patterns (lnk_file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 190


#line 195


#line 200


#line 205


#line 210


#line 215


#line 220


#line 225


#line 230


#line 235


#line 240


#line 245


#line 250


#
# (Un)named Pipes/FIFO patterns (fifo_file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 263


#line 268


#line 273


#line 278


#line 283


#line 288


#line 293


#line 298


#line 303


#line 308


#line 313


#line 318


#line 323


#
# (Un)named sockets patterns (sock_file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 336


#line 341


#line 346


#line 351


#line 356


#line 361


#line 366


#line 371


#line 376


#line 381


#line 386


#line 391


#
# Block device node patterns (blk_file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 404


#line 409


#line 414


#line 419


#line 424


#line 429


#line 435


#line 440


#line 445


#line 451


#line 456


#line 461


#line 466


#
# Character device node patterns (chr_file)
#
# Parameters:
# 1. domain type
# 2. container (directory) type
# 3. file type
#
#line 479


#line 484


#line 489


#line 494


#line 499


#line 504


#line 510


#line 515


#line 520


#line 526


#line 531


#line 536


#line 541


#
# File type_transition patterns
#
# filetrans_add_pattern(domain,dirtype,newtype,class(es),[filename])
#
#line 551


#
# filetrans_pattern(domain,dirtype,newtype,class(es),[filename])
#
#line 559


#line 573

#line 1 "/usr/share/selinux/devel/include/support/ipc_patterns.spt"
#
# unix domain socket patterns
#
#line 8


#line 14

#line 1 "/usr/share/selinux/devel/include/support/obj_perm_sets.spt"
########################################
# 
# Support macros for sets of object classes and permissions
#
# This file should only have object class and permission set macros - they
# can only reference object classes and/or permissions.

#
# All directory and file classes
#


#
# All non-directory file classes.
#


#
# Non-device file classes.
#


#
# Device file classes.
#


#
# All socket classes.
#


#
# Datagram socket classes.
# 


#
# Stream socket classes.
#


#
# Unprivileged socket classes (exclude rawip, netlink, packet).
#


########################################
# 
# Macros for sets of permissions
#

#
# Permissions to mount and unmount file systems.
#


#
# Permissions for using sockets.
# 


#
# Permissions for creating and using sockets.
# 


#
# Permissions for using stream sockets.
# 


#
# Permissions for creating and using stream sockets.
# 


#
# Permissions for creating and using sockets.
# 


#
# Permissions for creating and using sockets.
# 



#
# Permissions for creating and using netlink sockets.
# 


#
# Permissions for using netlink sockets for operations that modify state.
# 


#
# Permissions for using netlink sockets for operations that observe state.
# 


#
# Permissions for sending all signals.
#


#
# Permissions for sending and receiving network packets.
#


#
# Permissions for using System V IPC
#










########################################
#
# New permission sets
#

#
# Directory (dir)
#















#
# Regular file (file)
#


























#
# Symbolic link (lnk_file)
#














#
# (Un)named Pipes/FIFOs (fifo_file)
#















#
# (Un)named Sockets (sock_file)
#














#
# Block device nodes (blk_file)
#















#
# Character device nodes (chr_file)
#















########################################
#
# Special permission sets
#

#
# Use (read and write) terminals
#



#
# Sockets
#



#
# Keys
#


#
# Service
#

#line 1 "/usr/share/selinux/devel/include/support/misc_patterns.spt"
#
# Specified domain transition patterns
#
#line 8


# compatibility:


#line 20


#
# Automatic domain transition patterns
#
#line 28


# compatibility:


#line 39


#
# Dynamic transition pattern
#
#line 48


#
# Other process permissions
#
#line 58

#line 1 "/usr/share/selinux/devel/include/support/all_perms.spt"



































































































































#line 231


#line 266

#line 1 "/usr/share/selinux/devel/include/support/misc_macros.spt"

########################################
#
# Helper macros
#

#
# shiftn(num,list...)
#
# shift the list num times
#


#
# ifndef(expr,true_block,false_block)
#
# m4 does not have this.
#


#
# __endline__
#
# dummy macro to insert a newline.  used for 
# errprint, so the close parentheses can be
# indented correctly.
#
#line 29


########################################
#
# refpolwarn(message)
#
# print a warning message
#


########################################
#
# refpolerr(message)
#
# print an error message.  does not
# make anything fail.
#


########################################
#
# gen_user(username, prefix, role_set, mls_defaultlevel, mls_range, [mcs_categories])
#
#line 58


########################################
#
# gen_context(context,mls_sensitivity,[mcs_categories])
#
#line 65

########################################
#
# can_exec(domain,executable)
#


########################################
#
# gen_bool(name,default_value)
#
#line 78

#line 1 "/usr/share/selinux/devel/include/support/mls_mcs_macros.spt"
########################################
#
# gen_cats(N)
#
# declares categores c0 to c(N-1)
#
#line 10




########################################
#
# gen_sens(N)
#
# declares sensitivites s0 to s(N-1) with dominance
# in increasing numeric order with s0 lowest, s(N-1) highest
#
#line 24




#line 34


########################################
#
# gen_levels(N,M)
#
# levels from s0 to (N-1) with categories c0 to (M-1)
#
#line 45




########################################
#
# Basic level names for system low and high
#





#line 1 "/usr/share/selinux/devel/include/support/loadable_module.spt"
########################################
#
# Macros for switching between source policy
# and loadable policy module support
#

##############################
#
# For adding the module statement
#
#line 30


##############################
#
# For use in interfaces, to optionally insert a require block
#
#line 48


# helper function, since m4 wont expand macros
# if a line is a comment (#):
#line 55

##############################
#
# In the future interfaces should be in loadable modules
#
# template(name,rules)
#
#line 71


##############################
#
# In the future interfaces should be in loadable modules
#
# interface(name,rules)
#
#line 88




##############################
#
# Optional policy handling
#
#line 102


##############################
#
# Determine if we should use the default
# tunable value as specified by the policy
# or if the override value should be used
#


##############################
#
# Extract booleans out of an expression.
# This needs to be reworked so expressions
# with parentheses can work.

#line 123


##############################
#
# Tunable declaration
#
#line 131


##############################
#
# Tunable policy handling
#
#line 146

#line 382213 "tmp/all_interfaces.conf"

#line 1 "test_noaccess.te"
###############################################################################
# (c) Copyright Hewlett-Packard Development Company, L.P., 2007
#
#   This program is free software: you can redistribute it and/or modify
#   it under the terms of version 2 the GNU General Public License as
#   published by the Free Software Foundation.
#
#   This program is distributed in the hope that it will be useful,
#   but WITHOUT ANY WARRANTY; without even the implied warranty of
#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#   GNU General Public License for more details.
#
#   You should have received a copy of the GNU General Public License
#   along with this program.  If not, see <http://www.gnu.org/licenses/>.
###############################################################################

#################################
# 
# Policy for testing selinux policy utilities, modeled after
# some of the LTP selinux tests
#
# This version of the policy module defines the types/domains
# that the test uses but doesn't actually allow any access.
#
#################################


#line 27
	
#line 27
		module test_noaccess 1.0;
#line 27

#line 27
		require {
#line 27
			role system_r;
#line 27
			
#line 27
	class security { compute_av compute_create compute_member check_context load_policy compute_relabel compute_user setenforce setbool setsecparam setcheckreqprot read_policy validate_trans };
#line 27
	class process { fork transition sigchld sigkill sigstop signull signal ptrace getsched setsched getsession getpgid setpgid getcap setcap share getattr setexec setfscreate noatsecure siginh setrlimit rlimitinh dyntransition setcurrent execmem execstack execheap setkeycreate setsockcreate ptrace_child };
#line 27
	class system { ipc_info syslog_read syslog_mod syslog_console module_request module_load halt reboot status undefined enable disable reload kill };
#line 27
	class capability { chown dac_override dac_read_search fowner fsetid kill setgid setuid setpcap linux_immutable net_bind_service net_broadcast net_admin net_raw ipc_lock ipc_owner sys_module sys_rawio sys_chroot sys_ptrace sys_pacct sys_admin sys_boot sys_nice sys_resource sys_time sys_tty_config mknod lease audit_write audit_control setfcap };
#line 27
	class filesystem { mount remount unmount getattr relabelfrom relabelto transition associate quotamod quotaget };
#line 27
	class file { ioctl read write create getattr setattr lock relabelfrom relabelto append map unlink link rename execute swapon quotaon mounton execute_no_trans entrypoint execmod open audit_access };
#line 27
	class dir { ioctl read write create getattr setattr lock relabelfrom relabelto append map unlink link rename execute swapon quotaon mounton add_name remove_name reparent search rmdir open audit_access execmod };
#line 27
	class fd { use };
#line 27
	class lnk_file { ioctl read write create getattr setattr lock relabelfrom relabelto append map unlink link rename execute swapon quotaon mounton open audit_access execmod };
#line 27
	class chr_file { ioctl read write create getattr setattr lock relabelfrom relabelto append map unlink link rename execute swapon quotaon mounton execute_no_trans entrypoint execmod open audit_access };
#line 27
	class blk_file { ioctl read write create getattr setattr lock relabelfrom relabelto append map unlink link rename execute swapon quotaon mounton open audit_access execmod };
#line 27
	class sock_file { ioctl read write create getattr setattr lock relabelfrom relabelto append map unlink link rename execute swapon quotaon mounton open audit_access execmod };
#line 27
	class fifo_file { ioctl read write create getattr setattr lock relabelfrom relabelto append map unlink link rename execute swapon quotaon mounton open audit_access execmod };
#line 27
	class socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class tcp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind connectto newconn acceptfrom node_bind name_connect };
#line 27
	class udp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind };
#line 27
	class rawip_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind };
#line 27
	class node { tcp_recv tcp_send udp_recv udp_send rawip_recv rawip_send enforce_dest dccp_recv dccp_send recvfrom sendto };
#line 27
	class netif { tcp_recv tcp_send udp_recv udp_send rawip_recv rawip_send dccp_recv dccp_send ingress egress };
#line 27
	class netlink_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class packet_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class key_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class unix_stream_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind connectto newconn acceptfrom };
#line 27
	class unix_dgram_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class sem { create destroy getattr setattr read write associate unix_read unix_write };
#line 27
	class msg { send receive };
#line 27
	class msgq { create destroy getattr setattr read write associate unix_read unix_write enqueue };
#line 27
	class shm { create destroy getattr setattr read write associate unix_read unix_write lock };
#line 27
	class ipc { create destroy getattr setattr read write associate unix_read unix_write };
#line 27
	class netlink_route_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 27
	class netlink_firewall_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 27
	class netlink_tcpdiag_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 27
	class netlink_nflog_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class netlink_xfrm_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 27
	class netlink_selinux_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class netlink_audit_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write nlmsg_relay nlmsg_readpriv nlmsg_tty_audit };
#line 27
	class netlink_ip6fw_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind nlmsg_read nlmsg_write };
#line 27
	class netlink_dnrt_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class association { sendto recvfrom setcontext polmatch };
#line 27
	class netlink_kobject_uevent_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class appletalk_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class packet { send recv relabelto flow_in flow_out forward_in forward_out };
#line 27
	class key { view read write search link setattr create };
#line 27
	class dccp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind name_connect };
#line 27
	class memprotect { mmap_zero };
#line 27
	class peer { recv };
#line 27
	class capability2 { mac_override mac_admin syslog wake_alarm block_suspend audit_read epolwakeup compromise_kernel };
#line 27
	class kernel_service { use_as_override create_files_as };
#line 27
	class tun_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind attach_queue };
#line 27
	class binder { impersonate call set_context_mgr transfer };
#line 27
	class netlink_iscsi_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class netlink_fib_lookup_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class netlink_connector_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class netlink_netfilter_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class netlink_generic_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class netlink_scsitransport_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class netlink_rdma_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class netlink_crypto_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class infiniband_pkey { access };
#line 27
	class infiniband_endport { manage_subnet };
#line 27
	class service { start stop status reload enable disable kill load };
#line 27
	class proxy { read };
#line 27
	class cap_userns { chown dac_override dac_read_search fowner fsetid kill setgid setuid setpcap linux_immutable net_bind_service net_broadcast net_admin net_raw ipc_lock ipc_owner sys_module sys_rawio sys_chroot sys_ptrace sys_pacct sys_admin sys_boot sys_nice sys_resource sys_time sys_tty_config mknod lease audit_write audit_control setfcap };
#line 27
	class cap2_userns { mac_override mac_admin syslog wake_alarm block_suspend audit_read };
#line 27
	class process2 { nnp_transition nosuid_transition };
#line 27
	class sctp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind name_connect association };
#line 27
	class icmp_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind node_bind };
#line 27
	class ax25_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class ipx_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class netrom_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class bridge_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class atmpvc_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class x25_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class rose_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class decnet_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class atmsvc_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class rds_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class irda_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class pppox_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class llc_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class ib_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class mpls_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class can_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class tipc_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class bluetooth_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class iucv_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class rxrpc_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class isdn_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class phonet_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class ieee802154_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class caif_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class alg_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class nfc_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class vsock_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class kcm_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class qipcrtr_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class smc_socket { ioctl read write create getattr setattr lock relabelfrom relabelto append map bind connect listen accept getopt setopt shutdown recvfrom sendto recv_msg send_msg name_bind };
#line 27
	class bpf { map_create map_read map_write prog_load prog_run };
#line 27

#line 27

#line 27
			
#line 27
				sensitivity s0;
#line 27

#line 27
				category c0;
#line 27
category c1;
#line 27
category c2;
#line 27
category c3;
#line 27
category c4;
#line 27
category c5;
#line 27
category c6;
#line 27
category c7;
#line 27
category c8;
#line 27
category c9;
#line 27
category c10;
#line 27
category c11;
#line 27
category c12;
#line 27
category c13;
#line 27
category c14;
#line 27
category c15;
#line 27
category c16;
#line 27
category c17;
#line 27
category c18;
#line 27
category c19;
#line 27
category c20;
#line 27
category c21;
#line 27
category c22;
#line 27
category c23;
#line 27
category c24;
#line 27
category c25;
#line 27
category c26;
#line 27
category c27;
#line 27
category c28;
#line 27
category c29;
#line 27
category c30;
#line 27
category c31;
#line 27
category c32;
#line 27
category c33;
#line 27
category c34;
#line 27
category c35;
#line 27
category c36;
#line 27
category c37;
#line 27
category c38;
#line 27
category c39;
#line 27
category c40;
#line 27
category c41;
#line 27
category c42;
#line 27
category c43;
#line 27
category c44;
#line 27
category c45;
#line 27
category c46;
#line 27
category c47;
#line 27
category c48;
#line 27
category c49;
#line 27
category c50;
#line 27
category c51;
#line 27
category c52;
#line 27
category c53;
#line 27
category c54;
#line 27
category c55;
#line 27
category c56;
#line 27
category c57;
#line 27
category c58;
#line 27
category c59;
#line 27
category c60;
#line 27
category c61;
#line 27
category c62;
#line 27
category c63;
#line 27
category c64;
#line 27
category c65;
#line 27
category c66;
#line 27
category c67;
#line 27
category c68;
#line 27
category c69;
#line 27
category c70;
#line 27
category c71;
#line 27
category c72;
#line 27
category c73;
#line 27
category c74;
#line 27
category c75;
#line 27
category c76;
#line 27
category c77;
#line 27
category c78;
#line 27
category c79;
#line 27
category c80;
#line 27
category c81;
#line 27
category c82;
#line 27
category c83;
#line 27
category c84;
#line 27
category c85;
#line 27
category c86;
#line 27
category c87;
#line 27
category c88;
#line 27
category c89;
#line 27
category c90;
#line 27
category c91;
#line 27
category c92;
#line 27
category c93;
#line 27
category c94;
#line 27
category c95;
#line 27
category c96;
#line 27
category c97;
#line 27
category c98;
#line 27
category c99;
#line 27
category c100;
#line 27
category c101;
#line 27
category c102;
#line 27
category c103;
#line 27
category c104;
#line 27
category c105;
#line 27
category c106;
#line 27
category c107;
#line 27
category c108;
#line 27
category c109;
#line 27
category c110;
#line 27
category c111;
#line 27
category c112;
#line 27
category c113;
#line 27
category c114;
#line 27
category c115;
#line 27
category c116;
#line 27
category c117;
#line 27
category c118;
#line 27
category c119;
#line 27
category c120;
#line 27
category c121;
#line 27
category c122;
#line 27
category c123;
#line 27
category c124;
#line 27
category c125;
#line 27
category c126;
#line 27
category c127;
#line 27
category c128;
#line 27
category c129;
#line 27
category c130;
#line 27
category c131;
#line 27
category c132;
#line 27
category c133;
#line 27
category c134;
#line 27
category c135;
#line 27
category c136;
#line 27
category c137;
#line 27
category c138;
#line 27
category c139;
#line 27
category c140;
#line 27
category c141;
#line 27
category c142;
#line 27
category c143;
#line 27
category c144;
#line 27
category c145;
#line 27
category c146;
#line 27
category c147;
#line 27
category c148;
#line 27
category c149;
#line 27
category c150;
#line 27
category c151;
#line 27
category c152;
#line 27
category c153;
#line 27
category c154;
#line 27
category c155;
#line 27
category c156;
#line 27
category c157;
#line 27
category c158;
#line 27
category c159;
#line 27
category c160;
#line 27
category c161;
#line 27
category c162;
#line 27
category c163;
#line 27
category c164;
#line 27
category c165;
#line 27
category c166;
#line 27
category c167;
#line 27
category c168;
#line 27
category c169;
#line 27
category c170;
#line 27
category c171;
#line 27
category c172;
#line 27
category c173;
#line 27
category c174;
#line 27
category c175;
#line 27
category c176;
#line 27
category c177;
#line 27
category c178;
#line 27
category c179;
#line 27
category c180;
#line 27
category c181;
#line 27
category c182;
#line 27
category c183;
#line 27
category c184;
#line 27
category c185;
#line 27
category c186;
#line 27
category c187;
#line 27
category c188;
#line 27
category c189;
#line 27
category c190;
#line 27
category c191;
#line 27
category c192;
#line 27
category c193;
#line 27
category c194;
#line 27
category c195;
#line 27
category c196;
#line 27
category c197;
#line 27
category c198;
#line 27
category c199;
#line 27
category c200;
#line 27
category c201;
#line 27
category c202;
#line 27
category c203;
#line 27
category c204;
#line 27
category c205;
#line 27
category c206;
#line 27
category c207;
#line 27
category c208;
#line 27
category c209;
#line 27
category c210;
#line 27
category c211;
#line 27
category c212;
#line 27
category c213;
#line 27
category c214;
#line 27
category c215;
#line 27
category c216;
#line 27
category c217;
#line 27
category c218;
#line 27
category c219;
#line 27
category c220;
#line 27
category c221;
#line 27
category c222;
#line 27
category c223;
#line 27
category c224;
#line 27
category c225;
#line 27
category c226;
#line 27
category c227;
#line 27
category c228;
#line 27
category c229;
#line 27
category c230;
#line 27
category c231;
#line 27
category c232;
#line 27
category c233;
#line 27
category c234;
#line 27
category c235;
#line 27
category c236;
#line 27
category c237;
#line 27
category c238;
#line 27
category c239;
#line 27
category c240;
#line 27
category c241;
#line 27
category c242;
#line 27
category c243;
#line 27
category c244;
#line 27
category c245;
#line 27
category c246;
#line 27
category c247;
#line 27
category c248;
#line 27
category c249;
#line 27
category c250;
#line 27
category c251;
#line 27
category c252;
#line 27
category c253;
#line 27
category c254;
#line 27
category c255;
#line 27
category c256;
#line 27
category c257;
#line 27
category c258;
#line 27
category c259;
#line 27
category c260;
#line 27
category c261;
#line 27
category c262;
#line 27
category c263;
#line 27
category c264;
#line 27
category c265;
#line 27
category c266;
#line 27
category c267;
#line 27
category c268;
#line 27
category c269;
#line 27
category c270;
#line 27
category c271;
#line 27
category c272;
#line 27
category c273;
#line 27
category c274;
#line 27
category c275;
#line 27
category c276;
#line 27
category c277;
#line 27
category c278;
#line 27
category c279;
#line 27
category c280;
#line 27
category c281;
#line 27
category c282;
#line 27
category c283;
#line 27
category c284;
#line 27
category c285;
#line 27
category c286;
#line 27
category c287;
#line 27
category c288;
#line 27
category c289;
#line 27
category c290;
#line 27
category c291;
#line 27
category c292;
#line 27
category c293;
#line 27
category c294;
#line 27
category c295;
#line 27
category c296;
#line 27
category c297;
#line 27
category c298;
#line 27
category c299;
#line 27
category c300;
#line 27
category c301;
#line 27
category c302;
#line 27
category c303;
#line 27
category c304;
#line 27
category c305;
#line 27
category c306;
#line 27
category c307;
#line 27
category c308;
#line 27
category c309;
#line 27
category c310;
#line 27
category c311;
#line 27
category c312;
#line 27
category c313;
#line 27
category c314;
#line 27
category c315;
#line 27
category c316;
#line 27
category c317;
#line 27
category c318;
#line 27
category c319;
#line 27
category c320;
#line 27
category c321;
#line 27
category c322;
#line 27
category c323;
#line 27
category c324;
#line 27
category c325;
#line 27
category c326;
#line 27
category c327;
#line 27
category c328;
#line 27
category c329;
#line 27
category c330;
#line 27
category c331;
#line 27
category c332;
#line 27
category c333;
#line 27
category c334;
#line 27
category c335;
#line 27
category c336;
#line 27
category c337;
#line 27
category c338;
#line 27
category c339;
#line 27
category c340;
#line 27
category c341;
#line 27
category c342;
#line 27
category c343;
#line 27
category c344;
#line 27
category c345;
#line 27
category c346;
#line 27
category c347;
#line 27
category c348;
#line 27
category c349;
#line 27
category c350;
#line 27
category c351;
#line 27
category c352;
#line 27
category c353;
#line 27
category c354;
#line 27
category c355;
#line 27
category c356;
#line 27
category c357;
#line 27
category c358;
#line 27
category c359;
#line 27
category c360;
#line 27
category c361;
#line 27
category c362;
#line 27
category c363;
#line 27
category c364;
#line 27
category c365;
#line 27
category c366;
#line 27
category c367;
#line 27
category c368;
#line 27
category c369;
#line 27
category c370;
#line 27
category c371;
#line 27
category c372;
#line 27
category c373;
#line 27
category c374;
#line 27
category c375;
#line 27
category c376;
#line 27
category c377;
#line 27
category c378;
#line 27
category c379;
#line 27
category c380;
#line 27
category c381;
#line 27
category c382;
#line 27
category c383;
#line 27
category c384;
#line 27
category c385;
#line 27
category c386;
#line 27
category c387;
#line 27
category c388;
#line 27
category c389;
#line 27
category c390;
#line 27
category c391;
#line 27
category c392;
#line 27
category c393;
#line 27
category c394;
#line 27
category c395;
#line 27
category c396;
#line 27
category c397;
#line 27
category c398;
#line 27
category c399;
#line 27
category c400;
#line 27
category c401;
#line 27
category c402;
#line 27
category c403;
#line 27
category c404;
#line 27
category c405;
#line 27
category c406;
#line 27
category c407;
#line 27
category c408;
#line 27
category c409;
#line 27
category c410;
#line 27
category c411;
#line 27
category c412;
#line 27
category c413;
#line 27
category c414;
#line 27
category c415;
#line 27
category c416;
#line 27
category c417;
#line 27
category c418;
#line 27
category c419;
#line 27
category c420;
#line 27
category c421;
#line 27
category c422;
#line 27
category c423;
#line 27
category c424;
#line 27
category c425;
#line 27
category c426;
#line 27
category c427;
#line 27
category c428;
#line 27
category c429;
#line 27
category c430;
#line 27
category c431;
#line 27
category c432;
#line 27
category c433;
#line 27
category c434;
#line 27
category c435;
#line 27
category c436;
#line 27
category c437;
#line 27
category c438;
#line 27
category c439;
#line 27
category c440;
#line 27
category c441;
#line 27
category c442;
#line 27
category c443;
#line 27
category c444;
#line 27
category c445;
#line 27
category c446;
#line 27
category c447;
#line 27
category c448;
#line 27
category c449;
#line 27
category c450;
#line 27
category c451;
#line 27
category c452;
#line 27
category c453;
#line 27
category c454;
#line 27
category c455;
#line 27
category c456;
#line 27
category c457;
#line 27
category c458;
#line 27
category c459;
#line 27
category c460;
#line 27
category c461;
#line 27
category c462;
#line 27
category c463;
#line 27
category c464;
#line 27
category c465;
#line 27
category c466;
#line 27
category c467;
#line 27
category c468;
#line 27
category c469;
#line 27
category c470;
#line 27
category c471;
#line 27
category c472;
#line 27
category c473;
#line 27
category c474;
#line 27
category c475;
#line 27
category c476;
#line 27
category c477;
#line 27
category c478;
#line 27
category c479;
#line 27
category c480;
#line 27
category c481;
#line 27
category c482;
#line 27
category c483;
#line 27
category c484;
#line 27
category c485;
#line 27
category c486;
#line 27
category c487;
#line 27
category c488;
#line 27
category c489;
#line 27
category c490;
#line 27
category c491;
#line 27
category c492;
#line 27
category c493;
#line 27
category c494;
#line 27
category c495;
#line 27
category c496;
#line 27
category c497;
#line 27
category c498;
#line 27
category c499;
#line 27
category c500;
#line 27
category c501;
#line 27
category c502;
#line 27
category c503;
#line 27
category c504;
#line 27
category c505;
#line 27
category c506;
#line 27
category c507;
#line 27
category c508;
#line 27
category c509;
#line 27
category c510;
#line 27
category c511;
#line 27
category c512;
#line 27
category c513;
#line 27
category c514;
#line 27
category c515;
#line 27
category c516;
#line 27
category c517;
#line 27
category c518;
#line 27
category c519;
#line 27
category c520;
#line 27
category c521;
#line 27
category c522;
#line 27
category c523;
#line 27
category c524;
#line 27
category c525;
#line 27
category c526;
#line 27
category c527;
#line 27
category c528;
#line 27
category c529;
#line 27
category c530;
#line 27
category c531;
#line 27
category c532;
#line 27
category c533;
#line 27
category c534;
#line 27
category c535;
#line 27
category c536;
#line 27
category c537;
#line 27
category c538;
#line 27
category c539;
#line 27
category c540;
#line 27
category c541;
#line 27
category c542;
#line 27
category c543;
#line 27
category c544;
#line 27
category c545;
#line 27
category c546;
#line 27
category c547;
#line 27
category c548;
#line 27
category c549;
#line 27
category c550;
#line 27
category c551;
#line 27
category c552;
#line 27
category c553;
#line 27
category c554;
#line 27
category c555;
#line 27
category c556;
#line 27
category c557;
#line 27
category c558;
#line 27
category c559;
#line 27
category c560;
#line 27
category c561;
#line 27
category c562;
#line 27
category c563;
#line 27
category c564;
#line 27
category c565;
#line 27
category c566;
#line 27
category c567;
#line 27
category c568;
#line 27
category c569;
#line 27
category c570;
#line 27
category c571;
#line 27
category c572;
#line 27
category c573;
#line 27
category c574;
#line 27
category c575;
#line 27
category c576;
#line 27
category c577;
#line 27
category c578;
#line 27
category c579;
#line 27
category c580;
#line 27
category c581;
#line 27
category c582;
#line 27
category c583;
#line 27
category c584;
#line 27
category c585;
#line 27
category c586;
#line 27
category c587;
#line 27
category c588;
#line 27
category c589;
#line 27
category c590;
#line 27
category c591;
#line 27
category c592;
#line 27
category c593;
#line 27
category c594;
#line 27
category c595;
#line 27
category c596;
#line 27
category c597;
#line 27
category c598;
#line 27
category c599;
#line 27
category c600;
#line 27
category c601;
#line 27
category c602;
#line 27
category c603;
#line 27
category c604;
#line 27
category c605;
#line 27
category c606;
#line 27
category c607;
#line 27
category c608;
#line 27
category c609;
#line 27
category c610;
#line 27
category c611;
#line 27
category c612;
#line 27
category c613;
#line 27
category c614;
#line 27
category c615;
#line 27
category c616;
#line 27
category c617;
#line 27
category c618;
#line 27
category c619;
#line 27
category c620;
#line 27
category c621;
#line 27
category c622;
#line 27
category c623;
#line 27
category c624;
#line 27
category c625;
#line 27
category c626;
#line 27
category c627;
#line 27
category c628;
#line 27
category c629;
#line 27
category c630;
#line 27
category c631;
#line 27
category c632;
#line 27
category c633;
#line 27
category c634;
#line 27
category c635;
#line 27
category c636;
#line 27
category c637;
#line 27
category c638;
#line 27
category c639;
#line 27
category c640;
#line 27
category c641;
#line 27
category c642;
#line 27
category c643;
#line 27
category c644;
#line 27
category c645;
#line 27
category c646;
#line 27
category c647;
#line 27
category c648;
#line 27
category c649;
#line 27
category c650;
#line 27
category c651;
#line 27
category c652;
#line 27
category c653;
#line 27
category c654;
#line 27
category c655;
#line 27
category c656;
#line 27
category c657;
#line 27
category c658;
#line 27
category c659;
#line 27
category c660;
#line 27
category c661;
#line 27
category c662;
#line 27
category c663;
#line 27
category c664;
#line 27
category c665;
#line 27
category c666;
#line 27
category c667;
#line 27
category c668;
#line 27
category c669;
#line 27
category c670;
#line 27
category c671;
#line 27
category c672;
#line 27
category c673;
#line 27
category c674;
#line 27
category c675;
#line 27
category c676;
#line 27
category c677;
#line 27
category c678;
#line 27
category c679;
#line 27
category c680;
#line 27
category c681;
#line 27
category c682;
#line 27
category c683;
#line 27
category c684;
#line 27
category c685;
#line 27
category c686;
#line 27
category c687;
#line 27
category c688;
#line 27
category c689;
#line 27
category c690;
#line 27
category c691;
#line 27
category c692;
#line 27
category c693;
#line 27
category c694;
#line 27
category c695;
#line 27
category c696;
#line 27
category c697;
#line 27
category c698;
#line 27
category c699;
#line 27
category c700;
#line 27
category c701;
#line 27
category c702;
#line 27
category c703;
#line 27
category c704;
#line 27
category c705;
#line 27
category c706;
#line 27
category c707;
#line 27
category c708;
#line 27
category c709;
#line 27
category c710;
#line 27
category c711;
#line 27
category c712;
#line 27
category c713;
#line 27
category c714;
#line 27
category c715;
#line 27
category c716;
#line 27
category c717;
#line 27
category c718;
#line 27
category c719;
#line 27
category c720;
#line 27
category c721;
#line 27
category c722;
#line 27
category c723;
#line 27
category c724;
#line 27
category c725;
#line 27
category c726;
#line 27
category c727;
#line 27
category c728;
#line 27
category c729;
#line 27
category c730;
#line 27
category c731;
#line 27
category c732;
#line 27
category c733;
#line 27
category c734;
#line 27
category c735;
#line 27
category c736;
#line 27
category c737;
#line 27
category c738;
#line 27
category c739;
#line 27
category c740;
#line 27
category c741;
#line 27
category c742;
#line 27
category c743;
#line 27
category c744;
#line 27
category c745;
#line 27
category c746;
#line 27
category c747;
#line 27
category c748;
#line 27
category c749;
#line 27
category c750;
#line 27
category c751;
#line 27
category c752;
#line 27
category c753;
#line 27
category c754;
#line 27
category c755;
#line 27
category c756;
#line 27
category c757;
#line 27
category c758;
#line 27
category c759;
#line 27
category c760;
#line 27
category c761;
#line 27
category c762;
#line 27
category c763;
#line 27
category c764;
#line 27
category c765;
#line 27
category c766;
#line 27
category c767;
#line 27
category c768;
#line 27
category c769;
#line 27
category c770;
#line 27
category c771;
#line 27
category c772;
#line 27
category c773;
#line 27
category c774;
#line 27
category c775;
#line 27
category c776;
#line 27
category c777;
#line 27
category c778;
#line 27
category c779;
#line 27
category c780;
#line 27
category c781;
#line 27
category c782;
#line 27
category c783;
#line 27
category c784;
#line 27
category c785;
#line 27
category c786;
#line 27
category c787;
#line 27
category c788;
#line 27
category c789;
#line 27
category c790;
#line 27
category c791;
#line 27
category c792;
#line 27
category c793;
#line 27
category c794;
#line 27
category c795;
#line 27
category c796;
#line 27
category c797;
#line 27
category c798;
#line 27
category c799;
#line 27
category c800;
#line 27
category c801;
#line 27
category c802;
#line 27
category c803;
#line 27
category c804;
#line 27
category c805;
#line 27
category c806;
#line 27
category c807;
#line 27
category c808;
#line 27
category c809;
#line 27
category c810;
#line 27
category c811;
#line 27
category c812;
#line 27
category c813;
#line 27
category c814;
#line 27
category c815;
#line 27
category c816;
#line 27
category c817;
#line 27
category c818;
#line 27
category c819;
#line 27
category c820;
#line 27
category c821;
#line 27
category c822;
#line 27
category c823;
#line 27
category c824;
#line 27
category c825;
#line 27
category c826;
#line 27
category c827;
#line 27
category c828;
#line 27
category c829;
#line 27
category c830;
#line 27
category c831;
#line 27
category c832;
#line 27
category c833;
#line 27
category c834;
#line 27
category c835;
#line 27
category c836;
#line 27
category c837;
#line 27
category c838;
#line 27
category c839;
#line 27
category c840;
#line 27
category c841;
#line 27
category c842;
#line 27
category c843;
#line 27
category c844;
#line 27
category c845;
#line 27
category c846;
#line 27
category c847;
#line 27
category c848;
#line 27
category c849;
#line 27
category c850;
#line 27
category c851;
#line 27
category c852;
#line 27
category c853;
#line 27
category c854;
#line 27
category c855;
#line 27
category c856;
#line 27
category c857;
#line 27
category c858;
#line 27
category c859;
#line 27
category c860;
#line 27
category c861;
#line 27
category c862;
#line 27
category c863;
#line 27
category c864;
#line 27
category c865;
#line 27
category c866;
#line 27
category c867;
#line 27
category c868;
#line 27
category c869;
#line 27
category c870;
#line 27
category c871;
#line 27
category c872;
#line 27
category c873;
#line 27
category c874;
#line 27
category c875;
#line 27
category c876;
#line 27
category c877;
#line 27
category c878;
#line 27
category c879;
#line 27
category c880;
#line 27
category c881;
#line 27
category c882;
#line 27
category c883;
#line 27
category c884;
#line 27
category c885;
#line 27
category c886;
#line 27
category c887;
#line 27
category c888;
#line 27
category c889;
#line 27
category c890;
#line 27
category c891;
#line 27
category c892;
#line 27
category c893;
#line 27
category c894;
#line 27
category c895;
#line 27
category c896;
#line 27
category c897;
#line 27
category c898;
#line 27
category c899;
#line 27
category c900;
#line 27
category c901;
#line 27
category c902;
#line 27
category c903;
#line 27
category c904;
#line 27
category c905;
#line 27
category c906;
#line 27
category c907;
#line 27
category c908;
#line 27
category c909;
#line 27
category c910;
#line 27
category c911;
#line 27
category c912;
#line 27
category c913;
#line 27
category c914;
#line 27
category c915;
#line 27
category c916;
#line 27
category c917;
#line 27
category c918;
#line 27
category c919;
#line 27
category c920;
#line 27
category c921;
#line 27
category c922;
#line 27
category c923;
#line 27
category c924;
#line 27
category c925;
#line 27
category c926;
#line 27
category c927;
#line 27
category c928;
#line 27
category c929;
#line 27
category c930;
#line 27
category c931;
#line 27
category c932;
#line 27
category c933;
#line 27
category c934;
#line 27
category c935;
#line 27
category c936;
#line 27
category c937;
#line 27
category c938;
#line 27
category c939;
#line 27
category c940;
#line 27
category c941;
#line 27
category c942;
#line 27
category c943;
#line 27
category c944;
#line 27
category c945;
#line 27
category c946;
#line 27
category c947;
#line 27
category c948;
#line 27
category c949;
#line 27
category c950;
#line 27
category c951;
#line 27
category c952;
#line 27
category c953;
#line 27
category c954;
#line 27
category c955;
#line 27
category c956;
#line 27
category c957;
#line 27
category c958;
#line 27
category c959;
#line 27
category c960;
#line 27
category c961;
#line 27
category c962;
#line 27
category c963;
#line 27
category c964;
#line 27
category c965;
#line 27
category c966;
#line 27
category c967;
#line 27
category c968;
#line 27
category c969;
#line 27
category c970;
#line 27
category c971;
#line 27
category c972;
#line 27
category c973;
#line 27
category c974;
#line 27
category c975;
#line 27
category c976;
#line 27
category c977;
#line 27
category c978;
#line 27
category c979;
#line 27
category c980;
#line 27
category c981;
#line 27
category c982;
#line 27
category c983;
#line 27
category c984;
#line 27
category c985;
#line 27
category c986;
#line 27
category c987;
#line 27
category c988;
#line 27
category c989;
#line 27
category c990;
#line 27
category c991;
#line 27
category c992;
#line 27
category c993;
#line 27
category c994;
#line 27
category c995;
#line 27
category c996;
#line 27
category c997;
#line 27
category c998;
#line 27
category c999;
#line 27
category c1000;
#line 27
category c1001;
#line 27
category c1002;
#line 27
category c1003;
#line 27
category c1004;
#line 27
category c1005;
#line 27
category c1006;
#line 27
category c1007;
#line 27
category c1008;
#line 27
category c1009;
#line 27
category c1010;
#line 27
category c1011;
#line 27
category c1012;
#line 27
category c1013;
#line 27
category c1014;
#line 27
category c1015;
#line 27
category c1016;
#line 27
category c1017;
#line 27
category c1018;
#line 27
category c1019;
#line 27
category c1020;
#line 27
category c1021;
#line 27
category c1022;
#line 27
category c1023;
#line 27

#line 27
			
#line 27

#line 27
			
#line 27
		}
#line 27
	
#line 27


#line 28
	
#line 28
		require {
#line 28
			
#line 28
	role user_r, lspp_test_r;
#line 28
	attribute lspp_test_domains, lspp_domains;
#line 28
	type bin_t, lspp_harness_t;
#line 28

#line 28
		} # end require
#line 28
	
#line 32


## Type for test file.
type test_open_file_t;
 	 	
#line 36
##### begin files_type(test_open_file_t) depth: 1
#line 36
 	
#line 36
	
#line 36
	
#line 36
		require {
#line 36
			
#line 36
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 36
	
#line 36
		} # end require
#line 36
	
#line 36

#line 36

#line 36
	typeattribute test_open_file_t file_type, non_security_file_type, non_auth_file_type;
#line 36

#line 36
	 	
#line 36
##### end files_type(test_open_file_t) depth: 0
#line 36
 	;

## Domain for process that can open the test file for reading and writing.
 	 	
#line 39
##### begin userdom_unpriv_user_template(test_open) depth: 1
#line 39
 	
#line 39

#line 39
	##############################
#line 39
	#
#line 39
	# Declarations
#line 39
	#
#line 39

#line 39
	# Inherit rules for ordinary users.
#line 39
	 	 	
#line 39
##### begin userdom_restricted_xwindows_user_template(test_open) depth: 2
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin userdom_restricted_user_template(test_open) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute unpriv_userdomain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin userdom_login_user_template(test_open) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		class context contains;
#line 39
		attribute login_userdomain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin userdom_base_user_template(test_open) depth: 5
#line 39
 	
#line 39

#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute userdomain;
#line 39
		type user_devpts_t, user_tty_device_t;
#line 39
		class context contains;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	attribute test_open_file_type;
#line 39
	attribute test_open_usertype;
#line 39

#line 39
	type test_open_t, userdomain, test_open_usertype;
#line 39
	 	 	
#line 39
##### begin domain_type(test_open_t) depth: 6
#line 39
 	
#line 39
	# start with basic domain
#line 39
	 	 	
#line 39
##### begin domain_base_type(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t domain;
#line 39

#line 39
	 	
#line 39
##### end domain_base_type(test_open_t) depth: 6
#line 39
 	
#line 39

#line 39
	# Only way to get corenet_unlabeled packets disabled to work
#line 39
	 	 	
#line 39
##### begin corenet_all_recvfrom_unlabeled(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
                attribute corenet_unlabeled_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	typeattribute test_open_t corenet_unlabeled_type;
#line 39

#line 39
	 	
#line 39
##### end corenet_all_recvfrom_unlabeled(test_open_t) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end domain_type(test_open_t) depth: 5
#line 39
 	
#line 39
	role test_open_r;
#line 39
	 	 	
#line 39
##### begin corecmd_shell_entry_type(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type shell_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin domain_entry_file(test_open_t,shell_exec_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute entry_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t shell_exec_t:file entrypoint;
#line 39
	allow test_open_t shell_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 39

#line 39
	typeattribute shell_exec_t entry_type;
#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_executable_file(shell_exec_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute shell_exec_t exec_type;
#line 39

#line 39
	 	 	
#line 39
##### begin files_type(shell_exec_t) depth: 9
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute shell_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 39

#line 39
	 	
#line 39
##### end files_type(shell_exec_t) depth: 8
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corecmd_executable_file(shell_exec_t) depth: 7
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end domain_entry_file(test_open_t,shell_exec_t) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corecmd_shell_entry_type(test_open_t) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_bin_entry_type(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin domain_entry_file(test_open_t,bin_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute entry_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t bin_t:file entrypoint;
#line 39
	allow test_open_t bin_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 39

#line 39
	typeattribute bin_t entry_type;
#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_executable_file(bin_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute bin_t exec_type;
#line 39

#line 39
	 	 	
#line 39
##### begin files_type(bin_t) depth: 9
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute bin_t file_type, non_security_file_type, non_auth_file_type;
#line 39

#line 39
	 	
#line 39
##### end files_type(bin_t) depth: 8
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corecmd_executable_file(bin_t) depth: 7
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end domain_entry_file(test_open_t,bin_t) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin domain_entry_file(test_open_t,usr_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute entry_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t usr_t:file entrypoint;
#line 39
	allow test_open_t usr_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 39

#line 39
	typeattribute usr_t entry_type;
#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_executable_file(usr_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute usr_t exec_type;
#line 39

#line 39
	 	 	
#line 39
##### begin files_type(usr_t) depth: 9
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute usr_t file_type, non_security_file_type, non_auth_file_type;
#line 39

#line 39
	 	
#line 39
##### end files_type(usr_t) depth: 8
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corecmd_executable_file(usr_t) depth: 7
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end domain_entry_file(test_open_t,usr_t) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corecmd_bin_entry_type(test_open_t) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin domain_user_exemption_target(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute process_user_target;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t process_user_target;
#line 39

#line 39
	 	
#line 39
##### end domain_user_exemption_target(test_open_t) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin ubac_constrained(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute ubac_constrained_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t ubac_constrained_type;
#line 39

#line 39
	 	
#line 39
##### end ubac_constrained(test_open_t) depth: 5
#line 39
 	
#line 39
	role test_open_r;
#line 39
	role test_open_r types test_open_t;
#line 39
	allow system_r test_open_r;
#line 39

#line 39
	 	 	
#line 39
##### begin term_user_pty(test_open_t,user_devpts_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute server_ptynode;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin term_pty(user_devpts_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute ptynode;
#line 39
		type devpts_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_node(user_devpts_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute device_node;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute user_devpts_t device_node;
#line 39

#line 39
	 	
#line 39
##### end dev_node(user_devpts_t) depth: 7
#line 39
 	
#line 39
	allow user_devpts_t devpts_t:filesystem associate;
#line 39
	typeattribute user_devpts_t ptynode;
#line 39

#line 39
	 	
#line 39
##### end term_pty(user_devpts_t) depth: 6
#line 39
 	
#line 39
	type_change test_open_t server_ptynode:chr_file user_devpts_t;
#line 39

#line 39
	 	
#line 39
##### end term_user_pty(test_open_t,user_devpts_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin term_user_tty(test_open_t,user_tty_device_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute ttynode;
#line 39
		type console_device_t;
#line 39
		type tty_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin term_tty(user_tty_device_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute ttynode, serial_device;
#line 39
		type tty_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute user_tty_device_t ttynode, serial_device;
#line 39

#line 39
	 	 	
#line 39
##### begin dev_node(user_tty_device_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute device_node;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute user_tty_device_t device_node;
#line 39

#line 39
	 	
#line 39
##### end dev_node(user_tty_device_t) depth: 7
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end term_tty(user_tty_device_t) depth: 6
#line 39
 	
#line 39

#line 39
	type_change test_open_t tty_device_t:chr_file user_tty_device_t;
#line 39

#line 39
	# Debian login is from shadow utils and does not allow resetting the perms.
#line 39
	# have to fix this!
#line 39
	
#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool login_console_enabled;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (login_console_enabled) {
#line 39
		
#line 39
		# When user logs in from /dev/console, relabel it
#line 39
		# to user tty type as well.
#line 39
		type_change test_open_t console_device_t:chr_file user_tty_device_t;
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	 	
#line 39
##### end term_user_tty(test_open_t,user_tty_device_t) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin term_dontaudit_getattr_generic_ptys(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type devpts_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_t devpts_t:chr_file getattr;
#line 39

#line 39
	 	
#line 39
##### end term_dontaudit_getattr_generic_ptys(test_open_t) depth: 5
#line 39
 	
#line 39

#line 39
	allow test_open_usertype test_open_usertype:process { { sigchld sigkill sigstop signull signal } getsched setsched share getpgid setpgid getcap setcap getsession getattr };
#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool deny_ptrace;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (deny_ptrace) {
#line 39
		
#line 39
	} else {
#line 39
		
#line 39
		allow test_open_usertype test_open_usertype:process ptrace;
#line 39
	
#line 39
	}
#line 39

#line 39
	allow test_open_usertype test_open_usertype:fd use;
#line 39
	allow test_open_usertype test_open_t:key { create view read write search link setattr };
#line 39

#line 39
	allow test_open_usertype test_open_usertype:fifo_file { open { getattr read write append ioctl lock } };
#line 39
	allow test_open_usertype test_open_usertype:unix_dgram_socket { { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } } sendto };
#line 39
	allow test_open_usertype test_open_usertype:unix_stream_socket { { { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } } listen accept } connectto };
#line 39
	allow test_open_usertype test_open_usertype:shm { associate getattr setattr create destroy read write lock unix_read unix_write };
#line 39
	allow test_open_usertype test_open_usertype:sem { associate getattr setattr create destroy read write unix_read unix_write };
#line 39
	allow test_open_usertype test_open_usertype:msgq { associate getattr setattr create destroy read write enqueue unix_read unix_write };
#line 39
	allow test_open_usertype test_open_usertype:msg { send receive };
#line 39
	allow test_open_usertype test_open_usertype:context contains;
#line 39
	dontaudit test_open_usertype test_open_usertype:socket create;
#line 39

#line 39
	allow test_open_usertype user_devpts_t:chr_file { setattr { open { getattr read write append ioctl lock } } };
#line 39
	 	 	
#line 39
##### begin term_create_pty(test_open_usertype,user_devpts_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bsdpty_device_t, devpts_t, ptmx_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_list_all_dev_nodes(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype device_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype device_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_list_all_dev_nodes(test_open_usertype) depth: 6
#line 39
 	
#line 39
	allow test_open_usertype ptmx_t:chr_file { open { getattr read write append ioctl lock } };
#line 39

#line 39
	allow test_open_usertype devpts_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_usertype devpts_t:filesystem getattr;
#line 39
	dontaudit test_open_usertype bsdpty_device_t:chr_file { getattr read write };
#line 39
	type_transition test_open_usertype devpts_t:chr_file user_devpts_t;
#line 39

#line 39
	 	
#line 39
##### end term_create_pty(test_open_usertype,user_devpts_t) depth: 5
#line 39
 	
#line 39
	# avoid annoying messages on terminal hangup on role change
#line 39
	dontaudit test_open_usertype user_devpts_t:chr_file ioctl;
#line 39

#line 39
	allow test_open_usertype user_tty_device_t:chr_file { setattr { open { getattr read write append ioctl lock } } };
#line 39
	# avoid annoying messages on terminal hangup on role change
#line 39
	dontaudit test_open_usertype user_tty_device_t:chr_file ioctl;
#line 39

#line 39
	 	 	
#line 39
##### begin application_exec_all(test_open_usertype) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_dontaudit_exec_all_executables(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype exec_type:file { execute execute_no_trans };
#line 39

#line 39
	 	
#line 39
##### end corecmd_dontaudit_exec_all_executables(test_open_usertype) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_exec_bin(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype bin_t:dir { getattr search open };
#line 39
	allow test_open_usertype bin_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_usertype bin_t:dir { getattr search open };
#line 39
	allow test_open_usertype bin_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	allow test_open_usertype bin_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39

#line 39
	
#line 39
		 	 	
#line 39
##### begin files_exec_all_base_ro_files(test_open_usertype) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute base_ro_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype base_ro_file_type:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39

#line 39
	 	
#line 39
##### end files_exec_all_base_ro_files(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39

#line 39
	 	
#line 39
##### end corecmd_exec_bin(test_open_usertype) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_exec_shell(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t, shell_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype bin_t:dir { getattr search open };
#line 39
	allow test_open_usertype bin_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype bin_t:dir { getattr search open };
#line 39
	allow test_open_usertype bin_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_usertype shell_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39

#line 39
	 	
#line 39
##### end corecmd_exec_shell(test_open_usertype) depth: 6
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin application_exec(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute application_exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype application_exec_type:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39

#line 39
	 	
#line 39
##### end application_exec(test_open_usertype) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end application_exec_all(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin kernel_read_kernel_sysctls(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type proc_t, sysctl_t, sysctl_kernel_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype { proc_t sysctl_t sysctl_kernel_t }:dir { getattr search open };
#line 39
	allow test_open_usertype sysctl_kernel_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype { proc_t sysctl_t }:dir { getattr search open };
#line 39
	allow test_open_usertype sysctl_kernel_t:dir { getattr search open read lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end kernel_read_kernel_sysctls(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin kernel_read_all_sysctls(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute sysctl_type;
#line 39
		type proc_t, proc_net_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	# proc_net_t for /proc/net/rpc sysctls
#line 39
	
#line 39
	allow test_open_usertype { proc_t proc_net_t sysctl_type }:dir { getattr search open };
#line 39
	allow test_open_usertype sysctl_type:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype { proc_t proc_net_t }:dir { getattr search open };
#line 39
	allow test_open_usertype sysctl_type:dir { getattr search open read lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end kernel_read_all_sysctls(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin kernel_dontaudit_list_unlabeled(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type unlabeled_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype unlabeled_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end kernel_dontaudit_list_unlabeled(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin kernel_dontaudit_getattr_unlabeled_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type unlabeled_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype unlabeled_t:file getattr;
#line 39

#line 39
	 	
#line 39
##### end kernel_dontaudit_getattr_unlabeled_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin kernel_dontaudit_getattr_unlabeled_symlinks(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type unlabeled_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype unlabeled_t:lnk_file getattr;
#line 39

#line 39
	 	
#line 39
##### end kernel_dontaudit_getattr_unlabeled_symlinks(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin kernel_dontaudit_getattr_unlabeled_pipes(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type unlabeled_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype unlabeled_t:fifo_file getattr;
#line 39

#line 39
	 	
#line 39
##### end kernel_dontaudit_getattr_unlabeled_pipes(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin kernel_dontaudit_getattr_unlabeled_sockets(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type unlabeled_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype unlabeled_t:sock_file getattr;
#line 39

#line 39
	 	
#line 39
##### end kernel_dontaudit_getattr_unlabeled_sockets(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin kernel_dontaudit_getattr_unlabeled_blk_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type unlabeled_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype unlabeled_t:blk_file getattr;
#line 39

#line 39
	 	
#line 39
##### end kernel_dontaudit_getattr_unlabeled_blk_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin kernel_dontaudit_getattr_unlabeled_chr_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type unlabeled_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype unlabeled_t:chr_file getattr;
#line 39

#line 39
	 	
#line 39
##### end kernel_dontaudit_getattr_unlabeled_chr_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin kernel_dontaudit_list_proc(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type proc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype proc_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end kernel_dontaudit_list_proc(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin dev_dontaudit_getattr_all_blk_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute device_node;
#line 39
		type device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype { device_t device_node }:blk_file getattr;
#line 39

#line 39
	 	
#line 39
##### end dev_dontaudit_getattr_all_blk_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_dontaudit_getattr_all_chr_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute device_node;
#line 39
		type device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype { device_t device_node }:chr_file getattr;
#line 39

#line 39
	 	
#line 39
##### end dev_dontaudit_getattr_all_chr_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_getattr_mtrr_dev(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t, mtrr_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t device_t:dir { getattr search open };
#line 39
	allow test_open_t mtrr_device_t:file { getattr };
#line 39

#line 39
	
#line 39
	allow test_open_t device_t:dir { getattr search open };
#line 39
	allow test_open_t mtrr_device_t:chr_file { getattr };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_getattr_mtrr_dev(test_open_t) depth: 5
#line 39
 	
#line 39

#line 39
	# When the user domain runs ps, there will be a number of access
#line 39
	# denials when ps tries to search /proc. Do not audit these denials.
#line 39
	 	 	
#line 39
##### begin domain_dontaudit_read_all_domains_state(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype domain:dir { getattr search open read lock ioctl };
#line 39
	dontaudit test_open_usertype domain:lnk_file { getattr read };
#line 39
	dontaudit test_open_usertype domain:file { open { getattr read ioctl lock } };
#line 39

#line 39
	# cjp: these should be removed:
#line 39
	dontaudit test_open_usertype domain:sock_file { getattr open read };
#line 39
	dontaudit test_open_usertype domain:fifo_file { getattr open read lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end domain_dontaudit_read_all_domains_state(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin domain_dontaudit_getattr_all_domains(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype domain:process getattr;
#line 39

#line 39
	 	
#line 39
##### end domain_dontaudit_getattr_all_domains(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin domain_dontaudit_getsession_all_domains(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype domain:process getsession;
#line 39

#line 39
	 	
#line 39
##### end domain_dontaudit_getsession_all_domains(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_dontaudit_all_access_check(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute device_node;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype device_node:{ file lnk_file sock_file fifo_file chr_file blk_file } audit_access;
#line 39

#line 39
	 	
#line 39
##### end dev_dontaudit_all_access_check(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin files_read_etc_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype etc_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39
	allow test_open_usertype etc_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39
	allow test_open_usertype etc_t:lnk_file { getattr read };
#line 39

#line 39
	 	 	
#line 39
##### begin files_read_etc_runtime_files(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t, etc_runtime_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype etc_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39
	allow test_open_usertype etc_runtime_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39
	allow test_open_usertype etc_runtime_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_read_etc_runtime_files(test_open_usertype) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end files_read_etc_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_list_mnt(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type mnt_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype mnt_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end files_list_mnt(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_list_var(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end files_list_var(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_read_mnt_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type mnt_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype mnt_t:dir { getattr search open };
#line 39
	allow test_open_usertype mnt_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_read_mnt_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_dontaudit_all_access_check(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype file_type:{ dir file lnk_file sock_file fifo_file chr_file blk_file } audit_access;
#line 39

#line 39
	 	
#line 39
##### end files_dontaudit_all_access_check(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_read_etc_runtime_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t, etc_runtime_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype etc_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39
	allow test_open_usertype etc_runtime_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39
	allow test_open_usertype etc_runtime_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_read_etc_runtime_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_read_usr_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype usr_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype usr_t:dir { getattr search open };
#line 39
	allow test_open_usertype usr_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype usr_t:dir { getattr search open };
#line 39
	allow test_open_usertype usr_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_read_usr_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_read_usr_src_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type usr_t, src_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype usr_t:dir { getattr search open };
#line 39
	
#line 39
	allow test_open_usertype { usr_t src_t }:dir { getattr search open };
#line 39
	allow test_open_usertype src_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype { usr_t src_t }:dir { getattr search open };
#line 39
	allow test_open_usertype src_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_usertype src_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end files_read_usr_src_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	# Read directories and files with the readable_t type.
#line 39
	# This type is a general type for "world"-readable files.
#line 39
	 	 	
#line 39
##### begin files_list_world_readable(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type readable_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype readable_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end files_list_world_readable(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_read_world_readable_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type readable_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype readable_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end files_read_world_readable_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_read_world_readable_symlinks(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type readable_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype readable_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_read_world_readable_symlinks(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_read_world_readable_pipes(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type readable_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype readable_t:fifo_file { getattr open read lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end files_read_world_readable_pipes(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_read_world_readable_sockets(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type readable_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype readable_t:sock_file { getattr open read };
#line 39

#line 39
	 	
#line 39
##### end files_read_world_readable_sockets(test_open_usertype) depth: 5
#line 39
 	
#line 39
	# old broswer_domain():
#line 39
	 	 	
#line 39
##### begin files_dontaudit_getattr_all_dirs(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype file_type:dir getattr;
#line 39

#line 39
	 	
#line 39
##### end files_dontaudit_getattr_all_dirs(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_dontaudit_list_non_security(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute non_security_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype non_security_file_type:dir { getattr search open read lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end files_dontaudit_list_non_security(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_dontaudit_getattr_all_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype file_type:file getattr;
#line 39

#line 39
	 	
#line 39
##### end files_dontaudit_getattr_all_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_dontaudit_getattr_non_security_symlinks(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute non_security_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype non_security_file_type:lnk_file getattr;
#line 39

#line 39
	 	
#line 39
##### end files_dontaudit_getattr_non_security_symlinks(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_dontaudit_getattr_non_security_pipes(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute non_security_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype non_security_file_type:fifo_file getattr;
#line 39

#line 39
	 	
#line 39
##### end files_dontaudit_getattr_non_security_pipes(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_dontaudit_getattr_non_security_sockets(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute non_security_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype non_security_file_type:sock_file getattr;
#line 39

#line 39
	 	
#line 39
##### end files_dontaudit_getattr_non_security_sockets(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_dontaudit_setattr_etc_runtime_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_runtime_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype etc_runtime_t:file setattr;
#line 39

#line 39
	 	
#line 39
##### end files_dontaudit_setattr_etc_runtime_files(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin files_exec_usr_files(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t usr_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_t usr_t:dir { getattr search open };
#line 39
	allow test_open_t usr_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39

#line 39
	
#line 39
	allow test_open_t usr_t:dir { getattr search open };
#line 39
	allow test_open_t usr_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_exec_usr_files(test_open_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin fs_list_cgroup_dirs(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cgroup_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype cgroup_t:dir { getattr search open };
#line 39
	allow test_open_usertype cgroup_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	 	 	
#line 39
##### begin fs_search_tmpfs(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype tmpfs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_tmpfs(test_open_usertype) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_search_sysfs(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype sysfs_t:dir { getattr search open };
#line 39
	allow test_open_usertype sysfs_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_search_sysfs(test_open_usertype) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end fs_list_cgroup_dirs(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin fs_dontaudit_rw_cgroup_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cgroup_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype cgroup_t:file { open { getattr read write append ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end fs_dontaudit_rw_cgroup_files(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin storage_rw_fuse(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type fuse_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype fuse_device_t:chr_file { open { getattr read write append ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end storage_rw_fuse(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin auth_use_nsswitch(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute nsswitch_domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t nsswitch_domain;
#line 39

#line 39
	 	 	
#line 39
##### begin corenet_all_recvfrom_netlabel(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute netlabel_peer_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t netlabel_peer_type;
#line 39

#line 39
	 	
#line 39
##### end corenet_all_recvfrom_netlabel(test_open_t) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end auth_use_nsswitch(test_open_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin init_stream_connect(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type init_t, init_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype init_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype init_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_usertype init_t:unix_stream_socket connectto;
#line 39
    
#line 39
	allow test_open_usertype init_t:unix_stream_socket getattr;
#line 39

#line 39
	 	
#line 39
##### end init_stream_connect(test_open_usertype) depth: 5
#line 39
 	
#line 39
	# The library functions always try to open read-write first,
#line 39
	# then fall back to read-only if it fails. 
#line 39
	 	 	
#line 39
##### begin init_dontaudit_rw_utmp(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type initrc_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype initrc_var_run_t:file { open { getattr read write append ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end init_dontaudit_rw_utmp(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin libs_exec_ld_so(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type lib_t, ld_so_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype lib_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype lib_t:dir { getattr search open };
#line 39
	allow test_open_usertype { lib_t ld_so_t }:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_usertype lib_t:dir { getattr search open };
#line 39
	allow test_open_usertype ld_so_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39

#line 39

#line 39
	 	
#line 39
##### end libs_exec_ld_so(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin miscfiles_read_generic_certs(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cert_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t cert_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_t cert_t:dir { getattr search open };
#line 39
	allow test_open_t cert_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_t cert_t:dir { getattr search open };
#line 39
	allow test_open_t cert_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end miscfiles_read_generic_certs(test_open_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin miscfiles_read_all_certs(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute cert_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype cert_type:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype cert_type:dir { getattr search open };
#line 39
	allow test_open_usertype cert_type:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype cert_type:dir { getattr search open };
#line 39
	allow test_open_usertype cert_type:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end miscfiles_read_all_certs(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin miscfiles_read_public_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type public_content_t, public_content_rw_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype { public_content_t public_content_rw_t }:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype { public_content_t public_content_rw_t }:dir { getattr search open };
#line 39
	allow test_open_usertype { public_content_t public_content_rw_t }:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype { public_content_t public_content_rw_t }:dir { getattr search open };
#line 39
	allow test_open_usertype { public_content_t public_content_rw_t }:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end miscfiles_read_public_files(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin systemd_dbus_chat_logind(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type systemd_logind_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype systemd_logind_t:dbus send_msg;
#line 39
	allow systemd_logind_t test_open_usertype:dbus send_msg;
#line 39
	
#line 39
	allow systemd_logind_t test_open_usertype:dir { getattr search open read lock ioctl };
#line 39
	allow systemd_logind_t test_open_usertype:file { open { getattr read ioctl lock } };
#line 39
	allow systemd_logind_t test_open_usertype:lnk_file { getattr read };
#line 39
	allow systemd_logind_t test_open_usertype:process getattr;
#line 39

#line 39
	allow systemd_logind_t test_open_usertype:process signal;
#line 39
	allow test_open_usertype systemd_logind_t:fd use;
#line 39

#line 39
	 	
#line 39
##### end systemd_dbus_chat_logind(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin systemd_read_logind_sessions_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type systemd_logind_sessions_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin init_search_pid_dirs(test_open_usertype) depth: 7
#line 39
 	
#line 39
    
#line 39
	
#line 39
		require {
#line 39
			
#line 39
        type init_var_run_t;
#line 39
    
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
    allow test_open_usertype init_var_run_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end init_search_pid_dirs(test_open_usertype) depth: 6
#line 39
 	
#line 39
	allow test_open_usertype systemd_logind_sessions_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype systemd_logind_sessions_t:dir { getattr search open };
#line 39
	allow test_open_usertype systemd_logind_sessions_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end systemd_read_logind_sessions_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin systemd_write_inhibit_pipes(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type systemd_logind_inhibit_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype systemd_logind_inhibit_var_run_t:fifo_file write;
#line 39

#line 39
	 	
#line 39
##### end systemd_write_inhibit_pipes(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin systemd_write_inherited_logind_sessions_pipes(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type systemd_logind_sessions_t;
#line 39
		type systemd_logind_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype systemd_logind_t:fd use;
#line 39
	allow test_open_usertype systemd_logind_sessions_t:fifo_file write;
#line 39

#line 39
	 	
#line 39
##### end systemd_write_inherited_logind_sessions_pipes(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin systemd_login_read_pid_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type systemd_logind_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype systemd_logind_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype systemd_logind_var_run_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end systemd_login_read_pid_files(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool deny_execmem;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (deny_execmem) {
#line 39
		
#line 39
	} else {
#line 39
		
#line 39
		# Allow loading DSOs that require executable stack.
#line 39
		allow test_open_t self:process execmem;
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool selinuxuser_execstack;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (selinuxuser_execstack) {
#line 39
		
#line 39
		# Allow making the stack executable via mprotect.
#line 39
		allow test_open_t self:process execstack;
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin abrt_stream_connect(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type abrt_t, abrt_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype abrt_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype abrt_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_usertype abrt_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end abrt_stream_connect(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin fs_list_cgroup_dirs(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cgroup_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype cgroup_t:dir { getattr search open };
#line 39
	allow test_open_usertype cgroup_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	 	 	
#line 39
##### begin fs_search_tmpfs(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype tmpfs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_tmpfs(test_open_usertype) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_search_sysfs(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype sysfs_t:dir { getattr search open };
#line 39
	allow test_open_usertype sysfs_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_search_sysfs(test_open_usertype) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end fs_list_cgroup_dirs(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39
	
#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin ssh_rw_stream_sockets(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sshd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype sshd_t:unix_stream_socket { { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } listen accept };
#line 39

#line 39
	 	
#line 39
##### end ssh_rw_stream_sockets(test_open_usertype) depth: 5
#line 39
 	
#line 39
         	 	
#line 39
##### begin ssh_rw_dgram_sockets(test_open_usertype) depth: 6
#line 39
 	
#line 39
    
#line 39
	
#line 39
		require {
#line 39
			
#line 39
        type sshd_t;
#line 39
    
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
    allow test_open_usertype sshd_t:unix_dgram_socket { { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } listen accept };
#line 39

#line 39
	 	
#line 39
##### end ssh_rw_dgram_sockets(test_open_usertype) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin ssh_delete_tmp(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sshd_tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_tmp(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin fs_search_tmpfs(test_open_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t tmpfs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_tmpfs(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	allow test_open_t tmp_t:dir { getattr search open };
#line 39
	allow test_open_t tmp_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_t tmp_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_tmp(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	allow test_open_t sshd_tmp_t:dir { getattr search open lock ioctl write remove_name };
#line 39
	allow test_open_t sshd_tmp_t:file { getattr unlink };
#line 39

#line 39

#line 39
	 	
#line 39
##### end ssh_delete_tmp(test_open_t) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin ssh_signal(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sshd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t sshd_t:process signal;
#line 39

#line 39
	 	
#line 39
##### end ssh_signal(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39
 	 	
#line 39
##### end userdom_base_user_template(test_open) depth: 4
#line 39
 	
#line 39

#line 39
	typeattribute test_open_t login_userdomain;
#line 39

#line 39
	 	 	
#line 39
##### begin userdom_manage_home_role(test_open_r,test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_t, user_home_dir_t;
#line 39
		attribute user_home_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	role test_open_r types { user_home_type user_home_dir_t };
#line 39

#line 39
	##############################
#line 39
	#
#line 39
	# Domain access to home dir
#line 39
	#
#line 39

#line 39
	type_member test_open_t user_home_dir_t:dir user_home_dir_t;
#line 39

#line 39
	# full control of the home directory
#line 39
	allow test_open_t user_home_t:dir mounton;
#line 39
	allow test_open_t user_home_t:file entrypoint;
#line 39

#line 39
	allow test_open_t user_home_type:{ dir file lnk_file sock_file fifo_file chr_file blk_file } { relabelto relabelfrom };
#line 39
	allow test_open_t user_home_dir_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_t user_home_type:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_t user_home_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_t user_home_type:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_t user_home_type:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 39

#line 39
	
#line 39
	allow test_open_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_t user_home_type:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 39
	allow test_open_t user_home_type:dir { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 39
	allow test_open_t user_home_type:file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 39
	allow test_open_t user_home_type:lnk_file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 39
	allow test_open_t user_home_type:sock_file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 39
	allow test_open_t user_home_type:fifo_file { getattr relabelfrom relabelto };
#line 39

#line 39
	 	 	
#line 39
##### begin userdom_filetrans_home_content(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
	        attribute userdom_filetrans_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t  userdom_filetrans_type;
#line 39

#line 39
	 	
#line 39
##### end userdom_filetrans_home_content(test_open_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin files_list_home(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t home_root_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_list_home(test_open_t) depth: 5
#line 39
 	
#line 39

#line 39
	# cjp: this should probably be removed:
#line 39
	allow test_open_t user_home_dir_t:dir { { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl } { getattr relabelfrom relabelto } };
#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool use_nfs_home_dirs;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (use_nfs_home_dirs) {
#line 39
		
#line 39
		 	 	
#line 39
##### begin fs_mount_nfs(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t nfs_t:filesystem mount;
#line 39

#line 39
	 	
#line 39
##### end fs_mount_nfs(test_open_t) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_mounton_nfs(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t nfs_t:dir mounton;
#line 39

#line 39
	 	
#line 39
##### end fs_mounton_nfs(test_open_t) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_nfs_dirs(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin fs_search_auto_mountpoints(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type autofs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t autofs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_auto_mountpoints(test_open_t) depth: 6
#line 39
 	
#line 39
	allow test_open_t nfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end fs_manage_nfs_dirs(test_open_t) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_nfs_files(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin fs_search_auto_mountpoints(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type autofs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t autofs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_auto_mountpoints(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	allow test_open_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_t nfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_nfs_files(test_open_t) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_nfs_symlinks(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin fs_search_auto_mountpoints(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type autofs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t autofs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_auto_mountpoints(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	allow test_open_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_t nfs_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_nfs_symlinks(test_open_t) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_nfs_named_sockets(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_t nfs_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_nfs_named_sockets(test_open_t) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_nfs_named_pipes(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_t nfs_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_nfs_named_pipes(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool use_samba_home_dirs;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (use_samba_home_dirs) {
#line 39
		
#line 39
		 	 	
#line 39
##### begin fs_mount_cifs(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t cifs_t:filesystem mount;
#line 39

#line 39
	 	
#line 39
##### end fs_mount_cifs(test_open_t) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_mounton_cifs(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t cifs_t:dir mounton;
#line 39

#line 39
	 	
#line 39
##### end fs_mounton_cifs(test_open_t) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_cifs_dirs(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t cifs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end fs_manage_cifs_dirs(test_open_t) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_cifs_files(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_t cifs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_cifs_files(test_open_t) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_cifs_symlinks(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_t cifs_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_cifs_symlinks(test_open_t) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_cifs_named_sockets(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_t cifs_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_cifs_named_sockets(test_open_t) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_cifs_named_pipes(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_t cifs_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_cifs_named_pipes(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_manage_home_role(test_open_r,test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin userdom_manage_tmp_role(test_open_r,test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute user_tmp_type;
#line 39
		type user_tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	role test_open_r types user_tmp_t;
#line 39

#line 39
	 	 	
#line 39
##### begin files_poly_member_tmp(test_open_usertype,user_tmp_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	type_member test_open_usertype tmp_t:dir user_tmp_t;
#line 39

#line 39
	 	
#line 39
##### end files_poly_member_tmp(test_open_usertype,user_tmp_t) depth: 5
#line 39
 	
#line 39

#line 39
	allow test_open_usertype user_tmp_type:dir mounton;
#line 39
	
#line 39
	allow test_open_usertype user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_usertype user_tmp_type:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_usertype user_tmp_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_usertype user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_usertype user_tmp_type:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_usertype user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_usertype user_tmp_type:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 39

#line 39
	
#line 39
	allow test_open_usertype user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_usertype user_tmp_type:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	 	 	
#line 39
##### begin files_tmp_filetrans(test_open_usertype,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_usertype tmp_t:{ dir file lnk_file sock_file fifo_file } user_tmp_t ;
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_tmp_filetrans(test_open_usertype,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 5
#line 39
 	
#line 39
     	 	
#line 39
##### begin fs_tmpfs_filetrans(test_open_usertype,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow user_tmp_t tmpfs_t:filesystem associate;
#line 39
	
#line 39
	allow test_open_usertype tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_usertype tmpfs_t:{ dir file lnk_file sock_file fifo_file } user_tmp_t ;
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_tmpfs_filetrans(test_open_usertype,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype user_tmp_type:dir { getattr search open };
#line 39
	allow test_open_usertype user_tmp_type:dir { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_usertype user_tmp_type:dir { getattr search open };
#line 39
	allow test_open_usertype user_tmp_type:file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_usertype user_tmp_type:dir { getattr search open };
#line 39
	allow test_open_usertype user_tmp_type:lnk_file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_usertype user_tmp_type:dir { getattr search open };
#line 39
	allow test_open_usertype user_tmp_type:sock_file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_usertype user_tmp_type:dir { getattr search open };
#line 39
	allow test_open_usertype user_tmp_type:fifo_file { getattr relabelfrom relabelto };
#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_manage_tmp_role(test_open_r,test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	
#line 39
		
#line 39
	bool test_open_exec_content true;
#line 39

#line 39

#line 39
		
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool test_open_exec_content;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (test_open_exec_content) {
#line 39
		
#line 39
			 	 	
#line 39
##### begin userdom_exec_user_tmp_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype user_tmp_t:dir { getattr search open };
#line 39
	allow test_open_usertype user_tmp_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39

#line 39
	dontaudit test_open_usertype user_tmp_t:sock_file execute;
#line 39
	 	 	
#line 39
##### begin files_search_tmp(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin fs_search_tmpfs(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype tmpfs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_tmpfs(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype tmp_t:dir { getattr search open };
#line 39
	allow test_open_usertype tmp_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_usertype tmp_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_tmp(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_exec_user_tmp_files(test_open_usertype) depth: 4
#line 39
 	
#line 39
			 	 	
#line 39
##### begin userdom_exec_user_home_content_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_dir_t;
#line 39
		attribute user_home_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_home(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype home_root_t:dir { getattr search open };
#line 39
	allow test_open_usertype home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_search_home(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype { user_home_dir_t user_home_type }:dir { getattr search open };
#line 39
	allow test_open_usertype user_home_type:file { getattr open map read execute ioctl execute_no_trans };
#line 39

#line 39
	dontaudit test_open_usertype user_home_type:sock_file execute;
#line 39
	
#line 39
	 	
#line 39
##### end userdom_exec_user_home_content_files(test_open_usertype) depth: 4
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39
		
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool test_open_exec_content;
#line 39

#line 39
bool use_nfs_home_dirs;
#line 39

#line 39
   
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (test_open_exec_content && use_nfs_home_dirs) {
#line 39
		
#line 39
                         	 	
#line 39
##### begin fs_exec_nfs_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype nfs_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype nfs_t:dir { getattr search open };
#line 39
	allow test_open_usertype nfs_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_exec_nfs_files(test_open_usertype) depth: 4
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool test_open_exec_content;
#line 39

#line 39
bool use_samba_home_dirs;
#line 39

#line 39
   
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (test_open_exec_content && use_samba_home_dirs) {
#line 39
		
#line 39
			 	 	
#line 39
##### begin fs_exec_cifs_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype cifs_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype cifs_t:dir { getattr search open };
#line 39
	allow test_open_usertype cifs_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_exec_cifs_files(test_open_usertype) depth: 4
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39
	
#line 39

#line 39
	 	 	
#line 39
##### begin userdom_change_password_template(test_open) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type test_open_t;
#line 39
		role test_open_r;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin usermanage_run_chfn(test_open_t,test_open_r) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute_role chfn_roles;
#line 39
		type chfn_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin usermanage_domtrans_chfn(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type chfn_t, chfn_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_search_bin(test_open_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_read_bin_symlinks(test_open_t) depth: 9
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_read_bin_symlinks(test_open_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_search_bin(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t chfn_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t chfn_t:process transition;
#line 39
#	dontaudit test_open_t chfn_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t chfn_exec_t:process chfn_t;
#line 39

#line 39

#line 39
	allow chfn_t test_open_t:fd use;
#line 39
	allow chfn_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow chfn_t test_open_t:process sigchld;
#line 39

#line 39

#line 39
	 	
#line 39
##### end usermanage_domtrans_chfn(test_open_t) depth: 6
#line 39
 	
#line 39
	roleattribute test_open_r chfn_roles;
#line 39

#line 39
	 	
#line 39
##### end usermanage_run_chfn(test_open_t,test_open_r) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin usermanage_run_passwd(test_open_t,test_open_r) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type passwd_t;
#line 39
		attribute_role passwd_roles;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin usermanage_domtrans_passwd(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type passwd_t, passwd_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_search_bin(test_open_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_read_bin_symlinks(test_open_t) depth: 9
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_read_bin_symlinks(test_open_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_search_bin(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t passwd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t passwd_t:process transition;
#line 39
#	dontaudit test_open_t passwd_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t passwd_exec_t:process passwd_t;
#line 39

#line 39

#line 39
	allow passwd_t test_open_t:fd use;
#line 39
	allow passwd_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow passwd_t test_open_t:process sigchld;
#line 39

#line 39

#line 39
	 	
#line 39
##### end usermanage_domtrans_passwd(test_open_t) depth: 6
#line 39
 	
#line 39
	roleattribute test_open_r passwd_roles;
#line 39

#line 39
	 	
#line 39
##### end usermanage_run_passwd(test_open_t,test_open_r) depth: 5
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39
 	 	
#line 39
##### end userdom_change_password_template(test_open) depth: 4
#line 39
 	
#line 39

#line 39
	##############################
#line 39
	#
#line 39
	# User domain Local policy
#line 39
	#
#line 39
	dontaudit test_open_t self:capability { sys_nice fsetid };
#line 39
	allow test_open_t self:process ~{ ptrace execmem execstack execheap };
#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool selinuxuser_use_ssh_chroot;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (selinuxuser_use_ssh_chroot) {
#line 39
		
#line 39
		allow test_open_t self:capability { setuid setgid sys_chroot };
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	dontaudit test_open_t self:process setrlimit;
#line 39
	dontaudit test_open_t self:netlink_route_socket { create ioctl read getattr write setattr append bind connect getopt setopt shutdown nlmsg_read nlmsg_write };
#line 39
	 	 	
#line 39
##### begin domain_dyntrans_type(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute set_curr_context;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t set_curr_context;
#line 39

#line 39
	 	
#line 39
##### end domain_dyntrans_type(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	allow test_open_t self:context contains;
#line 39

#line 39
	 	 	
#line 39
##### begin kernel_dontaudit_read_system_state(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type proc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype proc_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end kernel_dontaudit_read_system_state(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin kernel_dontaudit_list_all_proc(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute proc_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype proc_type:dir { getattr search open read lock ioctl };
#line 39
	dontaudit test_open_usertype proc_type:file getattr;
#line 39

#line 39
	 	
#line 39
##### end kernel_dontaudit_list_all_proc(test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin dev_read_sysfs(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype sysfs_t:dir { getattr search open };
#line 39
	allow test_open_usertype sysfs_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype sysfs_t:dir { getattr search open };
#line 39
	allow test_open_usertype sysfs_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype sysfs_t:dir { getattr search open };
#line 39
	allow test_open_usertype sysfs_t:dir { getattr search open read lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_read_sysfs(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_read_rand(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t, random_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype random_device_t:chr_file { getattr open read lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_read_rand(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_read_urand(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t, urandom_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype urandom_device_t:chr_file { getattr open read lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_read_urand(test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin domain_use_interactive_fds(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute privfd;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype privfd:fd use;
#line 39

#line 39
	 	
#line 39
##### end domain_use_interactive_fds(test_open_usertype) depth: 4
#line 39
 	
#line 39
	# Command completion can fire hundreds of denials
#line 39
	 	 	
#line 39
##### begin domain_dontaudit_exec_all_entry_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute entry_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype entry_type:file { getattr open map read execute ioctl execute_no_trans };
#line 39

#line 39
	 	
#line 39
##### end domain_dontaudit_exec_all_entry_files(test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin files_dontaudit_list_default(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type default_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype default_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end files_dontaudit_list_default(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_dontaudit_read_default_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type default_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype default_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end files_dontaudit_read_default_files(test_open_usertype) depth: 4
#line 39
 	
#line 39
	# Stat lost+found.
#line 39
	 	 	
#line 39
##### begin files_getattr_lost_found_dirs(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type lost_found_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype lost_found_t:dir getattr;
#line 39

#line 39
	 	
#line 39
##### end files_getattr_lost_found_dirs(test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin fs_get_all_fs_quotas(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute filesystem_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype filesystem_type:filesystem quotaget;
#line 39

#line 39
	 	
#line 39
##### end fs_get_all_fs_quotas(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin fs_getattr_all_fs(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute filesystem_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype filesystem_type:filesystem getattr;
#line 39
	 	 	
#line 39
##### begin files_getattr_all_file_type_fs(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype file_type:filesystem getattr;
#line 39

#line 39
	 	
#line 39
##### end files_getattr_all_file_type_fs(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end fs_getattr_all_fs(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin fs_search_all(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute filesystem_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype filesystem_type:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_all(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin fs_list_inotifyfs(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type inotifyfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype inotifyfs_t:dir { getattr search open read lock ioctl };
#line 39
	 	 	
#line 39
##### begin fs_read_anon_inodefs_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type anon_inodefs_t;
#line 39

#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype anon_inodefs_t:dir { getattr search open };
#line 39
	allow test_open_usertype anon_inodefs_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_read_anon_inodefs_files(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end fs_list_inotifyfs(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin fs_rw_anon_inodefs_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type anon_inodefs_t;
#line 39

#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype anon_inodefs_t:dir { getattr search open };
#line 39
	allow test_open_usertype anon_inodefs_t:file { open { getattr read write append ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_rw_anon_inodefs_files(test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin auth_role(test_open_r,test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type chkpwd_t, chkpwd_exec_t, shadow_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	role test_open_r types chkpwd_t;
#line 39

#line 39
	# Transition from the user domain to this domain.
#line 39
	 	 	
#line 39
##### begin auth_domtrans_chkpwd(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type chkpwd_t, chkpwd_exec_t, shadow_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_search_bin(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_read_bin_symlinks(test_open_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_read_bin_symlinks(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_search_bin(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t chkpwd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t chkpwd_t:process transition;
#line 39
#	dontaudit test_open_t chkpwd_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t chkpwd_exec_t:process chkpwd_t;
#line 39

#line 39

#line 39
	allow chkpwd_t test_open_t:fd use;
#line 39
	allow chkpwd_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow chkpwd_t test_open_t:process sigchld;
#line 39

#line 39
	dontaudit test_open_t shadow_t:file { getattr read };
#line 39
	 	 	
#line 39
##### begin auth_domtrans_upd_passwd(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type updpwd_t, updpwd_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t updpwd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t updpwd_t:process transition;
#line 39
#	dontaudit test_open_t updpwd_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t updpwd_exec_t:process updpwd_t;
#line 39

#line 39

#line 39
	allow updpwd_t test_open_t:fd use;
#line 39
	allow updpwd_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow updpwd_t test_open_t:process sigchld;
#line 39

#line 39
	 	 	
#line 39
##### begin auth_dontaudit_read_shadow(test_open_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type shadow_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_t shadow_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end auth_dontaudit_read_shadow(test_open_t) depth: 7
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end auth_domtrans_upd_passwd(test_open_t) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end auth_domtrans_chkpwd(test_open_t) depth: 5
#line 39
 	
#line 39

#line 39
	
#line 39
	allow test_open_t chkpwd_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t chkpwd_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_t chkpwd_t:lnk_file { getattr read };
#line 39
	allow test_open_t chkpwd_t:process getattr;
#line 39

#line 39

#line 39
	dontaudit test_open_t shadow_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	 	 	
#line 39
##### begin logging_send_syslog_msg(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute syslog_client_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t syslog_client_type;
#line 39

#line 39
	 	
#line 39
##### end logging_send_syslog_msg(test_open_t) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin logging_send_audit_msgs(test_open_t) depth: 6
#line 39
 	
#line 39
	allow test_open_t self:capability audit_write;
#line 39
	allow test_open_t self:netlink_audit_socket { { { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } } nlmsg_read } nlmsg_relay nlmsg_tty_audit };
#line 39

#line 39
	 	
#line 39
##### end logging_send_audit_msgs(test_open_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin usermanage_read_crack_db(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type crack_db_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t var_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_var(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	allow test_open_t crack_db_t:dir { getattr search open };
#line 39
	allow test_open_t crack_db_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end usermanage_read_crack_db(test_open_t) depth: 5
#line 39
 	
#line 39

#line 39

#line 39
	 	
#line 39
##### end auth_role(test_open_r,test_open_t) depth: 4
#line 39
 	
#line 39
     	 	
#line 39
##### begin auth_create_cache(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type auth_cache_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t auth_cache_t:dir { getattr search open lock ioctl write add_name };
#line 39
	allow test_open_t auth_cache_t:file { getattr create open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end auth_create_cache(test_open_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin auth_rw_cache(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type auth_cache_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t auth_cache_t:dir { getattr search open };
#line 39
	allow test_open_t auth_cache_t:file { open { getattr read write append ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end auth_rw_cache(test_open_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin auth_search_pam_console_data(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type pam_var_console_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t var_t:lnk_file { getattr read };
#line 39
	allow test_open_t var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_t var_t:dir { getattr search open };
#line 39
	allow test_open_t var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_t) depth: 5
#line 39
 	
#line 39
	allow test_open_t pam_var_console_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end auth_search_pam_console_data(test_open_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin auth_dontaudit_read_login_records(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type wtmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_t wtmp_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end auth_dontaudit_read_login_records(test_open_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin auth_dontaudit_write_login_records(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type wtmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_t wtmp_t:file write;
#line 39

#line 39
	 	
#line 39
##### end auth_dontaudit_write_login_records(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin application_exec_all(test_open_t) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_dontaudit_exec_all_executables(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_t exec_type:file { execute execute_no_trans };
#line 39

#line 39
	 	
#line 39
##### end corecmd_dontaudit_exec_all_executables(test_open_t) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_exec_bin(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	allow test_open_t bin_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39

#line 39
	
#line 39
		 	 	
#line 39
##### begin files_exec_all_base_ro_files(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute base_ro_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t base_ro_file_type:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39

#line 39
	 	
#line 39
##### end files_exec_all_base_ro_files(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39

#line 39
	 	
#line 39
##### end corecmd_exec_bin(test_open_t) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_exec_shell(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t, shell_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_t shell_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39

#line 39
	 	
#line 39
##### end corecmd_exec_shell(test_open_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin application_exec(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute application_exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t application_exec_type:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39

#line 39
	 	
#line 39
##### end application_exec(test_open_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end application_exec_all(test_open_t) depth: 4
#line 39
 	
#line 39
	# The library functions always try to open read-write first,
#line 39
	# then fall back to read-only if it fails.
#line 39
	 	 	
#line 39
##### begin init_dontaudit_rw_utmp(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type initrc_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_t initrc_var_run_t:file { open { getattr read write append ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end init_dontaudit_rw_utmp(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	# Stop warnings about access to /dev/console
#line 39
	 	 	
#line 39
##### begin init_dontaudit_use_fds(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type init_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype init_t:fd use;
#line 39

#line 39
	 	
#line 39
##### end init_dontaudit_use_fds(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin init_dontaudit_use_script_fds(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type initrc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype initrc_t:fd use;
#line 39

#line 39
	 	
#line 39
##### end init_dontaudit_use_script_fds(test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin libs_exec_lib_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_usr(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype usr_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_usr(test_open_usertype) depth: 5
#line 39
 	
#line 39
	allow test_open_usertype lib_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype lib_t:dir { getattr search open };
#line 39
	allow test_open_usertype lib_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_usertype lib_t:dir { getattr search open };
#line 39
	allow test_open_usertype lib_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39

#line 39

#line 39
	 	
#line 39
##### end libs_exec_lib_files(test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin logging_dontaudit_getattr_all_logs(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute logfile;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype logfile:file getattr;
#line 39

#line 39
	 	
#line 39
##### end logging_dontaudit_getattr_all_logs(test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	# for running TeX programs
#line 39
	 	 	
#line 39
##### begin miscfiles_read_tetex_data(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tetex_data_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_var(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_search_var_lib(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_lib_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_var_lib(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	# cjp: TeX data can be in either of the above dirs
#line 39
	allow test_open_usertype tetex_data_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype tetex_data_t:dir { getattr search open };
#line 39
	allow test_open_usertype tetex_data_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype tetex_data_t:dir { getattr search open };
#line 39
	allow test_open_usertype tetex_data_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end miscfiles_read_tetex_data(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin miscfiles_exec_tetex_data(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type fonts_t;
#line 39
		type tetex_data_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_var(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_search_var_lib(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_lib_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_var_lib(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	# cjp: TeX data can be in either of the above dirs
#line 39
	allow test_open_usertype tetex_data_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype tetex_data_t:dir { getattr search open };
#line 39
	allow test_open_usertype tetex_data_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39

#line 39

#line 39
	 	
#line 39
##### end miscfiles_exec_tetex_data(test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin seutil_read_config(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type selinux_config_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_etc(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_etc(test_open_usertype) depth: 5
#line 39
 	
#line 39
	allow test_open_usertype selinux_config_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype selinux_config_t:dir { getattr search open };
#line 39
	allow test_open_usertype selinux_config_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype selinux_config_t:dir { getattr search open };
#line 39
	allow test_open_usertype selinux_config_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end seutil_read_config(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin seutil_read_file_contexts(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type selinux_config_t, default_context_t, file_context_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_etc(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_etc(test_open_usertype) depth: 5
#line 39
 	
#line 39
	allow test_open_usertype { selinux_config_t default_context_t }:dir { getattr search open };
#line 39
	
#line 39
	allow test_open_usertype file_context_t:dir { getattr search open };
#line 39
	allow test_open_usertype file_context_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype file_context_t:dir { getattr search open };
#line 39
	allow test_open_usertype file_context_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype file_context_t:dir { getattr search open };
#line 39
	allow test_open_usertype file_context_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_usertype file_context_t:file map;
#line 39

#line 39
	 	
#line 39
##### end seutil_read_file_contexts(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin seutil_read_default_contexts(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type selinux_config_t, default_context_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_etc(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_etc(test_open_usertype) depth: 5
#line 39
 	
#line 39
	allow test_open_usertype selinux_config_t:dir { getattr search open };
#line 39
	allow test_open_usertype default_context_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype default_context_t:dir { getattr search open };
#line 39
	allow test_open_usertype default_context_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end seutil_read_default_contexts(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin seutil_exec_setfiles(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type setfiles_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_usr(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype usr_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_usr(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_search_bin(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_read_bin_symlinks(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype bin_t:dir { getattr search open };
#line 39
	allow test_open_usertype bin_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_read_bin_symlinks(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype bin_t:dir { getattr search open };
#line 39
	allow test_open_usertype bin_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_search_bin(test_open_usertype) depth: 5
#line 39
 	
#line 39
	allow test_open_usertype setfiles_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39

#line 39
	 	
#line 39
##### end seutil_exec_setfiles(test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin cups_read_config(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cupsd_etc_t, cupsd_rw_etc_t;
#line 39
		type hplip_etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_etc(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_etc(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype cupsd_etc_t:dir { getattr search open };
#line 39
	allow test_open_usertype cupsd_etc_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype hplip_etc_t:dir { getattr search open };
#line 39
	allow test_open_usertype hplip_etc_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype cupsd_etc_t:dir { getattr search open };
#line 39
	allow test_open_usertype cupsd_rw_etc_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end cups_read_config(test_open_usertype) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin cups_stream_connect(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cupsd_t, cupsd_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype cupsd_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype cupsd_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_usertype cupsd_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end cups_stream_connect(test_open_usertype) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin cups_stream_connect_ptal(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type ptal_t, ptal_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype ptal_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype ptal_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_usertype ptal_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end cups_stream_connect_ptal(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin kerberos_use(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type krb5_conf_t, krb5kdc_conf_t;
#line 39
		type krb5_host_rcache_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_etc(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_etc(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype krb5_conf_t:dir { getattr search open };
#line 39
	allow test_open_usertype krb5_conf_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype krb5_conf_t:dir { getattr search open };
#line 39
	allow test_open_usertype krb5_conf_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	dontaudit test_open_usertype krb5_conf_t:file write;
#line 39
	dontaudit test_open_usertype krb5kdc_conf_t:dir { getattr search open read lock ioctl };
#line 39
	dontaudit test_open_usertype krb5kdc_conf_t:file { open { getattr read write append ioctl lock } };
#line 39

#line 39
	#kerberos libraries are attempting to set the correct file context
#line 39
	dontaudit test_open_usertype self:process setfscreate;
#line 39
	 	 	
#line 39
##### begin selinux_dontaudit_validate_context(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type security_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype security_t:dir { getattr search open read lock ioctl };
#line 39
	dontaudit test_open_usertype security_t:file { open { getattr read write append ioctl lock } };
#line 39
	dontaudit test_open_usertype security_t:security check_context;
#line 39

#line 39
	 	
#line 39
##### end selinux_dontaudit_validate_context(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin seutil_read_file_contexts(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type selinux_config_t, default_context_t, file_context_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_etc(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_etc(test_open_usertype) depth: 6
#line 39
 	
#line 39
	allow test_open_usertype { selinux_config_t default_context_t }:dir { getattr search open };
#line 39
	
#line 39
	allow test_open_usertype file_context_t:dir { getattr search open };
#line 39
	allow test_open_usertype file_context_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype file_context_t:dir { getattr search open };
#line 39
	allow test_open_usertype file_context_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype file_context_t:dir { getattr search open };
#line 39
	allow test_open_usertype file_context_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_usertype file_context_t:file map;
#line 39

#line 39
	 	
#line 39
##### end seutil_read_file_contexts(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool kerberos_enabled;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (kerberos_enabled) {
#line 39
		
#line 39
		allow test_open_usertype self:tcp_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 39
		allow test_open_usertype self:udp_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 39

#line 39
		 	 	
#line 39
##### begin corenet_tcp_sendrecv_generic_if(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type netif_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype netif_t:netif { tcp_send tcp_recv egress ingress };
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_sendrecv_generic_if(test_open_usertype) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin corenet_udp_sendrecv_generic_if(test_open_usertype) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_udp_send_generic_if(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type netif_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype netif_t:netif { udp_send egress };
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_send_generic_if(test_open_usertype) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_udp_receive_generic_if(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type netif_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype netif_t:netif { udp_recv ingress };
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_receive_generic_if(test_open_usertype) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_sendrecv_generic_if(test_open_usertype) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin corenet_tcp_sendrecv_generic_node(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type node_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype node_t:node { tcp_send tcp_recv sendto recvfrom };
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_sendrecv_generic_node(test_open_usertype) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin corenet_udp_sendrecv_generic_node(test_open_usertype) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_udp_send_generic_node(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type node_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype node_t:node { udp_send sendto };
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_send_generic_node(test_open_usertype) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_udp_receive_generic_node(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type node_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype node_t:node { udp_recv recvfrom };
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_receive_generic_node(test_open_usertype) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_sendrecv_generic_node(test_open_usertype) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin corenet_tcp_sendrecv_kerberos_port(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type kerberos_port_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype kerberos_port_t:tcp_socket { send_msg recv_msg };
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_sendrecv_kerberos_port(test_open_usertype) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin corenet_udp_sendrecv_kerberos_port(test_open_usertype) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_udp_send_kerberos_port(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type kerberos_port_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype kerberos_port_t:udp_socket send_msg;
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_send_kerberos_port(test_open_usertype) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_udp_receive_kerberos_port(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type kerberos_port_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype kerberos_port_t:udp_socket recv_msg;
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_receive_kerberos_port(test_open_usertype) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_sendrecv_kerberos_port(test_open_usertype) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin corenet_tcp_bind_generic_node(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type node_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype node_t:tcp_socket node_bind;
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_bind_generic_node(test_open_usertype) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin corenet_udp_bind_generic_node(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type node_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype node_t:udp_socket node_bind;
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_bind_generic_node(test_open_usertype) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin corenet_tcp_connect_kerberos_port(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type kerberos_port_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype kerberos_port_t:tcp_socket name_connect;
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_connect_kerberos_port(test_open_usertype) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin corenet_tcp_connect_ocsp_port(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type ocsp_port_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype ocsp_port_t:tcp_socket name_connect;
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_connect_ocsp_port(test_open_usertype) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin corenet_sendrecv_kerberos_client_packets(test_open_usertype) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_send_kerberos_client_packets(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type kerberos_client_packet_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype kerberos_client_packet_t:packet send;
#line 39

#line 39
	 	
#line 39
##### end corenet_send_kerberos_client_packets(test_open_usertype) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_receive_kerberos_client_packets(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type kerberos_client_packet_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype kerberos_client_packet_t:packet recv;
#line 39

#line 39
	 	
#line 39
##### end corenet_receive_kerberos_client_packets(test_open_usertype) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corenet_sendrecv_kerberos_client_packets(test_open_usertype) depth: 5
#line 39
 	
#line 39
		 	 	
#line 39
##### begin corenet_sendrecv_ocsp_client_packets(test_open_usertype) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_send_ocsp_client_packets(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type ocsp_client_packet_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype ocsp_client_packet_t:packet send;
#line 39

#line 39
	 	
#line 39
##### end corenet_send_ocsp_client_packets(test_open_usertype) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_receive_ocsp_client_packets(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type ocsp_client_packet_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype ocsp_client_packet_t:packet recv;
#line 39

#line 39
	 	
#line 39
##### end corenet_receive_ocsp_client_packets(test_open_usertype) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corenet_sendrecv_ocsp_client_packets(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
		allow test_open_usertype krb5_host_rcache_t:dir { getattr search open };
#line 39
		allow test_open_usertype krb5_host_rcache_t:file { getattr };
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool kerberos_enabled;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (kerberos_enabled) {
#line 39
		
#line 39
			 	 	
#line 39
##### begin pcscd_stream_connect(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type pcscd_t, pcscd_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype pcscd_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype pcscd_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_usertype pcscd_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end pcscd_stream_connect(test_open_usertype) depth: 5
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin sssd_read_public_files(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sssd_public_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin sssd_search_lib(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sssd_var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype sssd_var_lib_t:dir { getattr search open };
#line 39
	 	 	
#line 39
##### begin files_search_var_lib(test_open_usertype) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_lib_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_var_lib(test_open_usertype) depth: 7
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end sssd_search_lib(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype sssd_public_t:dir { getattr search open };
#line 39
	allow test_open_usertype sssd_public_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype sssd_public_t:dir { getattr search open };
#line 39
	allow test_open_usertype sssd_public_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
    allow test_open_usertype sssd_public_t:file map;
#line 39

#line 39
	 	
#line 39
##### end sssd_read_public_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	 	
#line 39
##### end kerberos_use(test_open_usertype) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin init_write_key(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type init_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype init_t:key read;
#line 39

#line 39
	 	
#line 39
##### end init_write_key(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin mysql_filetrans_named_content(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type mysqld_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin userdom_admin_home_dir_filetrans(test_open_usertype,mysqld_home_t,file,".my.cnf") depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type admin_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype admin_home_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype admin_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_usertype admin_home_t:file mysqld_home_t ".my.cnf";
#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_admin_home_dir_filetrans(test_open_usertype,mysqld_home_t,file,".my.cnf") depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin userdom_user_home_dir_filetrans(test_open_usertype,mysqld_home_t,file,".my.cnf") depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_dir_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_usertype user_home_dir_t:file mysqld_home_t ".my.cnf";
#line 39

#line 39
	 	 	
#line 39
##### begin files_search_home(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype home_root_t:dir { getattr search open };
#line 39
	allow test_open_usertype home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_search_home(test_open_usertype) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_user_home_dir_filetrans(test_open_usertype,mysqld_home_t,file,".my.cnf") depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end mysql_filetrans_named_content(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin mta_dontaudit_read_spool_symlinks(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type mail_spool_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype mail_spool_t:lnk_file read;
#line 39

#line 39
	 	
#line 39
##### end mta_dontaudit_read_spool_symlinks(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin quota_dontaudit_getattr_db(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type quota_db_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype quota_db_t:file { getattr };
#line 39

#line 39
	 	
#line 39
##### end quota_dontaudit_getattr_db(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin rpm_read_db(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type rpm_var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var_lib(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_lib_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_var_lib(test_open_usertype) depth: 5
#line 39
 	
#line 39
	allow test_open_usertype rpm_var_lib_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype rpm_var_lib_t:dir { getattr search open };
#line 39
	allow test_open_usertype rpm_var_lib_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype rpm_var_lib_t:dir { getattr search open };
#line 39
	allow test_open_usertype rpm_var_lib_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_usertype rpm_var_lib_t:file map;
#line 39
	 	 	
#line 39
##### begin rpm_read_cache(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type rpm_var_cache_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_var(test_open_usertype) depth: 6
#line 39
 	
#line 39
	allow test_open_usertype rpm_var_cache_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype rpm_var_cache_t:dir { getattr search open };
#line 39
	allow test_open_usertype rpm_var_cache_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype rpm_var_cache_t:dir { getattr search open };
#line 39
	allow test_open_usertype rpm_var_cache_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end rpm_read_cache(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end rpm_read_db(test_open_usertype) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin rpm_dontaudit_manage_db(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type rpm_var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype rpm_var_lib_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39
	dontaudit test_open_usertype rpm_var_lib_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39
	dontaudit test_open_usertype rpm_var_lib_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 39
	dontaudit test_open_usertype rpm_var_lib_t:file map;
#line 39

#line 39
	 	
#line 39
##### end rpm_dontaudit_manage_db(test_open_usertype) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin rpm_read_cache(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type rpm_var_cache_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_var(test_open_usertype) depth: 5
#line 39
 	
#line 39
	allow test_open_usertype rpm_var_cache_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype rpm_var_cache_t:dir { getattr search open };
#line 39
	allow test_open_usertype rpm_var_cache_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype rpm_var_cache_t:dir { getattr search open };
#line 39
	allow test_open_usertype rpm_var_cache_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end rpm_read_cache(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin oddjob_run_mkhomedir(test_open_t,test_open_r) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type oddjob_mkhomedir_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin oddjob_domtrans_mkhomedir(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type oddjob_mkhomedir_t, oddjob_mkhomedir_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t oddjob_mkhomedir_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t oddjob_mkhomedir_t:process transition;
#line 39
#	dontaudit test_open_t oddjob_mkhomedir_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t oddjob_mkhomedir_exec_t:process oddjob_mkhomedir_t;
#line 39

#line 39

#line 39
	allow oddjob_mkhomedir_t test_open_t:fd use;
#line 39
	allow oddjob_mkhomedir_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow oddjob_mkhomedir_t test_open_t:process sigchld;
#line 39

#line 39
    allow test_open_t oddjob_mkhomedir_exec_t:file map;
#line 39

#line 39
	 	
#line 39
##### end oddjob_domtrans_mkhomedir(test_open_t) depth: 5
#line 39
 	
#line 39
	role test_open_r types oddjob_mkhomedir_t;
#line 39

#line 39
	 	
#line 39
##### end oddjob_run_mkhomedir(test_open_t,test_open_r) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin oddjob_run(test_open_t,test_open_r) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type oddjob_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin oddjob_domtrans(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type oddjob_t, oddjob_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t oddjob_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t oddjob_t:process transition;
#line 39
#	dontaudit test_open_t oddjob_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t oddjob_exec_t:process oddjob_t;
#line 39

#line 39

#line 39
	allow oddjob_t test_open_t:fd use;
#line 39
	allow oddjob_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow oddjob_t test_open_t:process sigchld;
#line 39

#line 39

#line 39
	 	
#line 39
##### end oddjob_domtrans(test_open_t) depth: 5
#line 39
 	
#line 39
	role test_open_r types oddjob_t;
#line 39

#line 39
	 	
#line 39
##### end oddjob_run(test_open_t,test_open_r) depth: 4
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
    
#line 39
	optional {
#line 39
		
#line 39
         	 	
#line 39
##### begin chronyd_run_chronyc(test_open_t,test_open_r) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type chronyc_t;
#line 39
        attribute_role chronyc_roles;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin chronyd_domtrans_chronyc(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type chronyc_t, chronyc_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t chronyc_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t chronyc_t:process transition;
#line 39
#	dontaudit test_open_t chronyc_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t chronyc_exec_t:process chronyc_t;
#line 39

#line 39

#line 39
	allow chronyc_t test_open_t:fd use;
#line 39
	allow chronyc_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow chronyc_t test_open_t:process sigchld;
#line 39

#line 39

#line 39
	 	
#line 39
##### end chronyd_domtrans_chronyc(test_open_t) depth: 5
#line 39
 	
#line 39
    roleattribute test_open_r chronyc_roles;
#line 39

#line 39
	 	
#line 39
##### end chronyd_run_chronyc(test_open_t,test_open_r) depth: 4
#line 39
 	
#line 39
    
#line 39
	} # end optional
#line 39

#line 39

#line 39
    
#line 39
	optional {
#line 39
		
#line 39
         	 	
#line 39
##### begin ipa_run_helper(test_open_t,test_open_r) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type ipa_helper_t;
#line 39
        attribute_role ipa_helper_roles;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin ipa_domtrans_helper(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type ipa_helper_t, ipa_helper_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t ipa_helper_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t ipa_helper_t:process transition;
#line 39
#	dontaudit test_open_t ipa_helper_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t ipa_helper_exec_t:process ipa_helper_t;
#line 39

#line 39

#line 39
	allow ipa_helper_t test_open_t:fd use;
#line 39
	allow ipa_helper_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow ipa_helper_t test_open_t:process sigchld;
#line 39

#line 39

#line 39
	 	
#line 39
##### end ipa_domtrans_helper(test_open_t) depth: 5
#line 39
 	
#line 39
    roleattribute test_open_r ipa_helper_roles;
#line 39

#line 39
	 	
#line 39
##### end ipa_run_helper(test_open_t,test_open_r) depth: 4
#line 39
 	
#line 39
    
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin wine_filetrans_named_content(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type wine_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin userdom_user_home_dir_filetrans(test_open_usertype,wine_home_t,dir,".wine") depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_dir_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_usertype user_home_dir_t:dir wine_home_t ".wine";
#line 39

#line 39
	 	 	
#line 39
##### begin files_search_home(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype home_root_t:dir { getattr search open };
#line 39
	allow test_open_usertype home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_search_home(test_open_usertype) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_user_home_dir_filetrans(test_open_usertype,wine_home_t,dir,".wine") depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end wine_filetrans_named_content(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39
 	 	
#line 39
##### end userdom_login_user_template(test_open) depth: 3
#line 39
 	
#line 39

#line 39
	typeattribute test_open_t unpriv_userdomain;
#line 39
	 	 	
#line 39
##### begin domain_interactive_fd(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute privfd;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t privfd;
#line 39

#line 39
	 	
#line 39
##### end domain_interactive_fd(test_open_t) depth: 3
#line 39
 	
#line 39

#line 39
	allow test_open_usertype self:netlink_kobject_uevent_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 39
	dontaudit test_open_usertype self:netlink_audit_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 39

#line 39
	 	 	
#line 39
##### begin seutil_read_file_contexts(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type selinux_config_t, default_context_t, file_context_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_etc(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t etc_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_etc(test_open_t) depth: 4
#line 39
 	
#line 39
	allow test_open_t { selinux_config_t default_context_t }:dir { getattr search open };
#line 39
	
#line 39
	allow test_open_t file_context_t:dir { getattr search open };
#line 39
	allow test_open_t file_context_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_t file_context_t:dir { getattr search open };
#line 39
	allow test_open_t file_context_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_t file_context_t:dir { getattr search open };
#line 39
	allow test_open_t file_context_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_t file_context_t:file map;
#line 39

#line 39
	 	
#line 39
##### end seutil_read_file_contexts(test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin seutil_read_default_contexts(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type selinux_config_t, default_context_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_etc(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t etc_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_etc(test_open_t) depth: 4
#line 39
 	
#line 39
	allow test_open_t selinux_config_t:dir { getattr search open };
#line 39
	allow test_open_t default_context_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_t default_context_t:dir { getattr search open };
#line 39
	allow test_open_t default_context_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end seutil_read_default_contexts(test_open_t) depth: 3
#line 39
 	
#line 39

#line 39
	##############################
#line 39
	#
#line 39
	# Local policy
#line 39
	#
#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin loadkeys_run(test_open_t,test_open_r) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute_role loadkeys_roles;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin loadkeys_domtrans(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type loadkeys_t, loadkeys_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_search_bin(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_read_bin_symlinks(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_read_bin_symlinks(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_search_bin(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t loadkeys_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t loadkeys_t:process transition;
#line 39
#	dontaudit test_open_t loadkeys_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t loadkeys_exec_t:process loadkeys_t;
#line 39

#line 39

#line 39
	allow loadkeys_t test_open_t:fd use;
#line 39
	allow loadkeys_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow loadkeys_t test_open_t:process sigchld;
#line 39

#line 39

#line 39
	 	
#line 39
##### end loadkeys_domtrans(test_open_t) depth: 4
#line 39
 	
#line 39
	roleattribute test_open_r loadkeys_roles;
#line 39

#line 39
	 	
#line 39
##### end loadkeys_run(test_open_t,test_open_r) depth: 3
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39
 	 	
#line 39
##### end userdom_restricted_user_template(test_open) depth: 2
#line 39
 	
#line 39

#line 39
	##############################
#line 39
	#
#line 39
	# Local policy
#line 39
	#
#line 39
	 	 	
#line 39
##### begin kernel_stream_connect(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type kernel_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype kernel_t:unix_stream_socket connectto;
#line 39

#line 39
	 	
#line 39
##### end kernel_stream_connect(test_open_usertype) depth: 2
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin dev_read_sound(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t, sound_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype sound_device_t:chr_file { getattr open read lock ioctl };
#line 39

#line 39
	allow test_open_usertype sound_device_t:chr_file map;
#line 39

#line 39
	 	
#line 39
##### end dev_read_sound(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_write_sound(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t, sound_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype sound_device_t:chr_file { getattr open write append lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_write_sound(test_open_usertype) depth: 2
#line 39
 	
#line 39
	# gnome keyring wants to read this.
#line 39
	 	 	
#line 39
##### begin dev_dontaudit_read_rand(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type random_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype random_device_t:chr_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end dev_dontaudit_read_rand(test_open_usertype) depth: 2
#line 39
 	
#line 39
	# temporarily allow since openoffice requires this
#line 39
	 	 	
#line 39
##### begin dev_read_rand(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t, random_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype random_device_t:chr_file { getattr open read lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_read_rand(test_open_usertype) depth: 2
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin dev_read_video_dev(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t, v4l_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype v4l_device_t:chr_file { getattr open read lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_read_video_dev(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_write_video_dev(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t, v4l_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype v4l_device_t:chr_file { getattr open write append lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_write_video_dev(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_rw_wireless(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t, wireless_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype wireless_device_t:chr_file { open { getattr read write append ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_rw_wireless(test_open_usertype) depth: 2
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin libs_dontaudit_setattr_lib_files(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype lib_t:file setattr;
#line 39

#line 39
	 	
#line 39
##### end libs_dontaudit_setattr_lib_files(test_open_usertype) depth: 2
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin init_read_state(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type init_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype init_t:dir { getattr search open };
#line 39
	allow test_open_usertype init_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_usertype init_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end init_read_state(test_open_usertype) depth: 2
#line 39
 	
#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool selinuxuser_rw_noexattrfile;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (selinuxuser_rw_noexattrfile) {
#line 39
		
#line 39
		 	 	
#line 39
##### begin dev_rw_usbfs(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type usbfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t usbfs_t:dir { getattr search open };
#line 39
	allow test_open_t usbfs_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_t usbfs_t:dir { getattr search open };
#line 39
	allow test_open_t usbfs_t:file { open { getattr read write append ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_t usbfs_t:dir { getattr search open };
#line 39
	allow test_open_t usbfs_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_rw_usbfs(test_open_t) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin dev_rw_generic_usb_dev(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t, usb_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype usb_device_t:chr_file { open { getattr read write append ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_rw_generic_usb_dev(test_open_usertype) depth: 2
#line 39
 	
#line 39

#line 39
		 	 	
#line 39
##### begin fs_manage_noxattr_fs_files(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute noxattrfs;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype noxattrfs:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_usertype noxattrfs:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_noxattr_fs_files(test_open_usertype) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_noxattr_fs_dirs(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute noxattrfs;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype noxattrfs:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end fs_manage_noxattr_fs_dirs(test_open_usertype) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_dos_dirs(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type dosfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype dosfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_usertype dosfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_dos_dirs(test_open_usertype) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_dos_files(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type dosfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype dosfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_usertype dosfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_dos_files(test_open_usertype) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin storage_raw_read_removable_device(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type removable_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_list_all_dev_nodes(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype device_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype device_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_list_all_dev_nodes(test_open_usertype) depth: 3
#line 39
 	
#line 39
	allow test_open_usertype removable_device_t:blk_file { getattr open read lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end storage_raw_read_removable_device(test_open_usertype) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin storage_raw_write_removable_device(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type removable_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_list_all_dev_nodes(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype device_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype device_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_list_all_dev_nodes(test_open_usertype) depth: 3
#line 39
 	
#line 39
	allow test_open_usertype removable_device_t:blk_file { getattr open write append lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end storage_raw_write_removable_device(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin logging_send_syslog_msg(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute syslog_client_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t syslog_client_type;
#line 39

#line 39
	 	
#line 39
##### end logging_send_syslog_msg(test_open_t) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin logging_dontaudit_send_audit_msgs(test_open_t) depth: 3
#line 39
 	
#line 39
	dontaudit test_open_t self:capability audit_write;
#line 39
	dontaudit test_open_t self:netlink_audit_socket { { { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } } nlmsg_read } nlmsg_relay };
#line 39

#line 39
	 	
#line 39
##### end logging_dontaudit_send_audit_msgs(test_open_t) depth: 2
#line 39
 	
#line 39

#line 39
	# Need to to this just so screensaver will work. Should be moved to screensaver domain
#line 39
	 	 	
#line 39
##### begin selinux_get_enforce_mode(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type security_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_search_sysfs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_search_sysfs(test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin selinux_get_fs_mount(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type security_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t security_t:lnk_file { getattr read };
#line 39
	 	 	
#line 39
##### begin dev_getattr_sysfs_fs(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t sysfs_t:filesystem getattr;
#line 39

#line 39
	 	
#line 39
##### end dev_getattr_sysfs_fs(test_open_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_search_sysfs(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_search_sysfs(test_open_t) depth: 4
#line 39
 	
#line 39
	# starting in libselinux 2.0.5, init_selinuxmnt() will
#line 39
	# attempt to short circuit by checking if SELINUXMNT
#line 39
	# (/selinux) is already a selinuxfs
#line 39
	allow test_open_t security_t:filesystem getattr;
#line 39

#line 39
	# read /proc/filesystems to see if selinuxfs is supported
#line 39
	# then read /proc/self/mount to see where selinuxfs is mounted
#line 39
	 	 	
#line 39
##### begin kernel_read_system_state(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute kernel_system_state_reader;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t kernel_system_state_reader;
#line 39

#line 39
	 	
#line 39
##### end kernel_read_system_state(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end selinux_get_fs_mount(test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_t security_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t security_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_t security_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end selinux_get_enforce_mode(test_open_t) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin seutil_exec_restorecond(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type restorecond_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_usr(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t usr_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_usr(test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_search_bin(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_read_bin_symlinks(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_read_bin_symlinks(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_search_bin(test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_t restorecond_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39

#line 39
	 	
#line 39
##### end seutil_exec_restorecond(test_open_t) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin seutil_read_file_contexts(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type selinux_config_t, default_context_t, file_context_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_etc(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t etc_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_etc(test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_t { selinux_config_t default_context_t }:dir { getattr search open };
#line 39
	
#line 39
	allow test_open_t file_context_t:dir { getattr search open };
#line 39
	allow test_open_t file_context_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_t file_context_t:dir { getattr search open };
#line 39
	allow test_open_t file_context_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_t file_context_t:dir { getattr search open };
#line 39
	allow test_open_t file_context_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_t file_context_t:file map;
#line 39

#line 39
	 	
#line 39
##### end seutil_read_file_contexts(test_open_t) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin seutil_read_default_contexts(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type selinux_config_t, default_context_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_etc(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t etc_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_etc(test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_t selinux_config_t:dir { getattr search open };
#line 39
	allow test_open_t default_context_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_t default_context_t:dir { getattr search open };
#line 39
	allow test_open_t default_context_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end seutil_read_default_contexts(test_open_t) depth: 2
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin xserver_restricted_role(test_open_r,test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type xauth_t, iceauth_t;
#line 39
		attribute dridomain, x_userdomain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	role test_open_r types { xauth_t iceauth_t };
#line 39
	typeattribute test_open_t x_userdomain, dridomain;
#line 39

#line 39
	 	 	
#line 39
##### begin xserver_common_x_domain_template(user,test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type root_xdrawable_t, xdm_t, xserver_t;
#line 39
		type xproperty_t, user_xproperty_t;
#line 39
		type xevent_t, client_xevent_t;
#line 39
		type input_xevent_t, user_input_xevent_t;
#line 39

#line 39
		attribute x_domain, input_xevent_type;
#line 39
		attribute xdrawable_type, xcolormap_type;
#line 39

#line 39
		class x_drawable { create destroy read write blend getattr setattr list_child add_child remove_child list_property get_property set_property manage override show hide send receive };
#line 39
		class x_property { create destroy read write append getattr setattr };
#line 39
		class x_event { send receive };
#line 39
		class x_synthetic_event { send receive };
#line 39
		class x_client destroy;
#line 39
		class x_server manage;
#line 39
		class x_screen { saver_setattr saver_hide saver_show show_cursor hide_cursor };
#line 39
		class x_pointer { get_property set_property manage };
#line 39
		class x_keyboard { read manage freeze };
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	##############################
#line 39
	#
#line 39
	# Local Policy
#line 39
	#
#line 39

#line 39
	# Type attributes
#line 39
	typeattribute test_open_t x_domain;
#line 39
	typeattribute test_open_t xdrawable_type, xcolormap_type;
#line 39

#line 39
	# X Properties
#line 39
	# disable property transitions for the time being.
#line 39
#	type_transition test_open_t xproperty_t:x_property user_xproperty_t;
#line 39

#line 39
	# X Windows
#line 39
	# new windows have the domain type
#line 39
	type_transition test_open_t root_xdrawable_t:x_drawable test_open_t;
#line 39

#line 39
	# X Input
#line 39
	# distinguish input events
#line 39
	type_transition test_open_t input_xevent_t:x_event user_input_xevent_t;
#line 39
	# can send own events
#line 39
	allow test_open_t user_input_xevent_t:{ x_event x_synthetic_event } send;
#line 39
	# can receive own events
#line 39
	allow test_open_t user_input_xevent_t:{ x_event x_synthetic_event } receive;
#line 39
	# can receive default events
#line 39
	allow test_open_t client_xevent_t:{ x_event x_synthetic_event } receive;
#line 39
	allow test_open_t xevent_t:{ x_event x_synthetic_event } { send receive };
#line 39
	# dont audit send failures
#line 39
	dontaudit test_open_t input_xevent_type:x_event send;
#line 39

#line 39
	allow test_open_t xdm_t:x_drawable { hide read add_child manage };
#line 39
	allow test_open_t xdm_t:x_client destroy;
#line 39

#line 39
	allow test_open_t root_xdrawable_t:x_drawable write;
#line 39
	allow test_open_t xserver_t:x_server manage;
#line 39
	allow test_open_t xserver_t:x_screen { show_cursor hide_cursor saver_setattr saver_hide saver_show };
#line 39
	allow test_open_t xserver_t:x_pointer { get_property set_property manage };
#line 39
	allow test_open_t xserver_t:x_keyboard { read manage freeze };
#line 39
 	 	
#line 39
##### end xserver_common_x_domain_template(user,test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin xserver_stream_connect_xdm(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type xdm_t, xdm_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_tmp(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin fs_search_tmpfs(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t tmpfs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_tmpfs(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow test_open_t tmp_t:dir { getattr search open };
#line 39
	allow test_open_t tmp_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_t tmp_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_tmp(test_open_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t var_t:lnk_file { getattr read };
#line 39
	allow test_open_t var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_t var_t:dir { getattr search open };
#line 39
	allow test_open_t var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow test_open_t { xdm_var_run_t }:dir { getattr search open };
#line 39
	allow test_open_t { xdm_var_run_t }:sock_file { getattr write open append };
#line 39
	allow test_open_t xdm_t:unix_stream_socket connectto;
#line 39

#line 39
     	 	
#line 39
##### begin userdom_stream_connect(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_tmp_t;
#line 39
		attribute userdomain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t user_tmp_t:dir { getattr search open };
#line 39
	allow test_open_t user_tmp_t:sock_file { getattr write open append };
#line 39
	allow test_open_t userdomain:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_stream_connect(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end xserver_stream_connect_xdm(test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin xserver_xdm_append_log(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type xdm_log_t;
#line 39
		attribute xdmhomewriter;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t xdmhomewriter;
#line 39
	allow test_open_t xdm_log_t:file { getattr append };
#line 39

#line 39
	 	
#line 39
##### end xserver_xdm_append_log(test_open_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin xserver_dri_domain(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute dridomain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t dridomain;
#line 39

#line 39
	 	
#line 39
##### end xserver_dri_domain(test_open_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end xserver_restricted_role(test_open_r,test_open_t) depth: 2
#line 39
 	
#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin alsa_read_rw_config(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type alsa_etc_rw_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_etc(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_etc(test_open_usertype) depth: 3
#line 39
 	
#line 39
	allow test_open_usertype alsa_etc_rw_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype alsa_etc_rw_t:dir { getattr search open };
#line 39
	allow test_open_usertype alsa_etc_rw_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype alsa_etc_rw_t:dir { getattr search open };
#line 39
	allow test_open_usertype alsa_etc_rw_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	
#line 39

#line 39
	 	
#line 39
##### end alsa_read_rw_config(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	 # cjp: needed by KDE apps
#line 39
	 # bug: #682499
#line 39
	 
#line 39
	optional {
#line 39
		
#line 39
	 	 	 	
#line 39
##### begin gnome_read_usr_config(test_open_usertype) depth: 3
#line 39
 	
#line 39
        
#line 39
	
#line 39
		require {
#line 39
			
#line 39
                type config_usr_t;
#line 39
        
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
         	 	
#line 39
##### begin files_search_usr(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype usr_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_usr(test_open_usertype) depth: 3
#line 39
 	
#line 39
		
#line 39
	allow test_open_usertype config_usr_t:dir { getattr search open };
#line 39
	allow test_open_usertype config_usr_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
		
#line 39
	allow test_open_usertype config_usr_t:dir { getattr search open };
#line 39
	allow test_open_usertype config_usr_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
		
#line 39
	allow test_open_usertype config_usr_t:dir { getattr search open };
#line 39
	allow test_open_usertype config_usr_t:lnk_file { getattr read };
#line 39
	
#line 39

#line 39
	 	
#line 39
##### end gnome_read_usr_config(test_open_usertype) depth: 2
#line 39
 	
#line 39
		# cjp: telepathy F15 bugs
#line 39
		 	 	
#line 39
##### begin telepathy_role(test_open_r,test_open_t,test_open) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute telepathy_domain;
#line 39
		type telepathy_gabble_t, telepathy_sofiasip_t, telepathy_idle_t;
#line 39
		type telepathy_mission_control_t, telepathy_salut_t, telepathy_sunshine_t;
#line 39
		type telepathy_stream_engine_t, telepathy_msn_t, telepathy_gabble_exec_t;
#line 39
		type telepathy_sofiasip_exec_t, telepathy_idle_exec_t;
#line 39
		type telepathy_logger_t, telepathy_logger_exec_t;
#line 39
		type telepathy_mission_control_exec_t, telepathy_salut_exec_t;
#line 39
		type telepathy_sunshine_exec_t, telepathy_stream_engine_exec_t;
#line 39
		type telepathy_msn_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	role test_open_r types telepathy_domain;
#line 39

#line 39
	allow test_open_t telepathy_domain:process { sigchld sigkill sigstop signull signal };
#line 39
	
#line 39
	allow test_open_t telepathy_domain:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t telepathy_domain:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_t telepathy_domain:lnk_file { getattr read };
#line 39
	allow test_open_t telepathy_domain:process getattr;
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin telepathy_gabble_stream_connect(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type telepathy_gabble_t, telepathy_gabble_tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t telepathy_gabble_tmp_t:dir { getattr search open };
#line 39
	allow test_open_t telepathy_gabble_tmp_t:sock_file { getattr write open append };
#line 39
	allow test_open_t telepathy_gabble_t:unix_stream_socket connectto;
#line 39

#line 39
	 	 	
#line 39
##### begin files_search_tmp(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin fs_search_tmpfs(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t tmpfs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_tmpfs(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow test_open_t tmp_t:dir { getattr search open };
#line 39
	allow test_open_t tmp_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_t tmp_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_tmp(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end telepathy_gabble_stream_connect(test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin telepathy_msn_stream_connect(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type telepathy_msn_t, telepathy_msn_tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t telepathy_msn_tmp_t:dir { getattr search open };
#line 39
	allow test_open_t telepathy_msn_tmp_t:sock_file { getattr write open append };
#line 39
	allow test_open_t telepathy_msn_t:unix_stream_socket connectto;
#line 39

#line 39
	 	 	
#line 39
##### begin files_search_tmp(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin fs_search_tmpfs(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t tmpfs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_tmpfs(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow test_open_t tmp_t:dir { getattr search open };
#line 39
	allow test_open_t tmp_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_t tmp_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_tmp(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end telepathy_msn_stream_connect(test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin telepathy_salut_stream_connect(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type telepathy_salut_t, telepathy_salut_tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t telepathy_salut_tmp_t:dir { getattr search open };
#line 39
	allow test_open_t telepathy_salut_tmp_t:sock_file { getattr write open append };
#line 39
	allow test_open_t telepathy_salut_t:unix_stream_socket connectto;
#line 39

#line 39
	 	 	
#line 39
##### begin files_search_tmp(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin fs_search_tmpfs(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t tmpfs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_tmpfs(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow test_open_t tmp_t:dir { getattr search open };
#line 39
	allow test_open_t tmp_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_t tmp_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_tmp(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end telepathy_salut_stream_connect(test_open_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin dbus_session_domain(test_open,telepathy_gabble_exec_t,telepathy_gabble_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type test_open_dbusd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_dbusd_t telepathy_gabble_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_dbusd_t telepathy_gabble_t:process transition;
#line 39
#	dontaudit test_open_dbusd_t telepathy_gabble_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_dbusd_t telepathy_gabble_exec_t:process telepathy_gabble_t;
#line 39

#line 39

#line 39
	allow telepathy_gabble_t test_open_dbusd_t:fd use;
#line 39
	allow telepathy_gabble_t test_open_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow telepathy_gabble_t test_open_dbusd_t:process sigchld;
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dbus_session_bus_client(telepathy_gabble_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	# SE-DBus specific permissions
#line 39
	allow telepathy_gabble_t { session_bus_type self }:dbus send_msg;
#line 39

#line 39
	# For connecting to the bus
#line 39
	allow telepathy_gabble_t session_bus_type:unix_stream_socket connectto;
#line 39

#line 39
	allow session_bus_type telepathy_gabble_t:process sigkill;
#line 39

#line 39
	 	
#line 39
##### end dbus_session_bus_client(telepathy_gabble_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_connect_session_bus(telepathy_gabble_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus acquire_svc;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow telepathy_gabble_t session_bus_type:dbus acquire_svc;
#line 39

#line 39
	 	
#line 39
##### end dbus_connect_session_bus(telepathy_gabble_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end dbus_session_domain(test_open,telepathy_gabble_exec_t,telepathy_gabble_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_session_domain(test_open,telepathy_sofiasip_exec_t,telepathy_sofiasip_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type test_open_dbusd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_dbusd_t telepathy_sofiasip_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_dbusd_t telepathy_sofiasip_t:process transition;
#line 39
#	dontaudit test_open_dbusd_t telepathy_sofiasip_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_dbusd_t telepathy_sofiasip_exec_t:process telepathy_sofiasip_t;
#line 39

#line 39

#line 39
	allow telepathy_sofiasip_t test_open_dbusd_t:fd use;
#line 39
	allow telepathy_sofiasip_t test_open_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow telepathy_sofiasip_t test_open_dbusd_t:process sigchld;
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dbus_session_bus_client(telepathy_sofiasip_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	# SE-DBus specific permissions
#line 39
	allow telepathy_sofiasip_t { session_bus_type self }:dbus send_msg;
#line 39

#line 39
	# For connecting to the bus
#line 39
	allow telepathy_sofiasip_t session_bus_type:unix_stream_socket connectto;
#line 39

#line 39
	allow session_bus_type telepathy_sofiasip_t:process sigkill;
#line 39

#line 39
	 	
#line 39
##### end dbus_session_bus_client(telepathy_sofiasip_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_connect_session_bus(telepathy_sofiasip_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus acquire_svc;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow telepathy_sofiasip_t session_bus_type:dbus acquire_svc;
#line 39

#line 39
	 	
#line 39
##### end dbus_connect_session_bus(telepathy_sofiasip_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end dbus_session_domain(test_open,telepathy_sofiasip_exec_t,telepathy_sofiasip_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_session_domain(test_open,telepathy_idle_exec_t,telepathy_idle_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type test_open_dbusd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_dbusd_t telepathy_idle_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_dbusd_t telepathy_idle_t:process transition;
#line 39
#	dontaudit test_open_dbusd_t telepathy_idle_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_dbusd_t telepathy_idle_exec_t:process telepathy_idle_t;
#line 39

#line 39

#line 39
	allow telepathy_idle_t test_open_dbusd_t:fd use;
#line 39
	allow telepathy_idle_t test_open_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow telepathy_idle_t test_open_dbusd_t:process sigchld;
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dbus_session_bus_client(telepathy_idle_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	# SE-DBus specific permissions
#line 39
	allow telepathy_idle_t { session_bus_type self }:dbus send_msg;
#line 39

#line 39
	# For connecting to the bus
#line 39
	allow telepathy_idle_t session_bus_type:unix_stream_socket connectto;
#line 39

#line 39
	allow session_bus_type telepathy_idle_t:process sigkill;
#line 39

#line 39
	 	
#line 39
##### end dbus_session_bus_client(telepathy_idle_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_connect_session_bus(telepathy_idle_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus acquire_svc;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow telepathy_idle_t session_bus_type:dbus acquire_svc;
#line 39

#line 39
	 	
#line 39
##### end dbus_connect_session_bus(telepathy_idle_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end dbus_session_domain(test_open,telepathy_idle_exec_t,telepathy_idle_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_session_domain(test_open,telepathy_logger_exec_t,telepathy_logger_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type test_open_dbusd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_dbusd_t telepathy_logger_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_dbusd_t telepathy_logger_t:process transition;
#line 39
#	dontaudit test_open_dbusd_t telepathy_logger_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_dbusd_t telepathy_logger_exec_t:process telepathy_logger_t;
#line 39

#line 39

#line 39
	allow telepathy_logger_t test_open_dbusd_t:fd use;
#line 39
	allow telepathy_logger_t test_open_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow telepathy_logger_t test_open_dbusd_t:process sigchld;
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dbus_session_bus_client(telepathy_logger_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	# SE-DBus specific permissions
#line 39
	allow telepathy_logger_t { session_bus_type self }:dbus send_msg;
#line 39

#line 39
	# For connecting to the bus
#line 39
	allow telepathy_logger_t session_bus_type:unix_stream_socket connectto;
#line 39

#line 39
	allow session_bus_type telepathy_logger_t:process sigkill;
#line 39

#line 39
	 	
#line 39
##### end dbus_session_bus_client(telepathy_logger_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_connect_session_bus(telepathy_logger_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus acquire_svc;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow telepathy_logger_t session_bus_type:dbus acquire_svc;
#line 39

#line 39
	 	
#line 39
##### end dbus_connect_session_bus(telepathy_logger_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end dbus_session_domain(test_open,telepathy_logger_exec_t,telepathy_logger_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_session_domain(test_open,telepathy_mission_control_exec_t,telepathy_mission_control_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type test_open_dbusd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_dbusd_t telepathy_mission_control_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_dbusd_t telepathy_mission_control_t:process transition;
#line 39
#	dontaudit test_open_dbusd_t telepathy_mission_control_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_dbusd_t telepathy_mission_control_exec_t:process telepathy_mission_control_t;
#line 39

#line 39

#line 39
	allow telepathy_mission_control_t test_open_dbusd_t:fd use;
#line 39
	allow telepathy_mission_control_t test_open_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow telepathy_mission_control_t test_open_dbusd_t:process sigchld;
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dbus_session_bus_client(telepathy_mission_control_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	# SE-DBus specific permissions
#line 39
	allow telepathy_mission_control_t { session_bus_type self }:dbus send_msg;
#line 39

#line 39
	# For connecting to the bus
#line 39
	allow telepathy_mission_control_t session_bus_type:unix_stream_socket connectto;
#line 39

#line 39
	allow session_bus_type telepathy_mission_control_t:process sigkill;
#line 39

#line 39
	 	
#line 39
##### end dbus_session_bus_client(telepathy_mission_control_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_connect_session_bus(telepathy_mission_control_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus acquire_svc;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow telepathy_mission_control_t session_bus_type:dbus acquire_svc;
#line 39

#line 39
	 	
#line 39
##### end dbus_connect_session_bus(telepathy_mission_control_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end dbus_session_domain(test_open,telepathy_mission_control_exec_t,telepathy_mission_control_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_session_domain(test_open,telepathy_salut_exec_t,telepathy_salut_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type test_open_dbusd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_dbusd_t telepathy_salut_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_dbusd_t telepathy_salut_t:process transition;
#line 39
#	dontaudit test_open_dbusd_t telepathy_salut_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_dbusd_t telepathy_salut_exec_t:process telepathy_salut_t;
#line 39

#line 39

#line 39
	allow telepathy_salut_t test_open_dbusd_t:fd use;
#line 39
	allow telepathy_salut_t test_open_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow telepathy_salut_t test_open_dbusd_t:process sigchld;
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dbus_session_bus_client(telepathy_salut_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	# SE-DBus specific permissions
#line 39
	allow telepathy_salut_t { session_bus_type self }:dbus send_msg;
#line 39

#line 39
	# For connecting to the bus
#line 39
	allow telepathy_salut_t session_bus_type:unix_stream_socket connectto;
#line 39

#line 39
	allow session_bus_type telepathy_salut_t:process sigkill;
#line 39

#line 39
	 	
#line 39
##### end dbus_session_bus_client(telepathy_salut_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_connect_session_bus(telepathy_salut_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus acquire_svc;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow telepathy_salut_t session_bus_type:dbus acquire_svc;
#line 39

#line 39
	 	
#line 39
##### end dbus_connect_session_bus(telepathy_salut_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end dbus_session_domain(test_open,telepathy_salut_exec_t,telepathy_salut_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_session_domain(test_open,telepathy_sunshine_exec_t,telepathy_sunshine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type test_open_dbusd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_dbusd_t telepathy_sunshine_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_dbusd_t telepathy_sunshine_t:process transition;
#line 39
#	dontaudit test_open_dbusd_t telepathy_sunshine_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_dbusd_t telepathy_sunshine_exec_t:process telepathy_sunshine_t;
#line 39

#line 39

#line 39
	allow telepathy_sunshine_t test_open_dbusd_t:fd use;
#line 39
	allow telepathy_sunshine_t test_open_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow telepathy_sunshine_t test_open_dbusd_t:process sigchld;
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dbus_session_bus_client(telepathy_sunshine_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	# SE-DBus specific permissions
#line 39
	allow telepathy_sunshine_t { session_bus_type self }:dbus send_msg;
#line 39

#line 39
	# For connecting to the bus
#line 39
	allow telepathy_sunshine_t session_bus_type:unix_stream_socket connectto;
#line 39

#line 39
	allow session_bus_type telepathy_sunshine_t:process sigkill;
#line 39

#line 39
	 	
#line 39
##### end dbus_session_bus_client(telepathy_sunshine_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_connect_session_bus(telepathy_sunshine_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus acquire_svc;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow telepathy_sunshine_t session_bus_type:dbus acquire_svc;
#line 39

#line 39
	 	
#line 39
##### end dbus_connect_session_bus(telepathy_sunshine_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end dbus_session_domain(test_open,telepathy_sunshine_exec_t,telepathy_sunshine_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_session_domain(test_open,telepathy_stream_engine_exec_t,telepathy_stream_engine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type test_open_dbusd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_dbusd_t telepathy_stream_engine_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_dbusd_t telepathy_stream_engine_t:process transition;
#line 39
#	dontaudit test_open_dbusd_t telepathy_stream_engine_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_dbusd_t telepathy_stream_engine_exec_t:process telepathy_stream_engine_t;
#line 39

#line 39

#line 39
	allow telepathy_stream_engine_t test_open_dbusd_t:fd use;
#line 39
	allow telepathy_stream_engine_t test_open_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow telepathy_stream_engine_t test_open_dbusd_t:process sigchld;
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dbus_session_bus_client(telepathy_stream_engine_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	# SE-DBus specific permissions
#line 39
	allow telepathy_stream_engine_t { session_bus_type self }:dbus send_msg;
#line 39

#line 39
	# For connecting to the bus
#line 39
	allow telepathy_stream_engine_t session_bus_type:unix_stream_socket connectto;
#line 39

#line 39
	allow session_bus_type telepathy_stream_engine_t:process sigkill;
#line 39

#line 39
	 	
#line 39
##### end dbus_session_bus_client(telepathy_stream_engine_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_connect_session_bus(telepathy_stream_engine_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus acquire_svc;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow telepathy_stream_engine_t session_bus_type:dbus acquire_svc;
#line 39

#line 39
	 	
#line 39
##### end dbus_connect_session_bus(telepathy_stream_engine_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end dbus_session_domain(test_open,telepathy_stream_engine_exec_t,telepathy_stream_engine_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_session_domain(test_open,telepathy_msn_exec_t,telepathy_msn_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type test_open_dbusd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_dbusd_t telepathy_msn_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_dbusd_t telepathy_msn_t:process transition;
#line 39
#	dontaudit test_open_dbusd_t telepathy_msn_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_dbusd_t telepathy_msn_exec_t:process telepathy_msn_t;
#line 39

#line 39

#line 39
	allow telepathy_msn_t test_open_dbusd_t:fd use;
#line 39
	allow telepathy_msn_t test_open_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow telepathy_msn_t test_open_dbusd_t:process sigchld;
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dbus_session_bus_client(telepathy_msn_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	# SE-DBus specific permissions
#line 39
	allow telepathy_msn_t { session_bus_type self }:dbus send_msg;
#line 39

#line 39
	# For connecting to the bus
#line 39
	allow telepathy_msn_t session_bus_type:unix_stream_socket connectto;
#line 39

#line 39
	allow session_bus_type telepathy_msn_t:process sigkill;
#line 39

#line 39
	 	
#line 39
##### end dbus_session_bus_client(telepathy_msn_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_connect_session_bus(telepathy_msn_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus acquire_svc;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow telepathy_msn_t session_bus_type:dbus acquire_svc;
#line 39

#line 39
	 	
#line 39
##### end dbus_connect_session_bus(telepathy_msn_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end dbus_session_domain(test_open,telepathy_msn_exec_t,telepathy_msn_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin telepathy_dbus_chat(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute telepathy_domain;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t telepathy_domain:dbus send_msg;
#line 39
	allow telepathy_domain test_open_t:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end telepathy_dbus_chat(test_open_t) depth: 3
#line 39
 	
#line 39
 	 	
#line 39
##### end telepathy_role(test_open_r,test_open_t,test_open) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin obex_role(test_open_r,test_open_t,test_open) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute_role obex_roles;
#line 39
	        type obex_t, obex_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	########################################
#line 39
	#		 
#line 39
	# Declarations
#line 39
	#
#line 39

#line 39
    	roleattribute test_open_r obex_roles;
#line 39

#line 39
	########################################
#line 39
	#    
#line 39
	# Policy
#line 39
	#         
#line 39

#line 39
	allow test_open_t obex_t:process { sigchld sigkill sigstop signull signal };
#line 39
	
#line 39
	allow test_open_t obex_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t obex_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_t obex_t:lnk_file { getattr read };
#line 39
	allow test_open_t obex_t:process getattr;
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dbus_session_domain(test_open,obex_exec_t,obex_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type test_open_dbusd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_dbusd_t obex_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_dbusd_t obex_t:process transition;
#line 39
#	dontaudit test_open_dbusd_t obex_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_dbusd_t obex_exec_t:process obex_t;
#line 39

#line 39

#line 39
	allow obex_t test_open_dbusd_t:fd use;
#line 39
	allow obex_t test_open_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow obex_t test_open_dbusd_t:process sigchld;
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dbus_session_bus_client(obex_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	# SE-DBus specific permissions
#line 39
	allow obex_t { session_bus_type self }:dbus send_msg;
#line 39

#line 39
	# For connecting to the bus
#line 39
	allow obex_t session_bus_type:unix_stream_socket connectto;
#line 39

#line 39
	allow session_bus_type obex_t:process sigkill;
#line 39

#line 39
	 	
#line 39
##### end dbus_session_bus_client(obex_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_connect_session_bus(obex_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus acquire_svc;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow obex_t session_bus_type:dbus acquire_svc;
#line 39

#line 39
	 	
#line 39
##### end dbus_connect_session_bus(obex_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end dbus_session_domain(test_open,obex_exec_t,obex_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin obex_dbus_chat(test_open_t) depth: 4
#line 39
 	
#line 39
    
#line 39
	
#line 39
		require {
#line 39
			
#line 39
        type obex_t;
#line 39
        class dbus send_msg;
#line 39
    
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
    allow test_open_t obex_t:dbus send_msg;
#line 39
    allow obex_t test_open_t:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end obex_dbus_chat(test_open_t) depth: 3
#line 39
 	
#line 39
 	 	
#line 39
##### end obex_role(test_open_r,test_open_t,test_open) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin dbus_role_template(test_open,test_open_r,test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		class dbus { send_msg acquire_svc };
#line 39
		attribute dbusd_unconfined, session_bus_type;
#line 39
		type system_dbusd_t, session_dbusd_tmp_t, dbusd_exec_t, dbusd_etc_t;
#line 39
		type test_open_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	##############################
#line 39
	#
#line 39
	# Delcarations
#line 39
	#
#line 39

#line 39
	type test_open_dbusd_t, session_bus_type;
#line 39
	 	 	
#line 39
##### begin application_domain(test_open_dbusd_t,dbusd_exec_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin application_type(test_open_dbusd_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute application_domain_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_dbusd_t application_domain_type;
#line 39

#line 39
	# start with basic domain
#line 39
	 	 	
#line 39
##### begin domain_type(test_open_dbusd_t) depth: 6
#line 39
 	
#line 39
	# start with basic domain
#line 39
	 	 	
#line 39
##### begin domain_base_type(test_open_dbusd_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_dbusd_t domain;
#line 39

#line 39
	 	
#line 39
##### end domain_base_type(test_open_dbusd_t) depth: 6
#line 39
 	
#line 39

#line 39
	# Only way to get corenet_unlabeled packets disabled to work
#line 39
	 	 	
#line 39
##### begin corenet_all_recvfrom_unlabeled(test_open_dbusd_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
                attribute corenet_unlabeled_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	typeattribute test_open_dbusd_t corenet_unlabeled_type;
#line 39

#line 39
	 	
#line 39
##### end corenet_all_recvfrom_unlabeled(test_open_dbusd_t) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end domain_type(test_open_dbusd_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end application_type(test_open_dbusd_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin application_executable_file(dbusd_exec_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute application_exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute dbusd_exec_t application_exec_type;
#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_executable_file(dbusd_exec_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute dbusd_exec_t exec_type;
#line 39

#line 39
	 	 	
#line 39
##### begin files_type(dbusd_exec_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute dbusd_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 39

#line 39
	 	
#line 39
##### end files_type(dbusd_exec_t) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corecmd_executable_file(dbusd_exec_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end application_executable_file(dbusd_exec_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin domain_entry_file(test_open_dbusd_t,dbusd_exec_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute entry_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_dbusd_t dbusd_exec_t:file entrypoint;
#line 39
	allow test_open_dbusd_t dbusd_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 39

#line 39
	typeattribute dbusd_exec_t entry_type;
#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_executable_file(dbusd_exec_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute dbusd_exec_t exec_type;
#line 39

#line 39
	 	 	
#line 39
##### begin files_type(dbusd_exec_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute dbusd_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 39

#line 39
	 	
#line 39
##### end files_type(dbusd_exec_t) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corecmd_executable_file(dbusd_exec_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end domain_entry_file(test_open_dbusd_t,dbusd_exec_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end application_domain(test_open_dbusd_t,dbusd_exec_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin ubac_constrained(test_open_dbusd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute ubac_constrained_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_dbusd_t ubac_constrained_type;
#line 39

#line 39
	 	
#line 39
##### end ubac_constrained(test_open_dbusd_t) depth: 3
#line 39
 	
#line 39
	role test_open_r types test_open_dbusd_t;
#line 39

#line 39
	 	 	
#line 39
##### begin kernel_read_system_state(test_open_dbusd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute kernel_system_state_reader;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_dbusd_t kernel_system_state_reader;
#line 39

#line 39
	 	
#line 39
##### end kernel_read_system_state(test_open_dbusd_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin selinux_get_fs_mount(test_open_dbusd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type security_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_dbusd_t security_t:lnk_file { getattr read };
#line 39
	 	 	
#line 39
##### begin dev_getattr_sysfs_fs(test_open_dbusd_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_dbusd_t sysfs_t:filesystem getattr;
#line 39

#line 39
	 	
#line 39
##### end dev_getattr_sysfs_fs(test_open_dbusd_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_search_sysfs(test_open_dbusd_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_dbusd_t sysfs_t:dir { getattr search open };
#line 39
	allow test_open_dbusd_t sysfs_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_search_sysfs(test_open_dbusd_t) depth: 4
#line 39
 	
#line 39
	# starting in libselinux 2.0.5, init_selinuxmnt() will
#line 39
	# attempt to short circuit by checking if SELINUXMNT
#line 39
	# (/selinux) is already a selinuxfs
#line 39
	allow test_open_dbusd_t security_t:filesystem getattr;
#line 39

#line 39
	# read /proc/filesystems to see if selinuxfs is supported
#line 39
	# then read /proc/self/mount to see where selinuxfs is mounted
#line 39
	 	 	
#line 39
##### begin kernel_read_system_state(test_open_dbusd_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute kernel_system_state_reader;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_dbusd_t kernel_system_state_reader;
#line 39

#line 39
	 	
#line 39
##### end kernel_read_system_state(test_open_dbusd_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end selinux_get_fs_mount(test_open_dbusd_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin userdom_home_manager(test_open_dbusd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute userdom_home_manager_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_dbusd_t userdom_home_manager_type;
#line 39

#line 39
	 	
#line 39
##### end userdom_home_manager(test_open_dbusd_t) depth: 3
#line 39
 	
#line 39

#line 39
	##############################
#line 39
	#
#line 39
	# Local policy
#line 39
	#
#line 39

#line 39
	# For connecting to the bus
#line 39
	allow test_open_usertype test_open_dbusd_t:unix_stream_socket { connectto { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 39

#line 39
	# SE-DBus specific permissions
#line 39
	allow { dbusd_unconfined test_open_usertype } test_open_dbusd_t:dbus { send_msg acquire_svc };
#line 39
	allow test_open_usertype system_dbusd_t:dbus { send_msg acquire_svc };
#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_usertype dbusd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_usertype test_open_dbusd_t:process transition;
#line 39
#	dontaudit test_open_usertype test_open_dbusd_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_usertype dbusd_exec_t:process test_open_dbusd_t;
#line 39

#line 39

#line 39
	allow test_open_dbusd_t test_open_usertype:fd use;
#line 39
	allow test_open_dbusd_t test_open_usertype:fifo_file { getattr read write append ioctl lock };
#line 39
	allow test_open_dbusd_t test_open_usertype:process sigchld;
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype test_open_dbusd_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_usertype test_open_dbusd_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_usertype test_open_dbusd_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype test_open_dbusd_t:process getattr;
#line 39

#line 39
	allow test_open_usertype test_open_dbusd_t:process { sigchld sigkill sigstop signull signal };
#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool deny_ptrace;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (deny_ptrace) {
#line 39
		
#line 39
	} else {
#line 39
		
#line 39
		allow test_open_usertype test_open_dbusd_t:process ptrace;
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	# cjp: this seems very broken
#line 39
	 	 	
#line 39
##### begin corecmd_bin_domtrans(test_open_dbusd_t,test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_bin_spec_domtrans(test_open_dbusd_t,test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_dbusd_t bin_t:dir { getattr search open };
#line 39
	allow test_open_dbusd_t bin_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_dbusd_t bin_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_dbusd_t test_open_t:process transition;
#line 39
#	dontaudit test_open_dbusd_t test_open_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_dbusd_t usr_t:dir { getattr search open };
#line 39
	allow test_open_dbusd_t usr_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_dbusd_t usr_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_dbusd_t test_open_t:process transition;
#line 39
#	dontaudit test_open_dbusd_t test_open_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_bin_spec_domtrans(test_open_dbusd_t,test_open_t) depth: 4
#line 39
 	
#line 39
	type_transition test_open_dbusd_t bin_t:process test_open_t;
#line 39
	type_transition test_open_dbusd_t usr_t:process test_open_t;
#line 39

#line 39
	 	
#line 39
##### end corecmd_bin_domtrans(test_open_dbusd_t,test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_shell_domtrans(test_open_dbusd_t,test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type shell_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_shell_spec_domtrans(test_open_dbusd_t,test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t, shell_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_dbusd_t bin_t:dir { getattr search open };
#line 39
	allow test_open_dbusd_t bin_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_dbusd_t bin_t:dir { getattr search open };
#line 39
	allow test_open_dbusd_t bin_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_dbusd_t shell_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_dbusd_t test_open_t:process transition;
#line 39
#	dontaudit test_open_dbusd_t test_open_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_shell_spec_domtrans(test_open_dbusd_t,test_open_t) depth: 4
#line 39
 	
#line 39
	type_transition test_open_dbusd_t shell_exec_t:process test_open_t;
#line 39

#line 39
	 	
#line 39
##### end corecmd_shell_domtrans(test_open_dbusd_t,test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_dbusd_t test_open_usertype:process sigkill;
#line 39
	allow test_open_usertype test_open_dbusd_t:fd use;
#line 39
	allow test_open_usertype test_open_dbusd_t:fifo_file { open { getattr read write append ioctl lock } };
#line 39

#line 39
	 	 	
#line 39
##### begin auth_use_nsswitch(test_open_dbusd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute nsswitch_domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_dbusd_t nsswitch_domain;
#line 39

#line 39
	 	 	
#line 39
##### begin corenet_all_recvfrom_netlabel(test_open_dbusd_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute netlabel_peer_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_dbusd_t netlabel_peer_type;
#line 39

#line 39
	 	
#line 39
##### end corenet_all_recvfrom_netlabel(test_open_dbusd_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end auth_use_nsswitch(test_open_dbusd_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin logging_send_syslog_msg(test_open_dbusd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute syslog_client_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_dbusd_t syslog_client_type;
#line 39

#line 39
	 	
#line 39
##### end logging_send_syslog_msg(test_open_dbusd_t) depth: 3
#line 39
 	
#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin mozilla_domtrans_spec(test_open_dbusd_t,test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type mozilla_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin domain_entry_file(test_open_t,mozilla_exec_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute entry_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t mozilla_exec_t:file entrypoint;
#line 39
	allow test_open_t mozilla_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 39

#line 39
	typeattribute mozilla_exec_t entry_type;
#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_executable_file(mozilla_exec_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute mozilla_exec_t exec_type;
#line 39

#line 39
	 	 	
#line 39
##### begin files_type(mozilla_exec_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute mozilla_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 39

#line 39
	 	
#line 39
##### end files_type(mozilla_exec_t) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corecmd_executable_file(mozilla_exec_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end domain_entry_file(test_open_t,mozilla_exec_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_dbusd_t mozilla_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_dbusd_t test_open_t:process transition;
#line 39
#	dontaudit test_open_dbusd_t test_open_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_dbusd_t mozilla_exec_t:process test_open_t;
#line 39

#line 39

#line 39
	allow test_open_t test_open_dbusd_t:fd use;
#line 39
	allow test_open_t test_open_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow test_open_t test_open_dbusd_t:process sigchld;
#line 39

#line 39

#line 39
	 	
#line 39
##### end mozilla_domtrans_spec(test_open_dbusd_t,test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39
 	 	
#line 39
##### end dbus_role_template(test_open,test_open_r,test_open_usertype) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin dbus_system_bus_client(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type system_dbusd_t, system_dbusd_t;
#line 39
		type system_dbusd_var_run_t, system_dbusd_var_lib_t;
#line 39
		class dbus send_msg;
#line 39
		attribute dbusd_unconfined;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	# SE-DBus specific permissions
#line 39
	allow test_open_usertype { system_dbusd_t self }:dbus send_msg;
#line 39
	allow { system_dbusd_t dbusd_unconfined } test_open_usertype:dbus send_msg;
#line 39

#line 39
	
#line 39
	allow test_open_usertype system_dbusd_var_lib_t:dir { getattr search open };
#line 39
	allow test_open_usertype system_dbusd_var_lib_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var_lib(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_lib_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_var_lib(test_open_usertype) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin dev_read_urand(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t, urandom_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype urandom_device_t:chr_file { getattr open read lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_read_urand(test_open_usertype) depth: 3
#line 39
 	
#line 39

#line 39
	# For connecting to the bus
#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype system_dbusd_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype system_dbusd_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_usertype system_dbusd_t:unix_stream_socket connectto;
#line 39

#line 39
	 	 	
#line 39
##### begin dbus_read_config(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type dbusd_etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype dbusd_etc_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_usertype dbusd_etc_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end dbus_read_config(test_open_usertype) depth: 3
#line 39
 	
#line 39

#line 39
    
#line 39
	optional {
#line 39
		
#line 39
         	 	
#line 39
##### begin unconfined_server_dbus_chat(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type unconfined_service_t;
#line 39
        class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
        allow test_open_usertype unconfined_service_t:dbus send_msg;
#line 39
        allow unconfined_service_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end unconfined_server_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
    
#line 39
	}
#line 39

#line 39

#line 39
	 	
#line 39
##### end dbus_system_bus_client(test_open_usertype) depth: 2
#line 39
 	
#line 39
		allow test_open_usertype test_open_usertype:dbus send_msg;
#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin abrt_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type abrt_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype abrt_t:dbus send_msg;
#line 39
	allow abrt_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end abrt_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
			 	 	
#line 39
##### begin abrt_run_helper(test_open_usertype,test_open_r) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute_role abrt_helper_roles;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin abrt_domtrans_helper(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type abrt_helper_t, abrt_helper_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_usertype abrt_helper_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_usertype abrt_helper_t:process transition;
#line 39
#	dontaudit test_open_usertype abrt_helper_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_usertype abrt_helper_exec_t:process abrt_helper_t;
#line 39

#line 39

#line 39
	allow abrt_helper_t test_open_usertype:fd use;
#line 39
	allow abrt_helper_t test_open_usertype:fifo_file { getattr read write append ioctl lock };
#line 39
	allow abrt_helper_t test_open_usertype:process sigchld;
#line 39

#line 39

#line 39
	 	
#line 39
##### end abrt_domtrans_helper(test_open_usertype) depth: 3
#line 39
 	
#line 39
	roleattribute test_open_r abrt_helper_roles;
#line 39

#line 39
	 	
#line 39
##### end abrt_run_helper(test_open_usertype,test_open_r) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin accountsd_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type accountsd_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype accountsd_t:dbus send_msg;
#line 39
	allow accountsd_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end accountsd_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin consolekit_dontaudit_read_log(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type consolekit_log_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype consolekit_log_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end consolekit_dontaudit_read_log(test_open_usertype) depth: 2
#line 39
 	
#line 39
			 	 	
#line 39
##### begin consolekit_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type consolekit_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype consolekit_t:dbus send_msg;
#line 39
	allow consolekit_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end consolekit_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin cups_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cupsd_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype cupsd_t:dbus send_msg;
#line 39
	allow cupsd_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end cups_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
			 	 	
#line 39
##### begin cups_dbus_chat_config(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cupsd_config_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype cupsd_config_t:dbus send_msg;
#line 39
	allow cupsd_config_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end cups_dbus_chat_config(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin devicekit_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type devicekit_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype devicekit_t:dbus send_msg;
#line 39
	allow devicekit_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end devicekit_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
			 	 	
#line 39
##### begin devicekit_dbus_chat_disk(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type devicekit_disk_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype devicekit_disk_t:dbus send_msg;
#line 39
	allow devicekit_disk_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end devicekit_dbus_chat_disk(test_open_usertype) depth: 2
#line 39
 	
#line 39
			 	 	
#line 39
##### begin devicekit_dbus_chat_power(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type devicekit_power_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype devicekit_power_t:dbus send_msg;
#line 39
	allow devicekit_power_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end devicekit_dbus_chat_power(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin fprintd_dbus_chat(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type fprintd_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t fprintd_t:dbus send_msg;
#line 39
	allow fprintd_t test_open_t:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end fprintd_dbus_chat(test_open_t) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin realmd_dbus_chat(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type realmd_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t realmd_t:dbus send_msg;
#line 39
	allow realmd_t test_open_t:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end realmd_dbus_chat(test_open_t) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin gnome_role_template(test_open,test_open_r,test_open_t) depth: 3
#line 39
 	
#line 39
    
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute gnomedomain, gkeyringd_domain, gnome_home_type;
#line 39
		attribute_role gconfd_roles;
#line 39
		type gkeyringd_exec_t, gkeyringd_tmp_t;
#line 39
		type gconfd_t, gconfd_exec_t, gconf_tmp_t;
#line 39
		class dbus { acquire_svc send_msg };
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	########################################
#line 39
	#
#line 39
	# Gconf declarations
#line 39
	#
#line 39

#line 39
	roleattribute test_open_r gconfd_roles;
#line 39

#line 39
	########################################
#line 39
	#
#line 39
	# Gkeyringd declarations
#line 39
	#
#line 39

#line 39
	type test_open_gkeyringd_t, gnomedomain, gkeyringd_domain;
#line 39
	 	 	
#line 39
##### begin userdom_user_application_domain(test_open_gkeyringd_t,gkeyringd_exec_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin application_domain(test_open_gkeyringd_t,gkeyringd_exec_t) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin application_type(test_open_gkeyringd_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute application_domain_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_gkeyringd_t application_domain_type;
#line 39

#line 39
	# start with basic domain
#line 39
	 	 	
#line 39
##### begin domain_type(test_open_gkeyringd_t) depth: 7
#line 39
 	
#line 39
	# start with basic domain
#line 39
	 	 	
#line 39
##### begin domain_base_type(test_open_gkeyringd_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_gkeyringd_t domain;
#line 39

#line 39
	 	
#line 39
##### end domain_base_type(test_open_gkeyringd_t) depth: 7
#line 39
 	
#line 39

#line 39
	# Only way to get corenet_unlabeled packets disabled to work
#line 39
	 	 	
#line 39
##### begin corenet_all_recvfrom_unlabeled(test_open_gkeyringd_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
                attribute corenet_unlabeled_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	typeattribute test_open_gkeyringd_t corenet_unlabeled_type;
#line 39

#line 39
	 	
#line 39
##### end corenet_all_recvfrom_unlabeled(test_open_gkeyringd_t) depth: 7
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end domain_type(test_open_gkeyringd_t) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end application_type(test_open_gkeyringd_t) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin application_executable_file(gkeyringd_exec_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute application_exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute gkeyringd_exec_t application_exec_type;
#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_executable_file(gkeyringd_exec_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute gkeyringd_exec_t exec_type;
#line 39

#line 39
	 	 	
#line 39
##### begin files_type(gkeyringd_exec_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute gkeyringd_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 39

#line 39
	 	
#line 39
##### end files_type(gkeyringd_exec_t) depth: 7
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corecmd_executable_file(gkeyringd_exec_t) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end application_executable_file(gkeyringd_exec_t) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin domain_entry_file(test_open_gkeyringd_t,gkeyringd_exec_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute entry_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_gkeyringd_t gkeyringd_exec_t:file entrypoint;
#line 39
	allow test_open_gkeyringd_t gkeyringd_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 39

#line 39
	typeattribute gkeyringd_exec_t entry_type;
#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_executable_file(gkeyringd_exec_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute gkeyringd_exec_t exec_type;
#line 39

#line 39
	 	 	
#line 39
##### begin files_type(gkeyringd_exec_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute gkeyringd_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 39

#line 39
	 	
#line 39
##### end files_type(gkeyringd_exec_t) depth: 7
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corecmd_executable_file(gkeyringd_exec_t) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end domain_entry_file(test_open_gkeyringd_t,gkeyringd_exec_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end application_domain(test_open_gkeyringd_t,gkeyringd_exec_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin ubac_constrained(test_open_gkeyringd_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute ubac_constrained_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_gkeyringd_t ubac_constrained_type;
#line 39

#line 39
	 	
#line 39
##### end ubac_constrained(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_user_application_domain(test_open_gkeyringd_t,gkeyringd_exec_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin domain_user_exemption_target(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute process_user_target;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_gkeyringd_t process_user_target;
#line 39

#line 39
	 	
#line 39
##### end domain_user_exemption_target(test_open_gkeyringd_t) depth: 3
#line 39
 	
#line 39

#line 39
	role test_open_r types test_open_gkeyringd_t;
#line 39

#line 39
	########################################
#line 39
	#
#line 39
	# Gconf policy
#line 39
	#
#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t gconfd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t gconfd_t:process transition;
#line 39
#	dontaudit test_open_t gconfd_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t gconfd_exec_t:process gconfd_t;
#line 39

#line 39

#line 39
	allow gconfd_t test_open_t:fd use;
#line 39
	allow gconfd_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow gconfd_t test_open_t:process sigchld;
#line 39

#line 39

#line 39
	allow test_open_t gconfd_t:process { { sigchld sigkill sigstop signull signal } };
#line 39
	allow test_open_t gconfd_t:unix_stream_socket connectto;
#line 39
	
#line 39
	allow test_open_t gconfd_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t gconfd_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_t gconfd_t:lnk_file { getattr read };
#line 39
	allow test_open_t gconfd_t:process getattr;
#line 39

#line 39

#line 39

#line 39
	########################################
#line 39
	#
#line 39
	# Gkeyringd policy
#line 39
	#
#line 39

#line 39
    allow test_open_gkeyringd_t test_open_t:unix_stream_socket { connectto { { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } } listen accept } };
#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t gkeyringd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t test_open_gkeyringd_t:process transition;
#line 39
#	dontaudit test_open_t test_open_gkeyringd_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t gkeyringd_exec_t:process test_open_gkeyringd_t;
#line 39

#line 39

#line 39
	allow test_open_gkeyringd_t test_open_t:fd use;
#line 39
	allow test_open_gkeyringd_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow test_open_gkeyringd_t test_open_t:process sigchld;
#line 39

#line 39

#line 39
	allow test_open_t { gnome_home_type gkeyringd_tmp_t gconf_tmp_t }:dir { { getattr relabelfrom relabelto } { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl } };
#line 39
	allow test_open_t { gnome_home_type gkeyringd_tmp_t gconf_tmp_t }:file { { getattr relabelfrom relabelto } { create open getattr setattr read write append rename link unlink ioctl lock } };
#line 39

#line 39
	 	 	
#line 39
##### begin userdom_home_manager(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute userdom_home_manager_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_gkeyringd_t userdom_home_manager_type;
#line 39

#line 39
	 	
#line 39
##### end userdom_home_manager(test_open_gkeyringd_t) depth: 3
#line 39
 	
#line 39

#line 39
	allow test_open_t gkeyringd_tmp_t:sock_file { { getattr relabelfrom relabelto } { create open getattr setattr read write rename link unlink ioctl lock append } };
#line 39

#line 39
	
#line 39
	allow test_open_t test_open_gkeyringd_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t test_open_gkeyringd_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_t test_open_gkeyringd_t:lnk_file { getattr read };
#line 39
	allow test_open_t test_open_gkeyringd_t:process getattr;
#line 39

#line 39
	allow test_open_t test_open_gkeyringd_t:process { sigchld sigkill sigstop signull signal };
#line 39
	dontaudit test_open_t gkeyringd_exec_t:file entrypoint;
#line 39

#line 39
	allow test_open_gkeyringd_t test_open_t:process sigkill;
#line 39
	allow test_open_t test_open_gkeyringd_t:fd use;
#line 39
	allow test_open_t test_open_gkeyringd_t:fifo_file { open { getattr read write append ioctl lock } };
#line 39

#line 39
	dontaudit test_open_gkeyringd_t test_open_t:unix_stream_socket { getattr read write };
#line 39

#line 39
	
#line 39
	allow test_open_t gkeyringd_tmp_t:dir { getattr search open };
#line 39
	allow test_open_t gkeyringd_tmp_t:sock_file { getattr write open append };
#line 39
	allow test_open_t test_open_gkeyringd_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin kernel_read_system_state(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute kernel_system_state_reader;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_gkeyringd_t kernel_system_state_reader;
#line 39

#line 39
	 	
#line 39
##### end kernel_read_system_state(test_open_gkeyringd_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_bin_domtrans(test_open_gkeyringd_t,test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_bin_spec_domtrans(test_open_gkeyringd_t,test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_gkeyringd_t bin_t:dir { getattr search open };
#line 39
	allow test_open_gkeyringd_t bin_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_gkeyringd_t bin_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_gkeyringd_t test_open_t:process transition;
#line 39
#	dontaudit test_open_gkeyringd_t test_open_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_gkeyringd_t usr_t:dir { getattr search open };
#line 39
	allow test_open_gkeyringd_t usr_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_gkeyringd_t usr_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_gkeyringd_t test_open_t:process transition;
#line 39
#	dontaudit test_open_gkeyringd_t test_open_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_bin_spec_domtrans(test_open_gkeyringd_t,test_open_t) depth: 4
#line 39
 	
#line 39
	type_transition test_open_gkeyringd_t bin_t:process test_open_t;
#line 39
	type_transition test_open_gkeyringd_t usr_t:process test_open_t;
#line 39

#line 39
	 	
#line 39
##### end corecmd_bin_domtrans(test_open_gkeyringd_t,test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_shell_domtrans(test_open_gkeyringd_t,test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type shell_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_shell_spec_domtrans(test_open_gkeyringd_t,test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t, shell_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_gkeyringd_t bin_t:dir { getattr search open };
#line 39
	allow test_open_gkeyringd_t bin_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_gkeyringd_t bin_t:dir { getattr search open };
#line 39
	allow test_open_gkeyringd_t bin_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_gkeyringd_t shell_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_gkeyringd_t test_open_t:process transition;
#line 39
#	dontaudit test_open_gkeyringd_t test_open_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_shell_spec_domtrans(test_open_gkeyringd_t,test_open_t) depth: 4
#line 39
 	
#line 39
	type_transition test_open_gkeyringd_t shell_exec_t:process test_open_t;
#line 39

#line 39
	 	
#line 39
##### end corecmd_shell_domtrans(test_open_gkeyringd_t,test_open_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin gnome_stream_connect_gkeyringd(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
			attribute gkeyringd_domain;
#line 39
			type gkeyringd_tmp_t;
#line 39
			type gconf_tmp_t;
#line 39
			type cache_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t gconf_tmp_t:dir { getattr search open };
#line 39
	 	 	
#line 39
##### begin userdom_search_user_tmp_dirs(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_tmp(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin fs_search_tmpfs(test_open_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t tmpfs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_tmpfs(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	allow test_open_t tmp_t:dir { getattr search open };
#line 39
	allow test_open_t tmp_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_t tmp_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_tmp(test_open_t) depth: 5
#line 39
 	
#line 39
	allow test_open_t user_tmp_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end userdom_search_user_tmp_dirs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow test_open_t gkeyringd_tmp_t:dir { getattr search open };
#line 39
	allow test_open_t gkeyringd_tmp_t:sock_file { getattr write open append };
#line 39
	allow test_open_t gkeyringd_domain:unix_stream_socket connectto;
#line 39

#line 39
	
#line 39
	allow test_open_t cache_home_t:dir { getattr search open };
#line 39
	allow test_open_t cache_home_t:sock_file { getattr write open append };
#line 39
	allow test_open_t gkeyringd_domain:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end gnome_stream_connect_gkeyringd(test_open_t) depth: 3
#line 39
 	
#line 39

#line 39
	
#line 39
	allow test_open_gkeyringd_t test_open_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_gkeyringd_t test_open_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_gkeyringd_t test_open_t:lnk_file { getattr read };
#line 39
	allow test_open_gkeyringd_t test_open_t:process getattr;
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin auth_use_nsswitch(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute nsswitch_domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_gkeyringd_t nsswitch_domain;
#line 39

#line 39
	 	 	
#line 39
##### begin corenet_all_recvfrom_netlabel(test_open_gkeyringd_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute netlabel_peer_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_gkeyringd_t netlabel_peer_type;
#line 39

#line 39
	 	
#line 39
##### end corenet_all_recvfrom_netlabel(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end auth_use_nsswitch(test_open_gkeyringd_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin logging_send_syslog_msg(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute syslog_client_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_gkeyringd_t syslog_client_type;
#line 39

#line 39
	 	
#line 39
##### end logging_send_syslog_msg(test_open_gkeyringd_t) depth: 3
#line 39
 	
#line 39

#line 39
     	 	
#line 39
##### begin userdom_rw_user_tmp_sock_files(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_gkeyringd_t user_tmp_t:dir { getattr search open read lock ioctl };
#line 39
    allow test_open_gkeyringd_t user_tmp_t:sock_file { getattr read write append };
#line 39
	 	 	
#line 39
##### begin files_search_tmp(test_open_gkeyringd_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin fs_search_tmpfs(test_open_gkeyringd_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_gkeyringd_t tmpfs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_tmpfs(test_open_gkeyringd_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow test_open_gkeyringd_t tmp_t:dir { getattr search open };
#line 39
	allow test_open_gkeyringd_t tmp_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_gkeyringd_t tmp_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_tmp(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_rw_user_tmp_sock_files(test_open_gkeyringd_t) depth: 3
#line 39
 	
#line 39

#line 39
	allow test_open_gkeyringd_t test_open_t:dbus { acquire_svc send_msg };
#line 39
	allow test_open_t test_open_gkeyringd_t:dbus send_msg;
#line 39
	allow test_open_t test_open_t:dbus acquire_svc;
#line 39

#line 39
    
#line 39
	optional {
#line 39
		
#line 39
         	 	
#line 39
##### begin systemd_dbus_chat_logind(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type systemd_logind_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_gkeyringd_t systemd_logind_t:dbus send_msg;
#line 39
	allow systemd_logind_t test_open_gkeyringd_t:dbus send_msg;
#line 39
	
#line 39
	allow systemd_logind_t test_open_gkeyringd_t:dir { getattr search open read lock ioctl };
#line 39
	allow systemd_logind_t test_open_gkeyringd_t:file { open { getattr read ioctl lock } };
#line 39
	allow systemd_logind_t test_open_gkeyringd_t:lnk_file { getattr read };
#line 39
	allow systemd_logind_t test_open_gkeyringd_t:process getattr;
#line 39

#line 39
	allow systemd_logind_t test_open_gkeyringd_t:process signal;
#line 39
	allow test_open_gkeyringd_t systemd_logind_t:fd use;
#line 39

#line 39
	 	
#line 39
##### end systemd_dbus_chat_logind(test_open_gkeyringd_t) depth: 3
#line 39
 	
#line 39
    
#line 39
	}
#line 39

#line 39

#line 39
    
#line 39
	optional {
#line 39
		
#line 39
         	 	
#line 39
##### begin dbus_session_domain(test_open,gkeyringd_exec_t,test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type test_open_dbusd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_dbusd_t gkeyringd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_dbusd_t test_open_gkeyringd_t:process transition;
#line 39
#	dontaudit test_open_dbusd_t test_open_gkeyringd_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_dbusd_t gkeyringd_exec_t:process test_open_gkeyringd_t;
#line 39

#line 39

#line 39
	allow test_open_gkeyringd_t test_open_dbusd_t:fd use;
#line 39
	allow test_open_gkeyringd_t test_open_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow test_open_gkeyringd_t test_open_dbusd_t:process sigchld;
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dbus_session_bus_client(test_open_gkeyringd_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	# SE-DBus specific permissions
#line 39
	allow test_open_gkeyringd_t { session_bus_type self }:dbus send_msg;
#line 39

#line 39
	# For connecting to the bus
#line 39
	allow test_open_gkeyringd_t session_bus_type:unix_stream_socket connectto;
#line 39

#line 39
	allow session_bus_type test_open_gkeyringd_t:process sigkill;
#line 39

#line 39
	 	
#line 39
##### end dbus_session_bus_client(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dbus_connect_session_bus(test_open_gkeyringd_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute session_bus_type;
#line 39
		class dbus acquire_svc;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_gkeyringd_t session_bus_type:dbus acquire_svc;
#line 39

#line 39
	 	
#line 39
##### end dbus_connect_session_bus(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end dbus_session_domain(test_open,gkeyringd_exec_t,test_open_gkeyringd_t) depth: 3
#line 39
 	
#line 39
         	 	
#line 39
##### begin dbus_stream_connect_system_dbusd(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type system_dbusd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_gkeyringd_t system_dbusd_t:unix_stream_socket connectto;
#line 39

#line 39
	 	
#line 39
##### end dbus_stream_connect_system_dbusd(test_open_gkeyringd_t) depth: 3
#line 39
 	
#line 39
         	 	
#line 39
##### begin dbus_send_system_bus(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type system_dbusd_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_gkeyringd_t system_dbusd_t:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end dbus_send_system_bus(test_open_gkeyringd_t) depth: 3
#line 39
 	
#line 39
    
#line 39
	}
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin gnome_manage_generic_home_dirs(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type gnome_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin userdom_search_user_home_dirs(test_open_gkeyringd_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_dir_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_gkeyringd_t user_home_dir_t:dir { getattr search open };
#line 39
	allow test_open_gkeyringd_t user_home_dir_t:lnk_file { getattr read };
#line 39
	 	 	
#line 39
##### begin files_search_home(test_open_gkeyringd_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_gkeyringd_t home_root_t:dir { getattr search open };
#line 39
	allow test_open_gkeyringd_t home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_search_home(test_open_gkeyringd_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_search_user_home_dirs(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39
	allow test_open_gkeyringd_t gnome_home_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end gnome_manage_generic_home_dirs(test_open_gkeyringd_t) depth: 3
#line 39
 	
#line 39
		 	 	
#line 39
##### begin gnome_read_generic_data_home_files(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type data_home_t, gconf_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_gkeyringd_t { gconf_home_t data_home_t }:dir { getattr search open };
#line 39
	allow test_open_gkeyringd_t data_home_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_gkeyringd_t { gconf_home_t data_home_t }:dir { getattr search open };
#line 39
	allow test_open_gkeyringd_t data_home_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end gnome_read_generic_data_home_files(test_open_gkeyringd_t) depth: 3
#line 39
 	
#line 39
		 	 	
#line 39
##### begin gnome_read_generic_data_home_dirs(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39
    
#line 39
	
#line 39
		require {
#line 39
			
#line 39
        type data_home_t, gconf_home_t;
#line 39
    
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
    
#line 39
	allow test_open_gkeyringd_t { gconf_home_t data_home_t }:dir { getattr search open };
#line 39
	allow test_open_gkeyringd_t data_home_t:dir { getattr search open read lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end gnome_read_generic_data_home_dirs(test_open_gkeyringd_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin telepathy_mission_control_read_state(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type telepathy_mission_control_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin kernel_search_proc(test_open_gkeyringd_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type proc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_gkeyringd_t proc_t:dir { getattr search open };
#line 39
	allow test_open_gkeyringd_t proc_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end kernel_search_proc(test_open_gkeyringd_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow test_open_gkeyringd_t telepathy_mission_control_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_gkeyringd_t telepathy_mission_control_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_gkeyringd_t telepathy_mission_control_t:lnk_file { getattr read };
#line 39
	allow test_open_gkeyringd_t telepathy_mission_control_t:process getattr;
#line 39

#line 39

#line 39
	 	
#line 39
##### end telepathy_mission_control_read_state(test_open_gkeyringd_t) depth: 3
#line 39
 	
#line 39
         	 	
#line 39
##### begin telepathy_gabble_stream_connect_to(test_open_gkeyringd_t,gkeyringd_tmp_t,gkeyringd_tmp_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type telepathy_gabble_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow telepathy_gabble_t gkeyringd_tmp_t:dir { getattr search open };
#line 39
	allow telepathy_gabble_t gkeyringd_tmp_t:sock_file { getattr write open append };
#line 39
	allow telepathy_gabble_t test_open_gkeyringd_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end telepathy_gabble_stream_connect_to(test_open_gkeyringd_t,gkeyringd_tmp_t,gkeyringd_tmp_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39
 	 	
#line 39
##### end gnome_role_template(test_open,test_open_r,test_open_t) depth: 2
#line 39
 	
#line 39
        
#line 39
	}
#line 39

#line 39

#line 39
        
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin wm_role_template(test_open,test_open_r,test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type wm_exec_t;
#line 39
		class dbus send_msg;
#line 39
		attribute wm_domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	type test_open_wm_t, wm_domain;
#line 39
	 	 	
#line 39
##### begin domain_type(test_open_wm_t) depth: 4
#line 39
 	
#line 39
	# start with basic domain
#line 39
	 	 	
#line 39
##### begin domain_base_type(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wm_t domain;
#line 39

#line 39
	 	
#line 39
##### end domain_base_type(test_open_wm_t) depth: 4
#line 39
 	
#line 39

#line 39
	# Only way to get corenet_unlabeled packets disabled to work
#line 39
	 	 	
#line 39
##### begin corenet_all_recvfrom_unlabeled(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
                attribute corenet_unlabeled_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	typeattribute test_open_wm_t corenet_unlabeled_type;
#line 39

#line 39
	 	
#line 39
##### end corenet_all_recvfrom_unlabeled(test_open_wm_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end domain_type(test_open_wm_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin domain_entry_file(test_open_wm_t,wm_exec_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute entry_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wm_t wm_exec_t:file entrypoint;
#line 39
	allow test_open_wm_t wm_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 39

#line 39
	typeattribute wm_exec_t entry_type;
#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_executable_file(wm_exec_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute wm_exec_t exec_type;
#line 39

#line 39
	 	 	
#line 39
##### begin files_type(wm_exec_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute wm_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 39

#line 39
	 	
#line 39
##### end files_type(wm_exec_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corecmd_executable_file(wm_exec_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end domain_entry_file(test_open_wm_t,wm_exec_t) depth: 3
#line 39
 	
#line 39
	role test_open_r types test_open_wm_t;
#line 39

#line 39
	allow test_open_wm_t test_open_t:unix_stream_socket connectto;
#line 39
	allow test_open_t test_open_wm_t:unix_stream_socket connectto;
#line 39
	allow test_open_t test_open_wm_t:process { signal sigchld signull };
#line 39
	allow test_open_wm_t test_open_t:process { signull sigkill };
#line 39

#line 39
	allow test_open_wm_t test_open_t:dbus send_msg;
#line 39
	allow test_open_t test_open_wm_t:dbus send_msg;
#line 39

#line 39
	 	 	
#line 39
##### begin userdom_manage_home_role(test_open_r,test_open_wm_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_t, user_home_dir_t;
#line 39
		attribute user_home_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	role test_open_r types { user_home_type user_home_dir_t };
#line 39

#line 39
	##############################
#line 39
	#
#line 39
	# Domain access to home dir
#line 39
	#
#line 39

#line 39
	type_member test_open_wm_t user_home_dir_t:dir user_home_dir_t;
#line 39

#line 39
	# full control of the home directory
#line 39
	allow test_open_wm_t user_home_t:dir mounton;
#line 39
	allow test_open_wm_t user_home_t:file entrypoint;
#line 39

#line 39
	allow test_open_wm_t user_home_type:{ dir file lnk_file sock_file fifo_file chr_file blk_file } { relabelto relabelfrom };
#line 39
	allow test_open_wm_t user_home_dir_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_wm_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t user_home_type:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t user_home_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t user_home_type:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t user_home_type:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t user_home_type:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 39
	allow test_open_wm_t user_home_type:dir { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 39
	allow test_open_wm_t user_home_type:file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 39
	allow test_open_wm_t user_home_type:lnk_file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 39
	allow test_open_wm_t user_home_type:sock_file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 39
	allow test_open_wm_t user_home_type:fifo_file { getattr relabelfrom relabelto };
#line 39

#line 39
	 	 	
#line 39
##### begin userdom_filetrans_home_content(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
	        attribute userdom_filetrans_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wm_t  userdom_filetrans_type;
#line 39

#line 39
	 	
#line 39
##### end userdom_filetrans_home_content(test_open_wm_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin files_list_home(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wm_t home_root_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_wm_t home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_list_home(test_open_wm_t) depth: 4
#line 39
 	
#line 39

#line 39
	# cjp: this should probably be removed:
#line 39
	allow test_open_wm_t user_home_dir_t:dir { { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl } { getattr relabelfrom relabelto } };
#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool use_nfs_home_dirs;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (use_nfs_home_dirs) {
#line 39
		
#line 39
		 	 	
#line 39
##### begin fs_mount_nfs(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wm_t nfs_t:filesystem mount;
#line 39

#line 39
	 	
#line 39
##### end fs_mount_nfs(test_open_wm_t) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_mounton_nfs(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wm_t nfs_t:dir mounton;
#line 39

#line 39
	 	
#line 39
##### end fs_mounton_nfs(test_open_wm_t) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_nfs_dirs(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin fs_search_auto_mountpoints(test_open_wm_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type autofs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wm_t autofs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_auto_mountpoints(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	allow test_open_wm_t nfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end fs_manage_nfs_dirs(test_open_wm_t) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_nfs_files(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin fs_search_auto_mountpoints(test_open_wm_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type autofs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wm_t autofs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_auto_mountpoints(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow test_open_wm_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t nfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_nfs_files(test_open_wm_t) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_nfs_symlinks(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin fs_search_auto_mountpoints(test_open_wm_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type autofs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wm_t autofs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_auto_mountpoints(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow test_open_wm_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t nfs_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_nfs_symlinks(test_open_wm_t) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_nfs_named_sockets(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wm_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t nfs_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_nfs_named_sockets(test_open_wm_t) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_nfs_named_pipes(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wm_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t nfs_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_nfs_named_pipes(test_open_wm_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool use_samba_home_dirs;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (use_samba_home_dirs) {
#line 39
		
#line 39
		 	 	
#line 39
##### begin fs_mount_cifs(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wm_t cifs_t:filesystem mount;
#line 39

#line 39
	 	
#line 39
##### end fs_mount_cifs(test_open_wm_t) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_mounton_cifs(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wm_t cifs_t:dir mounton;
#line 39

#line 39
	 	
#line 39
##### end fs_mounton_cifs(test_open_wm_t) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_cifs_dirs(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wm_t cifs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end fs_manage_cifs_dirs(test_open_wm_t) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_cifs_files(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wm_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t cifs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_cifs_files(test_open_wm_t) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_cifs_symlinks(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wm_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t cifs_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_cifs_symlinks(test_open_wm_t) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_cifs_named_sockets(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wm_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t cifs_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_cifs_named_sockets(test_open_wm_t) depth: 4
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_cifs_named_pipes(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wm_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t cifs_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_cifs_named_pipes(test_open_wm_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_manage_home_role(test_open_r,test_open_wm_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin userdom_manage_tmp_role(test_open_r,test_open_wm_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute user_tmp_type;
#line 39
		type user_tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	role test_open_r types user_tmp_t;
#line 39

#line 39
	 	 	
#line 39
##### begin files_poly_member_tmp(test_open_wm_t,user_tmp_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	type_member test_open_wm_t tmp_t:dir user_tmp_t;
#line 39

#line 39
	 	
#line 39
##### end files_poly_member_tmp(test_open_wm_t,user_tmp_t) depth: 4
#line 39
 	
#line 39

#line 39
	allow test_open_wm_t user_tmp_type:dir mounton;
#line 39
	
#line 39
	allow test_open_wm_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t user_tmp_type:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t user_tmp_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t user_tmp_type:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t user_tmp_type:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t user_tmp_type:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	 	 	
#line 39
##### begin files_tmp_filetrans(test_open_wm_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wm_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_wm_t tmp_t:{ dir file lnk_file sock_file fifo_file } user_tmp_t ;
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_tmp_filetrans(test_open_wm_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 4
#line 39
 	
#line 39
     	 	
#line 39
##### begin fs_tmpfs_filetrans(test_open_wm_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow user_tmp_t tmpfs_t:filesystem associate;
#line 39
	
#line 39
	allow test_open_wm_t tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_wm_t tmpfs_t:{ dir file lnk_file sock_file fifo_file } user_tmp_t ;
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_tmpfs_filetrans(test_open_wm_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow test_open_wm_t user_tmp_type:dir { getattr search open };
#line 39
	allow test_open_wm_t user_tmp_type:dir { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_tmp_type:dir { getattr search open };
#line 39
	allow test_open_wm_t user_tmp_type:file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_tmp_type:dir { getattr search open };
#line 39
	allow test_open_wm_t user_tmp_type:lnk_file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_tmp_type:dir { getattr search open };
#line 39
	allow test_open_wm_t user_tmp_type:sock_file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_tmp_type:dir { getattr search open };
#line 39
	allow test_open_wm_t user_tmp_type:fifo_file { getattr relabelfrom relabelto };
#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_manage_tmp_role(test_open_r,test_open_wm_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin userdom_exec_user_tmp_files(test_open_wm_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_tmp_t:dir { getattr search open };
#line 39
	allow test_open_wm_t user_tmp_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39

#line 39
	dontaudit test_open_wm_t user_tmp_t:sock_file execute;
#line 39
	 	 	
#line 39
##### begin files_search_tmp(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin fs_search_tmpfs(test_open_wm_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wm_t tmpfs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_tmpfs(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow test_open_wm_t tmp_t:dir { getattr search open };
#line 39
	allow test_open_wm_t tmp_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_wm_t tmp_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_tmp(test_open_wm_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_exec_user_tmp_files(test_open_wm_t) depth: 3
#line 39
 	
#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t wm_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t test_open_wm_t:process transition;
#line 39
#	dontaudit test_open_t test_open_wm_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t wm_exec_t:process test_open_wm_t;
#line 39

#line 39

#line 39
	allow test_open_wm_t test_open_t:fd use;
#line 39
	allow test_open_wm_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow test_open_wm_t test_open_t:process sigchld;
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_bin_domtrans(test_open_wm_t,test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_bin_spec_domtrans(test_open_wm_t,test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wm_t bin_t:dir { getattr search open };
#line 39
	allow test_open_wm_t bin_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t bin_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_wm_t test_open_t:process transition;
#line 39
#	dontaudit test_open_wm_t test_open_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wm_t usr_t:dir { getattr search open };
#line 39
	allow test_open_wm_t usr_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t usr_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_wm_t test_open_t:process transition;
#line 39
#	dontaudit test_open_wm_t test_open_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_bin_spec_domtrans(test_open_wm_t,test_open_t) depth: 4
#line 39
 	
#line 39
	type_transition test_open_wm_t bin_t:process test_open_t;
#line 39
	type_transition test_open_wm_t usr_t:process test_open_t;
#line 39

#line 39
	 	
#line 39
##### end corecmd_bin_domtrans(test_open_wm_t,test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_shell_domtrans(test_open_wm_t,test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type shell_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_shell_spec_domtrans(test_open_wm_t,test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t, shell_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wm_t bin_t:dir { getattr search open };
#line 39
	allow test_open_wm_t bin_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t bin_t:dir { getattr search open };
#line 39
	allow test_open_wm_t bin_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t shell_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_wm_t test_open_t:process transition;
#line 39
#	dontaudit test_open_wm_t test_open_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_shell_spec_domtrans(test_open_wm_t,test_open_t) depth: 4
#line 39
 	
#line 39
	type_transition test_open_wm_t shell_exec_t:process test_open_t;
#line 39

#line 39
	 	
#line 39
##### end corecmd_shell_domtrans(test_open_wm_t,test_open_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin auth_use_nsswitch(test_open_wm_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute nsswitch_domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wm_t nsswitch_domain;
#line 39

#line 39
	 	 	
#line 39
##### begin corenet_all_recvfrom_netlabel(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute netlabel_peer_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wm_t netlabel_peer_type;
#line 39

#line 39
	 	
#line 39
##### end corenet_all_recvfrom_netlabel(test_open_wm_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end auth_use_nsswitch(test_open_wm_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin kernel_read_system_state(test_open_wm_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute kernel_system_state_reader;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wm_t kernel_system_state_reader;
#line 39

#line 39
	 	
#line 39
##### end kernel_read_system_state(test_open_wm_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin auth_use_nsswitch(test_open_wm_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute nsswitch_domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wm_t nsswitch_domain;
#line 39

#line 39
	 	 	
#line 39
##### begin corenet_all_recvfrom_netlabel(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute netlabel_peer_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wm_t netlabel_peer_type;
#line 39

#line 39
	 	
#line 39
##### end corenet_all_recvfrom_netlabel(test_open_wm_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end auth_use_nsswitch(test_open_wm_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin mls_file_read_all_levels(test_open_wm_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute mlsfileread;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wm_t mlsfileread;
#line 39

#line 39
	 	
#line 39
##### end mls_file_read_all_levels(test_open_wm_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin mls_file_write_all_levels(test_open_wm_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute mlsfilewrite;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wm_t mlsfilewrite;
#line 39

#line 39
	 	
#line 39
##### end mls_file_write_all_levels(test_open_wm_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin mls_xwin_read_all_levels(test_open_wm_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute mlsxwinread;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wm_t mlsxwinread;
#line 39

#line 39
	 	
#line 39
##### end mls_xwin_read_all_levels(test_open_wm_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin mls_xwin_write_all_levels(test_open_wm_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute mlsxwinwrite;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wm_t mlsxwinwrite;
#line 39

#line 39
	 	
#line 39
##### end mls_xwin_write_all_levels(test_open_wm_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin mls_fd_use_all_levels(test_open_wm_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute mlsfduse;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wm_t mlsfduse;
#line 39

#line 39
	 	
#line 39
##### end mls_fd_use_all_levels(test_open_wm_t) depth: 3
#line 39
 	
#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin pulseaudio_run(test_open_wm_t,test_open_r) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type pulseaudio_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin pulseaudio_domtrans(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute pulseaudio_client;
#line 39
		type pulseaudio_t, pulseaudio_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wm_t pulseaudio_client;
#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_search_bin(test_open_wm_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_read_bin_symlinks(test_open_wm_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wm_t bin_t:dir { getattr search open };
#line 39
	allow test_open_wm_t bin_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_read_bin_symlinks(test_open_wm_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	allow test_open_wm_t bin_t:dir { getattr search open };
#line 39
	allow test_open_wm_t bin_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_search_bin(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_wm_t pulseaudio_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_wm_t pulseaudio_t:process transition;
#line 39
#	dontaudit test_open_wm_t pulseaudio_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_wm_t pulseaudio_exec_t:process pulseaudio_t;
#line 39

#line 39

#line 39
	allow pulseaudio_t test_open_wm_t:fd use;
#line 39
	allow pulseaudio_t test_open_wm_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow pulseaudio_t test_open_wm_t:process sigchld;
#line 39

#line 39

#line 39
	 	
#line 39
##### end pulseaudio_domtrans(test_open_wm_t) depth: 4
#line 39
 	
#line 39
	role test_open_r types pulseaudio_t;
#line 39

#line 39
	 	
#line 39
##### end pulseaudio_run(test_open_wm_t,test_open_r) depth: 3
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin xserver_role(test_open_r,test_open_wm_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type iceauth_home_t, xserver_t, xserver_tmpfs_t, xauth_home_t;
#line 39
		type user_fonts_t, user_fonts_cache_t, user_fonts_config_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin xserver_restricted_role(test_open_r,test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type xauth_t, iceauth_t;
#line 39
		attribute dridomain, x_userdomain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	role test_open_r types { xauth_t iceauth_t };
#line 39
	typeattribute test_open_wm_t x_userdomain, dridomain;
#line 39

#line 39
	 	 	
#line 39
##### begin xserver_common_x_domain_template(user,test_open_wm_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type root_xdrawable_t, xdm_t, xserver_t;
#line 39
		type xproperty_t, user_xproperty_t;
#line 39
		type xevent_t, client_xevent_t;
#line 39
		type input_xevent_t, user_input_xevent_t;
#line 39

#line 39
		attribute x_domain, input_xevent_type;
#line 39
		attribute xdrawable_type, xcolormap_type;
#line 39

#line 39
		class x_drawable { create destroy read write blend getattr setattr list_child add_child remove_child list_property get_property set_property manage override show hide send receive };
#line 39
		class x_property { create destroy read write append getattr setattr };
#line 39
		class x_event { send receive };
#line 39
		class x_synthetic_event { send receive };
#line 39
		class x_client destroy;
#line 39
		class x_server manage;
#line 39
		class x_screen { saver_setattr saver_hide saver_show show_cursor hide_cursor };
#line 39
		class x_pointer { get_property set_property manage };
#line 39
		class x_keyboard { read manage freeze };
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	##############################
#line 39
	#
#line 39
	# Local Policy
#line 39
	#
#line 39

#line 39
	# Type attributes
#line 39
	typeattribute test_open_wm_t x_domain;
#line 39
	typeattribute test_open_wm_t xdrawable_type, xcolormap_type;
#line 39

#line 39
	# X Properties
#line 39
	# disable property transitions for the time being.
#line 39
#	type_transition test_open_wm_t xproperty_t:x_property user_xproperty_t;
#line 39

#line 39
	# X Windows
#line 39
	# new windows have the domain type
#line 39
	type_transition test_open_wm_t root_xdrawable_t:x_drawable test_open_wm_t;
#line 39

#line 39
	# X Input
#line 39
	# distinguish input events
#line 39
	type_transition test_open_wm_t input_xevent_t:x_event user_input_xevent_t;
#line 39
	# can send own events
#line 39
	allow test_open_wm_t user_input_xevent_t:{ x_event x_synthetic_event } send;
#line 39
	# can receive own events
#line 39
	allow test_open_wm_t user_input_xevent_t:{ x_event x_synthetic_event } receive;
#line 39
	# can receive default events
#line 39
	allow test_open_wm_t client_xevent_t:{ x_event x_synthetic_event } receive;
#line 39
	allow test_open_wm_t xevent_t:{ x_event x_synthetic_event } { send receive };
#line 39
	# dont audit send failures
#line 39
	dontaudit test_open_wm_t input_xevent_type:x_event send;
#line 39

#line 39
	allow test_open_wm_t xdm_t:x_drawable { hide read add_child manage };
#line 39
	allow test_open_wm_t xdm_t:x_client destroy;
#line 39

#line 39
	allow test_open_wm_t root_xdrawable_t:x_drawable write;
#line 39
	allow test_open_wm_t xserver_t:x_server manage;
#line 39
	allow test_open_wm_t xserver_t:x_screen { show_cursor hide_cursor saver_setattr saver_hide saver_show };
#line 39
	allow test_open_wm_t xserver_t:x_pointer { get_property set_property manage };
#line 39
	allow test_open_wm_t xserver_t:x_keyboard { read manage freeze };
#line 39
 	 	
#line 39
##### end xserver_common_x_domain_template(user,test_open_wm_t) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin xserver_stream_connect_xdm(test_open_wm_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type xdm_t, xdm_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_tmp(test_open_wm_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin fs_search_tmpfs(test_open_wm_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wm_t tmpfs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_tmpfs(test_open_wm_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	allow test_open_wm_t tmp_t:dir { getattr search open };
#line 39
	allow test_open_wm_t tmp_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_wm_t tmp_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_tmp(test_open_wm_t) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_wm_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wm_t var_t:lnk_file { getattr read };
#line 39
	allow test_open_wm_t var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_wm_t var_t:dir { getattr search open };
#line 39
	allow test_open_wm_t var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_wm_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	allow test_open_wm_t { xdm_var_run_t }:dir { getattr search open };
#line 39
	allow test_open_wm_t { xdm_var_run_t }:sock_file { getattr write open append };
#line 39
	allow test_open_wm_t xdm_t:unix_stream_socket connectto;
#line 39

#line 39
     	 	
#line 39
##### begin userdom_stream_connect(test_open_wm_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_tmp_t;
#line 39
		attribute userdomain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_tmp_t:dir { getattr search open };
#line 39
	allow test_open_wm_t user_tmp_t:sock_file { getattr write open append };
#line 39
	allow test_open_wm_t userdomain:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_stream_connect(test_open_wm_t) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end xserver_stream_connect_xdm(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin xserver_xdm_append_log(test_open_wm_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type xdm_log_t;
#line 39
		attribute xdmhomewriter;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wm_t xdmhomewriter;
#line 39
	allow test_open_wm_t xdm_log_t:file { getattr append };
#line 39

#line 39
	 	
#line 39
##### end xserver_xdm_append_log(test_open_wm_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin xserver_dri_domain(test_open_wm_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute dridomain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wm_t dridomain;
#line 39

#line 39
	 	
#line 39
##### end xserver_dri_domain(test_open_wm_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end xserver_restricted_role(test_open_r,test_open_wm_t) depth: 4
#line 39
 	
#line 39

#line 39
	# Communicate via System V shared memory.
#line 39
	allow test_open_wm_t xserver_t:shm { associate getattr read write lock unix_read unix_write };
#line 39
	allow test_open_wm_t xserver_tmpfs_t:file { open { getattr read write append ioctl lock } };
#line 39

#line 39
	allow test_open_wm_t iceauth_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39
	allow test_open_wm_t iceauth_home_t:file { getattr relabelfrom relabelto };
#line 39

#line 39
	allow test_open_wm_t xauth_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39
	allow test_open_wm_t xauth_home_t:file { getattr relabelfrom relabelto };
#line 39

#line 39
	 	 	
#line 39
##### begin mls_xwin_read_to_clearance(test_open_wm_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute mlsxwinreadtoclr;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wm_t mlsxwinreadtoclr;
#line 39

#line 39
	 	
#line 39
##### end mls_xwin_read_to_clearance(test_open_wm_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow test_open_wm_t user_fonts_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t user_fonts_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_fonts_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t user_fonts_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	allow test_open_wm_t user_fonts_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_wm_t user_fonts_t:dir { getattr search open };
#line 39
	allow test_open_wm_t user_fonts_t:dir { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_fonts_t:dir { getattr search open };
#line 39
	allow test_open_wm_t user_fonts_t:file { getattr relabelfrom relabelto };
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_fonts_cache_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t user_fonts_cache_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_fonts_cache_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t user_fonts_cache_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_fonts_cache_t:dir { getattr search open };
#line 39
	allow test_open_wm_t user_fonts_cache_t:dir { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_fonts_cache_t:dir { getattr search open };
#line 39
	allow test_open_wm_t user_fonts_cache_t:file { getattr relabelfrom relabelto };
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_fonts_config_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t user_fonts_config_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_fonts_config_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wm_t user_fonts_config_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_fonts_config_t:dir { getattr search open };
#line 39
	allow test_open_wm_t user_fonts_config_t:dir { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wm_t user_fonts_config_t:dir { getattr search open };
#line 39
	allow test_open_wm_t user_fonts_config_t:file { getattr relabelfrom relabelto };
#line 39

#line 39

#line 39
	 	
#line 39
##### end xserver_role(test_open_r,test_open_wm_t) depth: 3
#line 39
 	
#line 39
		 	 	
#line 39
##### begin xserver_manage_core_devices(test_open_wm_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type xserver_t, root_xdrawable_t, xevent_t;
#line 39
		class x_device { getattr setattr use read write getfocus setfocus bell force_cursor freeze grab manage list_property get_property set_property add remove create destroy };
#line 39
		class x_pointer { getattr setattr use read write getfocus setfocus bell force_cursor freeze grab manage list_property get_property set_property add remove create destroy };
#line 39
		class x_keyboard { getattr setattr use read write getfocus setfocus bell force_cursor freeze grab manage list_property get_property set_property add remove create destroy };
#line 39
		class x_screen { getattr setattr hide_cursor show_cursor saver_getattr saver_setattr saver_hide saver_show };
#line 39
		class x_drawable { manage };
#line 39
		attribute x_domain;
#line 39
		class x_drawable { create destroy read write blend getattr setattr list_child add_child remove_child list_property get_property set_property manage override show hide send receive };
#line 39
		class x_resource { read write };
#line 39
		class x_synthetic_event { send receive };
#line 39
		class x_cursor { create destroy read write getattr setattr use };
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wm_t xserver_t:{ x_device x_pointer x_keyboard } *;
#line 39
	allow test_open_wm_t xserver_t:{ x_screen } setattr;
#line 39
	
#line 39
	allow test_open_wm_t x_domain:x_cursor { create destroy read write getattr setattr use };
#line 39
	allow test_open_wm_t x_domain:x_drawable { create destroy read write blend getattr setattr list_child add_child remove_child list_property get_property set_property manage override show hide send receive };
#line 39
	allow test_open_wm_t x_domain:x_resource { read write };
#line 39
	allow test_open_wm_t root_xdrawable_t:x_drawable { create destroy read write blend getattr setattr list_child add_child remove_child list_property get_property set_property manage override show hide send receive };
#line 39
	allow test_open_wm_t xevent_t:x_synthetic_event { send receive };
#line 39

#line 39
	 	
#line 39
##### end xserver_manage_core_devices(test_open_wm_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39
 	 	
#line 39
##### end wm_role_template(test_open,test_open_r,test_open_t) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin policykit_role(test_open_r,test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin policykit_run_auth(test_open_usertype,test_open_r) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type policykit_auth_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin policykit_domtrans_auth(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type policykit_auth_t, policykit_auth_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_usertype policykit_auth_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_usertype policykit_auth_t:process transition;
#line 39
#	dontaudit test_open_usertype policykit_auth_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_usertype policykit_auth_exec_t:process policykit_auth_t;
#line 39

#line 39

#line 39
	allow policykit_auth_t test_open_usertype:fd use;
#line 39
	allow policykit_auth_t test_open_usertype:fifo_file { getattr read write append ioctl lock };
#line 39
	allow policykit_auth_t test_open_usertype:process sigchld;
#line 39

#line 39

#line 39
	 	
#line 39
##### end policykit_domtrans_auth(test_open_usertype) depth: 4
#line 39
 	
#line 39
	role test_open_r types policykit_auth_t;
#line 39

#line 39
	allow test_open_usertype policykit_auth_t:process signal;
#line 39
	
#line 39
	allow policykit_auth_t test_open_usertype:dir { getattr search open read lock ioctl };
#line 39
	allow policykit_auth_t test_open_usertype:file { open { getattr read ioctl lock } };
#line 39
	allow policykit_auth_t test_open_usertype:lnk_file { getattr read };
#line 39
	allow policykit_auth_t test_open_usertype:process getattr;
#line 39

#line 39

#line 39
	 	
#line 39
##### end policykit_run_auth(test_open_usertype,test_open_r) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin policykit_run_grant(test_open_usertype,test_open_r) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type policykit_grant_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin policykit_domtrans_grant(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type policykit_grant_t, policykit_grant_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_usertype policykit_grant_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_usertype policykit_grant_t:process transition;
#line 39
#	dontaudit test_open_usertype policykit_grant_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_usertype policykit_grant_exec_t:process policykit_grant_t;
#line 39

#line 39

#line 39
	allow policykit_grant_t test_open_usertype:fd use;
#line 39
	allow policykit_grant_t test_open_usertype:fifo_file { getattr read write append ioctl lock };
#line 39
	allow policykit_grant_t test_open_usertype:process sigchld;
#line 39

#line 39

#line 39
	 	
#line 39
##### end policykit_domtrans_grant(test_open_usertype) depth: 4
#line 39
 	
#line 39
	role test_open_r types policykit_grant_t;
#line 39

#line 39
	allow test_open_usertype policykit_grant_t:process signal;
#line 39

#line 39
	
#line 39
	allow policykit_grant_t test_open_usertype:dir { getattr search open read lock ioctl };
#line 39
	allow policykit_grant_t test_open_usertype:file { open { getattr read ioctl lock } };
#line 39
	allow policykit_grant_t test_open_usertype:lnk_file { getattr read };
#line 39
	allow policykit_grant_t test_open_usertype:process getattr;
#line 39

#line 39

#line 39
	 	
#line 39
##### end policykit_run_grant(test_open_usertype,test_open_r) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin policykit_read_lib(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type policykit_var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var_lib(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_lib_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_var_lib(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype policykit_var_lib_t:dir { getattr search open };
#line 39
	allow test_open_usertype policykit_var_lib_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		# Broken placement
#line 39
		 	 	
#line 39
##### begin cron_read_system_job_lib_files(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type system_cronjob_var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var_lib(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_lib_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_var_lib(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype system_cronjob_var_lib_t:dir { getattr search open };
#line 39
	allow test_open_usertype system_cronjob_var_lib_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end cron_read_system_job_lib_files(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	 	
#line 39
##### end policykit_read_lib(test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin policykit_read_reload(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type policykit_reload_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var_lib(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_lib_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_var_lib(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype policykit_reload_t:dir { getattr search open };
#line 39
	allow test_open_usertype policykit_reload_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end policykit_read_reload(test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin policykit_dbus_chat(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type policykit_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow policykit_t test_open_usertype:dir { getattr search open read lock ioctl };
#line 39
	allow policykit_t test_open_usertype:file { open { getattr read ioctl lock } };
#line 39
	allow policykit_t test_open_usertype:lnk_file { getattr read };
#line 39
	allow policykit_t test_open_usertype:process getattr;
#line 39

#line 39

#line 39
	allow test_open_usertype policykit_t:dbus send_msg;
#line 39
	allow policykit_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end policykit_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
 	 	
#line 39
##### end policykit_role(test_open_r,test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin pulseaudio_role(test_open_r,test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
        attribute pulseaudio_tmpfsfile;
#line 39
		type pulseaudio_t, pulseaudio_exec_t, pulseaudio_tmpfs_t;
#line 39
		class dbus { acquire_svc send_msg };
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	role test_open_r types pulseaudio_t;
#line 39

#line 39
	# Transition from the user domain to the derived domain.
#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_usertype pulseaudio_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_usertype pulseaudio_t:process transition;
#line 39
#	dontaudit test_open_usertype pulseaudio_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_usertype pulseaudio_exec_t:process pulseaudio_t;
#line 39

#line 39

#line 39
	allow pulseaudio_t test_open_usertype:fd use;
#line 39
	allow pulseaudio_t test_open_usertype:fifo_file { getattr read write append ioctl lock };
#line 39
	allow pulseaudio_t test_open_usertype:process sigchld;
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype pulseaudio_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_usertype pulseaudio_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_usertype pulseaudio_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype pulseaudio_t:process getattr;
#line 39

#line 39

#line 39
	allow pulseaudio_t test_open_usertype:process { signal signull };
#line 39
	allow test_open_usertype pulseaudio_t:process { signal signull sigkill };
#line 39
	
#line 39
	allow pulseaudio_t test_open_usertype:dir { getattr search open read lock ioctl };
#line 39
	allow pulseaudio_t test_open_usertype:file { open { getattr read ioctl lock } };
#line 39
	allow pulseaudio_t test_open_usertype:lnk_file { getattr read };
#line 39
	allow pulseaudio_t test_open_usertype:process getattr;
#line 39

#line 39

#line 39
	allow pulseaudio_t test_open_usertype:unix_stream_socket connectto;
#line 39
	allow test_open_usertype pulseaudio_t:unix_stream_socket connectto;
#line 39

#line 39
	allow test_open_usertype { pulseaudio_tmpfs_t pulseaudio_tmpfsfile }:dir { { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl } { getattr relabelfrom relabelto } };
#line 39
	allow test_open_usertype { pulseaudio_tmpfs_t pulseaudio_tmpfsfile }:file { { create open getattr setattr read write append rename link unlink ioctl lock } { getattr relabelfrom relabelto } };
#line 39

#line 39
	 	 	
#line 39
##### begin userdom_manage_tmp_role(test_open_r,pulseaudio_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute user_tmp_type;
#line 39
		type user_tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	role test_open_r types user_tmp_t;
#line 39

#line 39
	 	 	
#line 39
##### begin files_poly_member_tmp(pulseaudio_t,user_tmp_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	type_member pulseaudio_t tmp_t:dir user_tmp_t;
#line 39

#line 39
	 	
#line 39
##### end files_poly_member_tmp(pulseaudio_t,user_tmp_t) depth: 4
#line 39
 	
#line 39

#line 39
	allow pulseaudio_t user_tmp_type:dir mounton;
#line 39
	
#line 39
	allow pulseaudio_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow pulseaudio_t user_tmp_type:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	
#line 39
	allow pulseaudio_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow pulseaudio_t user_tmp_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow pulseaudio_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow pulseaudio_t user_tmp_type:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow pulseaudio_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow pulseaudio_t user_tmp_type:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 39

#line 39
	
#line 39
	allow pulseaudio_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow pulseaudio_t user_tmp_type:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	 	 	
#line 39
##### begin files_tmp_filetrans(pulseaudio_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow pulseaudio_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition pulseaudio_t tmp_t:{ dir file lnk_file sock_file fifo_file } user_tmp_t ;
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_tmp_filetrans(pulseaudio_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 4
#line 39
 	
#line 39
     	 	
#line 39
##### begin fs_tmpfs_filetrans(pulseaudio_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow user_tmp_t tmpfs_t:filesystem associate;
#line 39
	
#line 39
	allow pulseaudio_t tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition pulseaudio_t tmpfs_t:{ dir file lnk_file sock_file fifo_file } user_tmp_t ;
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_tmpfs_filetrans(pulseaudio_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow pulseaudio_t user_tmp_type:dir { getattr search open };
#line 39
	allow pulseaudio_t user_tmp_type:dir { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow pulseaudio_t user_tmp_type:dir { getattr search open };
#line 39
	allow pulseaudio_t user_tmp_type:file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow pulseaudio_t user_tmp_type:dir { getattr search open };
#line 39
	allow pulseaudio_t user_tmp_type:lnk_file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow pulseaudio_t user_tmp_type:dir { getattr search open };
#line 39
	allow pulseaudio_t user_tmp_type:sock_file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow pulseaudio_t user_tmp_type:dir { getattr search open };
#line 39
	allow pulseaudio_t user_tmp_type:fifo_file { getattr relabelfrom relabelto };
#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_manage_tmp_role(test_open_r,pulseaudio_t) depth: 3
#line 39
 	
#line 39

#line 39
	allow test_open_usertype pulseaudio_t:dbus send_msg;
#line 39
	allow pulseaudio_t test_open_usertype:dbus { acquire_svc send_msg };
#line 39

#line 39
	 	
#line 39
##### end pulseaudio_role(test_open_r,test_open_usertype) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin pulseaudio_filetrans_admin_home_content(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type pulseaudio_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin userdom_admin_home_dir_filetrans(test_open_usertype,pulseaudio_home_t,dir,".pulse") depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type admin_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype admin_home_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype admin_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_usertype admin_home_t:dir pulseaudio_home_t ".pulse";
#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_admin_home_dir_filetrans(test_open_usertype,pulseaudio_home_t,dir,".pulse") depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin userdom_admin_home_dir_filetrans(test_open_usertype,pulseaudio_home_t,file,".pulse-cookie") depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type admin_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype admin_home_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype admin_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_usertype admin_home_t:file pulseaudio_home_t ".pulse-cookie";
#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_admin_home_dir_filetrans(test_open_usertype,pulseaudio_home_t,file,".pulse-cookie") depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin userdom_admin_home_dir_filetrans(test_open_usertype,pulseaudio_home_t,file,".esd_auth") depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type admin_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype admin_home_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype admin_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_usertype admin_home_t:file pulseaudio_home_t ".esd_auth";
#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_admin_home_dir_filetrans(test_open_usertype,pulseaudio_home_t,file,".esd_auth") depth: 3
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end pulseaudio_filetrans_admin_home_content(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin rtkit_scheduled(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type rtkit_daemon_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow rtkit_daemon_t test_open_usertype:process { getsched setsched };
#line 39

#line 39
	 	 	
#line 39
##### begin kernel_search_proc(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type proc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype proc_t:dir { getattr search open };
#line 39
	allow test_open_usertype proc_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end kernel_search_proc(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow rtkit_daemon_t test_open_usertype:dir { getattr search open read lock ioctl };
#line 39
	allow rtkit_daemon_t test_open_usertype:file { open { getattr read ioctl lock } };
#line 39
	allow rtkit_daemon_t test_open_usertype:lnk_file { getattr read };
#line 39
	allow rtkit_daemon_t test_open_usertype:process getattr;
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin rtkit_daemon_dbus_chat(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type rtkit_daemon_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype rtkit_daemon_t:dbus send_msg;
#line 39
	allow rtkit_daemon_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end rtkit_daemon_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	 	
#line 39
##### end rtkit_scheduled(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin systemd_filetrans_home_content(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type systemd_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin gnome_data_filetrans(test_open_usertype,systemd_home_t,dir,"systemd") depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type data_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype data_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_usertype data_home_t:dir systemd_home_t "systemd";
#line 39

#line 39
	 	 	
#line 39
##### begin gnome_search_gconf(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type gconf_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype gconf_home_t:dir { getattr search open };
#line 39
	 	 	
#line 39
##### begin userdom_search_user_home_dirs(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_dir_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype user_home_dir_t:dir { getattr search open };
#line 39
	allow test_open_usertype user_home_dir_t:lnk_file { getattr read };
#line 39
	 	 	
#line 39
##### begin files_search_home(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype home_root_t:dir { getattr search open };
#line 39
	allow test_open_usertype home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_search_home(test_open_usertype) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_search_user_home_dirs(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end gnome_search_gconf(test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end gnome_data_filetrans(test_open_usertype,systemd_home_t,dir,"systemd") depth: 3
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	 	
#line 39
##### end systemd_filetrans_home_content(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin setroubleshoot_dontaudit_stream_connect(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type setroubleshootd_t, setroubleshoot_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_t setroubleshoot_var_run_t:sock_file { open { getattr read write append } };
#line 39
	dontaudit test_open_t setroubleshootd_t:unix_stream_socket connectto;
#line 39

#line 39
	 	
#line 39
##### end setroubleshoot_dontaudit_stream_connect(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin udev_read_db(test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin udev_read_pid_files(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type udev_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_list_all_dev_nodes(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype device_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype device_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_list_all_dev_nodes(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 4
#line 39
 	
#line 39
	allow test_open_usertype udev_var_run_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype udev_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype udev_var_run_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype udev_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype udev_var_run_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end udev_read_pid_files(test_open_usertype) depth: 3
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end udev_read_db(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin xserver_xdm_ioctl_log(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type xdm_log_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t xdm_log_t:file ioctl;
#line 39

#line 39
	 	
#line 39
##### end xserver_xdm_ioctl_log(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39
 	 	
#line 39
##### end userdom_restricted_xwindows_user_template(test_open) depth: 1
#line 39
 	
#line 39
	 	 	
#line 39
##### begin userdom_common_user_template(test_open) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute unpriv_userdomain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin userdom_basic_networking(test_open_usertype) depth: 3
#line 39
 	
#line 39

#line 39
	allow test_open_usertype self:tcp_socket { { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } } listen accept };
#line 39
	allow test_open_usertype self:udp_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 39

#line 39
	 	 	
#line 39
##### begin corenet_tcp_sendrecv_generic_if(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type netif_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype netif_t:netif { tcp_send tcp_recv egress ingress };
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_sendrecv_generic_if(test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_udp_sendrecv_generic_if(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_udp_send_generic_if(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type netif_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype netif_t:netif { udp_send egress };
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_send_generic_if(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_udp_receive_generic_if(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type netif_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype netif_t:netif { udp_recv ingress };
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_receive_generic_if(test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_sendrecv_generic_if(test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_tcp_sendrecv_generic_node(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type node_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype node_t:node { tcp_send tcp_recv sendto recvfrom };
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_sendrecv_generic_node(test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_udp_sendrecv_generic_node(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_udp_send_generic_node(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type node_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype node_t:node { udp_send sendto };
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_send_generic_node(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_udp_receive_generic_node(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type node_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype node_t:node { udp_recv recvfrom };
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_receive_generic_node(test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_sendrecv_generic_node(test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_tcp_sendrecv_all_ports(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute port_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype port_type:tcp_socket { send_msg recv_msg };
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_sendrecv_all_ports(test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_udp_sendrecv_all_ports(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_udp_send_all_ports(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute port_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype port_type:udp_socket send_msg;
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_send_all_ports(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_udp_receive_all_ports(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute port_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype port_type:udp_socket recv_msg;
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_receive_all_ports(test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_sendrecv_all_ports(test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_tcp_connect_all_ports(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute port_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype port_type:tcp_socket name_connect;
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_connect_all_ports(test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_sendrecv_all_client_packets(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_send_all_client_packets(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute client_packet_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype client_packet_type:packet send;
#line 39

#line 39
	 	
#line 39
##### end corenet_send_all_client_packets(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_receive_all_client_packets(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute client_packet_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype client_packet_type:packet recv;
#line 39

#line 39
	 	
#line 39
##### end corenet_receive_all_client_packets(test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corenet_sendrecv_all_client_packets(test_open_usertype) depth: 3
#line 39
 	
#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin init_tcp_recvfrom_all_daemons(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute daemon;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corenet_tcp_recvfrom_labeled(test_open_usertype,daemon) depth: 5
#line 39
 	
#line 39
	allow { test_open_usertype daemon } self:association sendto;
#line 39
	allow test_open_usertype daemon:{ association tcp_socket } recvfrom;
#line 39
	allow daemon test_open_usertype:{ association tcp_socket } recvfrom;
#line 39

#line 39
	allow test_open_usertype daemon:peer recv;
#line 39
	allow daemon test_open_usertype:peer recv;
#line 39

#line 39
	# allow receiving packets from MLS-only peers using NetLabel
#line 39
	 	 	
#line 39
##### begin corenet_tcp_recvfrom_netlabel(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type netlabel_peer_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype netlabel_peer_t:peer recv;
#line 39
	allow test_open_usertype netlabel_peer_t:tcp_socket recvfrom;
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_recvfrom_netlabel(test_open_usertype) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_tcp_recvfrom_netlabel(daemon) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type netlabel_peer_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow daemon netlabel_peer_t:peer recv;
#line 39
	allow daemon netlabel_peer_t:tcp_socket recvfrom;
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_recvfrom_netlabel(daemon) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_recvfrom_labeled(test_open_usertype,daemon) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end init_tcp_recvfrom_all_daemons(test_open_usertype) depth: 3
#line 39
 	
#line 39
		 	 	
#line 39
##### begin init_udp_recvfrom_all_daemons(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute daemon;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	 	 	
#line 39
##### begin corenet_udp_recvfrom_labeled(test_open_usertype,daemon) depth: 5
#line 39
 	
#line 39
	allow daemon self:association sendto;
#line 39
	allow test_open_usertype daemon:{ association udp_socket } recvfrom;
#line 39

#line 39
	allow test_open_usertype daemon:peer recv;
#line 39

#line 39
	# allow receiving packets from MLS-only peers using NetLabel
#line 39
	 	 	
#line 39
##### begin corenet_udp_recvfrom_netlabel(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type netlabel_peer_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype netlabel_peer_t:peer recv;
#line 39
	allow test_open_usertype netlabel_peer_t:udp_socket recvfrom;
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_recvfrom_netlabel(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_recvfrom_labeled(test_open_usertype,daemon) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end init_udp_recvfrom_all_daemons(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin ipsec_match_default_spd(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type ipsec_spd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype ipsec_spd_t:association polmatch;
#line 39
	allow test_open_usertype self:association sendto;
#line 39
	allow test_open_usertype self:peer recv;
#line 39

#line 39
	 	
#line 39
##### end ipsec_match_default_spd(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_basic_networking(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_all_recvfrom_netlabel(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute netlabel_peer_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t netlabel_peer_type;
#line 39

#line 39
	 	
#line 39
##### end corenet_all_recvfrom_netlabel(test_open_t) depth: 2
#line 39
 	
#line 39

#line 39
	##############################
#line 39
	#
#line 39
	# User domain Local policy
#line 39
	#
#line 39
	allow test_open_t self:packet_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 39

#line 39
	# evolution and gnome-session try to create a netlink socket
#line 39
	dontaudit test_open_t self:netlink_socket { create ioctl read getattr write setattr append bind connect getopt setopt shutdown };
#line 39
	dontaudit test_open_t self:netlink_route_socket { create ioctl read getattr write setattr append bind connect getopt setopt shutdown nlmsg_read nlmsg_write };
#line 39
	allow test_open_t self:netlink_kobject_uevent_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 39
	allow test_open_t self:socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 39

#line 39
	allow test_open_usertype unpriv_userdomain:fd use;
#line 39

#line 39
	 	 	
#line 39
##### begin kernel_read_system_state(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute kernel_system_state_reader;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t kernel_system_state_reader;
#line 39

#line 39
	 	
#line 39
##### end kernel_read_system_state(test_open_t) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin kernel_read_network_state(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type proc_t, proc_net_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype { proc_t proc_net_t }:dir { getattr search open };
#line 39
	allow test_open_usertype proc_net_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype { proc_t proc_net_t }:dir { getattr search open };
#line 39
	allow test_open_usertype proc_net_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype proc_t:dir { getattr search open };
#line 39
	allow test_open_usertype proc_net_t:dir { getattr search open read lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end kernel_read_network_state(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin kernel_read_software_raid_state(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type proc_t, proc_mdstat_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype proc_t:dir { getattr search open };
#line 39
	allow test_open_usertype proc_mdstat_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype proc_t:dir { getattr search open };
#line 39
	allow test_open_usertype proc_t:dir { getattr search open read lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end kernel_read_software_raid_state(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin kernel_read_net_sysctls(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type proc_t, sysctl_t, sysctl_net_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype { proc_t sysctl_t sysctl_net_t }:dir { getattr search open };
#line 39
	allow test_open_usertype sysctl_net_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype { proc_t sysctl_t sysctl_net_t }:dir { getattr search open };
#line 39
	allow test_open_usertype sysctl_net_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_usertype { proc_t sysctl_t }:dir { getattr search open };
#line 39
	allow test_open_usertype sysctl_net_t:dir { getattr search open read lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end kernel_read_net_sysctls(test_open_usertype) depth: 2
#line 39
 	
#line 39
     	 	
#line 39
##### begin kernel_read_afs_state(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type proc_t, proc_afs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype proc_t:dir { getattr search open };
#line 39
	allow test_open_usertype proc_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype proc_afs_t:dir { getattr search open };
#line 39
	allow test_open_usertype proc_afs_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end kernel_read_afs_state(test_open_usertype) depth: 2
#line 39
 	
#line 39
	# Very permissive allowing every domain to see every type:
#line 39
	 	 	
#line 39
##### begin kernel_get_sysvipc_info(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type kernel_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype kernel_t:system ipc_info;
#line 39

#line 39
	 	
#line 39
##### end kernel_get_sysvipc_info(test_open_usertype) depth: 2
#line 39
 	
#line 39
	# Find CDROM devices:
#line 39
	 	 	
#line 39
##### begin kernel_read_device_sysctls(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type proc_t, sysctl_t, sysctl_dev_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype { proc_t sysctl_t sysctl_dev_t }:dir { getattr search open };
#line 39
	allow test_open_usertype sysctl_dev_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype { proc_t sysctl_t }:dir { getattr search open };
#line 39
	allow test_open_usertype sysctl_dev_t:dir { getattr search open read lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end kernel_read_device_sysctls(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin kernel_request_load_module(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type kernel_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype kernel_t:system module_request;
#line 39

#line 39
	 	
#line 39
##### end kernel_request_load_module(test_open_usertype) depth: 2
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin corenet_udp_bind_generic_node(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type node_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype node_t:udp_socket node_bind;
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_bind_generic_node(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_udp_bind_generic_port(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type port_t, unreserved_port_t, ephemeral_port_t;
#line 39
		attribute defined_port_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype { port_t unreserved_port_t ephemeral_port_t }:udp_socket name_bind;
#line 39
	dontaudit test_open_usertype defined_port_type:udp_socket name_bind;
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_bind_generic_port(test_open_usertype) depth: 2
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin dev_read_rand(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t, random_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype random_device_t:chr_file { getattr open read lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_read_rand(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_write_sound(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t, sound_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype sound_device_t:chr_file { getattr open write append lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_write_sound(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_read_sound(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t, sound_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype sound_device_t:chr_file { getattr open read lock ioctl };
#line 39

#line 39
	allow test_open_usertype sound_device_t:chr_file map;
#line 39

#line 39
	 	
#line 39
##### end dev_read_sound(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_read_sound_mixer(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t, sound_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype sound_device_t:chr_file { getattr open read lock ioctl };
#line 39

#line 39
	allow test_open_usertype sound_device_t:chr_file map;
#line 39

#line 39
	 	
#line 39
##### end dev_read_sound_mixer(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_write_sound_mixer(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t, sound_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype sound_device_t:chr_file { getattr open write append lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_write_sound_mixer(test_open_usertype) depth: 2
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin files_exec_etc_files(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype etc_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39
	allow test_open_usertype etc_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39
	allow test_open_usertype etc_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_exec_etc_files(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_search_locks(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_lock_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 3
#line 39
 	
#line 39
	allow test_open_usertype var_lock_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_lock_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_locks(test_open_usertype) depth: 2
#line 39
 	
#line 39
	# Check to see if cdrom is mounted
#line 39
	 	 	
#line 39
##### begin files_search_mnt(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type mnt_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype mnt_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_mnt(test_open_usertype) depth: 2
#line 39
 	
#line 39
	# cjp: perhaps should cut back on file reads:
#line 39
	 	 	
#line 39
##### begin files_read_var_files(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_read_var_files(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_read_var_symlinks(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_read_var_symlinks(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_read_generic_spool(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_spool_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_spool_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype var_spool_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_spool_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_read_generic_spool(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_read_var_lib_files(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_lib_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype { var_t var_lib_t }:dir { getattr search open };
#line 39
	allow test_open_usertype var_lib_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_read_var_lib_files(test_open_usertype) depth: 2
#line 39
 	
#line 39
	# Stat lost+found.
#line 39
	 	 	
#line 39
##### begin files_getattr_lost_found_dirs(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type lost_found_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype lost_found_t:dir getattr;
#line 39

#line 39
	 	
#line 39
##### end files_getattr_lost_found_dirs(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_read_config_files(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute configfile;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype configfile:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype configfile:dir { getattr search open };
#line 39
	allow test_open_usertype configfile:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype configfile:dir { getattr search open };
#line 39
	allow test_open_usertype configfile:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_read_config_files(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin fs_read_noxattr_fs_files(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute noxattrfs;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype noxattrfs:dir { getattr search open };
#line 39
	allow test_open_usertype noxattrfs:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_read_noxattr_fs_files(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin fs_read_noxattr_fs_symlinks(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute noxattrfs;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype noxattrfs:dir { getattr search open };
#line 39
	allow test_open_usertype noxattrfs:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_read_noxattr_fs_symlinks(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin fs_rw_cgroup_files(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cgroup_t;
#line 39

#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype cgroup_t:dir { getattr search open };
#line 39
	allow test_open_usertype cgroup_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_usertype cgroup_t:dir { getattr search open };
#line 39
	allow test_open_usertype cgroup_t:file { open { getattr read write append ioctl lock } };
#line 39

#line 39
	 	 	
#line 39
##### begin fs_search_tmpfs(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype tmpfs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_tmpfs(test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_search_sysfs(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype sysfs_t:dir { getattr search open };
#line 39
	allow test_open_usertype sysfs_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_search_sysfs(test_open_usertype) depth: 3
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end fs_rw_cgroup_files(test_open_usertype) depth: 2
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin application_getattr_socket(test_open_usertype) depth: 3
#line 39
 	
#line 39
    
#line 39
	
#line 39
		require {
#line 39
			
#line 39
        attribute application_domain_type;
#line 39
    
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
    allow test_open_usertype application_domain_type:{ tcp_socket udp_socket rawip_socket netlink_socket packet_socket unix_stream_socket unix_dgram_socket appletalk_socket netlink_route_socket netlink_firewall_socket netlink_tcpdiag_socket netlink_nflog_socket netlink_xfrm_socket netlink_selinux_socket netlink_audit_socket netlink_ip6fw_socket netlink_dnrt_socket netlink_kobject_uevent_socket tun_socket netlink_iscsi_socket netlink_fib_lookup_socket netlink_connector_socket netlink_netfilter_socket netlink_generic_socket netlink_scsitransport_socket netlink_rdma_socket netlink_crypto_socket sctp_socket icmp_socket ax25_socket ipx_socket netrom_socket atmpvc_socket x25_socket rose_socket decnet_socket atmsvc_socket rds_socket irda_socket pppox_socket llc_socket can_socket tipc_socket bluetooth_socket iucv_socket rxrpc_socket isdn_socket phonet_socket ieee802154_socket caif_socket alg_socket nfc_socket vsock_socket kcm_socket qipcrtr_socket smc_socket bridge_socket dccp_socket ib_socket mpls_socket } getattr;
#line 39

#line 39
	 	
#line 39
##### end application_getattr_socket(test_open_usertype) depth: 2
#line 39
 	
#line 39

#line 39

#line 39
    
#line 39

#line 39
	 	 	
#line 39
##### begin logging_send_syslog_msg(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute syslog_client_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t syslog_client_type;
#line 39

#line 39
	 	
#line 39
##### end logging_send_syslog_msg(test_open_t) depth: 2
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin selinux_get_enforce_mode(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type security_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_search_sysfs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_search_sysfs(test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin selinux_get_fs_mount(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type security_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t security_t:lnk_file { getattr read };
#line 39
	 	 	
#line 39
##### begin dev_getattr_sysfs_fs(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t sysfs_t:filesystem getattr;
#line 39

#line 39
	 	
#line 39
##### end dev_getattr_sysfs_fs(test_open_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_search_sysfs(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_search_sysfs(test_open_t) depth: 4
#line 39
 	
#line 39
	# starting in libselinux 2.0.5, init_selinuxmnt() will
#line 39
	# attempt to short circuit by checking if SELINUXMNT
#line 39
	# (/selinux) is already a selinuxfs
#line 39
	allow test_open_t security_t:filesystem getattr;
#line 39

#line 39
	# read /proc/filesystems to see if selinuxfs is supported
#line 39
	# then read /proc/self/mount to see where selinuxfs is mounted
#line 39
	 	 	
#line 39
##### begin kernel_read_system_state(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute kernel_system_state_reader;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t kernel_system_state_reader;
#line 39

#line 39
	 	
#line 39
##### end kernel_read_system_state(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end selinux_get_fs_mount(test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_t security_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t security_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_t security_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end selinux_get_enforce_mode(test_open_t) depth: 2
#line 39
 	
#line 39

#line 39
	# cjp: some of this probably can be removed
#line 39
	 	 	
#line 39
##### begin selinux_get_fs_mount(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type security_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t security_t:lnk_file { getattr read };
#line 39
	 	 	
#line 39
##### begin dev_getattr_sysfs_fs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t sysfs_t:filesystem getattr;
#line 39

#line 39
	 	
#line 39
##### end dev_getattr_sysfs_fs(test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_search_sysfs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_search_sysfs(test_open_t) depth: 3
#line 39
 	
#line 39
	# starting in libselinux 2.0.5, init_selinuxmnt() will
#line 39
	# attempt to short circuit by checking if SELINUXMNT
#line 39
	# (/selinux) is already a selinuxfs
#line 39
	allow test_open_t security_t:filesystem getattr;
#line 39

#line 39
	# read /proc/filesystems to see if selinuxfs is supported
#line 39
	# then read /proc/self/mount to see where selinuxfs is mounted
#line 39
	 	 	
#line 39
##### begin kernel_read_system_state(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute kernel_system_state_reader;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_t kernel_system_state_reader;
#line 39

#line 39
	 	
#line 39
##### end kernel_read_system_state(test_open_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end selinux_get_fs_mount(test_open_t) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin selinux_validate_context(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type security_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_getattr_sysfs_fs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t sysfs_t:filesystem getattr;
#line 39

#line 39
	 	
#line 39
##### end dev_getattr_sysfs_fs(test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_search_sysfs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_search_sysfs(test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_t security_t:lnk_file { getattr read };
#line 39
	allow test_open_t security_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t security_t:file { map { open { getattr read write append ioctl lock } } };
#line 39
	allow test_open_t security_t:security check_context;
#line 39

#line 39
	 	
#line 39
##### end selinux_validate_context(test_open_t) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin selinux_compute_access_vector(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type security_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_getattr_sysfs_fs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t sysfs_t:filesystem getattr;
#line 39

#line 39
	 	
#line 39
##### end dev_getattr_sysfs_fs(test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_search_sysfs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_search_sysfs(test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_t security_t:lnk_file { getattr read };
#line 39
	allow test_open_t security_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t security_t:file { open { getattr read write append ioctl lock } };
#line 39
	allow test_open_t security_t:security compute_av;
#line 39

#line 39
	 	
#line 39
##### end selinux_compute_access_vector(test_open_t) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin selinux_compute_create_context(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type security_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_getattr_sysfs_fs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t sysfs_t:filesystem getattr;
#line 39

#line 39
	 	
#line 39
##### end dev_getattr_sysfs_fs(test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_search_sysfs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_search_sysfs(test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_t security_t:lnk_file { getattr read };
#line 39
	allow test_open_t security_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t security_t:file { open { getattr read write append ioctl lock } };
#line 39
	allow test_open_t security_t:security compute_create;
#line 39

#line 39
	 	
#line 39
##### end selinux_compute_create_context(test_open_t) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin selinux_compute_relabel_context(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type security_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_getattr_sysfs_fs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t sysfs_t:filesystem getattr;
#line 39

#line 39
	 	
#line 39
##### end dev_getattr_sysfs_fs(test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_search_sysfs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_search_sysfs(test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_t security_t:lnk_file { getattr read };
#line 39
	allow test_open_t security_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t security_t:file { open { getattr read write append ioctl lock } };
#line 39
	allow test_open_t security_t:security compute_relabel;
#line 39

#line 39
	 	
#line 39
##### end selinux_compute_relabel_context(test_open_t) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin selinux_compute_user_contexts(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type security_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_getattr_sysfs_fs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t sysfs_t:filesystem getattr;
#line 39

#line 39
	 	
#line 39
##### end dev_getattr_sysfs_fs(test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin dev_search_sysfs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sysfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39
	allow test_open_t sysfs_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_search_sysfs(test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_t security_t:lnk_file { getattr read };
#line 39
	allow test_open_t security_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t security_t:file { open { getattr read write append ioctl lock } };
#line 39
	allow test_open_t security_t:security compute_user;
#line 39

#line 39
	 	
#line 39
##### end selinux_compute_user_contexts(test_open_t) depth: 2
#line 39
 	
#line 39

#line 39
	# for eject
#line 39
	 	 	
#line 39
##### begin storage_getattr_fixed_disk_dev(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type fixed_disk_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_list_all_dev_nodes(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype device_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype device_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_list_all_dev_nodes(test_open_usertype) depth: 3
#line 39
 	
#line 39
	allow test_open_usertype fixed_disk_device_t:blk_file getattr;
#line 39

#line 39
	 	
#line 39
##### end storage_getattr_fixed_disk_dev(test_open_usertype) depth: 2
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin auth_read_login_records(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type wtmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin logging_search_logs(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_log_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_var(test_open_usertype) depth: 4
#line 39
 	
#line 39
	allow test_open_usertype var_log_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end logging_search_logs(test_open_usertype) depth: 3
#line 39
 	
#line 39
	allow test_open_usertype wtmp_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end auth_read_login_records(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin auth_run_pam_timestamp(test_open_t,test_open_r) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type pam_timestamp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin auth_domtrans_pam_timestamp(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type pam_timestamp_t, pam_timestamp_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t pam_timestamp_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t pam_timestamp_t:process transition;
#line 39
#	dontaudit test_open_t pam_timestamp_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t pam_timestamp_exec_t:process pam_timestamp_t;
#line 39

#line 39

#line 39
	allow pam_timestamp_t test_open_t:fd use;
#line 39
	allow pam_timestamp_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow pam_timestamp_t test_open_t:process sigchld;
#line 39

#line 39

#line 39
	 	
#line 39
##### end auth_domtrans_pam_timestamp(test_open_t) depth: 3
#line 39
 	
#line 39
	role test_open_r types pam_timestamp_t;
#line 39

#line 39
	 	
#line 39
##### end auth_run_pam_timestamp(test_open_t,test_open_r) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin auth_run_utempter(test_open_t,test_open_r) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type utempter_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin auth_domtrans_utempter(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type utempter_t, utempter_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t utempter_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t utempter_t:process transition;
#line 39
#	dontaudit test_open_t utempter_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t utempter_exec_t:process utempter_t;
#line 39

#line 39

#line 39
	allow utempter_t test_open_t:fd use;
#line 39
	allow utempter_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow utempter_t test_open_t:process sigchld;
#line 39

#line 39

#line 39
	 	
#line 39
##### end auth_domtrans_utempter(test_open_t) depth: 3
#line 39
 	
#line 39
	role test_open_r types utempter_t;
#line 39

#line 39
	 	
#line 39
##### end auth_run_utempter(test_open_t,test_open_r) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin auth_filetrans_admin_home_content(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type auth_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin userdom_admin_home_dir_filetrans(test_open_t,auth_home_t,file,".google_authenticator") depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type admin_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t admin_home_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_t admin_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_t admin_home_t:file auth_home_t ".google_authenticator";
#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_admin_home_dir_filetrans(test_open_t,auth_home_t,file,".google_authenticator") depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin userdom_admin_home_dir_filetrans(test_open_t,auth_home_t,file,".google_authenticator~") depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type admin_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t admin_home_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_t admin_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_t admin_home_t:file auth_home_t ".google_authenticator~";
#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_admin_home_dir_filetrans(test_open_t,auth_home_t,file,".google_authenticator~") depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin userdom_admin_home_dir_filetrans(test_open_t,auth_home_t,dir,".yubico") depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type admin_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t admin_home_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_t admin_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_t admin_home_t:dir auth_home_t ".yubico";
#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_admin_home_dir_filetrans(test_open_t,auth_home_t,dir,".yubico") depth: 3
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end auth_filetrans_admin_home_content(test_open_t) depth: 2
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin init_read_utmp(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type initrc_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_list_pids(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open read lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_list_pids(test_open_usertype) depth: 3
#line 39
 	
#line 39
	allow test_open_usertype initrc_var_run_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end init_read_utmp(test_open_usertype) depth: 2
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin seutil_read_file_contexts(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type selinux_config_t, default_context_t, file_context_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_etc(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_etc(test_open_usertype) depth: 3
#line 39
 	
#line 39
	allow test_open_usertype { selinux_config_t default_context_t }:dir { getattr search open };
#line 39
	
#line 39
	allow test_open_usertype file_context_t:dir { getattr search open };
#line 39
	allow test_open_usertype file_context_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype file_context_t:dir { getattr search open };
#line 39
	allow test_open_usertype file_context_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype file_context_t:dir { getattr search open };
#line 39
	allow test_open_usertype file_context_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_usertype file_context_t:file map;
#line 39

#line 39
	 	
#line 39
##### end seutil_read_file_contexts(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin seutil_read_default_contexts(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type selinux_config_t, default_context_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_etc(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_etc(test_open_usertype) depth: 3
#line 39
 	
#line 39
	allow test_open_usertype selinux_config_t:dir { getattr search open };
#line 39
	allow test_open_usertype default_context_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype default_context_t:dir { getattr search open };
#line 39
	allow test_open_usertype default_context_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end seutil_read_default_contexts(test_open_usertype) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin seutil_run_newrole(test_open_t,test_open_r) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type newrole_t;
#line 39
		#attribute_role newrole_roles;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	#seutil_domtrans_newrole(test_open_t)
#line 39
	#roleattribute test_open_r newrole_roles;
#line 39

#line 39
	 	 	
#line 39
##### begin seutil_domtrans_newrole(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type newrole_t, newrole_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_usr(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t usr_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_usr(test_open_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_search_bin(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_read_bin_symlinks(test_open_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_read_bin_symlinks(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_search_bin(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t newrole_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t newrole_t:process transition;
#line 39
#	dontaudit test_open_t newrole_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t newrole_exec_t:process newrole_t;
#line 39

#line 39

#line 39
	allow newrole_t test_open_t:fd use;
#line 39
	allow newrole_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow newrole_t test_open_t:process sigchld;
#line 39

#line 39

#line 39
	 	
#line 39
##### end seutil_domtrans_newrole(test_open_t) depth: 3
#line 39
 	
#line 39
        role test_open_r types newrole_t;
#line 39

#line 39
         	 	
#line 39
##### begin auth_run_upd_passwd(newrole_t,test_open_r) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type updpwd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin auth_domtrans_upd_passwd(newrole_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type updpwd_t, updpwd_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow newrole_t updpwd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow newrole_t updpwd_t:process transition;
#line 39
#	dontaudit newrole_t updpwd_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition newrole_t updpwd_exec_t:process updpwd_t;
#line 39

#line 39

#line 39
	allow updpwd_t newrole_t:fd use;
#line 39
	allow updpwd_t newrole_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow updpwd_t newrole_t:process sigchld;
#line 39

#line 39
	 	 	
#line 39
##### begin auth_dontaudit_read_shadow(newrole_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type shadow_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit newrole_t shadow_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end auth_dontaudit_read_shadow(newrole_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end auth_domtrans_upd_passwd(newrole_t) depth: 4
#line 39
 	
#line 39
	role test_open_r types updpwd_t;
#line 39

#line 39
	 	
#line 39
##### end auth_run_upd_passwd(newrole_t,test_open_r) depth: 3
#line 39
 	
#line 39

#line 39
        
#line 39
	optional {
#line 39
		
#line 39
                 	 	
#line 39
##### begin namespace_init_run(newrole_t,test_open_r) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type namespace_init_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin namespace_init_domtrans(newrole_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type namespace_init_t, namespace_init_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow newrole_t namespace_init_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow newrole_t namespace_init_t:process transition;
#line 39
#	dontaudit newrole_t namespace_init_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition newrole_t namespace_init_exec_t:process namespace_init_t;
#line 39

#line 39

#line 39
	allow namespace_init_t newrole_t:fd use;
#line 39
	allow namespace_init_t newrole_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow namespace_init_t newrole_t:process sigchld;
#line 39

#line 39

#line 39
	 	
#line 39
##### end namespace_init_domtrans(newrole_t) depth: 4
#line 39
 	
#line 39
	role test_open_r types namespace_init_t;
#line 39

#line 39
	 	 	
#line 39
##### begin seutil_run_setfiles(namespace_init_t,test_open_r) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type setfiles_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin seutil_domtrans_setfiles(namespace_init_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type setfiles_t, setfiles_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_usr(namespace_init_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow namespace_init_t usr_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_usr(namespace_init_t) depth: 6
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_search_bin(namespace_init_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_read_bin_symlinks(namespace_init_t) depth: 8
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow namespace_init_t bin_t:dir { getattr search open };
#line 39
	allow namespace_init_t bin_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_read_bin_symlinks(namespace_init_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	allow namespace_init_t bin_t:dir { getattr search open };
#line 39
	allow namespace_init_t bin_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_search_bin(namespace_init_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
	
#line 39
	allow namespace_init_t setfiles_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow namespace_init_t setfiles_t:process transition;
#line 39
#	dontaudit namespace_init_t setfiles_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition namespace_init_t setfiles_exec_t:process setfiles_t;
#line 39

#line 39

#line 39
	allow setfiles_t namespace_init_t:fd use;
#line 39
	allow setfiles_t namespace_init_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow setfiles_t namespace_init_t:process sigchld;
#line 39

#line 39
    allow namespace_init_t setfiles_exec_t:file map;
#line 39

#line 39
	 	
#line 39
##### end seutil_domtrans_setfiles(namespace_init_t) depth: 5
#line 39
 	
#line 39
	role test_open_r types setfiles_t;
#line 39

#line 39
	 	
#line 39
##### end seutil_run_setfiles(namespace_init_t,test_open_r) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end namespace_init_run(newrole_t,test_open_r) depth: 3
#line 39
 	
#line 39
        
#line 39
	} # end optional
#line 39

#line 39

#line 39

#line 39
	 	
#line 39
##### end seutil_run_newrole(test_open_t,test_open_r) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin seutil_exec_checkpolicy(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type checkpolicy_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_usr(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t usr_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_usr(test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_search_bin(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_read_bin_symlinks(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_read_bin_symlinks(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_search_bin(test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_t checkpolicy_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39

#line 39
	 	
#line 39
##### end seutil_exec_checkpolicy(test_open_t) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin seutil_exec_setfiles(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type setfiles_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_usr(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype usr_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_usr(test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_search_bin(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_read_bin_symlinks(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype bin_t:dir { getattr search open };
#line 39
	allow test_open_usertype bin_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_read_bin_symlinks(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype bin_t:dir { getattr search open };
#line 39
	allow test_open_usertype bin_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_search_bin(test_open_usertype) depth: 3
#line 39
 	
#line 39
	allow test_open_usertype setfiles_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39

#line 39
	 	
#line 39
##### end seutil_exec_setfiles(test_open_usertype) depth: 2
#line 39
 	
#line 39
	# for when the network connection is killed
#line 39
	# this is needed when a login role can change
#line 39
	# to this one.
#line 39
	 	 	
#line 39
##### begin seutil_dontaudit_signal_newrole(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type newrole_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_t newrole_t:process signal;
#line 39

#line 39
	 	
#line 39
##### end seutil_dontaudit_signal_newrole(test_open_t) depth: 2
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin term_getattr_all_ttys(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tty_device_t;
#line 39
		attribute ttynode;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_list_all_dev_nodes(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t device_t:dir { getattr search open };
#line 39
	allow test_open_t device_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_t device_t:dir { getattr search open };
#line 39
	allow test_open_t device_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_list_all_dev_nodes(test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_t ttynode:chr_file getattr;
#line 39
	allow test_open_t tty_device_t:chr_file getattr;
#line 39

#line 39
	 	
#line 39
##### end term_getattr_all_ttys(test_open_t) depth: 2
#line 39
 	
#line 39

#line 39
    
#line 39
	optional {
#line 39
		
#line 39
         	 	
#line 39
##### begin afs_read_config(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type afs_config_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t afs_config_t:dir { getattr search open };
#line 39
	allow test_open_t afs_config_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end afs_read_config(test_open_t) depth: 2
#line 39
 	
#line 39
    
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		# Allow graphical boot to check battery lifespan
#line 39
		 	 	
#line 39
##### begin apm_stream_connect(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type apmd_t, apmd_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype apmd_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype apmd_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_usertype apmd_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end apm_stream_connect(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin chrome_role(test_open_r,test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin chrome_role_notrans(test_open_r,test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type chrome_sandbox_t;
#line 39
		type chrome_sandbox_tmpfs_t;
#line 39
		type chrome_sandbox_nacl_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	role test_open_r types chrome_sandbox_t;
#line 39
	role test_open_r types chrome_sandbox_nacl_t;
#line 39

#line 39
	
#line 39
	allow test_open_usertype chrome_sandbox_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_usertype chrome_sandbox_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_usertype chrome_sandbox_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype chrome_sandbox_t:process getattr;
#line 39

#line 39
	allow test_open_usertype chrome_sandbox_t:process { sigchld sigkill sigstop signull signal };
#line 39

#line 39
	allow chrome_sandbox_t test_open_usertype:unix_dgram_socket { read write };
#line 39
	allow test_open_usertype chrome_sandbox_t:unix_dgram_socket { read write };
#line 39
	allow chrome_sandbox_t test_open_usertype:unix_stream_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 39
	allow chrome_sandbox_t test_open_usertype:udp_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };;
#line 39
	allow chrome_sandbox_nacl_t test_open_usertype:unix_stream_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 39
	allow test_open_usertype chrome_sandbox_nacl_t:unix_stream_socket { getattr read write };
#line 39
	allow test_open_usertype chrome_sandbox_t:unix_stream_socket { getattr read write };
#line 39

#line 39
	allow test_open_usertype chrome_sandbox_t:shm { associate getattr read write lock unix_read unix_write };
#line 39

#line 39
	allow test_open_usertype chrome_sandbox_tmpfs_t:file { open { getattr read write append ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end chrome_role_notrans(test_open_r,test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin chrome_domtrans_sandbox(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type chrome_sandbox_t, chrome_sandbox_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_usertype chrome_sandbox_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_usertype chrome_sandbox_t:process transition;
#line 39
#	dontaudit test_open_usertype chrome_sandbox_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_usertype chrome_sandbox_exec_t:process chrome_sandbox_t;
#line 39

#line 39

#line 39
	allow chrome_sandbox_t test_open_usertype:fd use;
#line 39
	allow chrome_sandbox_t test_open_usertype:fifo_file { getattr read write append ioctl lock };
#line 39
	allow chrome_sandbox_t test_open_usertype:process sigchld;
#line 39

#line 39
	
#line 39
	allow chrome_sandbox_t test_open_usertype:dir { getattr search open read lock ioctl };
#line 39
	allow chrome_sandbox_t test_open_usertype:file { open { getattr read ioctl lock } };
#line 39
	allow chrome_sandbox_t test_open_usertype:lnk_file { getattr read };
#line 39
	allow chrome_sandbox_t test_open_usertype:process getattr;
#line 39

#line 39

#line 39
	allow test_open_usertype chrome_sandbox_t:fd use;
#line 39

#line 39
	dontaudit chrome_sandbox_t test_open_usertype:{ tcp_socket udp_socket rawip_socket netlink_socket packet_socket unix_stream_socket unix_dgram_socket appletalk_socket netlink_route_socket netlink_firewall_socket netlink_tcpdiag_socket netlink_nflog_socket netlink_xfrm_socket netlink_selinux_socket netlink_audit_socket netlink_ip6fw_socket netlink_dnrt_socket netlink_kobject_uevent_socket tun_socket netlink_iscsi_socket netlink_fib_lookup_socket netlink_connector_socket netlink_netfilter_socket netlink_generic_socket netlink_scsitransport_socket netlink_rdma_socket netlink_crypto_socket sctp_socket icmp_socket ax25_socket ipx_socket netrom_socket atmpvc_socket x25_socket rose_socket decnet_socket atmsvc_socket rds_socket irda_socket pppox_socket llc_socket can_socket tipc_socket bluetooth_socket iucv_socket rxrpc_socket isdn_socket phonet_socket ieee802154_socket caif_socket alg_socket nfc_socket vsock_socket kcm_socket qipcrtr_socket smc_socket bridge_socket dccp_socket ib_socket mpls_socket } getattr;
#line 39
	allow chrome_sandbox_t test_open_usertype:unix_stream_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 39

#line 39
	
#line 39
		 	 	
#line 39
##### begin fs_dontaudit_rw_anon_inodefs_files(chrome_sandbox_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type anon_inodefs_t;
#line 39

#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit chrome_sandbox_t anon_inodefs_t:file { open { getattr read write append ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end fs_dontaudit_rw_anon_inodefs_files(chrome_sandbox_t) depth: 4
#line 39
 	
#line 39
	
#line 39

#line 39
	 	
#line 39
##### end chrome_domtrans_sandbox(test_open_usertype) depth: 3
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end chrome_role(test_open_r,test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin canna_stream_connect(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type canna_t, canna_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype canna_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype canna_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_usertype canna_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end canna_stream_connect(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin colord_read_lib_files(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type colord_var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var_lib(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_lib_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_var_lib(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype colord_var_lib_t:dir { getattr search open };
#line 39
	allow test_open_usertype colord_var_lib_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end colord_read_lib_files(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin dbus_system_bus_client(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type system_dbusd_t, system_dbusd_t;
#line 39
		type system_dbusd_var_run_t, system_dbusd_var_lib_t;
#line 39
		class dbus send_msg;
#line 39
		attribute dbusd_unconfined;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	# SE-DBus specific permissions
#line 39
	allow test_open_usertype { system_dbusd_t self }:dbus send_msg;
#line 39
	allow { system_dbusd_t dbusd_unconfined } test_open_usertype:dbus send_msg;
#line 39

#line 39
	
#line 39
	allow test_open_usertype system_dbusd_var_lib_t:dir { getattr search open };
#line 39
	allow test_open_usertype system_dbusd_var_lib_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var_lib(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_lib_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_var_lib(test_open_usertype) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin dev_read_urand(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t, urandom_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype urandom_device_t:chr_file { getattr open read lock ioctl };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_read_urand(test_open_usertype) depth: 3
#line 39
 	
#line 39

#line 39
	# For connecting to the bus
#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype system_dbusd_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype system_dbusd_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_usertype system_dbusd_t:unix_stream_socket connectto;
#line 39

#line 39
	 	 	
#line 39
##### begin dbus_read_config(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type dbusd_etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype dbusd_etc_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_usertype dbusd_etc_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end dbus_read_config(test_open_usertype) depth: 3
#line 39
 	
#line 39

#line 39
    
#line 39
	optional {
#line 39
		
#line 39
         	 	
#line 39
##### begin unconfined_server_dbus_chat(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type unconfined_service_t;
#line 39
        class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
        allow test_open_usertype unconfined_service_t:dbus send_msg;
#line 39
        allow unconfined_service_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end unconfined_server_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
    
#line 39
	}
#line 39

#line 39

#line 39
	 	
#line 39
##### end dbus_system_bus_client(test_open_usertype) depth: 2
#line 39
 	
#line 39

#line 39
		allow test_open_usertype test_open_usertype:dbus  send_msg;
#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin avahi_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type avahi_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype avahi_t:dbus send_msg;
#line 39
	allow avahi_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end avahi_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin bluetooth_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bluetooth_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype bluetooth_t:dbus send_msg;
#line 39
	allow bluetooth_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end bluetooth_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin consolekit_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type consolekit_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype consolekit_t:dbus send_msg;
#line 39
	allow consolekit_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end consolekit_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
			 	 	
#line 39
##### begin consolekit_read_log(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type consolekit_log_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype consolekit_log_t:dir { getattr search open };
#line 39
	allow test_open_usertype consolekit_log_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	 	 	
#line 39
##### begin logging_search_logs(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_log_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_var(test_open_usertype) depth: 4
#line 39
 	
#line 39
	allow test_open_usertype var_log_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end logging_search_logs(test_open_usertype) depth: 3
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end consolekit_read_log(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin devicekit_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type devicekit_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype devicekit_t:dbus send_msg;
#line 39
	allow devicekit_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end devicekit_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
			 	 	
#line 39
##### begin devicekit_dbus_chat_power(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type devicekit_power_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype devicekit_power_t:dbus send_msg;
#line 39
	allow devicekit_power_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end devicekit_dbus_chat_power(test_open_usertype) depth: 2
#line 39
 	
#line 39
			 	 	
#line 39
##### begin devicekit_dbus_chat_disk(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type devicekit_disk_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype devicekit_disk_t:dbus send_msg;
#line 39
	allow devicekit_disk_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end devicekit_dbus_chat_disk(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin evolution_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type evolution_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype evolution_t:dbus send_msg;
#line 39
	allow evolution_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end evolution_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
			 	 	
#line 39
##### begin evolution_alarm_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type evolution_alarm_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype evolution_alarm_t:dbus send_msg;
#line 39
	allow evolution_alarm_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end evolution_alarm_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
        
#line 39
	optional {
#line 39
		
#line 39
             	 	
#line 39
##### begin firewalld_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type firewalld_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype firewalld_t:dbus send_msg;
#line 39
	allow firewalld_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end firewalld_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
        
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin geoclue_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
        
#line 39
	
#line 39
		require {
#line 39
			
#line 39
                type geoclue_t;
#line 39
                class dbus send_msg;
#line 39
        
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
        allow test_open_usertype geoclue_t:dbus send_msg;
#line 39
        allow geoclue_t test_open_usertype:dbus send_msg;
#line 39
	    
#line 39
	allow geoclue_t test_open_usertype:dir { getattr search open read lock ioctl };
#line 39
	allow geoclue_t test_open_usertype:file { open { getattr read ioctl lock } };
#line 39
	allow geoclue_t test_open_usertype:lnk_file { getattr read };
#line 39
	allow geoclue_t test_open_usertype:process getattr;
#line 39

#line 39

#line 39
	 	
#line 39
##### end geoclue_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin gnome_dbus_chat_gconfdefault(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type gconfdefaultsm_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype gconfdefaultsm_t:dbus send_msg;
#line 39
	allow gconfdefaultsm_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end gnome_dbus_chat_gconfdefault(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin hal_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type hald_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype hald_t:dbus send_msg;
#line 39
	allow hald_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end hal_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin hwloc_exec_dhwd(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type hwloc_dhwd_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t hwloc_dhwd_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39

#line 39
	 	
#line 39
##### end hwloc_exec_dhwd(test_open_t) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin hwloc_read_runtime_files(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type hwloc_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t var_t:lnk_file { getattr read };
#line 39
	allow test_open_t var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_t var_t:dir { getattr search open };
#line 39
	allow test_open_t var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_t hwloc_var_run_t:dir { getattr search open };
#line 39
	allow test_open_t hwloc_var_run_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end hwloc_read_runtime_files(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin kde_dbus_chat_backlighthelper(test_open_usertype) depth: 3
#line 39
 	
#line 39
        
#line 39
	
#line 39
		require {
#line 39
			
#line 39
                type kdebacklighthelper_t;
#line 39
                class dbus send_msg;
#line 39
        
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype kdebacklighthelper_t:dbus send_msg;
#line 39
        allow kdebacklighthelper_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end kde_dbus_chat_backlighthelper(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
        
#line 39
	optional {
#line 39
		
#line 39
             	 	
#line 39
##### begin memcached_stream_connect(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type memcached_t, memcached_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype memcached_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype memcached_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_usertype memcached_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end memcached_stream_connect(test_open_usertype) depth: 2
#line 39
 	
#line 39
        
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin modemmanager_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type modemmanager_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype modemmanager_t:dbus send_msg;
#line 39
	allow modemmanager_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end modemmanager_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin networkmanager_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type NetworkManager_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype NetworkManager_t:dbus send_msg;
#line 39
	allow NetworkManager_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end networkmanager_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
			 	 	
#line 39
##### begin networkmanager_read_lib_files(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type NetworkManager_var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var_lib(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_lib_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_var_lib(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype NetworkManager_var_lib_t:dir { getattr search open };
#line 39
	allow test_open_usertype NetworkManager_var_lib_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype NetworkManager_var_lib_t:dir { getattr search open };
#line 39
	allow test_open_usertype NetworkManager_var_lib_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	allow test_open_usertype NetworkManager_var_lib_t:file map;
#line 39

#line 39
	 	
#line 39
##### end networkmanager_read_lib_files(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin policykit_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type policykit_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow policykit_t test_open_usertype:dir { getattr search open read lock ioctl };
#line 39
	allow policykit_t test_open_usertype:file { open { getattr read ioctl lock } };
#line 39
	allow policykit_t test_open_usertype:lnk_file { getattr read };
#line 39
	allow policykit_t test_open_usertype:process getattr;
#line 39

#line 39

#line 39
	allow test_open_usertype policykit_t:dbus send_msg;
#line 39
	allow policykit_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end policykit_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39

#line 39
		
#line 39
	optional {
#line 39
		
#line 39
			 	 	
#line 39
##### begin vpn_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type vpnc_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype vpnc_t:dbus send_msg;
#line 39
	allow vpnc_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end vpn_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin git_role(test_open_r,test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute_role git_session_roles;
#line 39
		type git_session_t, gitd_exec_t, git_user_content_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	########################################
#line 39
	#
#line 39
	# Declarations
#line 39
	#
#line 39

#line 39
	roleattribute test_open_r git_session_roles;
#line 39

#line 39
	########################################
#line 39
	#
#line 39
	# Policy
#line 39
	#
#line 39

#line 39
	allow test_open_t git_user_content_t:dir { { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl } { getattr relabelfrom relabelto } };
#line 39
	allow test_open_t git_user_content_t:file { { getattr open map read execute ioctl execute_no_trans } { create open getattr setattr read write append rename link unlink ioctl lock } { getattr relabelfrom relabelto } };
#line 39
	 	 	
#line 39
##### begin userdom_user_home_dir_filetrans(test_open_t,git_user_content_t,dir,"public_git") depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_dir_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_t user_home_dir_t:dir git_user_content_t "public_git";
#line 39

#line 39
	 	 	
#line 39
##### begin files_search_home(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t home_root_t:dir { getattr search open };
#line 39
	allow test_open_t home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_search_home(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_user_home_dir_filetrans(test_open_t,git_user_content_t,dir,"public_git") depth: 3
#line 39
 	
#line 39

#line 39
	allow test_open_t git_session_t:process { sigchld sigkill sigstop signull signal };
#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool deny_ptrace;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (deny_ptrace) {
#line 39
		
#line 39
	} else {
#line 39
		
#line 39
		allow test_open_t git_session_t:process ptrace;
#line 39
	
#line 39
	}
#line 39

#line 39
	
#line 39
	allow test_open_t git_session_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t git_session_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_t git_session_t:lnk_file { getattr read };
#line 39
	allow test_open_t git_session_t:process getattr;
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool git_session_users;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (git_session_users) {
#line 39
		
#line 39
		
#line 39
	
#line 39
	
#line 39
	allow test_open_t gitd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t git_session_t:process transition;
#line 39
#	dontaudit test_open_t git_session_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t gitd_exec_t:process git_session_t;
#line 39

#line 39

#line 39
	allow git_session_t test_open_t:fd use;
#line 39
	allow git_session_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow git_session_t test_open_t:process sigchld;
#line 39

#line 39
	
#line 39
	} else {
#line 39
		
#line 39
		allow test_open_t gitd_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39
	
#line 39
	}
#line 39

#line 39
 	 	
#line 39
##### end git_role(test_open_r,test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin inetd_use_fds(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type inetd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype inetd_t:fd use;
#line 39

#line 39
	 	
#line 39
##### end inetd_use_fds(test_open_usertype) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin inetd_rw_tcp_sockets(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type inetd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype inetd_t:tcp_socket { { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } listen accept };
#line 39

#line 39
	 	
#line 39
##### end inetd_rw_tcp_sockets(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin inn_read_config(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type innd_etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_etc(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_etc(test_open_usertype) depth: 3
#line 39
 	
#line 39
	allow test_open_usertype innd_etc_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_usertype innd_etc_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_usertype innd_etc_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end inn_read_config(test_open_usertype) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin inn_read_news_lib(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type innd_var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var_lib(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_lib_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_var_lib(test_open_usertype) depth: 3
#line 39
 	
#line 39
	allow test_open_usertype innd_var_lib_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_usertype innd_var_lib_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end inn_read_news_lib(test_open_usertype) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin inn_read_news_spool(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type news_spool_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_spool(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_spool_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_spool_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_spool(test_open_usertype) depth: 3
#line 39
 	
#line 39
	allow test_open_usertype news_spool_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_usertype news_spool_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_usertype news_spool_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end inn_read_news_spool(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin lircd_stream_connect(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type lircd_var_run_t, lircd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype lircd_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype lircd_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_usertype lircd_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end lircd_stream_connect(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin locate_read_lib_files(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type locate_var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var_lib(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t var_t:dir { getattr search open };
#line 39
	allow test_open_t var_lib_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_var_lib(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_t locate_var_lib_t:dir { getattr search open };
#line 39
	allow test_open_t locate_var_lib_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	allow test_open_t locate_var_lib_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end locate_read_lib_files(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin mpd_manage_user_data_content(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type mpd_user_data_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin userdom_search_user_home_dirs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_dir_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t user_home_dir_t:dir { getattr search open };
#line 39
	allow test_open_t user_home_dir_t:lnk_file { getattr read };
#line 39
	 	 	
#line 39
##### begin files_search_home(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t home_root_t:dir { getattr search open };
#line 39
	allow test_open_t home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_search_home(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_search_user_home_dirs(test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_t mpd_user_data_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39
	allow test_open_t mpd_user_data_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39
	allow test_open_t mpd_user_data_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	 	
#line 39
##### end mpd_manage_user_data_content(test_open_t) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin mpd_relabel_user_data_content(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type mpd_user_data_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin userdom_search_user_home_dirs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_dir_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t user_home_dir_t:dir { getattr search open };
#line 39
	allow test_open_t user_home_dir_t:lnk_file { getattr read };
#line 39
	 	 	
#line 39
##### begin files_search_home(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t home_root_t:dir { getattr search open };
#line 39
	allow test_open_t home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_search_home(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_search_user_home_dirs(test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_t mpd_user_data_t:dir { getattr relabelfrom relabelto };
#line 39
	allow test_open_t mpd_user_data_t:file { getattr relabelfrom relabelto };
#line 39
	allow test_open_t mpd_user_data_t:lnk_file { getattr relabelfrom relabelto };
#line 39

#line 39
	 	
#line 39
##### end mpd_relabel_user_data_content(test_open_t) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin mpd_stream_connect(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type mpd_t, mpd_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t var_t:lnk_file { getattr read };
#line 39
	allow test_open_t var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_t var_t:dir { getattr search open };
#line 39
	allow test_open_t var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_t mpd_var_run_t:dir { getattr search open };
#line 39
	allow test_open_t mpd_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_t mpd_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end mpd_stream_connect(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	# for running depmod as part of the kernel packaging process
#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin modutils_read_module_config(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type modules_conf_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	# This file type can be in /etc or
#line 39
	# /lib(64)?/modules
#line 39
	 	 	
#line 39
##### begin files_search_etc(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_etc(test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_search_boot(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type boot_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype boot_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_boot(test_open_usertype) depth: 3
#line 39
 	
#line 39

#line 39
	allow test_open_usertype modules_conf_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_usertype modules_conf_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_usertype modules_conf_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end modutils_read_module_config(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin mta_rw_spool(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type mail_spool_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_spool(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_spool_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_spool_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_spool(test_open_usertype) depth: 3
#line 39
 	
#line 39
	allow test_open_usertype mail_spool_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_usertype mail_spool_t:file { setattr };
#line 39
	
#line 39
	allow test_open_usertype mail_spool_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_usertype mail_spool_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_usertype mail_spool_t:dir { getattr search open };
#line 39
	allow test_open_usertype mail_spool_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end mta_rw_spool(test_open_usertype) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin mta_manage_queue(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type mqueue_spool_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_spool(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_spool_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_spool_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_spool(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype mqueue_spool_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_usertype mqueue_spool_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype mqueue_spool_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_usertype mqueue_spool_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end mta_manage_queue(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool selinuxuser_mysql_connect_enabled;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (selinuxuser_mysql_connect_enabled) {
#line 39
		
#line 39
			 	 	
#line 39
##### begin mysql_stream_connect(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type mysqld_t, mysqld_var_run_t, mysqld_db_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t var_t:lnk_file { getattr read };
#line 39
	allow test_open_t var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_t var_t:dir { getattr search open };
#line 39
	allow test_open_t var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_t mysqld_var_run_t:dir { getattr search open };
#line 39
	allow test_open_t mysqld_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_t mysqld_t:unix_stream_socket connectto;
#line 39

#line 39
	
#line 39
	allow test_open_t mysqld_db_t:dir { getattr search open };
#line 39
	allow test_open_t mysqld_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_t mysqld_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end mysql_stream_connect(test_open_t) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin oident_manage_user_content(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type oidentd_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin userdom_search_user_home_dirs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_dir_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t user_home_dir_t:dir { getattr search open };
#line 39
	allow test_open_t user_home_dir_t:lnk_file { getattr read };
#line 39
	 	 	
#line 39
##### begin files_search_home(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t home_root_t:dir { getattr search open };
#line 39
	allow test_open_t home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_search_home(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_search_user_home_dirs(test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_t oidentd_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	 	
#line 39
##### end oident_manage_user_content(test_open_t) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin oident_relabel_user_content(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type oidentd_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin userdom_search_user_home_dirs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_dir_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t user_home_dir_t:dir { getattr search open };
#line 39
	allow test_open_t user_home_dir_t:lnk_file { getattr read };
#line 39
	 	 	
#line 39
##### begin files_search_home(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t home_root_t:dir { getattr search open };
#line 39
	allow test_open_t home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_search_home(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_search_user_home_dirs(test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_t oidentd_home_t:file { getattr relabelfrom relabelto };
#line 39

#line 39
	 	
#line 39
##### end oident_relabel_user_content(test_open_t) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin oident_home_filetrans_oidentd_home(test_open_t,file,".oidentd.conf") depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type oidentd_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin userdom_user_home_dir_filetrans(test_open_t,oidentd_home_t,file,".oidentd.conf") depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_dir_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_t user_home_dir_t:file oidentd_home_t ".oidentd.conf";
#line 39

#line 39
	 	 	
#line 39
##### begin files_search_home(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t home_root_t:dir { getattr search open };
#line 39
	allow test_open_t home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_search_home(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_user_home_dir_filetrans(test_open_t,oidentd_home_t,file,".oidentd.conf") depth: 3
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end oident_home_filetrans_oidentd_home(test_open_t,file,".oidentd.conf") depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		# to allow monitoring of pcmcia status
#line 39
		 	 	
#line 39
##### begin pcmcia_read_pid(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cardmgr_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype cardmgr_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype cardmgr_var_run_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end pcmcia_read_pid(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin pcscd_read_pid_files(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type pcscd_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t var_t:lnk_file { getattr read };
#line 39
	allow test_open_t var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_t var_t:dir { getattr search open };
#line 39
	allow test_open_t var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_t pcscd_var_run_t:dir { getattr search open };
#line 39
	allow test_open_t pcscd_var_run_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end pcscd_read_pid_files(test_open_t) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin pcscd_stream_connect(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type pcscd_t, pcscd_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t var_t:lnk_file { getattr read };
#line 39
	allow test_open_t var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_t var_t:dir { getattr search open };
#line 39
	allow test_open_t var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_t pcscd_var_run_t:dir { getattr search open };
#line 39
	allow test_open_t pcscd_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_t pcscd_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end pcscd_stream_connect(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool selinuxuser_postgresql_connect_enabled;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (selinuxuser_postgresql_connect_enabled) {
#line 39
		
#line 39
			 	 	
#line 39
##### begin postgresql_stream_connect(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type postgresql_t, postgresql_var_run_t, postgresql_tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype { postgresql_var_run_t postgresql_tmp_t }:dir { getattr search open };
#line 39
	allow test_open_usertype { postgresql_var_run_t postgresql_tmp_t }:sock_file { getattr write open append };
#line 39
	allow test_open_usertype postgresql_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_search_tmp(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin fs_search_tmpfs(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype tmpfs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_tmpfs(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype tmp_t:dir { getattr search open };
#line 39
	allow test_open_usertype tmp_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_usertype tmp_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_tmp(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype { postgresql_var_run_t postgresql_tmp_t }:dir { getattr search open };
#line 39
	allow test_open_usertype { postgresql_var_run_t postgresql_tmp_t }:sock_file { getattr write open append };
#line 39
	allow test_open_usertype postgresql_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end postgresql_stream_connect(test_open_usertype) depth: 2
#line 39
 	
#line 39
			 	 	
#line 39
##### begin postgresql_tcp_connect(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type postgresql_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corenet_tcp_recvfrom_labeled(test_open_usertype,postgresql_t) depth: 4
#line 39
 	
#line 39
	allow { test_open_usertype postgresql_t } self:association sendto;
#line 39
	allow test_open_usertype postgresql_t:{ association tcp_socket } recvfrom;
#line 39
	allow postgresql_t test_open_usertype:{ association tcp_socket } recvfrom;
#line 39

#line 39
	allow test_open_usertype postgresql_t:peer recv;
#line 39
	allow postgresql_t test_open_usertype:peer recv;
#line 39

#line 39
	# allow receiving packets from MLS-only peers using NetLabel
#line 39
	 	 	
#line 39
##### begin corenet_tcp_recvfrom_netlabel(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type netlabel_peer_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype netlabel_peer_t:peer recv;
#line 39
	allow test_open_usertype netlabel_peer_t:tcp_socket recvfrom;
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_recvfrom_netlabel(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_tcp_recvfrom_netlabel(postgresql_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type netlabel_peer_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow postgresql_t netlabel_peer_t:peer recv;
#line 39
	allow postgresql_t netlabel_peer_t:tcp_socket recvfrom;
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_recvfrom_netlabel(postgresql_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_recvfrom_labeled(test_open_usertype,postgresql_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_tcp_sendrecv_postgresql_port(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type postgresql_port_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype postgresql_port_t:tcp_socket { send_msg recv_msg };
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_sendrecv_postgresql_port(test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_tcp_connect_postgresql_port(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type postgresql_port_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype postgresql_port_t:tcp_socket name_connect;
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_connect_postgresql_port(test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_sendrecv_postgresql_client_packets(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_send_postgresql_client_packets(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type postgresql_client_packet_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype postgresql_client_packet_t:packet send;
#line 39

#line 39
	 	
#line 39
##### end corenet_send_postgresql_client_packets(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_receive_postgresql_client_packets(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type postgresql_client_packet_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype postgresql_client_packet_t:packet recv;
#line 39

#line 39
	 	
#line 39
##### end corenet_receive_postgresql_client_packets(test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corenet_sendrecv_postgresql_client_packets(test_open_usertype) depth: 3
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end postgresql_tcp_connect(test_open_usertype) depth: 2
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin ppp_manage_home_files(test_open_t) depth: 3
#line 39
 	
#line 39
    
#line 39
	
#line 39
		require {
#line 39
			
#line 39
        type ppp_home_t;
#line 39
    
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin userdom_search_user_home_dirs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_dir_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t user_home_dir_t:dir { getattr search open };
#line 39
	allow test_open_t user_home_dir_t:lnk_file { getattr read };
#line 39
	 	 	
#line 39
##### begin files_search_home(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t home_root_t:dir { getattr search open };
#line 39
	allow test_open_t home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_search_home(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_search_user_home_dirs(test_open_t) depth: 3
#line 39
 	
#line 39
    allow test_open_t ppp_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	 	
#line 39
##### end ppp_manage_home_files(test_open_t) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin ppp_relabel_home_files(test_open_t) depth: 3
#line 39
 	
#line 39
    
#line 39
	
#line 39
		require {
#line 39
			
#line 39
        type ppp_home_t;
#line 39
    
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin userdom_search_user_home_dirs(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_dir_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t user_home_dir_t:dir { getattr search open };
#line 39
	allow test_open_t user_home_dir_t:lnk_file { getattr read };
#line 39
	 	 	
#line 39
##### begin files_search_home(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t home_root_t:dir { getattr search open };
#line 39
	allow test_open_t home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_search_home(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_search_user_home_dirs(test_open_t) depth: 3
#line 39
 	
#line 39
    allow test_open_t ppp_home_t:file { getattr relabelfrom relabelto };
#line 39

#line 39
	 	
#line 39
##### end ppp_relabel_home_files(test_open_t) depth: 2
#line 39
 	
#line 39
		 	 	
#line 39
##### begin ppp_home_filetrans_ppp_home(test_open_t,file,".ppprc") depth: 3
#line 39
 	
#line 39
    
#line 39
	
#line 39
		require {
#line 39
			
#line 39
        type ppp_home_t;
#line 39
    
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin userdom_user_home_dir_filetrans(test_open_t,ppp_home_t,file,".ppprc") depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_dir_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_t user_home_dir_t:file ppp_home_t ".ppprc";
#line 39

#line 39
	 	 	
#line 39
##### begin files_search_home(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t home_root_t:dir { getattr search open };
#line 39
	allow test_open_t home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_search_home(test_open_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_user_home_dir_filetrans(test_open_t,ppp_home_t,file,".ppprc") depth: 3
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end ppp_home_filetrans_ppp_home(test_open_t,file,".ppprc") depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin resmgr_stream_connect(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type resmgrd_var_run_t, resmgrd_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype resmgrd_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype resmgrd_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_usertype resmgrd_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end resmgr_stream_connect(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin rpc_dontaudit_getattr_exports(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type exports_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	dontaudit test_open_usertype exports_t:file { getattr };
#line 39

#line 39
	 	
#line 39
##### end rpc_dontaudit_getattr_exports(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin rpcbind_stream_connect(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type rpcbind_t, rpcbind_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype rpcbind_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype rpcbind_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_usertype rpcbind_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end rpcbind_stream_connect(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin samba_stream_connect_winbind(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type samba_var_t, winbind_t, winbind_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin samba_search_pid(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type smbd_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype var_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_usertype) depth: 4
#line 39
 	
#line 39
	allow test_open_usertype smbd_var_run_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end samba_search_pid(test_open_usertype) depth: 3
#line 39
 	
#line 39
	allow test_open_usertype samba_var_t:dir { getattr search open };
#line 39
	
#line 39
	allow test_open_usertype winbind_var_run_t:dir { getattr search open };
#line 39
	allow test_open_usertype winbind_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_usertype winbind_t:unix_stream_socket connectto;
#line 39

#line 39
	 	 	
#line 39
##### begin samba_read_config(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type samba_etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_etc(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type etc_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype etc_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_etc(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype samba_etc_t:dir { getattr search open };
#line 39
	allow test_open_usertype samba_etc_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype samba_etc_t:dir { getattr search open };
#line 39
	allow test_open_usertype samba_etc_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end samba_read_config(test_open_usertype) depth: 3
#line 39
 	
#line 39

#line 39
	
#line 39
		
#line 39
	
#line 39
		require {
#line 39
			
#line 39
			type winbind_tmp_t;
#line 39
		
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
		# the default for the socket is (poorly named):
#line 39
		# /tmp/.winbindd/pipe
#line 39
		 	 	
#line 39
##### begin files_search_tmp(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin fs_search_tmpfs(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype tmpfs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_tmpfs(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype tmp_t:dir { getattr search open };
#line 39
	allow test_open_usertype tmp_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_usertype tmp_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_tmp(test_open_usertype) depth: 3
#line 39
 	
#line 39
		
#line 39
	allow test_open_usertype winbind_tmp_t:dir { getattr search open };
#line 39
	allow test_open_usertype winbind_tmp_t:sock_file { getattr write open append };
#line 39
	allow test_open_usertype winbind_t:unix_stream_socket connectto;
#line 39

#line 39
	
#line 39

#line 39
	 	
#line 39
##### end samba_stream_connect_winbind(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin sandbox_transition(test_open_usertype,test_open_r) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute sandbox_domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin sandbox_dyntransition(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute sandbox_domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype sandbox_domain:process dyntransition;
#line 39

#line 39
	 	
#line 39
##### end sandbox_dyntransition(test_open_usertype) depth: 3
#line 39
 	 #885288
#line 39
    allow test_open_usertype sandbox_domain:process transition;
#line 39
    dontaudit test_open_usertype sandbox_domain:process { noatsecure siginh rlimitinh };
#line 39

#line 39
    role test_open_r types sandbox_domain;
#line 39

#line 39
    allow sandbox_domain test_open_usertype:process { sigchld signull };
#line 39
    allow sandbox_domain test_open_usertype:fifo_file { getattr read write append ioctl lock };
#line 39

#line 39
    dontaudit sandbox_domain test_open_usertype:process signal;
#line 39
    dontaudit sandbox_domain test_open_usertype:key { link read search view };
#line 39
    dontaudit sandbox_domain test_open_usertype:unix_stream_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 39

#line 39
	 	
#line 39
##### end sandbox_transition(test_open_usertype,test_open_r) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin seunshare_role_template(test_open,test_open_r,test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute seunshare_domain;
#line 39
		type seunshare_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	type test_open_seunshare_t, seunshare_domain;
#line 39
	 	 	
#line 39
##### begin application_domain(test_open_seunshare_t,seunshare_exec_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin application_type(test_open_seunshare_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute application_domain_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_seunshare_t application_domain_type;
#line 39

#line 39
	# start with basic domain
#line 39
	 	 	
#line 39
##### begin domain_type(test_open_seunshare_t) depth: 6
#line 39
 	
#line 39
	# start with basic domain
#line 39
	 	 	
#line 39
##### begin domain_base_type(test_open_seunshare_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_seunshare_t domain;
#line 39

#line 39
	 	
#line 39
##### end domain_base_type(test_open_seunshare_t) depth: 6
#line 39
 	
#line 39

#line 39
	# Only way to get corenet_unlabeled packets disabled to work
#line 39
	 	 	
#line 39
##### begin corenet_all_recvfrom_unlabeled(test_open_seunshare_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
                attribute corenet_unlabeled_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	typeattribute test_open_seunshare_t corenet_unlabeled_type;
#line 39

#line 39
	 	
#line 39
##### end corenet_all_recvfrom_unlabeled(test_open_seunshare_t) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end domain_type(test_open_seunshare_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end application_type(test_open_seunshare_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin application_executable_file(seunshare_exec_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute application_exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute seunshare_exec_t application_exec_type;
#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_executable_file(seunshare_exec_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute seunshare_exec_t exec_type;
#line 39

#line 39
	 	 	
#line 39
##### begin files_type(seunshare_exec_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute seunshare_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 39

#line 39
	 	
#line 39
##### end files_type(seunshare_exec_t) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corecmd_executable_file(seunshare_exec_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end application_executable_file(seunshare_exec_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin domain_entry_file(test_open_seunshare_t,seunshare_exec_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute entry_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_seunshare_t seunshare_exec_t:file entrypoint;
#line 39
	allow test_open_seunshare_t seunshare_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 39

#line 39
	typeattribute seunshare_exec_t entry_type;
#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_executable_file(seunshare_exec_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute seunshare_exec_t exec_type;
#line 39

#line 39
	 	 	
#line 39
##### begin files_type(seunshare_exec_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute seunshare_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 39

#line 39
	 	
#line 39
##### end files_type(seunshare_exec_t) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corecmd_executable_file(seunshare_exec_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end domain_entry_file(test_open_seunshare_t,seunshare_exec_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end application_domain(test_open_seunshare_t,seunshare_exec_t) depth: 3
#line 39
 	
#line 39
	role test_open_r types test_open_seunshare_t;
#line 39

#line 39
	 	 	
#line 39
##### begin kernel_read_system_state(test_open_seunshare_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute kernel_system_state_reader;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_seunshare_t kernel_system_state_reader;
#line 39

#line 39
	 	
#line 39
##### end kernel_read_system_state(test_open_seunshare_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin auth_use_nsswitch(test_open_seunshare_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute nsswitch_domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_seunshare_t nsswitch_domain;
#line 39

#line 39
	 	 	
#line 39
##### begin corenet_all_recvfrom_netlabel(test_open_seunshare_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute netlabel_peer_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_seunshare_t netlabel_peer_type;
#line 39

#line 39
	 	
#line 39
##### end corenet_all_recvfrom_netlabel(test_open_seunshare_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end auth_use_nsswitch(test_open_seunshare_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin logging_send_syslog_msg(test_open_seunshare_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute syslog_client_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_seunshare_t syslog_client_type;
#line 39

#line 39
	 	
#line 39
##### end logging_send_syslog_msg(test_open_seunshare_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin mls_process_set_level(test_open_seunshare_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute mlsprocsetsl;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_seunshare_t mlsprocsetsl;
#line 39

#line 39
	 	
#line 39
##### end mls_process_set_level(test_open_seunshare_t) depth: 3
#line 39
 	
#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t seunshare_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t test_open_seunshare_t:process transition;
#line 39
#	dontaudit test_open_t test_open_seunshare_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t seunshare_exec_t:process test_open_seunshare_t;
#line 39

#line 39

#line 39
	allow test_open_seunshare_t test_open_t:fd use;
#line 39
	allow test_open_seunshare_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow test_open_seunshare_t test_open_t:process sigchld;
#line 39

#line 39
	allow test_open_seunshare_t test_open_t:unix_stream_socket getattr;
#line 39

#line 39
	# part of sandboxX.pp
#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin sandbox_x_transition(test_open_seunshare_t,test_open_r) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type sandbox_xserver_t;
#line 39
		type sandbox_file_t;
#line 39
		attribute sandbox_x_domain;
#line 39
		attribute sandbox_tmpfs_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_seunshare_t sandbox_x_domain:process { { sigchld sigkill sigstop signull signal } transition };
#line 39
	allow test_open_seunshare_t sandbox_x_domain:process dyntransition;
#line 39
	dontaudit test_open_seunshare_t sandbox_x_domain:process { noatsecure siginh rlimitinh };
#line 39
	allow sandbox_x_domain test_open_seunshare_t:process { sigchld signull };
#line 39
	allow { sandbox_x_domain sandbox_xserver_t } test_open_seunshare_t:fd use;
#line 39
	role test_open_r types sandbox_x_domain;
#line 39
	role test_open_r types sandbox_xserver_t;
#line 39
	allow test_open_seunshare_t sandbox_xserver_t:process { sigchld sigkill sigstop signull signal };
#line 39
	dontaudit sandbox_xserver_t test_open_seunshare_t:fifo_file { getattr read write append ioctl lock };
#line 39
	dontaudit sandbox_xserver_t test_open_seunshare_t:tcp_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 39
	dontaudit sandbox_xserver_t test_open_seunshare_t:udp_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 39
	allow sandbox_xserver_t test_open_seunshare_t:unix_stream_socket { connectto { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 39
	dontaudit sandbox_xserver_t test_open_seunshare_t:file read;
#line 39
	allow sandbox_x_domain sandbox_x_domain:process signal;
#line 39
	# Dontaudit leaked file descriptors
#line 39
	dontaudit sandbox_x_domain test_open_seunshare_t:key { link read search view };
#line 39
	dontaudit sandbox_x_domain test_open_seunshare_t:fifo_file { read write };
#line 39
	dontaudit sandbox_x_domain test_open_seunshare_t:tcp_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 39
	dontaudit sandbox_x_domain test_open_seunshare_t:udp_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 39
	dontaudit sandbox_x_domain test_open_seunshare_t:unix_stream_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 39
	dontaudit sandbox_x_domain test_open_seunshare_t:process { signal sigkill };
#line 39
	
#line 39
	allow test_open_seunshare_t sandbox_tmpfs_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39
	dontaudit test_open_seunshare_t sandbox_tmpfs_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	allow test_open_seunshare_t sandbox_file_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39
	allow test_open_seunshare_t sandbox_file_t:filesystem getattr;
#line 39
	
#line 39
	allow test_open_seunshare_t sandbox_file_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_seunshare_t sandbox_file_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39
;
#line 39
	
#line 39
	allow test_open_seunshare_t sandbox_file_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_seunshare_t sandbox_file_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39
;
#line 39
	
#line 39
	allow test_open_seunshare_t sandbox_file_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_seunshare_t sandbox_file_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 39
;
#line 39
	
#line 39
	allow test_open_seunshare_t sandbox_file_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_seunshare_t sandbox_file_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39
;
#line 39
	
#line 39
	allow test_open_seunshare_t sandbox_file_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_seunshare_t sandbox_file_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 39
;
#line 39
	
#line 39
	allow test_open_seunshare_t sandbox_file_t:dir { getattr search open };
#line 39
	allow test_open_seunshare_t sandbox_file_t:dir { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_seunshare_t sandbox_file_t:dir { getattr search open };
#line 39
	allow test_open_seunshare_t sandbox_file_t:file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_seunshare_t sandbox_file_t:dir { getattr search open };
#line 39
	allow test_open_seunshare_t sandbox_file_t:lnk_file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_seunshare_t sandbox_file_t:dir { getattr search open };
#line 39
	allow test_open_seunshare_t sandbox_file_t:fifo_file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_seunshare_t sandbox_file_t:dir { getattr search open };
#line 39
	allow test_open_seunshare_t sandbox_file_t:sock_file { getattr relabelfrom relabelto };
#line 39

#line 39

#line 39
	 	
#line 39
##### end sandbox_x_transition(test_open_seunshare_t,test_open_r) depth: 3
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	# part of sandbox.pp
#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin sandbox_transition(test_open_seunshare_t,test_open_r) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute sandbox_domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin sandbox_dyntransition(test_open_seunshare_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute sandbox_domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_seunshare_t sandbox_domain:process dyntransition;
#line 39

#line 39
	 	
#line 39
##### end sandbox_dyntransition(test_open_seunshare_t) depth: 4
#line 39
 	 #885288
#line 39
    allow test_open_seunshare_t sandbox_domain:process transition;
#line 39
    dontaudit test_open_seunshare_t sandbox_domain:process { noatsecure siginh rlimitinh };
#line 39

#line 39
    role test_open_r types sandbox_domain;
#line 39

#line 39
    allow sandbox_domain test_open_seunshare_t:process { sigchld signull };
#line 39
    allow sandbox_domain test_open_seunshare_t:fifo_file { getattr read write append ioctl lock };
#line 39

#line 39
    dontaudit sandbox_domain test_open_seunshare_t:process signal;
#line 39
    dontaudit sandbox_domain test_open_seunshare_t:key { link read search view };
#line 39
    dontaudit sandbox_domain test_open_seunshare_t:unix_stream_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 39

#line 39
	 	
#line 39
##### end sandbox_transition(test_open_seunshare_t,test_open_r) depth: 3
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t test_open_seunshare_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t test_open_seunshare_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_t test_open_seunshare_t:lnk_file { getattr read };
#line 39
	allow test_open_t test_open_seunshare_t:process getattr;
#line 39

#line 39
	dontaudit test_open_seunshare_t test_open_t:file read;
#line 39
	allow test_open_t test_open_seunshare_t:process { sigchld sigkill sigstop signull signal };
#line 39
	allow test_open_t test_open_seunshare_t:fd use;
#line 39

#line 39
	allow test_open_seunshare_t test_open_t:process transition;
#line 39
	dontaudit test_open_seunshare_t test_open_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_bin_domtrans(test_open_seunshare_t,test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_bin_spec_domtrans(test_open_seunshare_t,test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_seunshare_t bin_t:dir { getattr search open };
#line 39
	allow test_open_seunshare_t bin_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_seunshare_t bin_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_seunshare_t test_open_t:process transition;
#line 39
#	dontaudit test_open_seunshare_t test_open_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_seunshare_t usr_t:dir { getattr search open };
#line 39
	allow test_open_seunshare_t usr_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_seunshare_t usr_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_seunshare_t test_open_t:process transition;
#line 39
#	dontaudit test_open_seunshare_t test_open_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_bin_spec_domtrans(test_open_seunshare_t,test_open_t) depth: 4
#line 39
 	
#line 39
	type_transition test_open_seunshare_t bin_t:process test_open_t;
#line 39
	type_transition test_open_seunshare_t usr_t:process test_open_t;
#line 39

#line 39
	 	
#line 39
##### end corecmd_bin_domtrans(test_open_seunshare_t,test_open_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_shell_domtrans(test_open_seunshare_t,test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type shell_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_shell_spec_domtrans(test_open_seunshare_t,test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t, shell_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_seunshare_t bin_t:dir { getattr search open };
#line 39
	allow test_open_seunshare_t bin_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_seunshare_t bin_t:dir { getattr search open };
#line 39
	allow test_open_seunshare_t bin_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_seunshare_t shell_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_seunshare_t test_open_t:process transition;
#line 39
#	dontaudit test_open_seunshare_t test_open_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_shell_spec_domtrans(test_open_seunshare_t,test_open_t) depth: 4
#line 39
 	
#line 39
	type_transition test_open_seunshare_t shell_exec_t:process test_open_t;
#line 39

#line 39
	 	
#line 39
##### end corecmd_shell_domtrans(test_open_seunshare_t,test_open_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end seunshare_role_template(test_open,test_open_r,test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin slrnpull_search_spool(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type slrnpull_spool_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_spool(test_open_usertype) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_spool_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_spool_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_spool(test_open_usertype) depth: 3
#line 39
 	
#line 39
	allow test_open_usertype slrnpull_spool_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end slrnpull_search_spool(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin thumb_role(test_open_r,test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type thumb_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin thumb_run(test_open_usertype,test_open_r) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type thumb_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin thumb_domtrans(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type thumb_t, thumb_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_search_bin(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_read_bin_symlinks(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype bin_t:dir { getattr search open };
#line 39
	allow test_open_usertype bin_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_read_bin_symlinks(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype bin_t:dir { getattr search open };
#line 39
	allow test_open_usertype bin_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_search_bin(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_usertype thumb_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_usertype thumb_t:process transition;
#line 39
#	dontaudit test_open_usertype thumb_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_usertype thumb_exec_t:process thumb_t;
#line 39

#line 39

#line 39
	allow thumb_t test_open_usertype:fd use;
#line 39
	allow thumb_t test_open_usertype:fifo_file { getattr read write append ioctl lock };
#line 39
	allow thumb_t test_open_usertype:process sigchld;
#line 39

#line 39
	dontaudit thumb_t test_open_usertype:unix_stream_socket { getattr read write };
#line 39

#line 39
	 	
#line 39
##### end thumb_domtrans(test_open_usertype) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin thumb_nnp_domtrans(test_open_usertype) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type thumb_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype thumb_t:process2 { nnp_transition nosuid_transition };
#line 39

#line 39

#line 39
	 	
#line 39
##### end thumb_nnp_domtrans(test_open_usertype) depth: 4
#line 39
 	
#line 39
	role test_open_r types thumb_t;
#line 39

#line 39
	allow test_open_usertype thumb_t:process { sigchld sigkill sigstop signull signal };
#line 39

#line 39
	dontaudit thumb_t test_open_usertype:dir { getattr search open read lock ioctl };
#line 39
	dontaudit thumb_t test_open_usertype:file { open { getattr read ioctl lock } };
#line 39
	dontaudit thumb_t test_open_usertype:unix_stream_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 39
    
#line 39
    allow thumb_t test_open_usertype:shm { associate getattr setattr create destroy read write lock unix_read unix_write };
#line 39
	allow thumb_t test_open_usertype:sem { associate getattr setattr create destroy read write unix_read unix_write };
#line 39

#line 39
	 	
#line 39
##### end thumb_run(test_open_usertype,test_open_r) depth: 3
#line 39
 	
#line 39

#line 39
	
#line 39
	allow test_open_usertype thumb_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_usertype thumb_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_usertype thumb_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype thumb_t:process getattr;
#line 39

#line 39
	allow thumb_t test_open_usertype:unix_stream_socket connectto;
#line 39

#line 39
	 	 	
#line 39
##### begin thumb_dbus_chat(test_open_usertype) depth: 4
#line 39
 	
#line 39
        
#line 39
	
#line 39
		require {
#line 39
			
#line 39
                type thumb_t;
#line 39
                class dbus send_msg;
#line 39
        
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
        allow test_open_usertype thumb_t:dbus send_msg;
#line 39
        allow thumb_t test_open_usertype:dbus send_msg;
#line 39
	
#line 39
	allow thumb_t test_open_usertype:dir { getattr search open read lock ioctl };
#line 39
	allow thumb_t test_open_usertype:file { open { getattr read ioctl lock } };
#line 39
	allow thumb_t test_open_usertype:lnk_file { getattr read };
#line 39
	allow thumb_t test_open_usertype:process getattr;
#line 39

#line 39

#line 39
	 	
#line 39
##### end thumb_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin thumb_filetrans_home_content(test_open_usertype) depth: 4
#line 39
 	
#line 39

#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type thumb_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin userdom_user_home_dir_filetrans(test_open_usertype,thumb_home_t,dir,".thumbnails") depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_dir_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_usertype user_home_dir_t:dir thumb_home_t ".thumbnails";
#line 39

#line 39
	 	 	
#line 39
##### begin files_search_home(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype home_root_t:dir { getattr search open };
#line 39
	allow test_open_usertype home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_search_home(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_user_home_dir_filetrans(test_open_usertype,thumb_home_t,dir,".thumbnails") depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin userdom_user_home_dir_filetrans(test_open_usertype,thumb_home_t,file,"missfont.log") depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_dir_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_usertype user_home_dir_t:file thumb_home_t "missfont.log";
#line 39

#line 39
	 	 	
#line 39
##### begin files_search_home(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype home_root_t:dir { getattr search open };
#line 39
	allow test_open_usertype home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_search_home(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_user_home_dir_filetrans(test_open_usertype,thumb_home_t,file,"missfont.log") depth: 4
#line 39
 	
#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin gnome_cache_filetrans(test_open_usertype,thumb_home_t,dir,"thumbnails") depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cache_home_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype cache_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_usertype cache_home_t:dir thumb_home_t "thumbnails";
#line 39

#line 39
	 	 	
#line 39
##### begin userdom_search_user_home_dirs(test_open_usertype) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_dir_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype user_home_dir_t:dir { getattr search open };
#line 39
	allow test_open_usertype user_home_dir_t:lnk_file { getattr read };
#line 39
	 	 	
#line 39
##### begin files_search_home(test_open_usertype) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype home_root_t:dir { getattr search open };
#line 39
	allow test_open_usertype home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_search_home(test_open_usertype) depth: 6
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end userdom_search_user_home_dirs(test_open_usertype) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end gnome_cache_filetrans(test_open_usertype,thumb_home_t,dir,"thumbnails") depth: 4
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	 	
#line 39
##### end thumb_filetrans_home_content(test_open_usertype) depth: 3
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end thumb_role(test_open_r,test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39
 	 	
#line 39
##### end userdom_common_user_template(test_open) depth: 1
#line 39
 	
#line 39

#line 39
	##############################
#line 39
	#
#line 39
	# Local policy
#line 39
	#
#line 39
	allow test_open_t self:capability { setgid chown fowner };
#line 39
    allow test_open_t self:bluetooth_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 39
    allow test_open_t self:alg_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 39
    allow test_open_t self:dccp_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 39
    allow test_open_t self:netlink_tcpdiag_socket { { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } } nlmsg_read nlmsg_write };
#line 39
    dontaudit test_open_t self:capability { setuid };
#line 39
    dontaudit test_open_t self:netlink_selinux_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_exec_chroot(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type chroot_exec_t;
#line 39
        type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_t chroot_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39
	allow test_open_t self:capability sys_chroot;
#line 39

#line 39
	 	
#line 39
##### end corecmd_exec_chroot(test_open_t) depth: 1
#line 39
 	
#line 39

#line 39
	# port access is audited even if dac would not have allowed it, so dontaudit it here
#line 39
#	corenet_dontaudit_tcp_bind_all_reserved_ports(test_open_t)
#line 39
	# Need the following rule to allow users to run vpnc
#line 39
	 	 	
#line 39
##### begin corenet_tcp_bind_xserver_port(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type xserver_port_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t xserver_port_t:tcp_socket name_bind;
#line 39
	allow test_open_t self:capability net_bind_service;
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_bind_xserver_port(test_open_t) depth: 1
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corenet_tcp_bind_generic_node(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type node_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype node_t:tcp_socket node_bind;
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_bind_generic_node(test_open_usertype) depth: 1
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin storage_rw_fuse(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type fuse_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t fuse_device_t:chr_file { open { getattr read write append ioctl lock } };
#line 39

#line 39
	 	
#line 39
##### end storage_rw_fuse(test_open_t) depth: 1
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin files_exec_usr_files(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t usr_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_t usr_t:dir { getattr search open };
#line 39
	allow test_open_t usr_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39

#line 39
	
#line 39
	allow test_open_t usr_t:dir { getattr search open };
#line 39
	allow test_open_t usr_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_exec_usr_files(test_open_t) depth: 1
#line 39
 	
#line 39
   # cjp: why?
#line 39
	 	 	
#line 39
##### begin files_read_kernel_symbol_table(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type boot_t, system_map_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t boot_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_t boot_t:dir { getattr search open };
#line 39
	allow test_open_t system_map_t:file { open { getattr read ioctl lock } };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_read_kernel_symbol_table(test_open_t) depth: 1
#line 39
 	
#line 39

#line 39
	
#line 39
		 	 	
#line 39
##### begin fs_exec_noxattr(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute noxattrfs;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t noxattrfs:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39

#line 39
	 	
#line 39
##### end fs_exec_noxattr(test_open_t) depth: 1
#line 39
 	
#line 39

#line 39
		
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool selinuxuser_rw_noexattrfile;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (selinuxuser_rw_noexattrfile) {
#line 39
		
#line 39
			 	 	
#line 39
##### begin fs_manage_noxattr_fs_files(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute noxattrfs;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t noxattrfs:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_t noxattrfs:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_noxattr_fs_files(test_open_t) depth: 1
#line 39
 	
#line 39
			 	 	
#line 39
##### begin fs_manage_noxattr_fs_dirs(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute noxattrfs;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t noxattrfs:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end fs_manage_noxattr_fs_dirs(test_open_t) depth: 1
#line 39
 	
#line 39
			# Write floppies
#line 39
			 	 	
#line 39
##### begin storage_raw_read_removable_device(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type removable_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_list_all_dev_nodes(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t device_t:dir { getattr search open };
#line 39
	allow test_open_t device_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_t device_t:dir { getattr search open };
#line 39
	allow test_open_t device_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_list_all_dev_nodes(test_open_t) depth: 2
#line 39
 	
#line 39
	allow test_open_t removable_device_t:blk_file { getattr open read lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end storage_raw_read_removable_device(test_open_t) depth: 1
#line 39
 	
#line 39
			 	 	
#line 39
##### begin storage_raw_write_removable_device(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type removable_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_list_all_dev_nodes(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t device_t:dir { getattr search open };
#line 39
	allow test_open_t device_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_t device_t:dir { getattr search open };
#line 39
	allow test_open_t device_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_list_all_dev_nodes(test_open_t) depth: 2
#line 39
 	
#line 39
	allow test_open_t removable_device_t:blk_file { getattr open write append lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end storage_raw_write_removable_device(test_open_t) depth: 1
#line 39
 	
#line 39
		
#line 39
	} else {
#line 39
		
#line 39
			 	 	
#line 39
##### begin storage_raw_read_removable_device(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type removable_device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_list_all_dev_nodes(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t device_t:dir { getattr search open };
#line 39
	allow test_open_t device_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_t device_t:dir { getattr search open };
#line 39
	allow test_open_t device_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_list_all_dev_nodes(test_open_t) depth: 2
#line 39
 	
#line 39
	allow test_open_t removable_device_t:blk_file { getattr open read lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end storage_raw_read_removable_device(test_open_t) depth: 1
#line 39
 	
#line 39
		
#line 39
	}
#line 39

#line 39
	
#line 39

#line 39
	 	 	
#line 39
##### begin miscfiles_read_hwdata(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type hwdata_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype hwdata_t:dir { getattr search open read lock ioctl };
#line 39
	
#line 39
	allow test_open_usertype hwdata_t:dir { getattr search open };
#line 39
	allow test_open_usertype hwdata_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	
#line 39
	allow test_open_usertype hwdata_t:dir { getattr search open };
#line 39
	allow test_open_usertype hwdata_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end miscfiles_read_hwdata(test_open_usertype) depth: 1
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin fs_mounton_fusefs(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type fusefs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype fusefs_t:dir mounton;
#line 39

#line 39
	 	
#line 39
##### end fs_mounton_fusefs(test_open_usertype) depth: 1
#line 39
 	
#line 39

#line 39
	# Allow users to run TCP servers (bind to ports and accept connection from
#line 39
	# the same domain and outside users) disabling this forces FTP passive mode
#line 39
	# and may change other protocols
#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool selinuxuser_share_music;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (selinuxuser_share_music) {
#line 39
		
#line 39
		 	 	
#line 39
##### begin corenet_tcp_bind_daap_port(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type daap_port_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype daap_port_t:tcp_socket name_bind;
#line 39
	
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_bind_daap_port(test_open_usertype) depth: 1
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool selinuxuser_tcp_server;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (selinuxuser_tcp_server) {
#line 39
		
#line 39
		 	 	
#line 39
##### begin corenet_tcp_bind_all_unreserved_ports(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute unreserved_port_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype unreserved_port_type:tcp_socket name_bind;
#line 39

#line 39
	 	
#line 39
##### end corenet_tcp_bind_all_unreserved_ports(test_open_usertype) depth: 1
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool selinuxuser_udp_server;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (selinuxuser_udp_server) {
#line 39
		
#line 39
		 	 	
#line 39
##### begin corenet_udp_bind_all_unreserved_ports(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute unreserved_port_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype unreserved_port_type:udp_socket name_bind;
#line 39

#line 39
	 	
#line 39
##### end corenet_udp_bind_all_unreserved_ports(test_open_usertype) depth: 1
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin cdrecord_role(test_open_r,test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute_role cdrecord_roles;
#line 39
		type cdrecord_t, cdrecord_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	roleattribute test_open_r cdrecord_roles;
#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t cdrecord_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t cdrecord_t:process transition;
#line 39
#	dontaudit test_open_t cdrecord_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t cdrecord_exec_t:process cdrecord_t;
#line 39

#line 39

#line 39
	allow cdrecord_t test_open_t:fd use;
#line 39
	allow cdrecord_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow cdrecord_t test_open_t:process sigchld;
#line 39

#line 39

#line 39
	allow cdrecord_t test_open_t:unix_stream_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 39

#line 39
	allow test_open_t cdrecord_t:process { sigchld sigkill sigstop signull signal };
#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool deny_ptrace;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (deny_ptrace) {
#line 39
		
#line 39
	} else {
#line 39
		
#line 39
		allow test_open_t cdrecord_t:process ptrace;
#line 39
	
#line 39
	}
#line 39

#line 39
	
#line 39
	allow test_open_t cdrecord_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t cdrecord_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_t cdrecord_t:lnk_file { getattr read };
#line 39
	allow test_open_t cdrecord_t:process getattr;
#line 39

#line 39

#line 39
	 	
#line 39
##### end cdrecord_role(test_open_r,test_open_t) depth: 1
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin cron_role(test_open_r,test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cronjob_t, crontab_t, crontab_exec_t;
#line 39
		type user_cron_spool_t, crond_t;
#line 39
        bool cron_userdomain_transition;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
    ##############################
#line 39
    #
#line 39
    # Declarations
#line 39
    #
#line 39

#line 39
	role test_open_r types { cronjob_t crontab_t };
#line 39

#line 39
    ##############################
#line 39
    #
#line 39
    # Local policy
#line 39
    #
#line 39

#line 39
	# Transition from the user domain to the derived domain.
#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t crontab_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t crontab_t:process transition;
#line 39
#	dontaudit test_open_t crontab_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t crontab_exec_t:process crontab_t;
#line 39

#line 39

#line 39
	allow crontab_t test_open_t:fd use;
#line 39
	allow crontab_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow crontab_t test_open_t:process sigchld;
#line 39

#line 39

#line 39
	dontaudit crond_t test_open_t:process { noatsecure siginh rlimitinh };
#line 39
	allow test_open_t crond_t:process sigchld;
#line 39

#line 39
    allow test_open_t user_cron_spool_t:file { getattr read write ioctl };
#line 39

#line 39
	# crontab shows up in user ps
#line 39
	allow test_open_t crontab_t:process { sigchld sigkill sigstop signull signal };
#line 39
	
#line 39
	allow test_open_t crontab_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t crontab_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_t crontab_t:lnk_file { getattr read };
#line 39
	allow test_open_t crontab_t:process getattr;
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool deny_ptrace;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (deny_ptrace) {
#line 39
		
#line 39
	} else {
#line 39
		
#line 39
		allow test_open_t crontab_t:process ptrace;
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	# Run helper programs as the user domain
#line 39
	#corecmd_bin_domtrans(crontab_t, test_open_t)
#line 39
	#corecmd_shell_domtrans(crontab_t, test_open_t)
#line 39
	 	 	
#line 39
##### begin corecmd_exec_bin(crontab_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow crontab_t bin_t:dir { getattr search open };
#line 39
	allow crontab_t bin_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow crontab_t bin_t:dir { getattr search open };
#line 39
	allow crontab_t bin_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	allow crontab_t bin_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39

#line 39
	
#line 39
		 	 	
#line 39
##### begin files_exec_all_base_ro_files(crontab_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute base_ro_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow crontab_t base_ro_file_type:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39

#line 39
	 	
#line 39
##### end files_exec_all_base_ro_files(crontab_t) depth: 3
#line 39
 	
#line 39
	
#line 39

#line 39
	 	
#line 39
##### end corecmd_exec_bin(crontab_t) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin corecmd_exec_shell(crontab_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t, shell_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow crontab_t bin_t:dir { getattr search open };
#line 39
	allow crontab_t bin_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow crontab_t bin_t:dir { getattr search open };
#line 39
	allow crontab_t bin_t:lnk_file { getattr read };
#line 39

#line 39
	allow crontab_t shell_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 39

#line 39
	 	
#line 39
##### end corecmd_exec_shell(crontab_t) depth: 2
#line 39
 	
#line 39

#line 39
    
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool cron_userdomain_transition;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (cron_userdomain_transition) {
#line 39
		
#line 39
        allow crond_t test_open_t:process transition;
#line 39
        allow crond_t test_open_t:fd use;
#line 39
        allow crond_t test_open_t:key { create link read search setattr view write } ;
#line 39

#line 39
	    # needs to be authorized SELinux context for cron
#line 39
	    allow test_open_t user_cron_spool_t:file entrypoint;
#line 39
        allow test_open_t crond_t:fifo_file { open { getattr read write append ioctl lock } };
#line 39

#line 39
        allow test_open_t cronjob_t:process { { sigchld sigkill sigstop signull signal } };
#line 39

#line 39
        
#line 39
	allow test_open_t cronjob_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_t cronjob_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_t cronjob_t:lnk_file { getattr read };
#line 39
	allow test_open_t cronjob_t:process getattr;
#line 39

#line 39
    
#line 39
	} else {
#line 39
		
#line 39
        dontaudit crond_t test_open_t:process transition;
#line 39
        dontaudit crond_t test_open_t:fd use;
#line 39
        dontaudit crond_t test_open_t:key { create link read search setattr view write } ;
#line 39

#line 39
        dontaudit test_open_t user_cron_spool_t:file entrypoint;
#line 39

#line 39
        dontaudit test_open_t crond_t:fifo_file { open { getattr read write append ioctl lock } };
#line 39

#line 39
        dontaudit test_open_t cronjob_t:process { { sigchld sigkill sigstop signull signal } };
#line 39
    
#line 39
	}
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		
#line 39
	
#line 39
		require {
#line 39
			
#line 39
			class dbus send_msg;
#line 39
		
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
		 	 	
#line 39
##### begin dbus_stub(cronjob_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type system_dbusd_t;
#line 39
		class dbus { acquire_svc send_msg };
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	
#line 39
##### end dbus_stub(cronjob_t) depth: 2
#line 39
 	
#line 39

#line 39
		allow cronjob_t test_open_t:dbus send_msg;
#line 39
	
#line 39
	}
#line 39
		
#line 39

#line 39
	 	
#line 39
##### end cron_role(test_open_r,test_open_t) depth: 1
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
         	 	
#line 39
##### begin games_manage_data_files(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type games_data_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var_lib(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_lib_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype var_t:dir { getattr search open };
#line 39
	allow test_open_usertype var_lib_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_var_lib(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype games_data_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_usertype games_data_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end games_manage_data_files(test_open_usertype) depth: 1
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin gpg_role(test_open_r,test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
        attribute_role gpg_roles, gpg_agent_roles, gpg_helper_roles, gpg_pinentry_roles;
#line 39
		type gpg_t, gpg_exec_t;
#line 39
		type gpg_agent_t, gpg_agent_exec_t;
#line 39
		type gpg_agent_tmp_t;
#line 39
		type gpg_helper_t, gpg_pinentry_t;
#line 39
		type gpg_pinentry_tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
    roleattribute test_open_r gpg_roles;
#line 39
    roleattribute test_open_r gpg_agent_roles;
#line 39
    roleattribute test_open_r gpg_helper_roles;
#line 39
    roleattribute test_open_r gpg_pinentry_roles;
#line 39

#line 39
	# transition from the userdomain to the derived domain
#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_usertype gpg_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_usertype gpg_t:process transition;
#line 39
#	dontaudit test_open_usertype gpg_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_usertype gpg_exec_t:process gpg_t;
#line 39

#line 39

#line 39
	allow gpg_t test_open_usertype:fd use;
#line 39
	allow gpg_t test_open_usertype:fifo_file { getattr read write append ioctl lock };
#line 39
	allow gpg_t test_open_usertype:process sigchld;
#line 39

#line 39

#line 39
	# allow ps to show gpg
#line 39
	
#line 39
	allow test_open_usertype gpg_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_usertype gpg_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_usertype gpg_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype gpg_t:process getattr;
#line 39

#line 39
	allow test_open_usertype gpg_t:process { signull sigstop signal sigkill };
#line 39

#line 39
	# communicate with the user
#line 39
	allow gpg_helper_t test_open_usertype:fd use;
#line 39
	allow gpg_helper_t test_open_usertype:fifo_file write;
#line 39

#line 39
	# allow ps to show gpg-agent
#line 39
	
#line 39
	allow test_open_usertype gpg_agent_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_usertype gpg_agent_t:file { open { getattr read ioctl lock } };
#line 39
	allow test_open_usertype gpg_agent_t:lnk_file { getattr read };
#line 39
	allow test_open_usertype gpg_agent_t:process getattr;
#line 39

#line 39

#line 39
	# Allow the user shell to signal the gpg-agent program.
#line 39
	allow test_open_usertype gpg_agent_t:process { signal sigkill };
#line 39

#line 39
	
#line 39
	allow test_open_usertype gpg_agent_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_usertype gpg_agent_tmp_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype gpg_agent_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_usertype gpg_agent_tmp_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_usertype gpg_agent_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_usertype gpg_agent_tmp_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 39

#line 39
	 	 	
#line 39
##### begin files_tmp_filetrans(gpg_agent_t,gpg_agent_tmp_t,{ file sock_file dir }) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow gpg_agent_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition gpg_agent_t tmp_t:{ file sock_file dir } gpg_agent_tmp_t ;
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_tmp_filetrans(gpg_agent_t,gpg_agent_tmp_t,{ file sock_file dir }) depth: 2
#line 39
 	
#line 39

#line 39
	# Transition from the user domain to the agent domain.
#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_usertype gpg_agent_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_usertype gpg_agent_t:process transition;
#line 39
#	dontaudit test_open_usertype gpg_agent_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_usertype gpg_agent_exec_t:process gpg_agent_t;
#line 39

#line 39

#line 39
	allow gpg_agent_t test_open_usertype:fd use;
#line 39
	allow gpg_agent_t test_open_usertype:fifo_file { getattr read write append ioctl lock };
#line 39
	allow gpg_agent_t test_open_usertype:process sigchld;
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype gpg_pinentry_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_usertype gpg_pinentry_tmp_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 39

#line 39
	
#line 39
	allow test_open_usertype gpg_pinentry_tmp_t:dir { getattr search open };
#line 39
	allow test_open_usertype gpg_pinentry_tmp_t:sock_file { getattr relabelfrom relabelto };
#line 39

#line 39

#line 39
	allow gpg_pinentry_t test_open_usertype:fifo_file { read write };
#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin gpg_pinentry_dbus_chat(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type gpg_pinentry_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_usertype gpg_pinentry_t:dbus send_msg;
#line 39
	allow gpg_pinentry_t test_open_usertype:dbus send_msg;
#line 39

#line 39
	 	
#line 39
##### end gpg_pinentry_dbus_chat(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	allow test_open_usertype gpg_agent_t:unix_stream_socket { { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } connectto };
#line 39
	
#line 39
		#Leaked File Descriptors
#line 39
		dontaudit gpg_t test_open_usertype:fifo_file { open { getattr read write append ioctl lock } };
#line 39
		dontaudit gpg_agent_t test_open_usertype:fifo_file { open { getattr read write append ioctl lock } };
#line 39
	
#line 39

#line 39
	 	
#line 39
##### end gpg_role(test_open_r,test_open_usertype) depth: 1
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin systemd_dbus_chat_timedated(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type systemd_timedated_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t systemd_timedated_t:dbus send_msg;
#line 39
	allow systemd_timedated_t test_open_t:dbus send_msg;
#line 39
	
#line 39
	allow systemd_timedated_t test_open_t:dir { getattr search open read lock ioctl };
#line 39
	allow systemd_timedated_t test_open_t:file { open { getattr read ioctl lock } };
#line 39
	allow systemd_timedated_t test_open_t:lnk_file { getattr read };
#line 39
	allow systemd_timedated_t test_open_t:process getattr;
#line 39

#line 39

#line 39
	 	
#line 39
##### end systemd_dbus_chat_timedated(test_open_t) depth: 1
#line 39
 	
#line 39
		 	 	
#line 39
##### begin systemd_dbus_chat_hostnamed(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type systemd_hostnamed_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t systemd_hostnamed_t:dbus send_msg;
#line 39
	allow systemd_hostnamed_t test_open_t:dbus send_msg;
#line 39
	
#line 39
	allow systemd_hostnamed_t test_open_t:dir { getattr search open read lock ioctl };
#line 39
	allow systemd_hostnamed_t test_open_t:file { open { getattr read ioctl lock } };
#line 39
	allow systemd_hostnamed_t test_open_t:lnk_file { getattr read };
#line 39
	allow systemd_hostnamed_t test_open_t:process getattr;
#line 39

#line 39

#line 39
	 	
#line 39
##### end systemd_dbus_chat_hostnamed(test_open_t) depth: 1
#line 39
 	
#line 39
		 	 	
#line 39
##### begin systemd_dbus_chat_localed(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type systemd_localed_t;
#line 39
		class dbus send_msg;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t systemd_localed_t:dbus send_msg;
#line 39
	allow systemd_localed_t test_open_t:dbus send_msg;
#line 39
	
#line 39
	allow systemd_localed_t test_open_t:dir { getattr search open read lock ioctl };
#line 39
	allow systemd_localed_t test_open_t:file { open { getattr read ioctl lock } };
#line 39
	allow systemd_localed_t test_open_t:lnk_file { getattr read };
#line 39
	allow systemd_localed_t test_open_t:process getattr;
#line 39

#line 39

#line 39
	 	
#line 39
##### end systemd_dbus_chat_localed(test_open_t) depth: 1
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin gpm_stream_connect(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type gpmctl_t, gpm_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin dev_list_all_dev_nodes(test_open_usertype) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type device_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype device_t:dir { getattr search open read lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_usertype device_t:dir { getattr search open };
#line 39
	allow test_open_usertype device_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end dev_list_all_dev_nodes(test_open_usertype) depth: 2
#line 39
 	
#line 39
	
#line 39
	allow test_open_usertype gpmctl_t:dir { getattr search open };
#line 39
	allow test_open_usertype gpmctl_t:sock_file { getattr write open append };
#line 39
	allow test_open_usertype gpm_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end gpm_stream_connect(test_open_usertype) depth: 1
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin mount_run_fusermount(test_open_t,test_open_r) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type mount_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin mount_domtrans_fusermount(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type mount_t, fusermount_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t fusermount_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t mount_t:process transition;
#line 39
#	dontaudit test_open_t mount_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t fusermount_exec_t:process mount_t;
#line 39

#line 39

#line 39
	allow mount_t test_open_t:fd use;
#line 39
	allow mount_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow mount_t test_open_t:process sigchld;
#line 39

#line 39
	
#line 39
	allow mount_t test_open_t:dir { getattr search open read lock ioctl };
#line 39
	allow mount_t test_open_t:file { open { getattr read ioctl lock } };
#line 39
	allow mount_t test_open_t:lnk_file { getattr read };
#line 39
	allow mount_t test_open_t:process getattr;
#line 39

#line 39

#line 39
	allow mount_t test_open_t:unix_stream_socket { read write };
#line 39
	allow test_open_t mount_t:fd use;
#line 39

#line 39
	 	
#line 39
##### end mount_domtrans_fusermount(test_open_t) depth: 2
#line 39
 	
#line 39
	role test_open_r types mount_t;
#line 39

#line 39
	 	 	
#line 39
##### begin fstools_run(mount_t,test_open_r) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type fsadm_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin fstools_domtrans(mount_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type fsadm_t, fsadm_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_search_bin(mount_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_read_bin_symlinks(mount_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow mount_t bin_t:dir { getattr search open };
#line 39
	allow mount_t bin_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_read_bin_symlinks(mount_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow mount_t bin_t:dir { getattr search open };
#line 39
	allow mount_t bin_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_search_bin(mount_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
	
#line 39
	allow mount_t fsadm_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow mount_t fsadm_t:process transition;
#line 39
#	dontaudit mount_t fsadm_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition mount_t fsadm_exec_t:process fsadm_t;
#line 39

#line 39

#line 39
	allow fsadm_t mount_t:fd use;
#line 39
	allow fsadm_t mount_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow fsadm_t mount_t:process sigchld;
#line 39

#line 39

#line 39
	 	
#line 39
##### end fstools_domtrans(mount_t) depth: 3
#line 39
 	
#line 39
	role test_open_r types fsadm_t;
#line 39

#line 39
	 	
#line 39
##### end fstools_run(mount_t,test_open_r) depth: 2
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end mount_run_fusermount(test_open_t,test_open_r) depth: 1
#line 39
 	
#line 39
		 	 	
#line 39
##### begin mount_read_pid_files(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type mount_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t mount_var_run_t:dir { getattr search open };
#line 39
	allow test_open_t mount_var_run_t:file { open { getattr read ioctl lock } };
#line 39

#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t var_t:lnk_file { getattr read };
#line 39
	allow test_open_t var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_t var_t:dir { getattr search open };
#line 39
	allow test_open_t var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_t) depth: 2
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end mount_read_pid_files(test_open_t) depth: 1
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin wine_role_template(test_open,test_open_r,test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type wine_t;
#line 39
		attribute wine_domain;
#line 39
		type wine_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	type test_open_wine_t, wine_domain;
#line 39
	 	 	
#line 39
##### begin domain_type(test_open_wine_t) depth: 3
#line 39
 	
#line 39
	# start with basic domain
#line 39
	 	 	
#line 39
##### begin domain_base_type(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wine_t domain;
#line 39

#line 39
	 	
#line 39
##### end domain_base_type(test_open_wine_t) depth: 3
#line 39
 	
#line 39

#line 39
	# Only way to get corenet_unlabeled packets disabled to work
#line 39
	 	 	
#line 39
##### begin corenet_all_recvfrom_unlabeled(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
                attribute corenet_unlabeled_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	typeattribute test_open_wine_t corenet_unlabeled_type;
#line 39

#line 39
	 	
#line 39
##### end corenet_all_recvfrom_unlabeled(test_open_wine_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end domain_type(test_open_wine_t) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin domain_entry_file(test_open_wine_t,wine_exec_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute entry_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wine_t wine_exec_t:file entrypoint;
#line 39
	allow test_open_wine_t wine_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 39

#line 39
	typeattribute wine_exec_t entry_type;
#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_executable_file(wine_exec_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute exec_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute wine_exec_t exec_type;
#line 39

#line 39
	 	 	
#line 39
##### begin files_type(wine_exec_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute wine_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 39

#line 39
	 	
#line 39
##### end files_type(wine_exec_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end corecmd_executable_file(wine_exec_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end domain_entry_file(test_open_wine_t,wine_exec_t) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin ubac_constrained(test_open_wine_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute ubac_constrained_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wine_t ubac_constrained_type;
#line 39

#line 39
	 	
#line 39
##### end ubac_constrained(test_open_wine_t) depth: 2
#line 39
 	
#line 39
	role test_open_r types test_open_wine_t;
#line 39
	allow test_open_t test_open_wine_t:process { getattr noatsecure { sigchld sigkill sigstop signull signal } };
#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t wine_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t test_open_wine_t:process transition;
#line 39
#	dontaudit test_open_t test_open_wine_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t wine_exec_t:process test_open_wine_t;
#line 39

#line 39

#line 39
	allow test_open_wine_t test_open_t:fd use;
#line 39
	allow test_open_wine_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow test_open_wine_t test_open_t:process sigchld;
#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_bin_domtrans(test_open_wine_t,test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_bin_spec_domtrans(test_open_wine_t,test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
		type usr_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wine_t bin_t:dir { getattr search open };
#line 39
	allow test_open_wine_t bin_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t bin_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_wine_t test_open_t:process transition;
#line 39
#	dontaudit test_open_wine_t test_open_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wine_t usr_t:dir { getattr search open };
#line 39
	allow test_open_wine_t usr_t:lnk_file { getattr read };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t usr_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_wine_t test_open_t:process transition;
#line 39
#	dontaudit test_open_wine_t test_open_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_bin_spec_domtrans(test_open_wine_t,test_open_t) depth: 3
#line 39
 	
#line 39
	type_transition test_open_wine_t bin_t:process test_open_t;
#line 39
	type_transition test_open_wine_t usr_t:process test_open_t;
#line 39

#line 39
	 	
#line 39
##### end corecmd_bin_domtrans(test_open_wine_t,test_open_t) depth: 2
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin userdom_unpriv_usertype(test_open,test_open_wine_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute unpriv_userdomain, userdomain;
#line 39
		attribute test_open_usertype;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	typeattribute test_open_wine_t  test_open_usertype;
#line 39
	typeattribute test_open_wine_t  unpriv_userdomain;
#line 39
	typeattribute test_open_wine_t  userdomain;
#line 39
	
#line 39
	 	 	
#line 39
##### begin auth_use_nsswitch(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute nsswitch_domain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wine_t nsswitch_domain;
#line 39

#line 39
	 	 	
#line 39
##### begin corenet_all_recvfrom_netlabel(test_open_wine_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute netlabel_peer_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wine_t netlabel_peer_type;
#line 39

#line 39
	 	
#line 39
##### end corenet_all_recvfrom_netlabel(test_open_wine_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end auth_use_nsswitch(test_open_wine_t) depth: 3
#line 39
 	
#line 39
	 	 	
#line 39
##### begin ubac_constrained(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute ubac_constrained_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wine_t ubac_constrained_type;
#line 39

#line 39
	 	
#line 39
##### end ubac_constrained(test_open_wine_t) depth: 3
#line 39
 	
#line 39
 	 	
#line 39
##### end userdom_unpriv_usertype(test_open,test_open_wine_t) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin userdom_manage_tmp_role(test_open_r,test_open_wine_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute user_tmp_type;
#line 39
		type user_tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	role test_open_r types user_tmp_t;
#line 39

#line 39
	 	 	
#line 39
##### begin files_poly_member_tmp(test_open_wine_t,user_tmp_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	type_member test_open_wine_t tmp_t:dir user_tmp_t;
#line 39

#line 39
	 	
#line 39
##### end files_poly_member_tmp(test_open_wine_t,user_tmp_t) depth: 3
#line 39
 	
#line 39

#line 39
	allow test_open_wine_t user_tmp_type:dir mounton;
#line 39
	
#line 39
	allow test_open_wine_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t user_tmp_type:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t user_tmp_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t user_tmp_type:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t user_tmp_type:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t user_tmp_type:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	 	 	
#line 39
##### begin files_tmp_filetrans(test_open_wine_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wine_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_wine_t tmp_t:{ dir file lnk_file sock_file fifo_file } user_tmp_t ;
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_tmp_filetrans(test_open_wine_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 3
#line 39
 	
#line 39
     	 	
#line 39
##### begin fs_tmpfs_filetrans(test_open_wine_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow user_tmp_t tmpfs_t:filesystem associate;
#line 39
	
#line 39
	allow test_open_wine_t tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	type_transition test_open_wine_t tmpfs_t:{ dir file lnk_file sock_file fifo_file } user_tmp_t ;
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_tmpfs_filetrans(test_open_wine_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_wine_t user_tmp_type:dir { getattr search open };
#line 39
	allow test_open_wine_t user_tmp_type:dir { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_tmp_type:dir { getattr search open };
#line 39
	allow test_open_wine_t user_tmp_type:file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_tmp_type:dir { getattr search open };
#line 39
	allow test_open_wine_t user_tmp_type:lnk_file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_tmp_type:dir { getattr search open };
#line 39
	allow test_open_wine_t user_tmp_type:sock_file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_tmp_type:dir { getattr search open };
#line 39
	allow test_open_wine_t user_tmp_type:fifo_file { getattr relabelfrom relabelto };
#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_manage_tmp_role(test_open_r,test_open_wine_t) depth: 2
#line 39
 	
#line 39
	 	 	
#line 39
##### begin userdom_manage_home_role(test_open_r ,test_open_wine_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_home_t, user_home_dir_t;
#line 39
		attribute user_home_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	role test_open_r  types { user_home_type user_home_dir_t };
#line 39

#line 39
	##############################
#line 39
	#
#line 39
	# Domain access to home dir
#line 39
	#
#line 39

#line 39
	type_member test_open_wine_t user_home_dir_t:dir user_home_dir_t;
#line 39

#line 39
	# full control of the home directory
#line 39
	allow test_open_wine_t user_home_t:dir mounton;
#line 39
	allow test_open_wine_t user_home_t:file entrypoint;
#line 39

#line 39
	allow test_open_wine_t user_home_type:{ dir file lnk_file sock_file fifo_file chr_file blk_file } { relabelto relabelfrom };
#line 39
	allow test_open_wine_t user_home_dir_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_wine_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t user_home_type:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t user_home_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t user_home_type:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t user_home_type:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t user_home_type:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 39
	allow test_open_wine_t user_home_type:dir { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 39
	allow test_open_wine_t user_home_type:file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 39
	allow test_open_wine_t user_home_type:lnk_file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 39
	allow test_open_wine_t user_home_type:sock_file { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 39
	allow test_open_wine_t user_home_type:fifo_file { getattr relabelfrom relabelto };
#line 39

#line 39
	 	 	
#line 39
##### begin userdom_filetrans_home_content(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
	        attribute userdom_filetrans_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wine_t  userdom_filetrans_type;
#line 39

#line 39
	 	
#line 39
##### end userdom_filetrans_home_content(test_open_wine_t) depth: 3
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin files_list_home(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type home_root_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wine_t home_root_t:dir { getattr search open read lock ioctl };
#line 39
	allow test_open_wine_t home_root_t:lnk_file { getattr read };
#line 39

#line 39
	 	
#line 39
##### end files_list_home(test_open_wine_t) depth: 3
#line 39
 	
#line 39

#line 39
	# cjp: this should probably be removed:
#line 39
	allow test_open_wine_t user_home_dir_t:dir { { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl } { getattr relabelfrom relabelto } };
#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool use_nfs_home_dirs;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (use_nfs_home_dirs) {
#line 39
		
#line 39
		 	 	
#line 39
##### begin fs_mount_nfs(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wine_t nfs_t:filesystem mount;
#line 39

#line 39
	 	
#line 39
##### end fs_mount_nfs(test_open_wine_t) depth: 3
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_mounton_nfs(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wine_t nfs_t:dir mounton;
#line 39

#line 39
	 	
#line 39
##### end fs_mounton_nfs(test_open_wine_t) depth: 3
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_nfs_dirs(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin fs_search_auto_mountpoints(test_open_wine_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type autofs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wine_t autofs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_auto_mountpoints(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	allow test_open_wine_t nfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end fs_manage_nfs_dirs(test_open_wine_t) depth: 3
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_nfs_files(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin fs_search_auto_mountpoints(test_open_wine_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type autofs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wine_t autofs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_auto_mountpoints(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow test_open_wine_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t nfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_nfs_files(test_open_wine_t) depth: 3
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_nfs_symlinks(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin fs_search_auto_mountpoints(test_open_wine_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type autofs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wine_t autofs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_auto_mountpoints(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow test_open_wine_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t nfs_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_nfs_symlinks(test_open_wine_t) depth: 3
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_nfs_named_sockets(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wine_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t nfs_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_nfs_named_sockets(test_open_wine_t) depth: 3
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_nfs_named_pipes(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type nfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wine_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t nfs_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_nfs_named_pipes(test_open_wine_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool use_samba_home_dirs;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (use_samba_home_dirs) {
#line 39
		
#line 39
		 	 	
#line 39
##### begin fs_mount_cifs(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wine_t cifs_t:filesystem mount;
#line 39

#line 39
	 	
#line 39
##### end fs_mount_cifs(test_open_wine_t) depth: 3
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_mounton_cifs(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wine_t cifs_t:dir mounton;
#line 39

#line 39
	 	
#line 39
##### end fs_mounton_cifs(test_open_wine_t) depth: 3
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_cifs_dirs(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wine_t cifs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	 	
#line 39
##### end fs_manage_cifs_dirs(test_open_wine_t) depth: 3
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_cifs_files(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wine_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t cifs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_cifs_files(test_open_wine_t) depth: 3
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_cifs_symlinks(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wine_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t cifs_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_cifs_symlinks(test_open_wine_t) depth: 3
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_cifs_named_sockets(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wine_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t cifs_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_cifs_named_sockets(test_open_wine_t) depth: 3
#line 39
 	
#line 39
		 	 	
#line 39
##### begin fs_manage_cifs_named_pipes(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type cifs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wine_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t cifs_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39

#line 39
	 	
#line 39
##### end fs_manage_cifs_named_pipes(test_open_wine_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_manage_home_role(test_open_r ,test_open_wine_t) depth: 2
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin domain_mmap_low(test_open_wine_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute mmap_low_domain_type;
#line 39
		bool mmap_low_allowed;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wine_t mmap_low_domain_type;
#line 39

#line 39
	if ( mmap_low_allowed ) {
#line 39
		allow test_open_wine_t self:memprotect mmap_zero;
#line 39
	}
#line 39

#line 39
	 	
#line 39
##### end domain_mmap_low(test_open_wine_t) depth: 2
#line 39
 	
#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin xserver_role(test_open_r,test_open_wine_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type iceauth_home_t, xserver_t, xserver_tmpfs_t, xauth_home_t;
#line 39
		type user_fonts_t, user_fonts_cache_t, user_fonts_config_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin xserver_restricted_role(test_open_r,test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type xauth_t, iceauth_t;
#line 39
		attribute dridomain, x_userdomain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	role test_open_r types { xauth_t iceauth_t };
#line 39
	typeattribute test_open_wine_t x_userdomain, dridomain;
#line 39

#line 39
	 	 	
#line 39
##### begin xserver_common_x_domain_template(user,test_open_wine_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type root_xdrawable_t, xdm_t, xserver_t;
#line 39
		type xproperty_t, user_xproperty_t;
#line 39
		type xevent_t, client_xevent_t;
#line 39
		type input_xevent_t, user_input_xevent_t;
#line 39

#line 39
		attribute x_domain, input_xevent_type;
#line 39
		attribute xdrawable_type, xcolormap_type;
#line 39

#line 39
		class x_drawable { create destroy read write blend getattr setattr list_child add_child remove_child list_property get_property set_property manage override show hide send receive };
#line 39
		class x_property { create destroy read write append getattr setattr };
#line 39
		class x_event { send receive };
#line 39
		class x_synthetic_event { send receive };
#line 39
		class x_client destroy;
#line 39
		class x_server manage;
#line 39
		class x_screen { saver_setattr saver_hide saver_show show_cursor hide_cursor };
#line 39
		class x_pointer { get_property set_property manage };
#line 39
		class x_keyboard { read manage freeze };
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	##############################
#line 39
	#
#line 39
	# Local Policy
#line 39
	#
#line 39

#line 39
	# Type attributes
#line 39
	typeattribute test_open_wine_t x_domain;
#line 39
	typeattribute test_open_wine_t xdrawable_type, xcolormap_type;
#line 39

#line 39
	# X Properties
#line 39
	# disable property transitions for the time being.
#line 39
#	type_transition test_open_wine_t xproperty_t:x_property user_xproperty_t;
#line 39

#line 39
	# X Windows
#line 39
	# new windows have the domain type
#line 39
	type_transition test_open_wine_t root_xdrawable_t:x_drawable test_open_wine_t;
#line 39

#line 39
	# X Input
#line 39
	# distinguish input events
#line 39
	type_transition test_open_wine_t input_xevent_t:x_event user_input_xevent_t;
#line 39
	# can send own events
#line 39
	allow test_open_wine_t user_input_xevent_t:{ x_event x_synthetic_event } send;
#line 39
	# can receive own events
#line 39
	allow test_open_wine_t user_input_xevent_t:{ x_event x_synthetic_event } receive;
#line 39
	# can receive default events
#line 39
	allow test_open_wine_t client_xevent_t:{ x_event x_synthetic_event } receive;
#line 39
	allow test_open_wine_t xevent_t:{ x_event x_synthetic_event } { send receive };
#line 39
	# dont audit send failures
#line 39
	dontaudit test_open_wine_t input_xevent_type:x_event send;
#line 39

#line 39
	allow test_open_wine_t xdm_t:x_drawable { hide read add_child manage };
#line 39
	allow test_open_wine_t xdm_t:x_client destroy;
#line 39

#line 39
	allow test_open_wine_t root_xdrawable_t:x_drawable write;
#line 39
	allow test_open_wine_t xserver_t:x_server manage;
#line 39
	allow test_open_wine_t xserver_t:x_screen { show_cursor hide_cursor saver_setattr saver_hide saver_show };
#line 39
	allow test_open_wine_t xserver_t:x_pointer { get_property set_property manage };
#line 39
	allow test_open_wine_t xserver_t:x_keyboard { read manage freeze };
#line 39
 	 	
#line 39
##### end xserver_common_x_domain_template(user,test_open_wine_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin xserver_stream_connect_xdm(test_open_wine_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type xdm_t, xdm_var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_tmp(test_open_wine_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmp_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin fs_search_tmpfs(test_open_wine_t) depth: 7
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type tmpfs_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wine_t tmpfs_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end fs_search_tmpfs(test_open_wine_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	allow test_open_wine_t tmp_t:dir { getattr search open };
#line 39
	allow test_open_wine_t tmp_t:lnk_file { getattr read };
#line 39

#line 39
	allow test_open_wine_t tmp_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_tmp(test_open_wine_t) depth: 5
#line 39
 	
#line 39
	 	 	
#line 39
##### begin files_search_pids(test_open_wine_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_wine_t var_t:lnk_file { getattr read };
#line 39
	allow test_open_wine_t var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_wine_t var_t:dir { getattr search open };
#line 39
	allow test_open_wine_t var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_wine_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	allow test_open_wine_t { xdm_var_run_t }:dir { getattr search open };
#line 39
	allow test_open_wine_t { xdm_var_run_t }:sock_file { getattr write open append };
#line 39
	allow test_open_wine_t xdm_t:unix_stream_socket connectto;
#line 39

#line 39
     	 	
#line 39
##### begin userdom_stream_connect(test_open_wine_t) depth: 6
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type user_tmp_t;
#line 39
		attribute userdomain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_tmp_t:dir { getattr search open };
#line 39
	allow test_open_wine_t user_tmp_t:sock_file { getattr write open append };
#line 39
	allow test_open_wine_t userdomain:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end userdom_stream_connect(test_open_wine_t) depth: 5
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end xserver_stream_connect_xdm(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	 	 	
#line 39
##### begin xserver_xdm_append_log(test_open_wine_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type xdm_log_t;
#line 39
		attribute xdmhomewriter;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wine_t xdmhomewriter;
#line 39
	allow test_open_wine_t xdm_log_t:file { getattr append };
#line 39

#line 39
	 	
#line 39
##### end xserver_xdm_append_log(test_open_wine_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	 	
#line 39
##### begin xserver_dri_domain(test_open_wine_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute dridomain;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wine_t dridomain;
#line 39

#line 39
	 	
#line 39
##### end xserver_dri_domain(test_open_wine_t) depth: 4
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end xserver_restricted_role(test_open_r,test_open_wine_t) depth: 3
#line 39
 	
#line 39

#line 39
	# Communicate via System V shared memory.
#line 39
	allow test_open_wine_t xserver_t:shm { associate getattr read write lock unix_read unix_write };
#line 39
	allow test_open_wine_t xserver_tmpfs_t:file { open { getattr read write append ioctl lock } };
#line 39

#line 39
	allow test_open_wine_t iceauth_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39
	allow test_open_wine_t iceauth_home_t:file { getattr relabelfrom relabelto };
#line 39

#line 39
	allow test_open_wine_t xauth_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39
	allow test_open_wine_t xauth_home_t:file { getattr relabelfrom relabelto };
#line 39

#line 39
	 	 	
#line 39
##### begin mls_xwin_read_to_clearance(test_open_wine_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute mlsxwinreadtoclr;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	typeattribute test_open_wine_t mlsxwinreadtoclr;
#line 39

#line 39
	 	
#line 39
##### end mls_xwin_read_to_clearance(test_open_wine_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	allow test_open_wine_t user_fonts_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t user_fonts_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_fonts_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t user_fonts_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	allow test_open_wine_t user_fonts_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_wine_t user_fonts_t:dir { getattr search open };
#line 39
	allow test_open_wine_t user_fonts_t:dir { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_fonts_t:dir { getattr search open };
#line 39
	allow test_open_wine_t user_fonts_t:file { getattr relabelfrom relabelto };
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_fonts_cache_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t user_fonts_cache_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_fonts_cache_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t user_fonts_cache_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_fonts_cache_t:dir { getattr search open };
#line 39
	allow test_open_wine_t user_fonts_cache_t:dir { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_fonts_cache_t:dir { getattr search open };
#line 39
	allow test_open_wine_t user_fonts_cache_t:file { getattr relabelfrom relabelto };
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_fonts_config_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t user_fonts_config_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_fonts_config_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 39
	allow test_open_wine_t user_fonts_config_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_fonts_config_t:dir { getattr search open };
#line 39
	allow test_open_wine_t user_fonts_config_t:dir { getattr relabelfrom relabelto };
#line 39

#line 39
	
#line 39
	allow test_open_wine_t user_fonts_config_t:dir { getattr search open };
#line 39
	allow test_open_wine_t user_fonts_config_t:file { getattr relabelfrom relabelto };
#line 39

#line 39

#line 39
	 	
#line 39
##### end xserver_role(test_open_r,test_open_wine_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39
 	 	
#line 39
##### end wine_role_template(test_open,test_open_r,test_open_t) depth: 1
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin postfix_run_postdrop(test_open_t,test_open_r) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type postfix_postdrop_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin postfix_domtrans_postdrop(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type postfix_postdrop_t, postfix_postdrop_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t postfix_postdrop_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t postfix_postdrop_t:process transition;
#line 39
#	dontaudit test_open_t postfix_postdrop_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t postfix_postdrop_exec_t:process postfix_postdrop_t;
#line 39

#line 39

#line 39
	allow postfix_postdrop_t test_open_t:fd use;
#line 39
	allow postfix_postdrop_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow postfix_postdrop_t test_open_t:process sigchld;
#line 39

#line 39
    allow test_open_t postfix_postdrop_exec_t:file map;
#line 39

#line 39
	 	
#line 39
##### end postfix_domtrans_postdrop(test_open_t) depth: 2
#line 39
 	
#line 39
	role test_open_r types postfix_postdrop_t;
#line 39
	allow postfix_postdrop_t test_open_t:unix_stream_socket { read write getattr };
#line 39

#line 39
	 	
#line 39
##### end postfix_run_postdrop(test_open_t,test_open_r) depth: 1
#line 39
 	
#line 39
		 	 	
#line 39
##### begin postfix_search_spool(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute postfix_spool_type;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t postfix_spool_type:dir { getattr search open };
#line 39
	 	 	
#line 39
##### begin files_search_spool(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_spool_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t var_t:dir { getattr search open };
#line 39
	allow test_open_t var_spool_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_spool(test_open_t) depth: 2
#line 39
 	
#line 39

#line 39
	 	
#line 39
##### end postfix_search_spool(test_open_t) depth: 1
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	# Run pppd in pppd_t by default for user
#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin ppp_run_cond(test_open_t,test_open_r) depth: 2
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		attribute_role pppd_roles;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	roleattribute test_open_r pppd_roles;
#line 39

#line 39
	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		
#line 39
bool pppd_for_user;
#line 39

#line 39
  
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39
	if (pppd_for_user) {
#line 39
		
#line 39
		 	 	
#line 39
##### begin ppp_domtrans(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type pppd_t, pppd_exec_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_search_bin(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin corecmd_read_bin_symlinks(test_open_t) depth: 5
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type bin_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:lnk_file { getattr read };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_read_bin_symlinks(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39
	allow test_open_t bin_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end corecmd_search_bin(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
	
#line 39
	allow test_open_t pppd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 39
	allow test_open_t pppd_t:process transition;
#line 39
#	dontaudit test_open_t pppd_t:process { noatsecure siginh rlimitinh };
#line 39

#line 39
	type_transition test_open_t pppd_exec_t:process pppd_t;
#line 39

#line 39

#line 39
	allow pppd_t test_open_t:fd use;
#line 39
	allow pppd_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 39
	allow pppd_t test_open_t:process sigchld;
#line 39

#line 39

#line 39
	 	
#line 39
##### end ppp_domtrans(test_open_t) depth: 2
#line 39
 	
#line 39
	
#line 39
	}
#line 39

#line 39

#line 39
	 	
#line 39
##### end ppp_run_cond(test_open_t,test_open_r) depth: 1
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39

#line 39
	
#line 39
	optional {
#line 39
		
#line 39
		 	 	
#line 39
##### begin vdagent_getattr_log(test_open_t) depth: 2
#line 39
 	
#line 39
    
#line 39
	
#line 39
		require {
#line 39
			
#line 39
        type vdagent_log_t;
#line 39
    
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
     	 	
#line 39
##### begin logging_search_logs(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_log_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	 	 	
#line 39
##### begin files_search_var(test_open_t) depth: 4
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t var_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end files_search_var(test_open_t) depth: 3
#line 39
 	
#line 39
	allow test_open_t var_log_t:dir { getattr search open };
#line 39

#line 39
	 	
#line 39
##### end logging_search_logs(test_open_t) depth: 2
#line 39
 	
#line 39
    allow test_open_t vdagent_log_t:file { getattr };
#line 39

#line 39
	 	
#line 39
##### end vdagent_getattr_log(test_open_t) depth: 1
#line 39
 	
#line 39
		 	 	
#line 39
##### begin vdagent_getattr_exec_files(test_open_t) depth: 2
#line 39
 	
#line 39
    
#line 39
	
#line 39
		require {
#line 39
			
#line 39
        type vdagent_exec_t;
#line 39
    
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t vdagent_exec_t:file { getattr };
#line 39

#line 39
	 	
#line 39
##### end vdagent_getattr_exec_files(test_open_t) depth: 1
#line 39
 	
#line 39
		 	 	
#line 39
##### begin vdagent_stream_connect(test_open_t) depth: 2
#line 39
 	
#line 39
        
#line 39
	
#line 39
		require {
#line 39
			
#line 39
                type vdagent_var_run_t, vdagent_t;
#line 39
        
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
         	 	
#line 39
##### begin files_search_pids(test_open_t) depth: 3
#line 39
 	
#line 39
	
#line 39
	
#line 39
		require {
#line 39
			
#line 39
		type var_t, var_run_t;
#line 39
	
#line 39
		} # end require
#line 39
	
#line 39

#line 39

#line 39
	allow test_open_t var_t:lnk_file { getattr read };
#line 39
	allow test_open_t var_run_t:lnk_file { getattr read };
#line 39
	
#line 39
	allow test_open_t var_t:dir { getattr search open };
#line 39
	allow test_open_t var_run_t:dir { getattr search open };
#line 39

#line 39

#line 39
	 	
#line 39
##### end files_search_pids(test_open_t) depth: 2
#line 39
 	
#line 39
        
#line 39
	allow test_open_t vdagent_var_run_t:dir { getattr search open };
#line 39
	allow test_open_t vdagent_var_run_t:sock_file { getattr write open append };
#line 39
	allow test_open_t vdagent_t:unix_stream_socket connectto;
#line 39

#line 39

#line 39
	 	
#line 39
##### end vdagent_stream_connect(test_open_t) depth: 1
#line 39
 	
#line 39
	
#line 39
	} # end optional
#line 39

#line 39
 	 	
#line 39
##### end userdom_unpriv_user_template(test_open) depth: 0
#line 39
 	;

## For this flavor of the policy, don't actually allow anything.
#allow test_open_t test_open_file_t:file { getattr read };
# We want to see an audit record if access is granted
auditallow test_open_t test_open_file_t:file read;

## Domain for process that cannot open the test file for reading or writing.
 	 	
#line 47
##### begin userdom_unpriv_user_template(test_noopen) depth: 1
#line 47
 	
#line 47

#line 47
	##############################
#line 47
	#
#line 47
	# Declarations
#line 47
	#
#line 47

#line 47
	# Inherit rules for ordinary users.
#line 47
	 	 	
#line 47
##### begin userdom_restricted_xwindows_user_template(test_noopen) depth: 2
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin userdom_restricted_user_template(test_noopen) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute unpriv_userdomain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin userdom_login_user_template(test_noopen) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		class context contains;
#line 47
		attribute login_userdomain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin userdom_base_user_template(test_noopen) depth: 5
#line 47
 	
#line 47

#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute userdomain;
#line 47
		type user_devpts_t, user_tty_device_t;
#line 47
		class context contains;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	attribute test_noopen_file_type;
#line 47
	attribute test_noopen_usertype;
#line 47

#line 47
	type test_noopen_t, userdomain, test_noopen_usertype;
#line 47
	 	 	
#line 47
##### begin domain_type(test_noopen_t) depth: 6
#line 47
 	
#line 47
	# start with basic domain
#line 47
	 	 	
#line 47
##### begin domain_base_type(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t domain;
#line 47

#line 47
	 	
#line 47
##### end domain_base_type(test_noopen_t) depth: 6
#line 47
 	
#line 47

#line 47
	# Only way to get corenet_unlabeled packets disabled to work
#line 47
	 	 	
#line 47
##### begin corenet_all_recvfrom_unlabeled(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
                attribute corenet_unlabeled_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	typeattribute test_noopen_t corenet_unlabeled_type;
#line 47

#line 47
	 	
#line 47
##### end corenet_all_recvfrom_unlabeled(test_noopen_t) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end domain_type(test_noopen_t) depth: 5
#line 47
 	
#line 47
	role test_noopen_r;
#line 47
	 	 	
#line 47
##### begin corecmd_shell_entry_type(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type shell_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin domain_entry_file(test_noopen_t,shell_exec_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute entry_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t shell_exec_t:file entrypoint;
#line 47
	allow test_noopen_t shell_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 47

#line 47
	typeattribute shell_exec_t entry_type;
#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_executable_file(shell_exec_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute shell_exec_t exec_type;
#line 47

#line 47
	 	 	
#line 47
##### begin files_type(shell_exec_t) depth: 9
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute shell_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 47

#line 47
	 	
#line 47
##### end files_type(shell_exec_t) depth: 8
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corecmd_executable_file(shell_exec_t) depth: 7
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end domain_entry_file(test_noopen_t,shell_exec_t) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corecmd_shell_entry_type(test_noopen_t) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_bin_entry_type(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin domain_entry_file(test_noopen_t,bin_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute entry_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t bin_t:file entrypoint;
#line 47
	allow test_noopen_t bin_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 47

#line 47
	typeattribute bin_t entry_type;
#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_executable_file(bin_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute bin_t exec_type;
#line 47

#line 47
	 	 	
#line 47
##### begin files_type(bin_t) depth: 9
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute bin_t file_type, non_security_file_type, non_auth_file_type;
#line 47

#line 47
	 	
#line 47
##### end files_type(bin_t) depth: 8
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corecmd_executable_file(bin_t) depth: 7
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end domain_entry_file(test_noopen_t,bin_t) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin domain_entry_file(test_noopen_t,usr_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute entry_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t usr_t:file entrypoint;
#line 47
	allow test_noopen_t usr_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 47

#line 47
	typeattribute usr_t entry_type;
#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_executable_file(usr_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute usr_t exec_type;
#line 47

#line 47
	 	 	
#line 47
##### begin files_type(usr_t) depth: 9
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute usr_t file_type, non_security_file_type, non_auth_file_type;
#line 47

#line 47
	 	
#line 47
##### end files_type(usr_t) depth: 8
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corecmd_executable_file(usr_t) depth: 7
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end domain_entry_file(test_noopen_t,usr_t) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corecmd_bin_entry_type(test_noopen_t) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin domain_user_exemption_target(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute process_user_target;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t process_user_target;
#line 47

#line 47
	 	
#line 47
##### end domain_user_exemption_target(test_noopen_t) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin ubac_constrained(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute ubac_constrained_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t ubac_constrained_type;
#line 47

#line 47
	 	
#line 47
##### end ubac_constrained(test_noopen_t) depth: 5
#line 47
 	
#line 47
	role test_noopen_r;
#line 47
	role test_noopen_r types test_noopen_t;
#line 47
	allow system_r test_noopen_r;
#line 47

#line 47
	 	 	
#line 47
##### begin term_user_pty(test_noopen_t,user_devpts_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute server_ptynode;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin term_pty(user_devpts_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute ptynode;
#line 47
		type devpts_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_node(user_devpts_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute device_node;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute user_devpts_t device_node;
#line 47

#line 47
	 	
#line 47
##### end dev_node(user_devpts_t) depth: 7
#line 47
 	
#line 47
	allow user_devpts_t devpts_t:filesystem associate;
#line 47
	typeattribute user_devpts_t ptynode;
#line 47

#line 47
	 	
#line 47
##### end term_pty(user_devpts_t) depth: 6
#line 47
 	
#line 47
	type_change test_noopen_t server_ptynode:chr_file user_devpts_t;
#line 47

#line 47
	 	
#line 47
##### end term_user_pty(test_noopen_t,user_devpts_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin term_user_tty(test_noopen_t,user_tty_device_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute ttynode;
#line 47
		type console_device_t;
#line 47
		type tty_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin term_tty(user_tty_device_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute ttynode, serial_device;
#line 47
		type tty_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute user_tty_device_t ttynode, serial_device;
#line 47

#line 47
	 	 	
#line 47
##### begin dev_node(user_tty_device_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute device_node;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute user_tty_device_t device_node;
#line 47

#line 47
	 	
#line 47
##### end dev_node(user_tty_device_t) depth: 7
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end term_tty(user_tty_device_t) depth: 6
#line 47
 	
#line 47

#line 47
	type_change test_noopen_t tty_device_t:chr_file user_tty_device_t;
#line 47

#line 47
	# Debian login is from shadow utils and does not allow resetting the perms.
#line 47
	# have to fix this!
#line 47
	
#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool login_console_enabled;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (login_console_enabled) {
#line 47
		
#line 47
		# When user logs in from /dev/console, relabel it
#line 47
		# to user tty type as well.
#line 47
		type_change test_noopen_t console_device_t:chr_file user_tty_device_t;
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	 	
#line 47
##### end term_user_tty(test_noopen_t,user_tty_device_t) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin term_dontaudit_getattr_generic_ptys(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type devpts_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_t devpts_t:chr_file getattr;
#line 47

#line 47
	 	
#line 47
##### end term_dontaudit_getattr_generic_ptys(test_noopen_t) depth: 5
#line 47
 	
#line 47

#line 47
	allow test_noopen_usertype test_noopen_usertype:process { { sigchld sigkill sigstop signull signal } getsched setsched share getpgid setpgid getcap setcap getsession getattr };
#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool deny_ptrace;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (deny_ptrace) {
#line 47
		
#line 47
	} else {
#line 47
		
#line 47
		allow test_noopen_usertype test_noopen_usertype:process ptrace;
#line 47
	
#line 47
	}
#line 47

#line 47
	allow test_noopen_usertype test_noopen_usertype:fd use;
#line 47
	allow test_noopen_usertype test_noopen_t:key { create view read write search link setattr };
#line 47

#line 47
	allow test_noopen_usertype test_noopen_usertype:fifo_file { open { getattr read write append ioctl lock } };
#line 47
	allow test_noopen_usertype test_noopen_usertype:unix_dgram_socket { { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } } sendto };
#line 47
	allow test_noopen_usertype test_noopen_usertype:unix_stream_socket { { { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } } listen accept } connectto };
#line 47
	allow test_noopen_usertype test_noopen_usertype:shm { associate getattr setattr create destroy read write lock unix_read unix_write };
#line 47
	allow test_noopen_usertype test_noopen_usertype:sem { associate getattr setattr create destroy read write unix_read unix_write };
#line 47
	allow test_noopen_usertype test_noopen_usertype:msgq { associate getattr setattr create destroy read write enqueue unix_read unix_write };
#line 47
	allow test_noopen_usertype test_noopen_usertype:msg { send receive };
#line 47
	allow test_noopen_usertype test_noopen_usertype:context contains;
#line 47
	dontaudit test_noopen_usertype test_noopen_usertype:socket create;
#line 47

#line 47
	allow test_noopen_usertype user_devpts_t:chr_file { setattr { open { getattr read write append ioctl lock } } };
#line 47
	 	 	
#line 47
##### begin term_create_pty(test_noopen_usertype,user_devpts_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bsdpty_device_t, devpts_t, ptmx_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_list_all_dev_nodes(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype device_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_list_all_dev_nodes(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	allow test_noopen_usertype ptmx_t:chr_file { open { getattr read write append ioctl lock } };
#line 47

#line 47
	allow test_noopen_usertype devpts_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_usertype devpts_t:filesystem getattr;
#line 47
	dontaudit test_noopen_usertype bsdpty_device_t:chr_file { getattr read write };
#line 47
	type_transition test_noopen_usertype devpts_t:chr_file user_devpts_t;
#line 47

#line 47
	 	
#line 47
##### end term_create_pty(test_noopen_usertype,user_devpts_t) depth: 5
#line 47
 	
#line 47
	# avoid annoying messages on terminal hangup on role change
#line 47
	dontaudit test_noopen_usertype user_devpts_t:chr_file ioctl;
#line 47

#line 47
	allow test_noopen_usertype user_tty_device_t:chr_file { setattr { open { getattr read write append ioctl lock } } };
#line 47
	# avoid annoying messages on terminal hangup on role change
#line 47
	dontaudit test_noopen_usertype user_tty_device_t:chr_file ioctl;
#line 47

#line 47
	 	 	
#line 47
##### begin application_exec_all(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_dontaudit_exec_all_executables(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype exec_type:file { execute execute_no_trans };
#line 47

#line 47
	 	
#line 47
##### end corecmd_dontaudit_exec_all_executables(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_exec_bin(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype bin_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype bin_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype bin_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype bin_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	allow test_noopen_usertype bin_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47

#line 47
	
#line 47
		 	 	
#line 47
##### begin files_exec_all_base_ro_files(test_noopen_usertype) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute base_ro_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype base_ro_file_type:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47

#line 47
	 	
#line 47
##### end files_exec_all_base_ro_files(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47

#line 47
	 	
#line 47
##### end corecmd_exec_bin(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_exec_shell(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t, shell_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype bin_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype bin_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype bin_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype bin_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_usertype shell_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47

#line 47
	 	
#line 47
##### end corecmd_exec_shell(test_noopen_usertype) depth: 6
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin application_exec(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute application_exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype application_exec_type:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47

#line 47
	 	
#line 47
##### end application_exec(test_noopen_usertype) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end application_exec_all(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin kernel_read_kernel_sysctls(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type proc_t, sysctl_t, sysctl_kernel_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype { proc_t sysctl_t sysctl_kernel_t }:dir { getattr search open };
#line 47
	allow test_noopen_usertype sysctl_kernel_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype { proc_t sysctl_t }:dir { getattr search open };
#line 47
	allow test_noopen_usertype sysctl_kernel_t:dir { getattr search open read lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end kernel_read_kernel_sysctls(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin kernel_read_all_sysctls(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute sysctl_type;
#line 47
		type proc_t, proc_net_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	# proc_net_t for /proc/net/rpc sysctls
#line 47
	
#line 47
	allow test_noopen_usertype { proc_t proc_net_t sysctl_type }:dir { getattr search open };
#line 47
	allow test_noopen_usertype sysctl_type:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype { proc_t proc_net_t }:dir { getattr search open };
#line 47
	allow test_noopen_usertype sysctl_type:dir { getattr search open read lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end kernel_read_all_sysctls(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin kernel_dontaudit_list_unlabeled(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type unlabeled_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype unlabeled_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end kernel_dontaudit_list_unlabeled(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin kernel_dontaudit_getattr_unlabeled_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type unlabeled_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype unlabeled_t:file getattr;
#line 47

#line 47
	 	
#line 47
##### end kernel_dontaudit_getattr_unlabeled_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin kernel_dontaudit_getattr_unlabeled_symlinks(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type unlabeled_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype unlabeled_t:lnk_file getattr;
#line 47

#line 47
	 	
#line 47
##### end kernel_dontaudit_getattr_unlabeled_symlinks(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin kernel_dontaudit_getattr_unlabeled_pipes(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type unlabeled_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype unlabeled_t:fifo_file getattr;
#line 47

#line 47
	 	
#line 47
##### end kernel_dontaudit_getattr_unlabeled_pipes(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin kernel_dontaudit_getattr_unlabeled_sockets(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type unlabeled_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype unlabeled_t:sock_file getattr;
#line 47

#line 47
	 	
#line 47
##### end kernel_dontaudit_getattr_unlabeled_sockets(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin kernel_dontaudit_getattr_unlabeled_blk_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type unlabeled_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype unlabeled_t:blk_file getattr;
#line 47

#line 47
	 	
#line 47
##### end kernel_dontaudit_getattr_unlabeled_blk_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin kernel_dontaudit_getattr_unlabeled_chr_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type unlabeled_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype unlabeled_t:chr_file getattr;
#line 47

#line 47
	 	
#line 47
##### end kernel_dontaudit_getattr_unlabeled_chr_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin kernel_dontaudit_list_proc(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type proc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype proc_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end kernel_dontaudit_list_proc(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin dev_dontaudit_getattr_all_blk_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute device_node;
#line 47
		type device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype { device_t device_node }:blk_file getattr;
#line 47

#line 47
	 	
#line 47
##### end dev_dontaudit_getattr_all_blk_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_dontaudit_getattr_all_chr_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute device_node;
#line 47
		type device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype { device_t device_node }:chr_file getattr;
#line 47

#line 47
	 	
#line 47
##### end dev_dontaudit_getattr_all_chr_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_getattr_mtrr_dev(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t, mtrr_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t device_t:dir { getattr search open };
#line 47
	allow test_noopen_t mtrr_device_t:file { getattr };
#line 47

#line 47
	
#line 47
	allow test_noopen_t device_t:dir { getattr search open };
#line 47
	allow test_noopen_t mtrr_device_t:chr_file { getattr };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_getattr_mtrr_dev(test_noopen_t) depth: 5
#line 47
 	
#line 47

#line 47
	# When the user domain runs ps, there will be a number of access
#line 47
	# denials when ps tries to search /proc. Do not audit these denials.
#line 47
	 	 	
#line 47
##### begin domain_dontaudit_read_all_domains_state(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype domain:dir { getattr search open read lock ioctl };
#line 47
	dontaudit test_noopen_usertype domain:lnk_file { getattr read };
#line 47
	dontaudit test_noopen_usertype domain:file { open { getattr read ioctl lock } };
#line 47

#line 47
	# cjp: these should be removed:
#line 47
	dontaudit test_noopen_usertype domain:sock_file { getattr open read };
#line 47
	dontaudit test_noopen_usertype domain:fifo_file { getattr open read lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end domain_dontaudit_read_all_domains_state(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin domain_dontaudit_getattr_all_domains(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype domain:process getattr;
#line 47

#line 47
	 	
#line 47
##### end domain_dontaudit_getattr_all_domains(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin domain_dontaudit_getsession_all_domains(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype domain:process getsession;
#line 47

#line 47
	 	
#line 47
##### end domain_dontaudit_getsession_all_domains(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_dontaudit_all_access_check(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute device_node;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype device_node:{ file lnk_file sock_file fifo_file chr_file blk_file } audit_access;
#line 47

#line 47
	 	
#line 47
##### end dev_dontaudit_all_access_check(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin files_read_etc_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype etc_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype etc_t:lnk_file { getattr read };
#line 47

#line 47
	 	 	
#line 47
##### begin files_read_etc_runtime_files(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t, etc_runtime_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype etc_runtime_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype etc_runtime_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_read_etc_runtime_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end files_read_etc_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_list_mnt(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type mnt_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype mnt_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end files_list_mnt(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_list_var(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end files_list_var(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_read_mnt_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type mnt_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype mnt_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype mnt_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_read_mnt_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_dontaudit_all_access_check(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype file_type:{ dir file lnk_file sock_file fifo_file chr_file blk_file } audit_access;
#line 47

#line 47
	 	
#line 47
##### end files_dontaudit_all_access_check(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_read_etc_runtime_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t, etc_runtime_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype etc_runtime_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype etc_runtime_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_read_etc_runtime_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_read_usr_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype usr_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype usr_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype usr_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype usr_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype usr_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_read_usr_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_read_usr_src_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type usr_t, src_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype usr_t:dir { getattr search open };
#line 47
	
#line 47
	allow test_noopen_usertype { usr_t src_t }:dir { getattr search open };
#line 47
	allow test_noopen_usertype src_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype { usr_t src_t }:dir { getattr search open };
#line 47
	allow test_noopen_usertype src_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_usertype src_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end files_read_usr_src_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	# Read directories and files with the readable_t type.
#line 47
	# This type is a general type for "world"-readable files.
#line 47
	 	 	
#line 47
##### begin files_list_world_readable(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type readable_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype readable_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end files_list_world_readable(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_read_world_readable_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type readable_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype readable_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end files_read_world_readable_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_read_world_readable_symlinks(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type readable_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype readable_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_read_world_readable_symlinks(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_read_world_readable_pipes(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type readable_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype readable_t:fifo_file { getattr open read lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end files_read_world_readable_pipes(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_read_world_readable_sockets(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type readable_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype readable_t:sock_file { getattr open read };
#line 47

#line 47
	 	
#line 47
##### end files_read_world_readable_sockets(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	# old broswer_domain():
#line 47
	 	 	
#line 47
##### begin files_dontaudit_getattr_all_dirs(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype file_type:dir getattr;
#line 47

#line 47
	 	
#line 47
##### end files_dontaudit_getattr_all_dirs(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_dontaudit_list_non_security(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute non_security_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype non_security_file_type:dir { getattr search open read lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end files_dontaudit_list_non_security(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_dontaudit_getattr_all_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype file_type:file getattr;
#line 47

#line 47
	 	
#line 47
##### end files_dontaudit_getattr_all_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_dontaudit_getattr_non_security_symlinks(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute non_security_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype non_security_file_type:lnk_file getattr;
#line 47

#line 47
	 	
#line 47
##### end files_dontaudit_getattr_non_security_symlinks(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_dontaudit_getattr_non_security_pipes(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute non_security_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype non_security_file_type:fifo_file getattr;
#line 47

#line 47
	 	
#line 47
##### end files_dontaudit_getattr_non_security_pipes(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_dontaudit_getattr_non_security_sockets(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute non_security_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype non_security_file_type:sock_file getattr;
#line 47

#line 47
	 	
#line 47
##### end files_dontaudit_getattr_non_security_sockets(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_dontaudit_setattr_etc_runtime_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_runtime_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype etc_runtime_t:file setattr;
#line 47

#line 47
	 	
#line 47
##### end files_dontaudit_setattr_etc_runtime_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin files_exec_usr_files(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t usr_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_t usr_t:dir { getattr search open };
#line 47
	allow test_noopen_t usr_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47

#line 47
	
#line 47
	allow test_noopen_t usr_t:dir { getattr search open };
#line 47
	allow test_noopen_t usr_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_exec_usr_files(test_noopen_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin fs_list_cgroup_dirs(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cgroup_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype cgroup_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype cgroup_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	 	 	
#line 47
##### begin fs_search_tmpfs(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype tmpfs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_tmpfs(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_search_sysfs(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype sysfs_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype sysfs_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_search_sysfs(test_noopen_usertype) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end fs_list_cgroup_dirs(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin fs_dontaudit_rw_cgroup_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cgroup_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype cgroup_t:file { open { getattr read write append ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end fs_dontaudit_rw_cgroup_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin storage_rw_fuse(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type fuse_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype fuse_device_t:chr_file { open { getattr read write append ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end storage_rw_fuse(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin auth_use_nsswitch(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute nsswitch_domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t nsswitch_domain;
#line 47

#line 47
	 	 	
#line 47
##### begin corenet_all_recvfrom_netlabel(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute netlabel_peer_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t netlabel_peer_type;
#line 47

#line 47
	 	
#line 47
##### end corenet_all_recvfrom_netlabel(test_noopen_t) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end auth_use_nsswitch(test_noopen_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin init_stream_connect(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type init_t, init_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype init_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype init_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype init_t:unix_stream_socket connectto;
#line 47
    
#line 47
	allow test_noopen_usertype init_t:unix_stream_socket getattr;
#line 47

#line 47
	 	
#line 47
##### end init_stream_connect(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	# The library functions always try to open read-write first,
#line 47
	# then fall back to read-only if it fails. 
#line 47
	 	 	
#line 47
##### begin init_dontaudit_rw_utmp(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type initrc_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype initrc_var_run_t:file { open { getattr read write append ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end init_dontaudit_rw_utmp(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin libs_exec_ld_so(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type lib_t, ld_so_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype lib_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype lib_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype { lib_t ld_so_t }:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype lib_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype ld_so_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47

#line 47

#line 47
	 	
#line 47
##### end libs_exec_ld_so(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin miscfiles_read_generic_certs(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cert_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t cert_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_t cert_t:dir { getattr search open };
#line 47
	allow test_noopen_t cert_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_t cert_t:dir { getattr search open };
#line 47
	allow test_noopen_t cert_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end miscfiles_read_generic_certs(test_noopen_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin miscfiles_read_all_certs(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute cert_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype cert_type:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype cert_type:dir { getattr search open };
#line 47
	allow test_noopen_usertype cert_type:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype cert_type:dir { getattr search open };
#line 47
	allow test_noopen_usertype cert_type:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end miscfiles_read_all_certs(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin miscfiles_read_public_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type public_content_t, public_content_rw_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype { public_content_t public_content_rw_t }:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype { public_content_t public_content_rw_t }:dir { getattr search open };
#line 47
	allow test_noopen_usertype { public_content_t public_content_rw_t }:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype { public_content_t public_content_rw_t }:dir { getattr search open };
#line 47
	allow test_noopen_usertype { public_content_t public_content_rw_t }:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end miscfiles_read_public_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin systemd_dbus_chat_logind(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type systemd_logind_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype systemd_logind_t:dbus send_msg;
#line 47
	allow systemd_logind_t test_noopen_usertype:dbus send_msg;
#line 47
	
#line 47
	allow systemd_logind_t test_noopen_usertype:dir { getattr search open read lock ioctl };
#line 47
	allow systemd_logind_t test_noopen_usertype:file { open { getattr read ioctl lock } };
#line 47
	allow systemd_logind_t test_noopen_usertype:lnk_file { getattr read };
#line 47
	allow systemd_logind_t test_noopen_usertype:process getattr;
#line 47

#line 47
	allow systemd_logind_t test_noopen_usertype:process signal;
#line 47
	allow test_noopen_usertype systemd_logind_t:fd use;
#line 47

#line 47
	 	
#line 47
##### end systemd_dbus_chat_logind(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin systemd_read_logind_sessions_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type systemd_logind_sessions_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin init_search_pid_dirs(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
    
#line 47
	
#line 47
		require {
#line 47
			
#line 47
        type init_var_run_t;
#line 47
    
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
    allow test_noopen_usertype init_var_run_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end init_search_pid_dirs(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	allow test_noopen_usertype systemd_logind_sessions_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype systemd_logind_sessions_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype systemd_logind_sessions_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end systemd_read_logind_sessions_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin systemd_write_inhibit_pipes(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type systemd_logind_inhibit_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype systemd_logind_inhibit_var_run_t:fifo_file write;
#line 47

#line 47
	 	
#line 47
##### end systemd_write_inhibit_pipes(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin systemd_write_inherited_logind_sessions_pipes(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type systemd_logind_sessions_t;
#line 47
		type systemd_logind_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype systemd_logind_t:fd use;
#line 47
	allow test_noopen_usertype systemd_logind_sessions_t:fifo_file write;
#line 47

#line 47
	 	
#line 47
##### end systemd_write_inherited_logind_sessions_pipes(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin systemd_login_read_pid_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type systemd_logind_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype systemd_logind_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype systemd_logind_var_run_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end systemd_login_read_pid_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool deny_execmem;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (deny_execmem) {
#line 47
		
#line 47
	} else {
#line 47
		
#line 47
		# Allow loading DSOs that require executable stack.
#line 47
		allow test_noopen_t self:process execmem;
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool selinuxuser_execstack;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (selinuxuser_execstack) {
#line 47
		
#line 47
		# Allow making the stack executable via mprotect.
#line 47
		allow test_noopen_t self:process execstack;
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin abrt_stream_connect(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type abrt_t, abrt_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype abrt_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype abrt_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype abrt_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end abrt_stream_connect(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin fs_list_cgroup_dirs(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cgroup_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype cgroup_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype cgroup_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	 	 	
#line 47
##### begin fs_search_tmpfs(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype tmpfs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_tmpfs(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_search_sysfs(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype sysfs_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype sysfs_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_search_sysfs(test_noopen_usertype) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end fs_list_cgroup_dirs(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47
	
#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin ssh_rw_stream_sockets(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sshd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype sshd_t:unix_stream_socket { { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } listen accept };
#line 47

#line 47
	 	
#line 47
##### end ssh_rw_stream_sockets(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
         	 	
#line 47
##### begin ssh_rw_dgram_sockets(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
    
#line 47
	
#line 47
		require {
#line 47
			
#line 47
        type sshd_t;
#line 47
    
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
    allow test_noopen_usertype sshd_t:unix_dgram_socket { { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } listen accept };
#line 47

#line 47
	 	
#line 47
##### end ssh_rw_dgram_sockets(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin ssh_delete_tmp(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sshd_tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_tmp(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin fs_search_tmpfs(test_noopen_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t tmpfs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_tmpfs(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_t tmp_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_t tmp_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_tmp(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t sshd_tmp_t:dir { getattr search open lock ioctl write remove_name };
#line 47
	allow test_noopen_t sshd_tmp_t:file { getattr unlink };
#line 47

#line 47

#line 47
	 	
#line 47
##### end ssh_delete_tmp(test_noopen_t) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin ssh_signal(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sshd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t sshd_t:process signal;
#line 47

#line 47
	 	
#line 47
##### end ssh_signal(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47
 	 	
#line 47
##### end userdom_base_user_template(test_noopen) depth: 4
#line 47
 	
#line 47

#line 47
	typeattribute test_noopen_t login_userdomain;
#line 47

#line 47
	 	 	
#line 47
##### begin userdom_manage_home_role(test_noopen_r,test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_t, user_home_dir_t;
#line 47
		attribute user_home_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	role test_noopen_r types { user_home_type user_home_dir_t };
#line 47

#line 47
	##############################
#line 47
	#
#line 47
	# Domain access to home dir
#line 47
	#
#line 47

#line 47
	type_member test_noopen_t user_home_dir_t:dir user_home_dir_t;
#line 47

#line 47
	# full control of the home directory
#line 47
	allow test_noopen_t user_home_t:dir mounton;
#line 47
	allow test_noopen_t user_home_t:file entrypoint;
#line 47

#line 47
	allow test_noopen_t user_home_type:{ dir file lnk_file sock_file fifo_file chr_file blk_file } { relabelto relabelfrom };
#line 47
	allow test_noopen_t user_home_dir_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_t user_home_type:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_t user_home_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_t user_home_type:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_t user_home_type:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 47

#line 47
	
#line 47
	allow test_noopen_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_t user_home_type:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 47
	allow test_noopen_t user_home_type:dir { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 47
	allow test_noopen_t user_home_type:file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 47
	allow test_noopen_t user_home_type:lnk_file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 47
	allow test_noopen_t user_home_type:sock_file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 47
	allow test_noopen_t user_home_type:fifo_file { getattr relabelfrom relabelto };
#line 47

#line 47
	 	 	
#line 47
##### begin userdom_filetrans_home_content(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
	        attribute userdom_filetrans_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t  userdom_filetrans_type;
#line 47

#line 47
	 	
#line 47
##### end userdom_filetrans_home_content(test_noopen_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin files_list_home(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t home_root_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_list_home(test_noopen_t) depth: 5
#line 47
 	
#line 47

#line 47
	# cjp: this should probably be removed:
#line 47
	allow test_noopen_t user_home_dir_t:dir { { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl } { getattr relabelfrom relabelto } };
#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool use_nfs_home_dirs;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (use_nfs_home_dirs) {
#line 47
		
#line 47
		 	 	
#line 47
##### begin fs_mount_nfs(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t nfs_t:filesystem mount;
#line 47

#line 47
	 	
#line 47
##### end fs_mount_nfs(test_noopen_t) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_mounton_nfs(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t nfs_t:dir mounton;
#line 47

#line 47
	 	
#line 47
##### end fs_mounton_nfs(test_noopen_t) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_nfs_dirs(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin fs_search_auto_mountpoints(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type autofs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t autofs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_auto_mountpoints(test_noopen_t) depth: 6
#line 47
 	
#line 47
	allow test_noopen_t nfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end fs_manage_nfs_dirs(test_noopen_t) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_nfs_files(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin fs_search_auto_mountpoints(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type autofs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t autofs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_auto_mountpoints(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_t nfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_nfs_files(test_noopen_t) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_nfs_symlinks(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin fs_search_auto_mountpoints(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type autofs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t autofs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_auto_mountpoints(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_t nfs_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_nfs_symlinks(test_noopen_t) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_nfs_named_sockets(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_t nfs_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_nfs_named_sockets(test_noopen_t) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_nfs_named_pipes(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_t nfs_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_nfs_named_pipes(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool use_samba_home_dirs;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (use_samba_home_dirs) {
#line 47
		
#line 47
		 	 	
#line 47
##### begin fs_mount_cifs(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t cifs_t:filesystem mount;
#line 47

#line 47
	 	
#line 47
##### end fs_mount_cifs(test_noopen_t) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_mounton_cifs(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t cifs_t:dir mounton;
#line 47

#line 47
	 	
#line 47
##### end fs_mounton_cifs(test_noopen_t) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_cifs_dirs(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t cifs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end fs_manage_cifs_dirs(test_noopen_t) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_cifs_files(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_t cifs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_cifs_files(test_noopen_t) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_cifs_symlinks(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_t cifs_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_cifs_symlinks(test_noopen_t) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_cifs_named_sockets(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_t cifs_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_cifs_named_sockets(test_noopen_t) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_cifs_named_pipes(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_t cifs_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_cifs_named_pipes(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_manage_home_role(test_noopen_r,test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin userdom_manage_tmp_role(test_noopen_r,test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute user_tmp_type;
#line 47
		type user_tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	role test_noopen_r types user_tmp_t;
#line 47

#line 47
	 	 	
#line 47
##### begin files_poly_member_tmp(test_noopen_usertype,user_tmp_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	type_member test_noopen_usertype tmp_t:dir user_tmp_t;
#line 47

#line 47
	 	
#line 47
##### end files_poly_member_tmp(test_noopen_usertype,user_tmp_t) depth: 5
#line 47
 	
#line 47

#line 47
	allow test_noopen_usertype user_tmp_type:dir mounton;
#line 47
	
#line 47
	allow test_noopen_usertype user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_usertype user_tmp_type:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_usertype user_tmp_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_usertype user_tmp_type:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_usertype user_tmp_type:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_usertype user_tmp_type:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	 	 	
#line 47
##### begin files_tmp_filetrans(test_noopen_usertype,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_usertype tmp_t:{ dir file lnk_file sock_file fifo_file } user_tmp_t ;
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_tmp_filetrans(test_noopen_usertype,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 5
#line 47
 	
#line 47
     	 	
#line 47
##### begin fs_tmpfs_filetrans(test_noopen_usertype,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow user_tmp_t tmpfs_t:filesystem associate;
#line 47
	
#line 47
	allow test_noopen_usertype tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_usertype tmpfs_t:{ dir file lnk_file sock_file fifo_file } user_tmp_t ;
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_tmpfs_filetrans(test_noopen_usertype,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype user_tmp_type:dir { getattr search open };
#line 47
	allow test_noopen_usertype user_tmp_type:dir { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype user_tmp_type:dir { getattr search open };
#line 47
	allow test_noopen_usertype user_tmp_type:file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype user_tmp_type:dir { getattr search open };
#line 47
	allow test_noopen_usertype user_tmp_type:lnk_file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype user_tmp_type:dir { getattr search open };
#line 47
	allow test_noopen_usertype user_tmp_type:sock_file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype user_tmp_type:dir { getattr search open };
#line 47
	allow test_noopen_usertype user_tmp_type:fifo_file { getattr relabelfrom relabelto };
#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_manage_tmp_role(test_noopen_r,test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	
#line 47
		
#line 47
	bool test_noopen_exec_content true;
#line 47

#line 47

#line 47
		
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool test_noopen_exec_content;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (test_noopen_exec_content) {
#line 47
		
#line 47
			 	 	
#line 47
##### begin userdom_exec_user_tmp_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype user_tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype user_tmp_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47

#line 47
	dontaudit test_noopen_usertype user_tmp_t:sock_file execute;
#line 47
	 	 	
#line 47
##### begin files_search_tmp(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin fs_search_tmpfs(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype tmpfs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_tmpfs(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype tmp_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_usertype tmp_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_tmp(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_exec_user_tmp_files(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
			 	 	
#line 47
##### begin userdom_exec_user_home_content_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_dir_t;
#line 47
		attribute user_home_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_home(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype home_root_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_search_home(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype { user_home_dir_t user_home_type }:dir { getattr search open };
#line 47
	allow test_noopen_usertype user_home_type:file { getattr open map read execute ioctl execute_no_trans };
#line 47

#line 47
	dontaudit test_noopen_usertype user_home_type:sock_file execute;
#line 47
	
#line 47
	 	
#line 47
##### end userdom_exec_user_home_content_files(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47
		
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool test_noopen_exec_content;
#line 47

#line 47
bool use_nfs_home_dirs;
#line 47

#line 47
   
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (test_noopen_exec_content && use_nfs_home_dirs) {
#line 47
		
#line 47
                         	 	
#line 47
##### begin fs_exec_nfs_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype nfs_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype nfs_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype nfs_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_exec_nfs_files(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool test_noopen_exec_content;
#line 47

#line 47
bool use_samba_home_dirs;
#line 47

#line 47
   
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (test_noopen_exec_content && use_samba_home_dirs) {
#line 47
		
#line 47
			 	 	
#line 47
##### begin fs_exec_cifs_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype cifs_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype cifs_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype cifs_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_exec_cifs_files(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47
	
#line 47

#line 47
	 	 	
#line 47
##### begin userdom_change_password_template(test_noopen) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type test_noopen_t;
#line 47
		role test_noopen_r;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin usermanage_run_chfn(test_noopen_t,test_noopen_r) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute_role chfn_roles;
#line 47
		type chfn_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin usermanage_domtrans_chfn(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type chfn_t, chfn_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_search_bin(test_noopen_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_read_bin_symlinks(test_noopen_t) depth: 9
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_read_bin_symlinks(test_noopen_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_search_bin(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t chfn_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t chfn_t:process transition;
#line 47
#	dontaudit test_noopen_t chfn_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t chfn_exec_t:process chfn_t;
#line 47

#line 47

#line 47
	allow chfn_t test_noopen_t:fd use;
#line 47
	allow chfn_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow chfn_t test_noopen_t:process sigchld;
#line 47

#line 47

#line 47
	 	
#line 47
##### end usermanage_domtrans_chfn(test_noopen_t) depth: 6
#line 47
 	
#line 47
	roleattribute test_noopen_r chfn_roles;
#line 47

#line 47
	 	
#line 47
##### end usermanage_run_chfn(test_noopen_t,test_noopen_r) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin usermanage_run_passwd(test_noopen_t,test_noopen_r) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type passwd_t;
#line 47
		attribute_role passwd_roles;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin usermanage_domtrans_passwd(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type passwd_t, passwd_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_search_bin(test_noopen_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_read_bin_symlinks(test_noopen_t) depth: 9
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_read_bin_symlinks(test_noopen_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_search_bin(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t passwd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t passwd_t:process transition;
#line 47
#	dontaudit test_noopen_t passwd_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t passwd_exec_t:process passwd_t;
#line 47

#line 47

#line 47
	allow passwd_t test_noopen_t:fd use;
#line 47
	allow passwd_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow passwd_t test_noopen_t:process sigchld;
#line 47

#line 47

#line 47
	 	
#line 47
##### end usermanage_domtrans_passwd(test_noopen_t) depth: 6
#line 47
 	
#line 47
	roleattribute test_noopen_r passwd_roles;
#line 47

#line 47
	 	
#line 47
##### end usermanage_run_passwd(test_noopen_t,test_noopen_r) depth: 5
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47
 	 	
#line 47
##### end userdom_change_password_template(test_noopen) depth: 4
#line 47
 	
#line 47

#line 47
	##############################
#line 47
	#
#line 47
	# User domain Local policy
#line 47
	#
#line 47
	dontaudit test_noopen_t self:capability { sys_nice fsetid };
#line 47
	allow test_noopen_t self:process ~{ ptrace execmem execstack execheap };
#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool selinuxuser_use_ssh_chroot;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (selinuxuser_use_ssh_chroot) {
#line 47
		
#line 47
		allow test_noopen_t self:capability { setuid setgid sys_chroot };
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	dontaudit test_noopen_t self:process setrlimit;
#line 47
	dontaudit test_noopen_t self:netlink_route_socket { create ioctl read getattr write setattr append bind connect getopt setopt shutdown nlmsg_read nlmsg_write };
#line 47
	 	 	
#line 47
##### begin domain_dyntrans_type(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute set_curr_context;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t set_curr_context;
#line 47

#line 47
	 	
#line 47
##### end domain_dyntrans_type(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	allow test_noopen_t self:context contains;
#line 47

#line 47
	 	 	
#line 47
##### begin kernel_dontaudit_read_system_state(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type proc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype proc_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end kernel_dontaudit_read_system_state(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin kernel_dontaudit_list_all_proc(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute proc_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype proc_type:dir { getattr search open read lock ioctl };
#line 47
	dontaudit test_noopen_usertype proc_type:file getattr;
#line 47

#line 47
	 	
#line 47
##### end kernel_dontaudit_list_all_proc(test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin dev_read_sysfs(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype sysfs_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype sysfs_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype sysfs_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype sysfs_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype sysfs_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype sysfs_t:dir { getattr search open read lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_read_sysfs(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_read_rand(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t, random_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype random_device_t:chr_file { getattr open read lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_read_rand(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_read_urand(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t, urandom_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype urandom_device_t:chr_file { getattr open read lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_read_urand(test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin domain_use_interactive_fds(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute privfd;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype privfd:fd use;
#line 47

#line 47
	 	
#line 47
##### end domain_use_interactive_fds(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	# Command completion can fire hundreds of denials
#line 47
	 	 	
#line 47
##### begin domain_dontaudit_exec_all_entry_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute entry_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype entry_type:file { getattr open map read execute ioctl execute_no_trans };
#line 47

#line 47
	 	
#line 47
##### end domain_dontaudit_exec_all_entry_files(test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin files_dontaudit_list_default(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type default_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype default_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end files_dontaudit_list_default(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_dontaudit_read_default_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type default_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype default_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end files_dontaudit_read_default_files(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	# Stat lost+found.
#line 47
	 	 	
#line 47
##### begin files_getattr_lost_found_dirs(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type lost_found_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype lost_found_t:dir getattr;
#line 47

#line 47
	 	
#line 47
##### end files_getattr_lost_found_dirs(test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin fs_get_all_fs_quotas(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute filesystem_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype filesystem_type:filesystem quotaget;
#line 47

#line 47
	 	
#line 47
##### end fs_get_all_fs_quotas(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin fs_getattr_all_fs(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute filesystem_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype filesystem_type:filesystem getattr;
#line 47
	 	 	
#line 47
##### begin files_getattr_all_file_type_fs(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype file_type:filesystem getattr;
#line 47

#line 47
	 	
#line 47
##### end files_getattr_all_file_type_fs(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end fs_getattr_all_fs(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin fs_search_all(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute filesystem_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype filesystem_type:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_all(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin fs_list_inotifyfs(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type inotifyfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype inotifyfs_t:dir { getattr search open read lock ioctl };
#line 47
	 	 	
#line 47
##### begin fs_read_anon_inodefs_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type anon_inodefs_t;
#line 47

#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype anon_inodefs_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype anon_inodefs_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_read_anon_inodefs_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end fs_list_inotifyfs(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin fs_rw_anon_inodefs_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type anon_inodefs_t;
#line 47

#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype anon_inodefs_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype anon_inodefs_t:file { open { getattr read write append ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_rw_anon_inodefs_files(test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin auth_role(test_noopen_r,test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type chkpwd_t, chkpwd_exec_t, shadow_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	role test_noopen_r types chkpwd_t;
#line 47

#line 47
	# Transition from the user domain to this domain.
#line 47
	 	 	
#line 47
##### begin auth_domtrans_chkpwd(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type chkpwd_t, chkpwd_exec_t, shadow_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_search_bin(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_read_bin_symlinks(test_noopen_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_read_bin_symlinks(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_search_bin(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t chkpwd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t chkpwd_t:process transition;
#line 47
#	dontaudit test_noopen_t chkpwd_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t chkpwd_exec_t:process chkpwd_t;
#line 47

#line 47

#line 47
	allow chkpwd_t test_noopen_t:fd use;
#line 47
	allow chkpwd_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow chkpwd_t test_noopen_t:process sigchld;
#line 47

#line 47
	dontaudit test_noopen_t shadow_t:file { getattr read };
#line 47
	 	 	
#line 47
##### begin auth_domtrans_upd_passwd(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type updpwd_t, updpwd_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t updpwd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t updpwd_t:process transition;
#line 47
#	dontaudit test_noopen_t updpwd_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t updpwd_exec_t:process updpwd_t;
#line 47

#line 47

#line 47
	allow updpwd_t test_noopen_t:fd use;
#line 47
	allow updpwd_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow updpwd_t test_noopen_t:process sigchld;
#line 47

#line 47
	 	 	
#line 47
##### begin auth_dontaudit_read_shadow(test_noopen_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type shadow_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_t shadow_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end auth_dontaudit_read_shadow(test_noopen_t) depth: 7
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end auth_domtrans_upd_passwd(test_noopen_t) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end auth_domtrans_chkpwd(test_noopen_t) depth: 5
#line 47
 	
#line 47

#line 47
	
#line 47
	allow test_noopen_t chkpwd_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t chkpwd_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_t chkpwd_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t chkpwd_t:process getattr;
#line 47

#line 47

#line 47
	dontaudit test_noopen_t shadow_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	 	 	
#line 47
##### begin logging_send_syslog_msg(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute syslog_client_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t syslog_client_type;
#line 47

#line 47
	 	
#line 47
##### end logging_send_syslog_msg(test_noopen_t) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin logging_send_audit_msgs(test_noopen_t) depth: 6
#line 47
 	
#line 47
	allow test_noopen_t self:capability audit_write;
#line 47
	allow test_noopen_t self:netlink_audit_socket { { { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } } nlmsg_read } nlmsg_relay nlmsg_tty_audit };
#line 47

#line 47
	 	
#line 47
##### end logging_send_audit_msgs(test_noopen_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin usermanage_read_crack_db(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type crack_db_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t var_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_var(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t crack_db_t:dir { getattr search open };
#line 47
	allow test_noopen_t crack_db_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end usermanage_read_crack_db(test_noopen_t) depth: 5
#line 47
 	
#line 47

#line 47

#line 47
	 	
#line 47
##### end auth_role(test_noopen_r,test_noopen_t) depth: 4
#line 47
 	
#line 47
     	 	
#line 47
##### begin auth_create_cache(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type auth_cache_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t auth_cache_t:dir { getattr search open lock ioctl write add_name };
#line 47
	allow test_noopen_t auth_cache_t:file { getattr create open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end auth_create_cache(test_noopen_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin auth_rw_cache(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type auth_cache_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t auth_cache_t:dir { getattr search open };
#line 47
	allow test_noopen_t auth_cache_t:file { open { getattr read write append ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end auth_rw_cache(test_noopen_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin auth_search_pam_console_data(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type pam_var_console_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_t var_t:dir { getattr search open };
#line 47
	allow test_noopen_t var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_t) depth: 5
#line 47
 	
#line 47
	allow test_noopen_t pam_var_console_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end auth_search_pam_console_data(test_noopen_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin auth_dontaudit_read_login_records(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type wtmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_t wtmp_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end auth_dontaudit_read_login_records(test_noopen_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin auth_dontaudit_write_login_records(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type wtmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_t wtmp_t:file write;
#line 47

#line 47
	 	
#line 47
##### end auth_dontaudit_write_login_records(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin application_exec_all(test_noopen_t) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_dontaudit_exec_all_executables(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_t exec_type:file { execute execute_no_trans };
#line 47

#line 47
	 	
#line 47
##### end corecmd_dontaudit_exec_all_executables(test_noopen_t) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_exec_bin(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	allow test_noopen_t bin_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47

#line 47
	
#line 47
		 	 	
#line 47
##### begin files_exec_all_base_ro_files(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute base_ro_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t base_ro_file_type:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47

#line 47
	 	
#line 47
##### end files_exec_all_base_ro_files(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47

#line 47
	 	
#line 47
##### end corecmd_exec_bin(test_noopen_t) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_exec_shell(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t, shell_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_t shell_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47

#line 47
	 	
#line 47
##### end corecmd_exec_shell(test_noopen_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin application_exec(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute application_exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t application_exec_type:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47

#line 47
	 	
#line 47
##### end application_exec(test_noopen_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end application_exec_all(test_noopen_t) depth: 4
#line 47
 	
#line 47
	# The library functions always try to open read-write first,
#line 47
	# then fall back to read-only if it fails.
#line 47
	 	 	
#line 47
##### begin init_dontaudit_rw_utmp(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type initrc_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_t initrc_var_run_t:file { open { getattr read write append ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end init_dontaudit_rw_utmp(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	# Stop warnings about access to /dev/console
#line 47
	 	 	
#line 47
##### begin init_dontaudit_use_fds(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type init_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype init_t:fd use;
#line 47

#line 47
	 	
#line 47
##### end init_dontaudit_use_fds(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin init_dontaudit_use_script_fds(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type initrc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype initrc_t:fd use;
#line 47

#line 47
	 	
#line 47
##### end init_dontaudit_use_script_fds(test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin libs_exec_lib_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_usr(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype usr_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_usr(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	allow test_noopen_usertype lib_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype lib_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype lib_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype lib_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype lib_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47

#line 47

#line 47
	 	
#line 47
##### end libs_exec_lib_files(test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin logging_dontaudit_getattr_all_logs(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute logfile;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype logfile:file getattr;
#line 47

#line 47
	 	
#line 47
##### end logging_dontaudit_getattr_all_logs(test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	# for running TeX programs
#line 47
	 	 	
#line 47
##### begin miscfiles_read_tetex_data(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tetex_data_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_var(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_search_var_lib(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_lib_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_var_lib(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	# cjp: TeX data can be in either of the above dirs
#line 47
	allow test_noopen_usertype tetex_data_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype tetex_data_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype tetex_data_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype tetex_data_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype tetex_data_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end miscfiles_read_tetex_data(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin miscfiles_exec_tetex_data(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type fonts_t;
#line 47
		type tetex_data_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_var(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_search_var_lib(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_lib_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_var_lib(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	# cjp: TeX data can be in either of the above dirs
#line 47
	allow test_noopen_usertype tetex_data_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype tetex_data_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype tetex_data_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47

#line 47

#line 47
	 	
#line 47
##### end miscfiles_exec_tetex_data(test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin seutil_read_config(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type selinux_config_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_etc(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_etc(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	allow test_noopen_usertype selinux_config_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype selinux_config_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype selinux_config_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype selinux_config_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype selinux_config_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end seutil_read_config(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin seutil_read_file_contexts(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type selinux_config_t, default_context_t, file_context_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_etc(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_etc(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	allow test_noopen_usertype { selinux_config_t default_context_t }:dir { getattr search open };
#line 47
	
#line 47
	allow test_noopen_usertype file_context_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype file_context_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype file_context_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype file_context_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype file_context_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype file_context_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_usertype file_context_t:file map;
#line 47

#line 47
	 	
#line 47
##### end seutil_read_file_contexts(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin seutil_read_default_contexts(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type selinux_config_t, default_context_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_etc(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_etc(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	allow test_noopen_usertype selinux_config_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype default_context_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype default_context_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype default_context_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end seutil_read_default_contexts(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin seutil_exec_setfiles(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type setfiles_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_usr(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype usr_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_usr(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_search_bin(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_read_bin_symlinks(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype bin_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype bin_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_read_bin_symlinks(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype bin_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype bin_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_search_bin(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	allow test_noopen_usertype setfiles_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47

#line 47
	 	
#line 47
##### end seutil_exec_setfiles(test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin cups_read_config(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cupsd_etc_t, cupsd_rw_etc_t;
#line 47
		type hplip_etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_etc(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_etc(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype cupsd_etc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype cupsd_etc_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype hplip_etc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype hplip_etc_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype cupsd_etc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype cupsd_rw_etc_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end cups_read_config(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin cups_stream_connect(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cupsd_t, cupsd_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype cupsd_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype cupsd_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype cupsd_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end cups_stream_connect(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin cups_stream_connect_ptal(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type ptal_t, ptal_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype ptal_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype ptal_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype ptal_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end cups_stream_connect_ptal(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin kerberos_use(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type krb5_conf_t, krb5kdc_conf_t;
#line 47
		type krb5_host_rcache_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_etc(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_etc(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype krb5_conf_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype krb5_conf_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype krb5_conf_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype krb5_conf_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	dontaudit test_noopen_usertype krb5_conf_t:file write;
#line 47
	dontaudit test_noopen_usertype krb5kdc_conf_t:dir { getattr search open read lock ioctl };
#line 47
	dontaudit test_noopen_usertype krb5kdc_conf_t:file { open { getattr read write append ioctl lock } };
#line 47

#line 47
	#kerberos libraries are attempting to set the correct file context
#line 47
	dontaudit test_noopen_usertype self:process setfscreate;
#line 47
	 	 	
#line 47
##### begin selinux_dontaudit_validate_context(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type security_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype security_t:dir { getattr search open read lock ioctl };
#line 47
	dontaudit test_noopen_usertype security_t:file { open { getattr read write append ioctl lock } };
#line 47
	dontaudit test_noopen_usertype security_t:security check_context;
#line 47

#line 47
	 	
#line 47
##### end selinux_dontaudit_validate_context(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin seutil_read_file_contexts(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type selinux_config_t, default_context_t, file_context_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_etc(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_etc(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	allow test_noopen_usertype { selinux_config_t default_context_t }:dir { getattr search open };
#line 47
	
#line 47
	allow test_noopen_usertype file_context_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype file_context_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype file_context_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype file_context_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype file_context_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype file_context_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_usertype file_context_t:file map;
#line 47

#line 47
	 	
#line 47
##### end seutil_read_file_contexts(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool kerberos_enabled;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (kerberos_enabled) {
#line 47
		
#line 47
		allow test_noopen_usertype self:tcp_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 47
		allow test_noopen_usertype self:udp_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 47

#line 47
		 	 	
#line 47
##### begin corenet_tcp_sendrecv_generic_if(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type netif_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype netif_t:netif { tcp_send tcp_recv egress ingress };
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_sendrecv_generic_if(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin corenet_udp_sendrecv_generic_if(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_udp_send_generic_if(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type netif_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype netif_t:netif { udp_send egress };
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_send_generic_if(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_udp_receive_generic_if(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type netif_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype netif_t:netif { udp_recv ingress };
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_receive_generic_if(test_noopen_usertype) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_sendrecv_generic_if(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin corenet_tcp_sendrecv_generic_node(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type node_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype node_t:node { tcp_send tcp_recv sendto recvfrom };
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_sendrecv_generic_node(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin corenet_udp_sendrecv_generic_node(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_udp_send_generic_node(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type node_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype node_t:node { udp_send sendto };
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_send_generic_node(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_udp_receive_generic_node(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type node_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype node_t:node { udp_recv recvfrom };
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_receive_generic_node(test_noopen_usertype) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_sendrecv_generic_node(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin corenet_tcp_sendrecv_kerberos_port(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type kerberos_port_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype kerberos_port_t:tcp_socket { send_msg recv_msg };
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_sendrecv_kerberos_port(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin corenet_udp_sendrecv_kerberos_port(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_udp_send_kerberos_port(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type kerberos_port_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype kerberos_port_t:udp_socket send_msg;
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_send_kerberos_port(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_udp_receive_kerberos_port(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type kerberos_port_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype kerberos_port_t:udp_socket recv_msg;
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_receive_kerberos_port(test_noopen_usertype) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_sendrecv_kerberos_port(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin corenet_tcp_bind_generic_node(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type node_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype node_t:tcp_socket node_bind;
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_bind_generic_node(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin corenet_udp_bind_generic_node(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type node_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype node_t:udp_socket node_bind;
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_bind_generic_node(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin corenet_tcp_connect_kerberos_port(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type kerberos_port_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype kerberos_port_t:tcp_socket name_connect;
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_connect_kerberos_port(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin corenet_tcp_connect_ocsp_port(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type ocsp_port_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype ocsp_port_t:tcp_socket name_connect;
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_connect_ocsp_port(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin corenet_sendrecv_kerberos_client_packets(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_send_kerberos_client_packets(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type kerberos_client_packet_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype kerberos_client_packet_t:packet send;
#line 47

#line 47
	 	
#line 47
##### end corenet_send_kerberos_client_packets(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_receive_kerberos_client_packets(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type kerberos_client_packet_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype kerberos_client_packet_t:packet recv;
#line 47

#line 47
	 	
#line 47
##### end corenet_receive_kerberos_client_packets(test_noopen_usertype) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corenet_sendrecv_kerberos_client_packets(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
		 	 	
#line 47
##### begin corenet_sendrecv_ocsp_client_packets(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_send_ocsp_client_packets(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type ocsp_client_packet_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype ocsp_client_packet_t:packet send;
#line 47

#line 47
	 	
#line 47
##### end corenet_send_ocsp_client_packets(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_receive_ocsp_client_packets(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type ocsp_client_packet_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype ocsp_client_packet_t:packet recv;
#line 47

#line 47
	 	
#line 47
##### end corenet_receive_ocsp_client_packets(test_noopen_usertype) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corenet_sendrecv_ocsp_client_packets(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
		allow test_noopen_usertype krb5_host_rcache_t:dir { getattr search open };
#line 47
		allow test_noopen_usertype krb5_host_rcache_t:file { getattr };
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool kerberos_enabled;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (kerberos_enabled) {
#line 47
		
#line 47
			 	 	
#line 47
##### begin pcscd_stream_connect(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type pcscd_t, pcscd_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype pcscd_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype pcscd_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype pcscd_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end pcscd_stream_connect(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin sssd_read_public_files(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sssd_public_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin sssd_search_lib(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sssd_var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype sssd_var_lib_t:dir { getattr search open };
#line 47
	 	 	
#line 47
##### begin files_search_var_lib(test_noopen_usertype) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_lib_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_var_lib(test_noopen_usertype) depth: 7
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end sssd_search_lib(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype sssd_public_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype sssd_public_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype sssd_public_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype sssd_public_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
    allow test_noopen_usertype sssd_public_t:file map;
#line 47

#line 47
	 	
#line 47
##### end sssd_read_public_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	 	
#line 47
##### end kerberos_use(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin init_write_key(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type init_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype init_t:key read;
#line 47

#line 47
	 	
#line 47
##### end init_write_key(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin mysql_filetrans_named_content(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type mysqld_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin userdom_admin_home_dir_filetrans(test_noopen_usertype,mysqld_home_t,file,".my.cnf") depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type admin_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype admin_home_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype admin_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_usertype admin_home_t:file mysqld_home_t ".my.cnf";
#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_admin_home_dir_filetrans(test_noopen_usertype,mysqld_home_t,file,".my.cnf") depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin userdom_user_home_dir_filetrans(test_noopen_usertype,mysqld_home_t,file,".my.cnf") depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_dir_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_usertype user_home_dir_t:file mysqld_home_t ".my.cnf";
#line 47

#line 47
	 	 	
#line 47
##### begin files_search_home(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype home_root_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_search_home(test_noopen_usertype) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_user_home_dir_filetrans(test_noopen_usertype,mysqld_home_t,file,".my.cnf") depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end mysql_filetrans_named_content(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin mta_dontaudit_read_spool_symlinks(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type mail_spool_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype mail_spool_t:lnk_file read;
#line 47

#line 47
	 	
#line 47
##### end mta_dontaudit_read_spool_symlinks(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin quota_dontaudit_getattr_db(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type quota_db_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype quota_db_t:file { getattr };
#line 47

#line 47
	 	
#line 47
##### end quota_dontaudit_getattr_db(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin rpm_read_db(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type rpm_var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var_lib(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_lib_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_var_lib(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	allow test_noopen_usertype rpm_var_lib_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype rpm_var_lib_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype rpm_var_lib_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype rpm_var_lib_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype rpm_var_lib_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_usertype rpm_var_lib_t:file map;
#line 47
	 	 	
#line 47
##### begin rpm_read_cache(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type rpm_var_cache_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_var(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	allow test_noopen_usertype rpm_var_cache_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype rpm_var_cache_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype rpm_var_cache_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype rpm_var_cache_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype rpm_var_cache_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end rpm_read_cache(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end rpm_read_db(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin rpm_dontaudit_manage_db(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type rpm_var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype rpm_var_lib_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47
	dontaudit test_noopen_usertype rpm_var_lib_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47
	dontaudit test_noopen_usertype rpm_var_lib_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 47
	dontaudit test_noopen_usertype rpm_var_lib_t:file map;
#line 47

#line 47
	 	
#line 47
##### end rpm_dontaudit_manage_db(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin rpm_read_cache(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type rpm_var_cache_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_var(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	allow test_noopen_usertype rpm_var_cache_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype rpm_var_cache_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype rpm_var_cache_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype rpm_var_cache_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype rpm_var_cache_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end rpm_read_cache(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin oddjob_run_mkhomedir(test_noopen_t,test_noopen_r) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type oddjob_mkhomedir_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin oddjob_domtrans_mkhomedir(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type oddjob_mkhomedir_t, oddjob_mkhomedir_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t oddjob_mkhomedir_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t oddjob_mkhomedir_t:process transition;
#line 47
#	dontaudit test_noopen_t oddjob_mkhomedir_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t oddjob_mkhomedir_exec_t:process oddjob_mkhomedir_t;
#line 47

#line 47

#line 47
	allow oddjob_mkhomedir_t test_noopen_t:fd use;
#line 47
	allow oddjob_mkhomedir_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow oddjob_mkhomedir_t test_noopen_t:process sigchld;
#line 47

#line 47
    allow test_noopen_t oddjob_mkhomedir_exec_t:file map;
#line 47

#line 47
	 	
#line 47
##### end oddjob_domtrans_mkhomedir(test_noopen_t) depth: 5
#line 47
 	
#line 47
	role test_noopen_r types oddjob_mkhomedir_t;
#line 47

#line 47
	 	
#line 47
##### end oddjob_run_mkhomedir(test_noopen_t,test_noopen_r) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin oddjob_run(test_noopen_t,test_noopen_r) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type oddjob_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin oddjob_domtrans(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type oddjob_t, oddjob_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t oddjob_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t oddjob_t:process transition;
#line 47
#	dontaudit test_noopen_t oddjob_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t oddjob_exec_t:process oddjob_t;
#line 47

#line 47

#line 47
	allow oddjob_t test_noopen_t:fd use;
#line 47
	allow oddjob_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow oddjob_t test_noopen_t:process sigchld;
#line 47

#line 47

#line 47
	 	
#line 47
##### end oddjob_domtrans(test_noopen_t) depth: 5
#line 47
 	
#line 47
	role test_noopen_r types oddjob_t;
#line 47

#line 47
	 	
#line 47
##### end oddjob_run(test_noopen_t,test_noopen_r) depth: 4
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
    
#line 47
	optional {
#line 47
		
#line 47
         	 	
#line 47
##### begin chronyd_run_chronyc(test_noopen_t,test_noopen_r) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type chronyc_t;
#line 47
        attribute_role chronyc_roles;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin chronyd_domtrans_chronyc(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type chronyc_t, chronyc_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t chronyc_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t chronyc_t:process transition;
#line 47
#	dontaudit test_noopen_t chronyc_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t chronyc_exec_t:process chronyc_t;
#line 47

#line 47

#line 47
	allow chronyc_t test_noopen_t:fd use;
#line 47
	allow chronyc_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow chronyc_t test_noopen_t:process sigchld;
#line 47

#line 47

#line 47
	 	
#line 47
##### end chronyd_domtrans_chronyc(test_noopen_t) depth: 5
#line 47
 	
#line 47
    roleattribute test_noopen_r chronyc_roles;
#line 47

#line 47
	 	
#line 47
##### end chronyd_run_chronyc(test_noopen_t,test_noopen_r) depth: 4
#line 47
 	
#line 47
    
#line 47
	} # end optional
#line 47

#line 47

#line 47
    
#line 47
	optional {
#line 47
		
#line 47
         	 	
#line 47
##### begin ipa_run_helper(test_noopen_t,test_noopen_r) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type ipa_helper_t;
#line 47
        attribute_role ipa_helper_roles;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin ipa_domtrans_helper(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type ipa_helper_t, ipa_helper_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t ipa_helper_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t ipa_helper_t:process transition;
#line 47
#	dontaudit test_noopen_t ipa_helper_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t ipa_helper_exec_t:process ipa_helper_t;
#line 47

#line 47

#line 47
	allow ipa_helper_t test_noopen_t:fd use;
#line 47
	allow ipa_helper_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow ipa_helper_t test_noopen_t:process sigchld;
#line 47

#line 47

#line 47
	 	
#line 47
##### end ipa_domtrans_helper(test_noopen_t) depth: 5
#line 47
 	
#line 47
    roleattribute test_noopen_r ipa_helper_roles;
#line 47

#line 47
	 	
#line 47
##### end ipa_run_helper(test_noopen_t,test_noopen_r) depth: 4
#line 47
 	
#line 47
    
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin wine_filetrans_named_content(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type wine_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin userdom_user_home_dir_filetrans(test_noopen_usertype,wine_home_t,dir,".wine") depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_dir_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_usertype user_home_dir_t:dir wine_home_t ".wine";
#line 47

#line 47
	 	 	
#line 47
##### begin files_search_home(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype home_root_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_search_home(test_noopen_usertype) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_user_home_dir_filetrans(test_noopen_usertype,wine_home_t,dir,".wine") depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end wine_filetrans_named_content(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47
 	 	
#line 47
##### end userdom_login_user_template(test_noopen) depth: 3
#line 47
 	
#line 47

#line 47
	typeattribute test_noopen_t unpriv_userdomain;
#line 47
	 	 	
#line 47
##### begin domain_interactive_fd(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute privfd;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t privfd;
#line 47

#line 47
	 	
#line 47
##### end domain_interactive_fd(test_noopen_t) depth: 3
#line 47
 	
#line 47

#line 47
	allow test_noopen_usertype self:netlink_kobject_uevent_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 47
	dontaudit test_noopen_usertype self:netlink_audit_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 47

#line 47
	 	 	
#line 47
##### begin seutil_read_file_contexts(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type selinux_config_t, default_context_t, file_context_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_etc(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t etc_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_etc(test_noopen_t) depth: 4
#line 47
 	
#line 47
	allow test_noopen_t { selinux_config_t default_context_t }:dir { getattr search open };
#line 47
	
#line 47
	allow test_noopen_t file_context_t:dir { getattr search open };
#line 47
	allow test_noopen_t file_context_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_t file_context_t:dir { getattr search open };
#line 47
	allow test_noopen_t file_context_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_t file_context_t:dir { getattr search open };
#line 47
	allow test_noopen_t file_context_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_t file_context_t:file map;
#line 47

#line 47
	 	
#line 47
##### end seutil_read_file_contexts(test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin seutil_read_default_contexts(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type selinux_config_t, default_context_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_etc(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t etc_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_etc(test_noopen_t) depth: 4
#line 47
 	
#line 47
	allow test_noopen_t selinux_config_t:dir { getattr search open };
#line 47
	allow test_noopen_t default_context_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_t default_context_t:dir { getattr search open };
#line 47
	allow test_noopen_t default_context_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end seutil_read_default_contexts(test_noopen_t) depth: 3
#line 47
 	
#line 47

#line 47
	##############################
#line 47
	#
#line 47
	# Local policy
#line 47
	#
#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin loadkeys_run(test_noopen_t,test_noopen_r) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute_role loadkeys_roles;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin loadkeys_domtrans(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type loadkeys_t, loadkeys_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_search_bin(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_read_bin_symlinks(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_read_bin_symlinks(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_search_bin(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t loadkeys_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t loadkeys_t:process transition;
#line 47
#	dontaudit test_noopen_t loadkeys_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t loadkeys_exec_t:process loadkeys_t;
#line 47

#line 47

#line 47
	allow loadkeys_t test_noopen_t:fd use;
#line 47
	allow loadkeys_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow loadkeys_t test_noopen_t:process sigchld;
#line 47

#line 47

#line 47
	 	
#line 47
##### end loadkeys_domtrans(test_noopen_t) depth: 4
#line 47
 	
#line 47
	roleattribute test_noopen_r loadkeys_roles;
#line 47

#line 47
	 	
#line 47
##### end loadkeys_run(test_noopen_t,test_noopen_r) depth: 3
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47
 	 	
#line 47
##### end userdom_restricted_user_template(test_noopen) depth: 2
#line 47
 	
#line 47

#line 47
	##############################
#line 47
	#
#line 47
	# Local policy
#line 47
	#
#line 47
	 	 	
#line 47
##### begin kernel_stream_connect(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type kernel_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype kernel_t:unix_stream_socket connectto;
#line 47

#line 47
	 	
#line 47
##### end kernel_stream_connect(test_noopen_usertype) depth: 2
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin dev_read_sound(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t, sound_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype sound_device_t:chr_file { getattr open read lock ioctl };
#line 47

#line 47
	allow test_noopen_usertype sound_device_t:chr_file map;
#line 47

#line 47
	 	
#line 47
##### end dev_read_sound(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_write_sound(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t, sound_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype sound_device_t:chr_file { getattr open write append lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_write_sound(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	# gnome keyring wants to read this.
#line 47
	 	 	
#line 47
##### begin dev_dontaudit_read_rand(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type random_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype random_device_t:chr_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end dev_dontaudit_read_rand(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	# temporarily allow since openoffice requires this
#line 47
	 	 	
#line 47
##### begin dev_read_rand(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t, random_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype random_device_t:chr_file { getattr open read lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_read_rand(test_noopen_usertype) depth: 2
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin dev_read_video_dev(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t, v4l_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype v4l_device_t:chr_file { getattr open read lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_read_video_dev(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_write_video_dev(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t, v4l_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype v4l_device_t:chr_file { getattr open write append lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_write_video_dev(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_rw_wireless(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t, wireless_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype wireless_device_t:chr_file { open { getattr read write append ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_rw_wireless(test_noopen_usertype) depth: 2
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin libs_dontaudit_setattr_lib_files(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype lib_t:file setattr;
#line 47

#line 47
	 	
#line 47
##### end libs_dontaudit_setattr_lib_files(test_noopen_usertype) depth: 2
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin init_read_state(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type init_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype init_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype init_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_usertype init_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end init_read_state(test_noopen_usertype) depth: 2
#line 47
 	
#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool selinuxuser_rw_noexattrfile;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (selinuxuser_rw_noexattrfile) {
#line 47
		
#line 47
		 	 	
#line 47
##### begin dev_rw_usbfs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type usbfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t usbfs_t:dir { getattr search open };
#line 47
	allow test_noopen_t usbfs_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_t usbfs_t:dir { getattr search open };
#line 47
	allow test_noopen_t usbfs_t:file { open { getattr read write append ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_t usbfs_t:dir { getattr search open };
#line 47
	allow test_noopen_t usbfs_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_rw_usbfs(test_noopen_t) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin dev_rw_generic_usb_dev(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t, usb_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype usb_device_t:chr_file { open { getattr read write append ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_rw_generic_usb_dev(test_noopen_usertype) depth: 2
#line 47
 	
#line 47

#line 47
		 	 	
#line 47
##### begin fs_manage_noxattr_fs_files(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute noxattrfs;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype noxattrfs:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_usertype noxattrfs:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_noxattr_fs_files(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_noxattr_fs_dirs(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute noxattrfs;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype noxattrfs:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end fs_manage_noxattr_fs_dirs(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_dos_dirs(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type dosfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype dosfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_usertype dosfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_dos_dirs(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_dos_files(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type dosfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype dosfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_usertype dosfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_dos_files(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin storage_raw_read_removable_device(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type removable_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_list_all_dev_nodes(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype device_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_list_all_dev_nodes(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	allow test_noopen_usertype removable_device_t:blk_file { getattr open read lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end storage_raw_read_removable_device(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin storage_raw_write_removable_device(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type removable_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_list_all_dev_nodes(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype device_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_list_all_dev_nodes(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	allow test_noopen_usertype removable_device_t:blk_file { getattr open write append lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end storage_raw_write_removable_device(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin logging_send_syslog_msg(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute syslog_client_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t syslog_client_type;
#line 47

#line 47
	 	
#line 47
##### end logging_send_syslog_msg(test_noopen_t) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin logging_dontaudit_send_audit_msgs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	dontaudit test_noopen_t self:capability audit_write;
#line 47
	dontaudit test_noopen_t self:netlink_audit_socket { { { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } } nlmsg_read } nlmsg_relay };
#line 47

#line 47
	 	
#line 47
##### end logging_dontaudit_send_audit_msgs(test_noopen_t) depth: 2
#line 47
 	
#line 47

#line 47
	# Need to to this just so screensaver will work. Should be moved to screensaver domain
#line 47
	 	 	
#line 47
##### begin selinux_get_enforce_mode(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type security_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_search_sysfs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_search_sysfs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin selinux_get_fs_mount(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type security_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t security_t:lnk_file { getattr read };
#line 47
	 	 	
#line 47
##### begin dev_getattr_sysfs_fs(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t sysfs_t:filesystem getattr;
#line 47

#line 47
	 	
#line 47
##### end dev_getattr_sysfs_fs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_search_sysfs(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_search_sysfs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	# starting in libselinux 2.0.5, init_selinuxmnt() will
#line 47
	# attempt to short circuit by checking if SELINUXMNT
#line 47
	# (/selinux) is already a selinuxfs
#line 47
	allow test_noopen_t security_t:filesystem getattr;
#line 47

#line 47
	# read /proc/filesystems to see if selinuxfs is supported
#line 47
	# then read /proc/self/mount to see where selinuxfs is mounted
#line 47
	 	 	
#line 47
##### begin kernel_read_system_state(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute kernel_system_state_reader;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t kernel_system_state_reader;
#line 47

#line 47
	 	
#line 47
##### end kernel_read_system_state(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end selinux_get_fs_mount(test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_t security_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t security_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_t security_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end selinux_get_enforce_mode(test_noopen_t) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin seutil_exec_restorecond(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type restorecond_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_usr(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t usr_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_usr(test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_search_bin(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_read_bin_symlinks(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_read_bin_symlinks(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_search_bin(test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_t restorecond_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47

#line 47
	 	
#line 47
##### end seutil_exec_restorecond(test_noopen_t) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin seutil_read_file_contexts(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type selinux_config_t, default_context_t, file_context_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_etc(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t etc_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_etc(test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_t { selinux_config_t default_context_t }:dir { getattr search open };
#line 47
	
#line 47
	allow test_noopen_t file_context_t:dir { getattr search open };
#line 47
	allow test_noopen_t file_context_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_t file_context_t:dir { getattr search open };
#line 47
	allow test_noopen_t file_context_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_t file_context_t:dir { getattr search open };
#line 47
	allow test_noopen_t file_context_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_t file_context_t:file map;
#line 47

#line 47
	 	
#line 47
##### end seutil_read_file_contexts(test_noopen_t) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin seutil_read_default_contexts(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type selinux_config_t, default_context_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_etc(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t etc_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_etc(test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_t selinux_config_t:dir { getattr search open };
#line 47
	allow test_noopen_t default_context_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_t default_context_t:dir { getattr search open };
#line 47
	allow test_noopen_t default_context_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end seutil_read_default_contexts(test_noopen_t) depth: 2
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin xserver_restricted_role(test_noopen_r,test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type xauth_t, iceauth_t;
#line 47
		attribute dridomain, x_userdomain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	role test_noopen_r types { xauth_t iceauth_t };
#line 47
	typeattribute test_noopen_t x_userdomain, dridomain;
#line 47

#line 47
	 	 	
#line 47
##### begin xserver_common_x_domain_template(user,test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type root_xdrawable_t, xdm_t, xserver_t;
#line 47
		type xproperty_t, user_xproperty_t;
#line 47
		type xevent_t, client_xevent_t;
#line 47
		type input_xevent_t, user_input_xevent_t;
#line 47

#line 47
		attribute x_domain, input_xevent_type;
#line 47
		attribute xdrawable_type, xcolormap_type;
#line 47

#line 47
		class x_drawable { create destroy read write blend getattr setattr list_child add_child remove_child list_property get_property set_property manage override show hide send receive };
#line 47
		class x_property { create destroy read write append getattr setattr };
#line 47
		class x_event { send receive };
#line 47
		class x_synthetic_event { send receive };
#line 47
		class x_client destroy;
#line 47
		class x_server manage;
#line 47
		class x_screen { saver_setattr saver_hide saver_show show_cursor hide_cursor };
#line 47
		class x_pointer { get_property set_property manage };
#line 47
		class x_keyboard { read manage freeze };
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	##############################
#line 47
	#
#line 47
	# Local Policy
#line 47
	#
#line 47

#line 47
	# Type attributes
#line 47
	typeattribute test_noopen_t x_domain;
#line 47
	typeattribute test_noopen_t xdrawable_type, xcolormap_type;
#line 47

#line 47
	# X Properties
#line 47
	# disable property transitions for the time being.
#line 47
#	type_transition test_noopen_t xproperty_t:x_property user_xproperty_t;
#line 47

#line 47
	# X Windows
#line 47
	# new windows have the domain type
#line 47
	type_transition test_noopen_t root_xdrawable_t:x_drawable test_noopen_t;
#line 47

#line 47
	# X Input
#line 47
	# distinguish input events
#line 47
	type_transition test_noopen_t input_xevent_t:x_event user_input_xevent_t;
#line 47
	# can send own events
#line 47
	allow test_noopen_t user_input_xevent_t:{ x_event x_synthetic_event } send;
#line 47
	# can receive own events
#line 47
	allow test_noopen_t user_input_xevent_t:{ x_event x_synthetic_event } receive;
#line 47
	# can receive default events
#line 47
	allow test_noopen_t client_xevent_t:{ x_event x_synthetic_event } receive;
#line 47
	allow test_noopen_t xevent_t:{ x_event x_synthetic_event } { send receive };
#line 47
	# dont audit send failures
#line 47
	dontaudit test_noopen_t input_xevent_type:x_event send;
#line 47

#line 47
	allow test_noopen_t xdm_t:x_drawable { hide read add_child manage };
#line 47
	allow test_noopen_t xdm_t:x_client destroy;
#line 47

#line 47
	allow test_noopen_t root_xdrawable_t:x_drawable write;
#line 47
	allow test_noopen_t xserver_t:x_server manage;
#line 47
	allow test_noopen_t xserver_t:x_screen { show_cursor hide_cursor saver_setattr saver_hide saver_show };
#line 47
	allow test_noopen_t xserver_t:x_pointer { get_property set_property manage };
#line 47
	allow test_noopen_t xserver_t:x_keyboard { read manage freeze };
#line 47
 	 	
#line 47
##### end xserver_common_x_domain_template(user,test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin xserver_stream_connect_xdm(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type xdm_t, xdm_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_tmp(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin fs_search_tmpfs(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t tmpfs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_tmpfs(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_t tmp_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_t tmp_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_tmp(test_noopen_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_t var_t:dir { getattr search open };
#line 47
	allow test_noopen_t var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t { xdm_var_run_t }:dir { getattr search open };
#line 47
	allow test_noopen_t { xdm_var_run_t }:sock_file { getattr write open append };
#line 47
	allow test_noopen_t xdm_t:unix_stream_socket connectto;
#line 47

#line 47
     	 	
#line 47
##### begin userdom_stream_connect(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_tmp_t;
#line 47
		attribute userdomain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t user_tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_t user_tmp_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_t userdomain:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_stream_connect(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end xserver_stream_connect_xdm(test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin xserver_xdm_append_log(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type xdm_log_t;
#line 47
		attribute xdmhomewriter;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t xdmhomewriter;
#line 47
	allow test_noopen_t xdm_log_t:file { getattr append };
#line 47

#line 47
	 	
#line 47
##### end xserver_xdm_append_log(test_noopen_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin xserver_dri_domain(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute dridomain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t dridomain;
#line 47

#line 47
	 	
#line 47
##### end xserver_dri_domain(test_noopen_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end xserver_restricted_role(test_noopen_r,test_noopen_t) depth: 2
#line 47
 	
#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin alsa_read_rw_config(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type alsa_etc_rw_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_etc(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_etc(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	allow test_noopen_usertype alsa_etc_rw_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype alsa_etc_rw_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype alsa_etc_rw_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype alsa_etc_rw_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype alsa_etc_rw_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	
#line 47

#line 47
	 	
#line 47
##### end alsa_read_rw_config(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	 # cjp: needed by KDE apps
#line 47
	 # bug: #682499
#line 47
	 
#line 47
	optional {
#line 47
		
#line 47
	 	 	 	
#line 47
##### begin gnome_read_usr_config(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
        
#line 47
	
#line 47
		require {
#line 47
			
#line 47
                type config_usr_t;
#line 47
        
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
         	 	
#line 47
##### begin files_search_usr(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype usr_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_usr(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
		
#line 47
	allow test_noopen_usertype config_usr_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype config_usr_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
		
#line 47
	allow test_noopen_usertype config_usr_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype config_usr_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
		
#line 47
	allow test_noopen_usertype config_usr_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype config_usr_t:lnk_file { getattr read };
#line 47
	
#line 47

#line 47
	 	
#line 47
##### end gnome_read_usr_config(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		# cjp: telepathy F15 bugs
#line 47
		 	 	
#line 47
##### begin telepathy_role(test_noopen_r,test_noopen_t,test_noopen) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute telepathy_domain;
#line 47
		type telepathy_gabble_t, telepathy_sofiasip_t, telepathy_idle_t;
#line 47
		type telepathy_mission_control_t, telepathy_salut_t, telepathy_sunshine_t;
#line 47
		type telepathy_stream_engine_t, telepathy_msn_t, telepathy_gabble_exec_t;
#line 47
		type telepathy_sofiasip_exec_t, telepathy_idle_exec_t;
#line 47
		type telepathy_logger_t, telepathy_logger_exec_t;
#line 47
		type telepathy_mission_control_exec_t, telepathy_salut_exec_t;
#line 47
		type telepathy_sunshine_exec_t, telepathy_stream_engine_exec_t;
#line 47
		type telepathy_msn_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	role test_noopen_r types telepathy_domain;
#line 47

#line 47
	allow test_noopen_t telepathy_domain:process { sigchld sigkill sigstop signull signal };
#line 47
	
#line 47
	allow test_noopen_t telepathy_domain:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t telepathy_domain:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_t telepathy_domain:lnk_file { getattr read };
#line 47
	allow test_noopen_t telepathy_domain:process getattr;
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin telepathy_gabble_stream_connect(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type telepathy_gabble_t, telepathy_gabble_tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t telepathy_gabble_tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_t telepathy_gabble_tmp_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_t telepathy_gabble_t:unix_stream_socket connectto;
#line 47

#line 47
	 	 	
#line 47
##### begin files_search_tmp(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin fs_search_tmpfs(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t tmpfs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_tmpfs(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_t tmp_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_t tmp_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_tmp(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end telepathy_gabble_stream_connect(test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin telepathy_msn_stream_connect(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type telepathy_msn_t, telepathy_msn_tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t telepathy_msn_tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_t telepathy_msn_tmp_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_t telepathy_msn_t:unix_stream_socket connectto;
#line 47

#line 47
	 	 	
#line 47
##### begin files_search_tmp(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin fs_search_tmpfs(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t tmpfs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_tmpfs(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_t tmp_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_t tmp_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_tmp(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end telepathy_msn_stream_connect(test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin telepathy_salut_stream_connect(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type telepathy_salut_t, telepathy_salut_tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t telepathy_salut_tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_t telepathy_salut_tmp_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_t telepathy_salut_t:unix_stream_socket connectto;
#line 47

#line 47
	 	 	
#line 47
##### begin files_search_tmp(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin fs_search_tmpfs(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t tmpfs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_tmpfs(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_t tmp_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_t tmp_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_tmp(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end telepathy_salut_stream_connect(test_noopen_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin dbus_session_domain(test_noopen,telepathy_gabble_exec_t,telepathy_gabble_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type test_noopen_dbusd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_dbusd_t telepathy_gabble_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_dbusd_t telepathy_gabble_t:process transition;
#line 47
#	dontaudit test_noopen_dbusd_t telepathy_gabble_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_dbusd_t telepathy_gabble_exec_t:process telepathy_gabble_t;
#line 47

#line 47

#line 47
	allow telepathy_gabble_t test_noopen_dbusd_t:fd use;
#line 47
	allow telepathy_gabble_t test_noopen_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow telepathy_gabble_t test_noopen_dbusd_t:process sigchld;
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dbus_session_bus_client(telepathy_gabble_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	# SE-DBus specific permissions
#line 47
	allow telepathy_gabble_t { session_bus_type self }:dbus send_msg;
#line 47

#line 47
	# For connecting to the bus
#line 47
	allow telepathy_gabble_t session_bus_type:unix_stream_socket connectto;
#line 47

#line 47
	allow session_bus_type telepathy_gabble_t:process sigkill;
#line 47

#line 47
	 	
#line 47
##### end dbus_session_bus_client(telepathy_gabble_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_connect_session_bus(telepathy_gabble_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus acquire_svc;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow telepathy_gabble_t session_bus_type:dbus acquire_svc;
#line 47

#line 47
	 	
#line 47
##### end dbus_connect_session_bus(telepathy_gabble_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end dbus_session_domain(test_noopen,telepathy_gabble_exec_t,telepathy_gabble_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_session_domain(test_noopen,telepathy_sofiasip_exec_t,telepathy_sofiasip_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type test_noopen_dbusd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_dbusd_t telepathy_sofiasip_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_dbusd_t telepathy_sofiasip_t:process transition;
#line 47
#	dontaudit test_noopen_dbusd_t telepathy_sofiasip_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_dbusd_t telepathy_sofiasip_exec_t:process telepathy_sofiasip_t;
#line 47

#line 47

#line 47
	allow telepathy_sofiasip_t test_noopen_dbusd_t:fd use;
#line 47
	allow telepathy_sofiasip_t test_noopen_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow telepathy_sofiasip_t test_noopen_dbusd_t:process sigchld;
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dbus_session_bus_client(telepathy_sofiasip_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	# SE-DBus specific permissions
#line 47
	allow telepathy_sofiasip_t { session_bus_type self }:dbus send_msg;
#line 47

#line 47
	# For connecting to the bus
#line 47
	allow telepathy_sofiasip_t session_bus_type:unix_stream_socket connectto;
#line 47

#line 47
	allow session_bus_type telepathy_sofiasip_t:process sigkill;
#line 47

#line 47
	 	
#line 47
##### end dbus_session_bus_client(telepathy_sofiasip_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_connect_session_bus(telepathy_sofiasip_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus acquire_svc;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow telepathy_sofiasip_t session_bus_type:dbus acquire_svc;
#line 47

#line 47
	 	
#line 47
##### end dbus_connect_session_bus(telepathy_sofiasip_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end dbus_session_domain(test_noopen,telepathy_sofiasip_exec_t,telepathy_sofiasip_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_session_domain(test_noopen,telepathy_idle_exec_t,telepathy_idle_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type test_noopen_dbusd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_dbusd_t telepathy_idle_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_dbusd_t telepathy_idle_t:process transition;
#line 47
#	dontaudit test_noopen_dbusd_t telepathy_idle_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_dbusd_t telepathy_idle_exec_t:process telepathy_idle_t;
#line 47

#line 47

#line 47
	allow telepathy_idle_t test_noopen_dbusd_t:fd use;
#line 47
	allow telepathy_idle_t test_noopen_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow telepathy_idle_t test_noopen_dbusd_t:process sigchld;
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dbus_session_bus_client(telepathy_idle_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	# SE-DBus specific permissions
#line 47
	allow telepathy_idle_t { session_bus_type self }:dbus send_msg;
#line 47

#line 47
	# For connecting to the bus
#line 47
	allow telepathy_idle_t session_bus_type:unix_stream_socket connectto;
#line 47

#line 47
	allow session_bus_type telepathy_idle_t:process sigkill;
#line 47

#line 47
	 	
#line 47
##### end dbus_session_bus_client(telepathy_idle_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_connect_session_bus(telepathy_idle_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus acquire_svc;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow telepathy_idle_t session_bus_type:dbus acquire_svc;
#line 47

#line 47
	 	
#line 47
##### end dbus_connect_session_bus(telepathy_idle_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end dbus_session_domain(test_noopen,telepathy_idle_exec_t,telepathy_idle_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_session_domain(test_noopen,telepathy_logger_exec_t,telepathy_logger_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type test_noopen_dbusd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_dbusd_t telepathy_logger_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_dbusd_t telepathy_logger_t:process transition;
#line 47
#	dontaudit test_noopen_dbusd_t telepathy_logger_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_dbusd_t telepathy_logger_exec_t:process telepathy_logger_t;
#line 47

#line 47

#line 47
	allow telepathy_logger_t test_noopen_dbusd_t:fd use;
#line 47
	allow telepathy_logger_t test_noopen_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow telepathy_logger_t test_noopen_dbusd_t:process sigchld;
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dbus_session_bus_client(telepathy_logger_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	# SE-DBus specific permissions
#line 47
	allow telepathy_logger_t { session_bus_type self }:dbus send_msg;
#line 47

#line 47
	# For connecting to the bus
#line 47
	allow telepathy_logger_t session_bus_type:unix_stream_socket connectto;
#line 47

#line 47
	allow session_bus_type telepathy_logger_t:process sigkill;
#line 47

#line 47
	 	
#line 47
##### end dbus_session_bus_client(telepathy_logger_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_connect_session_bus(telepathy_logger_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus acquire_svc;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow telepathy_logger_t session_bus_type:dbus acquire_svc;
#line 47

#line 47
	 	
#line 47
##### end dbus_connect_session_bus(telepathy_logger_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end dbus_session_domain(test_noopen,telepathy_logger_exec_t,telepathy_logger_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_session_domain(test_noopen,telepathy_mission_control_exec_t,telepathy_mission_control_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type test_noopen_dbusd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_dbusd_t telepathy_mission_control_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_dbusd_t telepathy_mission_control_t:process transition;
#line 47
#	dontaudit test_noopen_dbusd_t telepathy_mission_control_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_dbusd_t telepathy_mission_control_exec_t:process telepathy_mission_control_t;
#line 47

#line 47

#line 47
	allow telepathy_mission_control_t test_noopen_dbusd_t:fd use;
#line 47
	allow telepathy_mission_control_t test_noopen_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow telepathy_mission_control_t test_noopen_dbusd_t:process sigchld;
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dbus_session_bus_client(telepathy_mission_control_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	# SE-DBus specific permissions
#line 47
	allow telepathy_mission_control_t { session_bus_type self }:dbus send_msg;
#line 47

#line 47
	# For connecting to the bus
#line 47
	allow telepathy_mission_control_t session_bus_type:unix_stream_socket connectto;
#line 47

#line 47
	allow session_bus_type telepathy_mission_control_t:process sigkill;
#line 47

#line 47
	 	
#line 47
##### end dbus_session_bus_client(telepathy_mission_control_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_connect_session_bus(telepathy_mission_control_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus acquire_svc;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow telepathy_mission_control_t session_bus_type:dbus acquire_svc;
#line 47

#line 47
	 	
#line 47
##### end dbus_connect_session_bus(telepathy_mission_control_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end dbus_session_domain(test_noopen,telepathy_mission_control_exec_t,telepathy_mission_control_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_session_domain(test_noopen,telepathy_salut_exec_t,telepathy_salut_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type test_noopen_dbusd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_dbusd_t telepathy_salut_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_dbusd_t telepathy_salut_t:process transition;
#line 47
#	dontaudit test_noopen_dbusd_t telepathy_salut_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_dbusd_t telepathy_salut_exec_t:process telepathy_salut_t;
#line 47

#line 47

#line 47
	allow telepathy_salut_t test_noopen_dbusd_t:fd use;
#line 47
	allow telepathy_salut_t test_noopen_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow telepathy_salut_t test_noopen_dbusd_t:process sigchld;
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dbus_session_bus_client(telepathy_salut_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	# SE-DBus specific permissions
#line 47
	allow telepathy_salut_t { session_bus_type self }:dbus send_msg;
#line 47

#line 47
	# For connecting to the bus
#line 47
	allow telepathy_salut_t session_bus_type:unix_stream_socket connectto;
#line 47

#line 47
	allow session_bus_type telepathy_salut_t:process sigkill;
#line 47

#line 47
	 	
#line 47
##### end dbus_session_bus_client(telepathy_salut_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_connect_session_bus(telepathy_salut_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus acquire_svc;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow telepathy_salut_t session_bus_type:dbus acquire_svc;
#line 47

#line 47
	 	
#line 47
##### end dbus_connect_session_bus(telepathy_salut_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end dbus_session_domain(test_noopen,telepathy_salut_exec_t,telepathy_salut_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_session_domain(test_noopen,telepathy_sunshine_exec_t,telepathy_sunshine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type test_noopen_dbusd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_dbusd_t telepathy_sunshine_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_dbusd_t telepathy_sunshine_t:process transition;
#line 47
#	dontaudit test_noopen_dbusd_t telepathy_sunshine_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_dbusd_t telepathy_sunshine_exec_t:process telepathy_sunshine_t;
#line 47

#line 47

#line 47
	allow telepathy_sunshine_t test_noopen_dbusd_t:fd use;
#line 47
	allow telepathy_sunshine_t test_noopen_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow telepathy_sunshine_t test_noopen_dbusd_t:process sigchld;
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dbus_session_bus_client(telepathy_sunshine_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	# SE-DBus specific permissions
#line 47
	allow telepathy_sunshine_t { session_bus_type self }:dbus send_msg;
#line 47

#line 47
	# For connecting to the bus
#line 47
	allow telepathy_sunshine_t session_bus_type:unix_stream_socket connectto;
#line 47

#line 47
	allow session_bus_type telepathy_sunshine_t:process sigkill;
#line 47

#line 47
	 	
#line 47
##### end dbus_session_bus_client(telepathy_sunshine_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_connect_session_bus(telepathy_sunshine_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus acquire_svc;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow telepathy_sunshine_t session_bus_type:dbus acquire_svc;
#line 47

#line 47
	 	
#line 47
##### end dbus_connect_session_bus(telepathy_sunshine_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end dbus_session_domain(test_noopen,telepathy_sunshine_exec_t,telepathy_sunshine_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_session_domain(test_noopen,telepathy_stream_engine_exec_t,telepathy_stream_engine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type test_noopen_dbusd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_dbusd_t telepathy_stream_engine_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_dbusd_t telepathy_stream_engine_t:process transition;
#line 47
#	dontaudit test_noopen_dbusd_t telepathy_stream_engine_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_dbusd_t telepathy_stream_engine_exec_t:process telepathy_stream_engine_t;
#line 47

#line 47

#line 47
	allow telepathy_stream_engine_t test_noopen_dbusd_t:fd use;
#line 47
	allow telepathy_stream_engine_t test_noopen_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow telepathy_stream_engine_t test_noopen_dbusd_t:process sigchld;
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dbus_session_bus_client(telepathy_stream_engine_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	# SE-DBus specific permissions
#line 47
	allow telepathy_stream_engine_t { session_bus_type self }:dbus send_msg;
#line 47

#line 47
	# For connecting to the bus
#line 47
	allow telepathy_stream_engine_t session_bus_type:unix_stream_socket connectto;
#line 47

#line 47
	allow session_bus_type telepathy_stream_engine_t:process sigkill;
#line 47

#line 47
	 	
#line 47
##### end dbus_session_bus_client(telepathy_stream_engine_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_connect_session_bus(telepathy_stream_engine_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus acquire_svc;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow telepathy_stream_engine_t session_bus_type:dbus acquire_svc;
#line 47

#line 47
	 	
#line 47
##### end dbus_connect_session_bus(telepathy_stream_engine_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end dbus_session_domain(test_noopen,telepathy_stream_engine_exec_t,telepathy_stream_engine_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_session_domain(test_noopen,telepathy_msn_exec_t,telepathy_msn_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type test_noopen_dbusd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_dbusd_t telepathy_msn_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_dbusd_t telepathy_msn_t:process transition;
#line 47
#	dontaudit test_noopen_dbusd_t telepathy_msn_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_dbusd_t telepathy_msn_exec_t:process telepathy_msn_t;
#line 47

#line 47

#line 47
	allow telepathy_msn_t test_noopen_dbusd_t:fd use;
#line 47
	allow telepathy_msn_t test_noopen_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow telepathy_msn_t test_noopen_dbusd_t:process sigchld;
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dbus_session_bus_client(telepathy_msn_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	# SE-DBus specific permissions
#line 47
	allow telepathy_msn_t { session_bus_type self }:dbus send_msg;
#line 47

#line 47
	# For connecting to the bus
#line 47
	allow telepathy_msn_t session_bus_type:unix_stream_socket connectto;
#line 47

#line 47
	allow session_bus_type telepathy_msn_t:process sigkill;
#line 47

#line 47
	 	
#line 47
##### end dbus_session_bus_client(telepathy_msn_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_connect_session_bus(telepathy_msn_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus acquire_svc;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow telepathy_msn_t session_bus_type:dbus acquire_svc;
#line 47

#line 47
	 	
#line 47
##### end dbus_connect_session_bus(telepathy_msn_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end dbus_session_domain(test_noopen,telepathy_msn_exec_t,telepathy_msn_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin telepathy_dbus_chat(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute telepathy_domain;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t telepathy_domain:dbus send_msg;
#line 47
	allow telepathy_domain test_noopen_t:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end telepathy_dbus_chat(test_noopen_t) depth: 3
#line 47
 	
#line 47
 	 	
#line 47
##### end telepathy_role(test_noopen_r,test_noopen_t,test_noopen) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin obex_role(test_noopen_r,test_noopen_t,test_noopen) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute_role obex_roles;
#line 47
	        type obex_t, obex_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	########################################
#line 47
	#		 
#line 47
	# Declarations
#line 47
	#
#line 47

#line 47
    	roleattribute test_noopen_r obex_roles;
#line 47

#line 47
	########################################
#line 47
	#    
#line 47
	# Policy
#line 47
	#         
#line 47

#line 47
	allow test_noopen_t obex_t:process { sigchld sigkill sigstop signull signal };
#line 47
	
#line 47
	allow test_noopen_t obex_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t obex_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_t obex_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t obex_t:process getattr;
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dbus_session_domain(test_noopen,obex_exec_t,obex_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type test_noopen_dbusd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_dbusd_t obex_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_dbusd_t obex_t:process transition;
#line 47
#	dontaudit test_noopen_dbusd_t obex_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_dbusd_t obex_exec_t:process obex_t;
#line 47

#line 47

#line 47
	allow obex_t test_noopen_dbusd_t:fd use;
#line 47
	allow obex_t test_noopen_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow obex_t test_noopen_dbusd_t:process sigchld;
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dbus_session_bus_client(obex_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	# SE-DBus specific permissions
#line 47
	allow obex_t { session_bus_type self }:dbus send_msg;
#line 47

#line 47
	# For connecting to the bus
#line 47
	allow obex_t session_bus_type:unix_stream_socket connectto;
#line 47

#line 47
	allow session_bus_type obex_t:process sigkill;
#line 47

#line 47
	 	
#line 47
##### end dbus_session_bus_client(obex_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_connect_session_bus(obex_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus acquire_svc;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow obex_t session_bus_type:dbus acquire_svc;
#line 47

#line 47
	 	
#line 47
##### end dbus_connect_session_bus(obex_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end dbus_session_domain(test_noopen,obex_exec_t,obex_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin obex_dbus_chat(test_noopen_t) depth: 4
#line 47
 	
#line 47
    
#line 47
	
#line 47
		require {
#line 47
			
#line 47
        type obex_t;
#line 47
        class dbus send_msg;
#line 47
    
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
    allow test_noopen_t obex_t:dbus send_msg;
#line 47
    allow obex_t test_noopen_t:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end obex_dbus_chat(test_noopen_t) depth: 3
#line 47
 	
#line 47
 	 	
#line 47
##### end obex_role(test_noopen_r,test_noopen_t,test_noopen) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin dbus_role_template(test_noopen,test_noopen_r,test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		class dbus { send_msg acquire_svc };
#line 47
		attribute dbusd_unconfined, session_bus_type;
#line 47
		type system_dbusd_t, session_dbusd_tmp_t, dbusd_exec_t, dbusd_etc_t;
#line 47
		type test_noopen_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	##############################
#line 47
	#
#line 47
	# Delcarations
#line 47
	#
#line 47

#line 47
	type test_noopen_dbusd_t, session_bus_type;
#line 47
	 	 	
#line 47
##### begin application_domain(test_noopen_dbusd_t,dbusd_exec_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin application_type(test_noopen_dbusd_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute application_domain_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_dbusd_t application_domain_type;
#line 47

#line 47
	# start with basic domain
#line 47
	 	 	
#line 47
##### begin domain_type(test_noopen_dbusd_t) depth: 6
#line 47
 	
#line 47
	# start with basic domain
#line 47
	 	 	
#line 47
##### begin domain_base_type(test_noopen_dbusd_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_dbusd_t domain;
#line 47

#line 47
	 	
#line 47
##### end domain_base_type(test_noopen_dbusd_t) depth: 6
#line 47
 	
#line 47

#line 47
	# Only way to get corenet_unlabeled packets disabled to work
#line 47
	 	 	
#line 47
##### begin corenet_all_recvfrom_unlabeled(test_noopen_dbusd_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
                attribute corenet_unlabeled_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	typeattribute test_noopen_dbusd_t corenet_unlabeled_type;
#line 47

#line 47
	 	
#line 47
##### end corenet_all_recvfrom_unlabeled(test_noopen_dbusd_t) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end domain_type(test_noopen_dbusd_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end application_type(test_noopen_dbusd_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin application_executable_file(dbusd_exec_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute application_exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute dbusd_exec_t application_exec_type;
#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_executable_file(dbusd_exec_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute dbusd_exec_t exec_type;
#line 47

#line 47
	 	 	
#line 47
##### begin files_type(dbusd_exec_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute dbusd_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 47

#line 47
	 	
#line 47
##### end files_type(dbusd_exec_t) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corecmd_executable_file(dbusd_exec_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end application_executable_file(dbusd_exec_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin domain_entry_file(test_noopen_dbusd_t,dbusd_exec_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute entry_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_dbusd_t dbusd_exec_t:file entrypoint;
#line 47
	allow test_noopen_dbusd_t dbusd_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 47

#line 47
	typeattribute dbusd_exec_t entry_type;
#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_executable_file(dbusd_exec_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute dbusd_exec_t exec_type;
#line 47

#line 47
	 	 	
#line 47
##### begin files_type(dbusd_exec_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute dbusd_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 47

#line 47
	 	
#line 47
##### end files_type(dbusd_exec_t) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corecmd_executable_file(dbusd_exec_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end domain_entry_file(test_noopen_dbusd_t,dbusd_exec_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end application_domain(test_noopen_dbusd_t,dbusd_exec_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin ubac_constrained(test_noopen_dbusd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute ubac_constrained_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_dbusd_t ubac_constrained_type;
#line 47

#line 47
	 	
#line 47
##### end ubac_constrained(test_noopen_dbusd_t) depth: 3
#line 47
 	
#line 47
	role test_noopen_r types test_noopen_dbusd_t;
#line 47

#line 47
	 	 	
#line 47
##### begin kernel_read_system_state(test_noopen_dbusd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute kernel_system_state_reader;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_dbusd_t kernel_system_state_reader;
#line 47

#line 47
	 	
#line 47
##### end kernel_read_system_state(test_noopen_dbusd_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin selinux_get_fs_mount(test_noopen_dbusd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type security_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_dbusd_t security_t:lnk_file { getattr read };
#line 47
	 	 	
#line 47
##### begin dev_getattr_sysfs_fs(test_noopen_dbusd_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_dbusd_t sysfs_t:filesystem getattr;
#line 47

#line 47
	 	
#line 47
##### end dev_getattr_sysfs_fs(test_noopen_dbusd_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_search_sysfs(test_noopen_dbusd_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_dbusd_t sysfs_t:dir { getattr search open };
#line 47
	allow test_noopen_dbusd_t sysfs_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_search_sysfs(test_noopen_dbusd_t) depth: 4
#line 47
 	
#line 47
	# starting in libselinux 2.0.5, init_selinuxmnt() will
#line 47
	# attempt to short circuit by checking if SELINUXMNT
#line 47
	# (/selinux) is already a selinuxfs
#line 47
	allow test_noopen_dbusd_t security_t:filesystem getattr;
#line 47

#line 47
	# read /proc/filesystems to see if selinuxfs is supported
#line 47
	# then read /proc/self/mount to see where selinuxfs is mounted
#line 47
	 	 	
#line 47
##### begin kernel_read_system_state(test_noopen_dbusd_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute kernel_system_state_reader;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_dbusd_t kernel_system_state_reader;
#line 47

#line 47
	 	
#line 47
##### end kernel_read_system_state(test_noopen_dbusd_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end selinux_get_fs_mount(test_noopen_dbusd_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin userdom_home_manager(test_noopen_dbusd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute userdom_home_manager_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_dbusd_t userdom_home_manager_type;
#line 47

#line 47
	 	
#line 47
##### end userdom_home_manager(test_noopen_dbusd_t) depth: 3
#line 47
 	
#line 47

#line 47
	##############################
#line 47
	#
#line 47
	# Local policy
#line 47
	#
#line 47

#line 47
	# For connecting to the bus
#line 47
	allow test_noopen_usertype test_noopen_dbusd_t:unix_stream_socket { connectto { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 47

#line 47
	# SE-DBus specific permissions
#line 47
	allow { dbusd_unconfined test_noopen_usertype } test_noopen_dbusd_t:dbus { send_msg acquire_svc };
#line 47
	allow test_noopen_usertype system_dbusd_t:dbus { send_msg acquire_svc };
#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_usertype dbusd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_usertype test_noopen_dbusd_t:process transition;
#line 47
#	dontaudit test_noopen_usertype test_noopen_dbusd_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_usertype dbusd_exec_t:process test_noopen_dbusd_t;
#line 47

#line 47

#line 47
	allow test_noopen_dbusd_t test_noopen_usertype:fd use;
#line 47
	allow test_noopen_dbusd_t test_noopen_usertype:fifo_file { getattr read write append ioctl lock };
#line 47
	allow test_noopen_dbusd_t test_noopen_usertype:process sigchld;
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype test_noopen_dbusd_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_usertype test_noopen_dbusd_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_usertype test_noopen_dbusd_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype test_noopen_dbusd_t:process getattr;
#line 47

#line 47
	allow test_noopen_usertype test_noopen_dbusd_t:process { sigchld sigkill sigstop signull signal };
#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool deny_ptrace;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (deny_ptrace) {
#line 47
		
#line 47
	} else {
#line 47
		
#line 47
		allow test_noopen_usertype test_noopen_dbusd_t:process ptrace;
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	# cjp: this seems very broken
#line 47
	 	 	
#line 47
##### begin corecmd_bin_domtrans(test_noopen_dbusd_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_bin_spec_domtrans(test_noopen_dbusd_t,test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_dbusd_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_dbusd_t bin_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_dbusd_t bin_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_dbusd_t test_noopen_t:process transition;
#line 47
#	dontaudit test_noopen_dbusd_t test_noopen_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_dbusd_t usr_t:dir { getattr search open };
#line 47
	allow test_noopen_dbusd_t usr_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_dbusd_t usr_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_dbusd_t test_noopen_t:process transition;
#line 47
#	dontaudit test_noopen_dbusd_t test_noopen_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_bin_spec_domtrans(test_noopen_dbusd_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	type_transition test_noopen_dbusd_t bin_t:process test_noopen_t;
#line 47
	type_transition test_noopen_dbusd_t usr_t:process test_noopen_t;
#line 47

#line 47
	 	
#line 47
##### end corecmd_bin_domtrans(test_noopen_dbusd_t,test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_shell_domtrans(test_noopen_dbusd_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type shell_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_shell_spec_domtrans(test_noopen_dbusd_t,test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t, shell_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_dbusd_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_dbusd_t bin_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_dbusd_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_dbusd_t bin_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_dbusd_t shell_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_dbusd_t test_noopen_t:process transition;
#line 47
#	dontaudit test_noopen_dbusd_t test_noopen_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_shell_spec_domtrans(test_noopen_dbusd_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	type_transition test_noopen_dbusd_t shell_exec_t:process test_noopen_t;
#line 47

#line 47
	 	
#line 47
##### end corecmd_shell_domtrans(test_noopen_dbusd_t,test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_dbusd_t test_noopen_usertype:process sigkill;
#line 47
	allow test_noopen_usertype test_noopen_dbusd_t:fd use;
#line 47
	allow test_noopen_usertype test_noopen_dbusd_t:fifo_file { open { getattr read write append ioctl lock } };
#line 47

#line 47
	 	 	
#line 47
##### begin auth_use_nsswitch(test_noopen_dbusd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute nsswitch_domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_dbusd_t nsswitch_domain;
#line 47

#line 47
	 	 	
#line 47
##### begin corenet_all_recvfrom_netlabel(test_noopen_dbusd_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute netlabel_peer_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_dbusd_t netlabel_peer_type;
#line 47

#line 47
	 	
#line 47
##### end corenet_all_recvfrom_netlabel(test_noopen_dbusd_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end auth_use_nsswitch(test_noopen_dbusd_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin logging_send_syslog_msg(test_noopen_dbusd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute syslog_client_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_dbusd_t syslog_client_type;
#line 47

#line 47
	 	
#line 47
##### end logging_send_syslog_msg(test_noopen_dbusd_t) depth: 3
#line 47
 	
#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin mozilla_domtrans_spec(test_noopen_dbusd_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type mozilla_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin domain_entry_file(test_noopen_t,mozilla_exec_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute entry_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t mozilla_exec_t:file entrypoint;
#line 47
	allow test_noopen_t mozilla_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 47

#line 47
	typeattribute mozilla_exec_t entry_type;
#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_executable_file(mozilla_exec_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute mozilla_exec_t exec_type;
#line 47

#line 47
	 	 	
#line 47
##### begin files_type(mozilla_exec_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute mozilla_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 47

#line 47
	 	
#line 47
##### end files_type(mozilla_exec_t) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corecmd_executable_file(mozilla_exec_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end domain_entry_file(test_noopen_t,mozilla_exec_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_dbusd_t mozilla_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_dbusd_t test_noopen_t:process transition;
#line 47
#	dontaudit test_noopen_dbusd_t test_noopen_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_dbusd_t mozilla_exec_t:process test_noopen_t;
#line 47

#line 47

#line 47
	allow test_noopen_t test_noopen_dbusd_t:fd use;
#line 47
	allow test_noopen_t test_noopen_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow test_noopen_t test_noopen_dbusd_t:process sigchld;
#line 47

#line 47

#line 47
	 	
#line 47
##### end mozilla_domtrans_spec(test_noopen_dbusd_t,test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47
 	 	
#line 47
##### end dbus_role_template(test_noopen,test_noopen_r,test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin dbus_system_bus_client(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type system_dbusd_t, system_dbusd_t;
#line 47
		type system_dbusd_var_run_t, system_dbusd_var_lib_t;
#line 47
		class dbus send_msg;
#line 47
		attribute dbusd_unconfined;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	# SE-DBus specific permissions
#line 47
	allow test_noopen_usertype { system_dbusd_t self }:dbus send_msg;
#line 47
	allow { system_dbusd_t dbusd_unconfined } test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype system_dbusd_var_lib_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype system_dbusd_var_lib_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var_lib(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_lib_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_var_lib(test_noopen_usertype) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin dev_read_urand(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t, urandom_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype urandom_device_t:chr_file { getattr open read lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_read_urand(test_noopen_usertype) depth: 3
#line 47
 	
#line 47

#line 47
	# For connecting to the bus
#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype system_dbusd_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype system_dbusd_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype system_dbusd_t:unix_stream_socket connectto;
#line 47

#line 47
	 	 	
#line 47
##### begin dbus_read_config(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type dbusd_etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype dbusd_etc_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_usertype dbusd_etc_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end dbus_read_config(test_noopen_usertype) depth: 3
#line 47
 	
#line 47

#line 47
    
#line 47
	optional {
#line 47
		
#line 47
         	 	
#line 47
##### begin unconfined_server_dbus_chat(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type unconfined_service_t;
#line 47
        class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
        allow test_noopen_usertype unconfined_service_t:dbus send_msg;
#line 47
        allow unconfined_service_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end unconfined_server_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
    
#line 47
	}
#line 47

#line 47

#line 47
	 	
#line 47
##### end dbus_system_bus_client(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		allow test_noopen_usertype test_noopen_usertype:dbus send_msg;
#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin abrt_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type abrt_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype abrt_t:dbus send_msg;
#line 47
	allow abrt_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end abrt_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
			 	 	
#line 47
##### begin abrt_run_helper(test_noopen_usertype,test_noopen_r) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute_role abrt_helper_roles;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin abrt_domtrans_helper(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type abrt_helper_t, abrt_helper_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_usertype abrt_helper_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_usertype abrt_helper_t:process transition;
#line 47
#	dontaudit test_noopen_usertype abrt_helper_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_usertype abrt_helper_exec_t:process abrt_helper_t;
#line 47

#line 47

#line 47
	allow abrt_helper_t test_noopen_usertype:fd use;
#line 47
	allow abrt_helper_t test_noopen_usertype:fifo_file { getattr read write append ioctl lock };
#line 47
	allow abrt_helper_t test_noopen_usertype:process sigchld;
#line 47

#line 47

#line 47
	 	
#line 47
##### end abrt_domtrans_helper(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	roleattribute test_noopen_r abrt_helper_roles;
#line 47

#line 47
	 	
#line 47
##### end abrt_run_helper(test_noopen_usertype,test_noopen_r) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin accountsd_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type accountsd_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype accountsd_t:dbus send_msg;
#line 47
	allow accountsd_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end accountsd_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin consolekit_dontaudit_read_log(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type consolekit_log_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype consolekit_log_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end consolekit_dontaudit_read_log(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
			 	 	
#line 47
##### begin consolekit_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type consolekit_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype consolekit_t:dbus send_msg;
#line 47
	allow consolekit_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end consolekit_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin cups_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cupsd_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype cupsd_t:dbus send_msg;
#line 47
	allow cupsd_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end cups_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
			 	 	
#line 47
##### begin cups_dbus_chat_config(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cupsd_config_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype cupsd_config_t:dbus send_msg;
#line 47
	allow cupsd_config_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end cups_dbus_chat_config(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin devicekit_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type devicekit_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype devicekit_t:dbus send_msg;
#line 47
	allow devicekit_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end devicekit_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
			 	 	
#line 47
##### begin devicekit_dbus_chat_disk(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type devicekit_disk_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype devicekit_disk_t:dbus send_msg;
#line 47
	allow devicekit_disk_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end devicekit_dbus_chat_disk(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
			 	 	
#line 47
##### begin devicekit_dbus_chat_power(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type devicekit_power_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype devicekit_power_t:dbus send_msg;
#line 47
	allow devicekit_power_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end devicekit_dbus_chat_power(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin fprintd_dbus_chat(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type fprintd_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t fprintd_t:dbus send_msg;
#line 47
	allow fprintd_t test_noopen_t:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end fprintd_dbus_chat(test_noopen_t) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin realmd_dbus_chat(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type realmd_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t realmd_t:dbus send_msg;
#line 47
	allow realmd_t test_noopen_t:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end realmd_dbus_chat(test_noopen_t) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin gnome_role_template(test_noopen,test_noopen_r,test_noopen_t) depth: 3
#line 47
 	
#line 47
    
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute gnomedomain, gkeyringd_domain, gnome_home_type;
#line 47
		attribute_role gconfd_roles;
#line 47
		type gkeyringd_exec_t, gkeyringd_tmp_t;
#line 47
		type gconfd_t, gconfd_exec_t, gconf_tmp_t;
#line 47
		class dbus { acquire_svc send_msg };
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	########################################
#line 47
	#
#line 47
	# Gconf declarations
#line 47
	#
#line 47

#line 47
	roleattribute test_noopen_r gconfd_roles;
#line 47

#line 47
	########################################
#line 47
	#
#line 47
	# Gkeyringd declarations
#line 47
	#
#line 47

#line 47
	type test_noopen_gkeyringd_t, gnomedomain, gkeyringd_domain;
#line 47
	 	 	
#line 47
##### begin userdom_user_application_domain(test_noopen_gkeyringd_t,gkeyringd_exec_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin application_domain(test_noopen_gkeyringd_t,gkeyringd_exec_t) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin application_type(test_noopen_gkeyringd_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute application_domain_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_gkeyringd_t application_domain_type;
#line 47

#line 47
	# start with basic domain
#line 47
	 	 	
#line 47
##### begin domain_type(test_noopen_gkeyringd_t) depth: 7
#line 47
 	
#line 47
	# start with basic domain
#line 47
	 	 	
#line 47
##### begin domain_base_type(test_noopen_gkeyringd_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_gkeyringd_t domain;
#line 47

#line 47
	 	
#line 47
##### end domain_base_type(test_noopen_gkeyringd_t) depth: 7
#line 47
 	
#line 47

#line 47
	# Only way to get corenet_unlabeled packets disabled to work
#line 47
	 	 	
#line 47
##### begin corenet_all_recvfrom_unlabeled(test_noopen_gkeyringd_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
                attribute corenet_unlabeled_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	typeattribute test_noopen_gkeyringd_t corenet_unlabeled_type;
#line 47

#line 47
	 	
#line 47
##### end corenet_all_recvfrom_unlabeled(test_noopen_gkeyringd_t) depth: 7
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end domain_type(test_noopen_gkeyringd_t) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end application_type(test_noopen_gkeyringd_t) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin application_executable_file(gkeyringd_exec_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute application_exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute gkeyringd_exec_t application_exec_type;
#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_executable_file(gkeyringd_exec_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute gkeyringd_exec_t exec_type;
#line 47

#line 47
	 	 	
#line 47
##### begin files_type(gkeyringd_exec_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute gkeyringd_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 47

#line 47
	 	
#line 47
##### end files_type(gkeyringd_exec_t) depth: 7
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corecmd_executable_file(gkeyringd_exec_t) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end application_executable_file(gkeyringd_exec_t) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin domain_entry_file(test_noopen_gkeyringd_t,gkeyringd_exec_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute entry_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_gkeyringd_t gkeyringd_exec_t:file entrypoint;
#line 47
	allow test_noopen_gkeyringd_t gkeyringd_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 47

#line 47
	typeattribute gkeyringd_exec_t entry_type;
#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_executable_file(gkeyringd_exec_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute gkeyringd_exec_t exec_type;
#line 47

#line 47
	 	 	
#line 47
##### begin files_type(gkeyringd_exec_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute gkeyringd_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 47

#line 47
	 	
#line 47
##### end files_type(gkeyringd_exec_t) depth: 7
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corecmd_executable_file(gkeyringd_exec_t) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end domain_entry_file(test_noopen_gkeyringd_t,gkeyringd_exec_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end application_domain(test_noopen_gkeyringd_t,gkeyringd_exec_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin ubac_constrained(test_noopen_gkeyringd_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute ubac_constrained_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_gkeyringd_t ubac_constrained_type;
#line 47

#line 47
	 	
#line 47
##### end ubac_constrained(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_user_application_domain(test_noopen_gkeyringd_t,gkeyringd_exec_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin domain_user_exemption_target(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute process_user_target;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_gkeyringd_t process_user_target;
#line 47

#line 47
	 	
#line 47
##### end domain_user_exemption_target(test_noopen_gkeyringd_t) depth: 3
#line 47
 	
#line 47

#line 47
	role test_noopen_r types test_noopen_gkeyringd_t;
#line 47

#line 47
	########################################
#line 47
	#
#line 47
	# Gconf policy
#line 47
	#
#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t gconfd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t gconfd_t:process transition;
#line 47
#	dontaudit test_noopen_t gconfd_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t gconfd_exec_t:process gconfd_t;
#line 47

#line 47

#line 47
	allow gconfd_t test_noopen_t:fd use;
#line 47
	allow gconfd_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow gconfd_t test_noopen_t:process sigchld;
#line 47

#line 47

#line 47
	allow test_noopen_t gconfd_t:process { { sigchld sigkill sigstop signull signal } };
#line 47
	allow test_noopen_t gconfd_t:unix_stream_socket connectto;
#line 47
	
#line 47
	allow test_noopen_t gconfd_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t gconfd_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_t gconfd_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t gconfd_t:process getattr;
#line 47

#line 47

#line 47

#line 47
	########################################
#line 47
	#
#line 47
	# Gkeyringd policy
#line 47
	#
#line 47

#line 47
    allow test_noopen_gkeyringd_t test_noopen_t:unix_stream_socket { connectto { { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } } listen accept } };
#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t gkeyringd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t test_noopen_gkeyringd_t:process transition;
#line 47
#	dontaudit test_noopen_t test_noopen_gkeyringd_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t gkeyringd_exec_t:process test_noopen_gkeyringd_t;
#line 47

#line 47

#line 47
	allow test_noopen_gkeyringd_t test_noopen_t:fd use;
#line 47
	allow test_noopen_gkeyringd_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow test_noopen_gkeyringd_t test_noopen_t:process sigchld;
#line 47

#line 47

#line 47
	allow test_noopen_t { gnome_home_type gkeyringd_tmp_t gconf_tmp_t }:dir { { getattr relabelfrom relabelto } { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl } };
#line 47
	allow test_noopen_t { gnome_home_type gkeyringd_tmp_t gconf_tmp_t }:file { { getattr relabelfrom relabelto } { create open getattr setattr read write append rename link unlink ioctl lock } };
#line 47

#line 47
	 	 	
#line 47
##### begin userdom_home_manager(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute userdom_home_manager_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_gkeyringd_t userdom_home_manager_type;
#line 47

#line 47
	 	
#line 47
##### end userdom_home_manager(test_noopen_gkeyringd_t) depth: 3
#line 47
 	
#line 47

#line 47
	allow test_noopen_t gkeyringd_tmp_t:sock_file { { getattr relabelfrom relabelto } { create open getattr setattr read write rename link unlink ioctl lock append } };
#line 47

#line 47
	
#line 47
	allow test_noopen_t test_noopen_gkeyringd_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t test_noopen_gkeyringd_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_t test_noopen_gkeyringd_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t test_noopen_gkeyringd_t:process getattr;
#line 47

#line 47
	allow test_noopen_t test_noopen_gkeyringd_t:process { sigchld sigkill sigstop signull signal };
#line 47
	dontaudit test_noopen_t gkeyringd_exec_t:file entrypoint;
#line 47

#line 47
	allow test_noopen_gkeyringd_t test_noopen_t:process sigkill;
#line 47
	allow test_noopen_t test_noopen_gkeyringd_t:fd use;
#line 47
	allow test_noopen_t test_noopen_gkeyringd_t:fifo_file { open { getattr read write append ioctl lock } };
#line 47

#line 47
	dontaudit test_noopen_gkeyringd_t test_noopen_t:unix_stream_socket { getattr read write };
#line 47

#line 47
	
#line 47
	allow test_noopen_t gkeyringd_tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_t gkeyringd_tmp_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_t test_noopen_gkeyringd_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin kernel_read_system_state(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute kernel_system_state_reader;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_gkeyringd_t kernel_system_state_reader;
#line 47

#line 47
	 	
#line 47
##### end kernel_read_system_state(test_noopen_gkeyringd_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_bin_domtrans(test_noopen_gkeyringd_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_bin_spec_domtrans(test_noopen_gkeyringd_t,test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_gkeyringd_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_gkeyringd_t bin_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_gkeyringd_t bin_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_gkeyringd_t test_noopen_t:process transition;
#line 47
#	dontaudit test_noopen_gkeyringd_t test_noopen_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_gkeyringd_t usr_t:dir { getattr search open };
#line 47
	allow test_noopen_gkeyringd_t usr_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_gkeyringd_t usr_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_gkeyringd_t test_noopen_t:process transition;
#line 47
#	dontaudit test_noopen_gkeyringd_t test_noopen_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_bin_spec_domtrans(test_noopen_gkeyringd_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	type_transition test_noopen_gkeyringd_t bin_t:process test_noopen_t;
#line 47
	type_transition test_noopen_gkeyringd_t usr_t:process test_noopen_t;
#line 47

#line 47
	 	
#line 47
##### end corecmd_bin_domtrans(test_noopen_gkeyringd_t,test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_shell_domtrans(test_noopen_gkeyringd_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type shell_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_shell_spec_domtrans(test_noopen_gkeyringd_t,test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t, shell_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_gkeyringd_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_gkeyringd_t bin_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_gkeyringd_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_gkeyringd_t bin_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_gkeyringd_t shell_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_gkeyringd_t test_noopen_t:process transition;
#line 47
#	dontaudit test_noopen_gkeyringd_t test_noopen_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_shell_spec_domtrans(test_noopen_gkeyringd_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	type_transition test_noopen_gkeyringd_t shell_exec_t:process test_noopen_t;
#line 47

#line 47
	 	
#line 47
##### end corecmd_shell_domtrans(test_noopen_gkeyringd_t,test_noopen_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin gnome_stream_connect_gkeyringd(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
			attribute gkeyringd_domain;
#line 47
			type gkeyringd_tmp_t;
#line 47
			type gconf_tmp_t;
#line 47
			type cache_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t gconf_tmp_t:dir { getattr search open };
#line 47
	 	 	
#line 47
##### begin userdom_search_user_tmp_dirs(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_tmp(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin fs_search_tmpfs(test_noopen_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t tmpfs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_tmpfs(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_t tmp_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_t tmp_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_tmp(test_noopen_t) depth: 5
#line 47
 	
#line 47
	allow test_noopen_t user_tmp_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end userdom_search_user_tmp_dirs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t gkeyringd_tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_t gkeyringd_tmp_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_t gkeyringd_domain:unix_stream_socket connectto;
#line 47

#line 47
	
#line 47
	allow test_noopen_t cache_home_t:dir { getattr search open };
#line 47
	allow test_noopen_t cache_home_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_t gkeyringd_domain:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end gnome_stream_connect_gkeyringd(test_noopen_t) depth: 3
#line 47
 	
#line 47

#line 47
	
#line 47
	allow test_noopen_gkeyringd_t test_noopen_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_gkeyringd_t test_noopen_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_gkeyringd_t test_noopen_t:lnk_file { getattr read };
#line 47
	allow test_noopen_gkeyringd_t test_noopen_t:process getattr;
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin auth_use_nsswitch(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute nsswitch_domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_gkeyringd_t nsswitch_domain;
#line 47

#line 47
	 	 	
#line 47
##### begin corenet_all_recvfrom_netlabel(test_noopen_gkeyringd_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute netlabel_peer_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_gkeyringd_t netlabel_peer_type;
#line 47

#line 47
	 	
#line 47
##### end corenet_all_recvfrom_netlabel(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end auth_use_nsswitch(test_noopen_gkeyringd_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin logging_send_syslog_msg(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute syslog_client_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_gkeyringd_t syslog_client_type;
#line 47

#line 47
	 	
#line 47
##### end logging_send_syslog_msg(test_noopen_gkeyringd_t) depth: 3
#line 47
 	
#line 47

#line 47
     	 	
#line 47
##### begin userdom_rw_user_tmp_sock_files(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_gkeyringd_t user_tmp_t:dir { getattr search open read lock ioctl };
#line 47
    allow test_noopen_gkeyringd_t user_tmp_t:sock_file { getattr read write append };
#line 47
	 	 	
#line 47
##### begin files_search_tmp(test_noopen_gkeyringd_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin fs_search_tmpfs(test_noopen_gkeyringd_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_gkeyringd_t tmpfs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_tmpfs(test_noopen_gkeyringd_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_gkeyringd_t tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_gkeyringd_t tmp_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_gkeyringd_t tmp_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_tmp(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_rw_user_tmp_sock_files(test_noopen_gkeyringd_t) depth: 3
#line 47
 	
#line 47

#line 47
	allow test_noopen_gkeyringd_t test_noopen_t:dbus { acquire_svc send_msg };
#line 47
	allow test_noopen_t test_noopen_gkeyringd_t:dbus send_msg;
#line 47
	allow test_noopen_t test_noopen_t:dbus acquire_svc;
#line 47

#line 47
    
#line 47
	optional {
#line 47
		
#line 47
         	 	
#line 47
##### begin systemd_dbus_chat_logind(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type systemd_logind_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_gkeyringd_t systemd_logind_t:dbus send_msg;
#line 47
	allow systemd_logind_t test_noopen_gkeyringd_t:dbus send_msg;
#line 47
	
#line 47
	allow systemd_logind_t test_noopen_gkeyringd_t:dir { getattr search open read lock ioctl };
#line 47
	allow systemd_logind_t test_noopen_gkeyringd_t:file { open { getattr read ioctl lock } };
#line 47
	allow systemd_logind_t test_noopen_gkeyringd_t:lnk_file { getattr read };
#line 47
	allow systemd_logind_t test_noopen_gkeyringd_t:process getattr;
#line 47

#line 47
	allow systemd_logind_t test_noopen_gkeyringd_t:process signal;
#line 47
	allow test_noopen_gkeyringd_t systemd_logind_t:fd use;
#line 47

#line 47
	 	
#line 47
##### end systemd_dbus_chat_logind(test_noopen_gkeyringd_t) depth: 3
#line 47
 	
#line 47
    
#line 47
	}
#line 47

#line 47

#line 47
    
#line 47
	optional {
#line 47
		
#line 47
         	 	
#line 47
##### begin dbus_session_domain(test_noopen,gkeyringd_exec_t,test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type test_noopen_dbusd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_dbusd_t gkeyringd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_dbusd_t test_noopen_gkeyringd_t:process transition;
#line 47
#	dontaudit test_noopen_dbusd_t test_noopen_gkeyringd_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_dbusd_t gkeyringd_exec_t:process test_noopen_gkeyringd_t;
#line 47

#line 47

#line 47
	allow test_noopen_gkeyringd_t test_noopen_dbusd_t:fd use;
#line 47
	allow test_noopen_gkeyringd_t test_noopen_dbusd_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow test_noopen_gkeyringd_t test_noopen_dbusd_t:process sigchld;
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dbus_session_bus_client(test_noopen_gkeyringd_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	# SE-DBus specific permissions
#line 47
	allow test_noopen_gkeyringd_t { session_bus_type self }:dbus send_msg;
#line 47

#line 47
	# For connecting to the bus
#line 47
	allow test_noopen_gkeyringd_t session_bus_type:unix_stream_socket connectto;
#line 47

#line 47
	allow session_bus_type test_noopen_gkeyringd_t:process sigkill;
#line 47

#line 47
	 	
#line 47
##### end dbus_session_bus_client(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dbus_connect_session_bus(test_noopen_gkeyringd_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute session_bus_type;
#line 47
		class dbus acquire_svc;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_gkeyringd_t session_bus_type:dbus acquire_svc;
#line 47

#line 47
	 	
#line 47
##### end dbus_connect_session_bus(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end dbus_session_domain(test_noopen,gkeyringd_exec_t,test_noopen_gkeyringd_t) depth: 3
#line 47
 	
#line 47
         	 	
#line 47
##### begin dbus_stream_connect_system_dbusd(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type system_dbusd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_gkeyringd_t system_dbusd_t:unix_stream_socket connectto;
#line 47

#line 47
	 	
#line 47
##### end dbus_stream_connect_system_dbusd(test_noopen_gkeyringd_t) depth: 3
#line 47
 	
#line 47
         	 	
#line 47
##### begin dbus_send_system_bus(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type system_dbusd_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_gkeyringd_t system_dbusd_t:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end dbus_send_system_bus(test_noopen_gkeyringd_t) depth: 3
#line 47
 	
#line 47
    
#line 47
	}
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin gnome_manage_generic_home_dirs(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type gnome_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin userdom_search_user_home_dirs(test_noopen_gkeyringd_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_dir_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_gkeyringd_t user_home_dir_t:dir { getattr search open };
#line 47
	allow test_noopen_gkeyringd_t user_home_dir_t:lnk_file { getattr read };
#line 47
	 	 	
#line 47
##### begin files_search_home(test_noopen_gkeyringd_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_gkeyringd_t home_root_t:dir { getattr search open };
#line 47
	allow test_noopen_gkeyringd_t home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_search_home(test_noopen_gkeyringd_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_search_user_home_dirs(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47
	allow test_noopen_gkeyringd_t gnome_home_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end gnome_manage_generic_home_dirs(test_noopen_gkeyringd_t) depth: 3
#line 47
 	
#line 47
		 	 	
#line 47
##### begin gnome_read_generic_data_home_files(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type data_home_t, gconf_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_gkeyringd_t { gconf_home_t data_home_t }:dir { getattr search open };
#line 47
	allow test_noopen_gkeyringd_t data_home_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_gkeyringd_t { gconf_home_t data_home_t }:dir { getattr search open };
#line 47
	allow test_noopen_gkeyringd_t data_home_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end gnome_read_generic_data_home_files(test_noopen_gkeyringd_t) depth: 3
#line 47
 	
#line 47
		 	 	
#line 47
##### begin gnome_read_generic_data_home_dirs(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47
    
#line 47
	
#line 47
		require {
#line 47
			
#line 47
        type data_home_t, gconf_home_t;
#line 47
    
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
    
#line 47
	allow test_noopen_gkeyringd_t { gconf_home_t data_home_t }:dir { getattr search open };
#line 47
	allow test_noopen_gkeyringd_t data_home_t:dir { getattr search open read lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end gnome_read_generic_data_home_dirs(test_noopen_gkeyringd_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin telepathy_mission_control_read_state(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type telepathy_mission_control_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin kernel_search_proc(test_noopen_gkeyringd_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type proc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_gkeyringd_t proc_t:dir { getattr search open };
#line 47
	allow test_noopen_gkeyringd_t proc_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end kernel_search_proc(test_noopen_gkeyringd_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_gkeyringd_t telepathy_mission_control_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_gkeyringd_t telepathy_mission_control_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_gkeyringd_t telepathy_mission_control_t:lnk_file { getattr read };
#line 47
	allow test_noopen_gkeyringd_t telepathy_mission_control_t:process getattr;
#line 47

#line 47

#line 47
	 	
#line 47
##### end telepathy_mission_control_read_state(test_noopen_gkeyringd_t) depth: 3
#line 47
 	
#line 47
         	 	
#line 47
##### begin telepathy_gabble_stream_connect_to(test_noopen_gkeyringd_t,gkeyringd_tmp_t,gkeyringd_tmp_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type telepathy_gabble_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow telepathy_gabble_t gkeyringd_tmp_t:dir { getattr search open };
#line 47
	allow telepathy_gabble_t gkeyringd_tmp_t:sock_file { getattr write open append };
#line 47
	allow telepathy_gabble_t test_noopen_gkeyringd_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end telepathy_gabble_stream_connect_to(test_noopen_gkeyringd_t,gkeyringd_tmp_t,gkeyringd_tmp_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47
 	 	
#line 47
##### end gnome_role_template(test_noopen,test_noopen_r,test_noopen_t) depth: 2
#line 47
 	
#line 47
        
#line 47
	}
#line 47

#line 47

#line 47
        
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin wm_role_template(test_noopen,test_noopen_r,test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type wm_exec_t;
#line 47
		class dbus send_msg;
#line 47
		attribute wm_domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	type test_noopen_wm_t, wm_domain;
#line 47
	 	 	
#line 47
##### begin domain_type(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	# start with basic domain
#line 47
	 	 	
#line 47
##### begin domain_base_type(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wm_t domain;
#line 47

#line 47
	 	
#line 47
##### end domain_base_type(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47

#line 47
	# Only way to get corenet_unlabeled packets disabled to work
#line 47
	 	 	
#line 47
##### begin corenet_all_recvfrom_unlabeled(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
                attribute corenet_unlabeled_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	typeattribute test_noopen_wm_t corenet_unlabeled_type;
#line 47

#line 47
	 	
#line 47
##### end corenet_all_recvfrom_unlabeled(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end domain_type(test_noopen_wm_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin domain_entry_file(test_noopen_wm_t,wm_exec_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute entry_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wm_t wm_exec_t:file entrypoint;
#line 47
	allow test_noopen_wm_t wm_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 47

#line 47
	typeattribute wm_exec_t entry_type;
#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_executable_file(wm_exec_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute wm_exec_t exec_type;
#line 47

#line 47
	 	 	
#line 47
##### begin files_type(wm_exec_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute wm_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 47

#line 47
	 	
#line 47
##### end files_type(wm_exec_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corecmd_executable_file(wm_exec_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end domain_entry_file(test_noopen_wm_t,wm_exec_t) depth: 3
#line 47
 	
#line 47
	role test_noopen_r types test_noopen_wm_t;
#line 47

#line 47
	allow test_noopen_wm_t test_noopen_t:unix_stream_socket connectto;
#line 47
	allow test_noopen_t test_noopen_wm_t:unix_stream_socket connectto;
#line 47
	allow test_noopen_t test_noopen_wm_t:process { signal sigchld signull };
#line 47
	allow test_noopen_wm_t test_noopen_t:process { signull sigkill };
#line 47

#line 47
	allow test_noopen_wm_t test_noopen_t:dbus send_msg;
#line 47
	allow test_noopen_t test_noopen_wm_t:dbus send_msg;
#line 47

#line 47
	 	 	
#line 47
##### begin userdom_manage_home_role(test_noopen_r,test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_t, user_home_dir_t;
#line 47
		attribute user_home_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	role test_noopen_r types { user_home_type user_home_dir_t };
#line 47

#line 47
	##############################
#line 47
	#
#line 47
	# Domain access to home dir
#line 47
	#
#line 47

#line 47
	type_member test_noopen_wm_t user_home_dir_t:dir user_home_dir_t;
#line 47

#line 47
	# full control of the home directory
#line 47
	allow test_noopen_wm_t user_home_t:dir mounton;
#line 47
	allow test_noopen_wm_t user_home_t:file entrypoint;
#line 47

#line 47
	allow test_noopen_wm_t user_home_type:{ dir file lnk_file sock_file fifo_file chr_file blk_file } { relabelto relabelfrom };
#line 47
	allow test_noopen_wm_t user_home_dir_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_wm_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t user_home_type:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t user_home_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t user_home_type:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t user_home_type:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t user_home_type:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_home_type:dir { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_home_type:file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_home_type:lnk_file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_home_type:sock_file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_home_type:fifo_file { getattr relabelfrom relabelto };
#line 47

#line 47
	 	 	
#line 47
##### begin userdom_filetrans_home_content(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
	        attribute userdom_filetrans_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wm_t  userdom_filetrans_type;
#line 47

#line 47
	 	
#line 47
##### end userdom_filetrans_home_content(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin files_list_home(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wm_t home_root_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_wm_t home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_list_home(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47

#line 47
	# cjp: this should probably be removed:
#line 47
	allow test_noopen_wm_t user_home_dir_t:dir { { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl } { getattr relabelfrom relabelto } };
#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool use_nfs_home_dirs;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (use_nfs_home_dirs) {
#line 47
		
#line 47
		 	 	
#line 47
##### begin fs_mount_nfs(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wm_t nfs_t:filesystem mount;
#line 47

#line 47
	 	
#line 47
##### end fs_mount_nfs(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_mounton_nfs(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wm_t nfs_t:dir mounton;
#line 47

#line 47
	 	
#line 47
##### end fs_mounton_nfs(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_nfs_dirs(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin fs_search_auto_mountpoints(test_noopen_wm_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type autofs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wm_t autofs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_auto_mountpoints(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	allow test_noopen_wm_t nfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end fs_manage_nfs_dirs(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_nfs_files(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin fs_search_auto_mountpoints(test_noopen_wm_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type autofs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wm_t autofs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_auto_mountpoints(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_wm_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t nfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_nfs_files(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_nfs_symlinks(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin fs_search_auto_mountpoints(test_noopen_wm_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type autofs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wm_t autofs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_auto_mountpoints(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_wm_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t nfs_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_nfs_symlinks(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_nfs_named_sockets(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t nfs_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_nfs_named_sockets(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_nfs_named_pipes(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t nfs_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_nfs_named_pipes(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool use_samba_home_dirs;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (use_samba_home_dirs) {
#line 47
		
#line 47
		 	 	
#line 47
##### begin fs_mount_cifs(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wm_t cifs_t:filesystem mount;
#line 47

#line 47
	 	
#line 47
##### end fs_mount_cifs(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_mounton_cifs(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wm_t cifs_t:dir mounton;
#line 47

#line 47
	 	
#line 47
##### end fs_mounton_cifs(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_cifs_dirs(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wm_t cifs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end fs_manage_cifs_dirs(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_cifs_files(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t cifs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_cifs_files(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_cifs_symlinks(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t cifs_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_cifs_symlinks(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_cifs_named_sockets(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t cifs_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_cifs_named_sockets(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_cifs_named_pipes(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t cifs_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_cifs_named_pipes(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_manage_home_role(test_noopen_r,test_noopen_wm_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin userdom_manage_tmp_role(test_noopen_r,test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute user_tmp_type;
#line 47
		type user_tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	role test_noopen_r types user_tmp_t;
#line 47

#line 47
	 	 	
#line 47
##### begin files_poly_member_tmp(test_noopen_wm_t,user_tmp_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	type_member test_noopen_wm_t tmp_t:dir user_tmp_t;
#line 47

#line 47
	 	
#line 47
##### end files_poly_member_tmp(test_noopen_wm_t,user_tmp_t) depth: 4
#line 47
 	
#line 47

#line 47
	allow test_noopen_wm_t user_tmp_type:dir mounton;
#line 47
	
#line 47
	allow test_noopen_wm_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t user_tmp_type:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t user_tmp_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t user_tmp_type:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t user_tmp_type:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t user_tmp_type:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	 	 	
#line 47
##### begin files_tmp_filetrans(test_noopen_wm_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_wm_t tmp_t:{ dir file lnk_file sock_file fifo_file } user_tmp_t ;
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_tmp_filetrans(test_noopen_wm_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 4
#line 47
 	
#line 47
     	 	
#line 47
##### begin fs_tmpfs_filetrans(test_noopen_wm_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow user_tmp_t tmpfs_t:filesystem associate;
#line 47
	
#line 47
	allow test_noopen_wm_t tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_wm_t tmpfs_t:{ dir file lnk_file sock_file fifo_file } user_tmp_t ;
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_tmpfs_filetrans(test_noopen_wm_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_wm_t user_tmp_type:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_tmp_type:dir { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_tmp_type:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_tmp_type:file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_tmp_type:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_tmp_type:lnk_file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_tmp_type:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_tmp_type:sock_file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_tmp_type:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_tmp_type:fifo_file { getattr relabelfrom relabelto };
#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_manage_tmp_role(test_noopen_r,test_noopen_wm_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin userdom_exec_user_tmp_files(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_tmp_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47

#line 47
	dontaudit test_noopen_wm_t user_tmp_t:sock_file execute;
#line 47
	 	 	
#line 47
##### begin files_search_tmp(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin fs_search_tmpfs(test_noopen_wm_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wm_t tmpfs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_tmpfs(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_wm_t tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_wm_t tmp_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_wm_t tmp_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_tmp(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_exec_user_tmp_files(test_noopen_wm_t) depth: 3
#line 47
 	
#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t wm_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t test_noopen_wm_t:process transition;
#line 47
#	dontaudit test_noopen_t test_noopen_wm_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t wm_exec_t:process test_noopen_wm_t;
#line 47

#line 47

#line 47
	allow test_noopen_wm_t test_noopen_t:fd use;
#line 47
	allow test_noopen_wm_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow test_noopen_wm_t test_noopen_t:process sigchld;
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_bin_domtrans(test_noopen_wm_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_bin_spec_domtrans(test_noopen_wm_t,test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_wm_t bin_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t bin_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_wm_t test_noopen_t:process transition;
#line 47
#	dontaudit test_noopen_wm_t test_noopen_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t usr_t:dir { getattr search open };
#line 47
	allow test_noopen_wm_t usr_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t usr_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_wm_t test_noopen_t:process transition;
#line 47
#	dontaudit test_noopen_wm_t test_noopen_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_bin_spec_domtrans(test_noopen_wm_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	type_transition test_noopen_wm_t bin_t:process test_noopen_t;
#line 47
	type_transition test_noopen_wm_t usr_t:process test_noopen_t;
#line 47

#line 47
	 	
#line 47
##### end corecmd_bin_domtrans(test_noopen_wm_t,test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_shell_domtrans(test_noopen_wm_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type shell_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_shell_spec_domtrans(test_noopen_wm_t,test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t, shell_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_wm_t bin_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_wm_t bin_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t shell_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_wm_t test_noopen_t:process transition;
#line 47
#	dontaudit test_noopen_wm_t test_noopen_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_shell_spec_domtrans(test_noopen_wm_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	type_transition test_noopen_wm_t shell_exec_t:process test_noopen_t;
#line 47

#line 47
	 	
#line 47
##### end corecmd_shell_domtrans(test_noopen_wm_t,test_noopen_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin auth_use_nsswitch(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute nsswitch_domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wm_t nsswitch_domain;
#line 47

#line 47
	 	 	
#line 47
##### begin corenet_all_recvfrom_netlabel(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute netlabel_peer_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wm_t netlabel_peer_type;
#line 47

#line 47
	 	
#line 47
##### end corenet_all_recvfrom_netlabel(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end auth_use_nsswitch(test_noopen_wm_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin kernel_read_system_state(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute kernel_system_state_reader;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wm_t kernel_system_state_reader;
#line 47

#line 47
	 	
#line 47
##### end kernel_read_system_state(test_noopen_wm_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin auth_use_nsswitch(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute nsswitch_domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wm_t nsswitch_domain;
#line 47

#line 47
	 	 	
#line 47
##### begin corenet_all_recvfrom_netlabel(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute netlabel_peer_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wm_t netlabel_peer_type;
#line 47

#line 47
	 	
#line 47
##### end corenet_all_recvfrom_netlabel(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end auth_use_nsswitch(test_noopen_wm_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin mls_file_read_all_levels(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute mlsfileread;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wm_t mlsfileread;
#line 47

#line 47
	 	
#line 47
##### end mls_file_read_all_levels(test_noopen_wm_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin mls_file_write_all_levels(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute mlsfilewrite;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wm_t mlsfilewrite;
#line 47

#line 47
	 	
#line 47
##### end mls_file_write_all_levels(test_noopen_wm_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin mls_xwin_read_all_levels(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute mlsxwinread;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wm_t mlsxwinread;
#line 47

#line 47
	 	
#line 47
##### end mls_xwin_read_all_levels(test_noopen_wm_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin mls_xwin_write_all_levels(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute mlsxwinwrite;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wm_t mlsxwinwrite;
#line 47

#line 47
	 	
#line 47
##### end mls_xwin_write_all_levels(test_noopen_wm_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin mls_fd_use_all_levels(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute mlsfduse;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wm_t mlsfduse;
#line 47

#line 47
	 	
#line 47
##### end mls_fd_use_all_levels(test_noopen_wm_t) depth: 3
#line 47
 	
#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin pulseaudio_run(test_noopen_wm_t,test_noopen_r) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type pulseaudio_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin pulseaudio_domtrans(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute pulseaudio_client;
#line 47
		type pulseaudio_t, pulseaudio_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wm_t pulseaudio_client;
#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_search_bin(test_noopen_wm_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_read_bin_symlinks(test_noopen_wm_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_wm_t bin_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_read_bin_symlinks(test_noopen_wm_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_wm_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_wm_t bin_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_search_bin(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_wm_t pulseaudio_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_wm_t pulseaudio_t:process transition;
#line 47
#	dontaudit test_noopen_wm_t pulseaudio_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_wm_t pulseaudio_exec_t:process pulseaudio_t;
#line 47

#line 47

#line 47
	allow pulseaudio_t test_noopen_wm_t:fd use;
#line 47
	allow pulseaudio_t test_noopen_wm_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow pulseaudio_t test_noopen_wm_t:process sigchld;
#line 47

#line 47

#line 47
	 	
#line 47
##### end pulseaudio_domtrans(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	role test_noopen_r types pulseaudio_t;
#line 47

#line 47
	 	
#line 47
##### end pulseaudio_run(test_noopen_wm_t,test_noopen_r) depth: 3
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin xserver_role(test_noopen_r,test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type iceauth_home_t, xserver_t, xserver_tmpfs_t, xauth_home_t;
#line 47
		type user_fonts_t, user_fonts_cache_t, user_fonts_config_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin xserver_restricted_role(test_noopen_r,test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type xauth_t, iceauth_t;
#line 47
		attribute dridomain, x_userdomain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	role test_noopen_r types { xauth_t iceauth_t };
#line 47
	typeattribute test_noopen_wm_t x_userdomain, dridomain;
#line 47

#line 47
	 	 	
#line 47
##### begin xserver_common_x_domain_template(user,test_noopen_wm_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type root_xdrawable_t, xdm_t, xserver_t;
#line 47
		type xproperty_t, user_xproperty_t;
#line 47
		type xevent_t, client_xevent_t;
#line 47
		type input_xevent_t, user_input_xevent_t;
#line 47

#line 47
		attribute x_domain, input_xevent_type;
#line 47
		attribute xdrawable_type, xcolormap_type;
#line 47

#line 47
		class x_drawable { create destroy read write blend getattr setattr list_child add_child remove_child list_property get_property set_property manage override show hide send receive };
#line 47
		class x_property { create destroy read write append getattr setattr };
#line 47
		class x_event { send receive };
#line 47
		class x_synthetic_event { send receive };
#line 47
		class x_client destroy;
#line 47
		class x_server manage;
#line 47
		class x_screen { saver_setattr saver_hide saver_show show_cursor hide_cursor };
#line 47
		class x_pointer { get_property set_property manage };
#line 47
		class x_keyboard { read manage freeze };
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	##############################
#line 47
	#
#line 47
	# Local Policy
#line 47
	#
#line 47

#line 47
	# Type attributes
#line 47
	typeattribute test_noopen_wm_t x_domain;
#line 47
	typeattribute test_noopen_wm_t xdrawable_type, xcolormap_type;
#line 47

#line 47
	# X Properties
#line 47
	# disable property transitions for the time being.
#line 47
#	type_transition test_noopen_wm_t xproperty_t:x_property user_xproperty_t;
#line 47

#line 47
	# X Windows
#line 47
	# new windows have the domain type
#line 47
	type_transition test_noopen_wm_t root_xdrawable_t:x_drawable test_noopen_wm_t;
#line 47

#line 47
	# X Input
#line 47
	# distinguish input events
#line 47
	type_transition test_noopen_wm_t input_xevent_t:x_event user_input_xevent_t;
#line 47
	# can send own events
#line 47
	allow test_noopen_wm_t user_input_xevent_t:{ x_event x_synthetic_event } send;
#line 47
	# can receive own events
#line 47
	allow test_noopen_wm_t user_input_xevent_t:{ x_event x_synthetic_event } receive;
#line 47
	# can receive default events
#line 47
	allow test_noopen_wm_t client_xevent_t:{ x_event x_synthetic_event } receive;
#line 47
	allow test_noopen_wm_t xevent_t:{ x_event x_synthetic_event } { send receive };
#line 47
	# dont audit send failures
#line 47
	dontaudit test_noopen_wm_t input_xevent_type:x_event send;
#line 47

#line 47
	allow test_noopen_wm_t xdm_t:x_drawable { hide read add_child manage };
#line 47
	allow test_noopen_wm_t xdm_t:x_client destroy;
#line 47

#line 47
	allow test_noopen_wm_t root_xdrawable_t:x_drawable write;
#line 47
	allow test_noopen_wm_t xserver_t:x_server manage;
#line 47
	allow test_noopen_wm_t xserver_t:x_screen { show_cursor hide_cursor saver_setattr saver_hide saver_show };
#line 47
	allow test_noopen_wm_t xserver_t:x_pointer { get_property set_property manage };
#line 47
	allow test_noopen_wm_t xserver_t:x_keyboard { read manage freeze };
#line 47
 	 	
#line 47
##### end xserver_common_x_domain_template(user,test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin xserver_stream_connect_xdm(test_noopen_wm_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type xdm_t, xdm_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_tmp(test_noopen_wm_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin fs_search_tmpfs(test_noopen_wm_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wm_t tmpfs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_tmpfs(test_noopen_wm_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_wm_t tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_wm_t tmp_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_wm_t tmp_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_tmp(test_noopen_wm_t) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_wm_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wm_t var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_wm_t var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_wm_t var_t:dir { getattr search open };
#line 47
	allow test_noopen_wm_t var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_wm_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_wm_t { xdm_var_run_t }:dir { getattr search open };
#line 47
	allow test_noopen_wm_t { xdm_var_run_t }:sock_file { getattr write open append };
#line 47
	allow test_noopen_wm_t xdm_t:unix_stream_socket connectto;
#line 47

#line 47
     	 	
#line 47
##### begin userdom_stream_connect(test_noopen_wm_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_tmp_t;
#line 47
		attribute userdomain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_tmp_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_wm_t userdomain:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_stream_connect(test_noopen_wm_t) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end xserver_stream_connect_xdm(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin xserver_xdm_append_log(test_noopen_wm_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type xdm_log_t;
#line 47
		attribute xdmhomewriter;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wm_t xdmhomewriter;
#line 47
	allow test_noopen_wm_t xdm_log_t:file { getattr append };
#line 47

#line 47
	 	
#line 47
##### end xserver_xdm_append_log(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin xserver_dri_domain(test_noopen_wm_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute dridomain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wm_t dridomain;
#line 47

#line 47
	 	
#line 47
##### end xserver_dri_domain(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end xserver_restricted_role(test_noopen_r,test_noopen_wm_t) depth: 4
#line 47
 	
#line 47

#line 47
	# Communicate via System V shared memory.
#line 47
	allow test_noopen_wm_t xserver_t:shm { associate getattr read write lock unix_read unix_write };
#line 47
	allow test_noopen_wm_t xserver_tmpfs_t:file { open { getattr read write append ioctl lock } };
#line 47

#line 47
	allow test_noopen_wm_t iceauth_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47
	allow test_noopen_wm_t iceauth_home_t:file { getattr relabelfrom relabelto };
#line 47

#line 47
	allow test_noopen_wm_t xauth_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47
	allow test_noopen_wm_t xauth_home_t:file { getattr relabelfrom relabelto };
#line 47

#line 47
	 	 	
#line 47
##### begin mls_xwin_read_to_clearance(test_noopen_wm_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute mlsxwinreadtoclr;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wm_t mlsxwinreadtoclr;
#line 47

#line 47
	 	
#line 47
##### end mls_xwin_read_to_clearance(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_wm_t user_fonts_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t user_fonts_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_fonts_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t user_fonts_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	allow test_noopen_wm_t user_fonts_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_wm_t user_fonts_t:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_fonts_t:dir { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_fonts_t:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_fonts_t:file { getattr relabelfrom relabelto };
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_fonts_cache_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t user_fonts_cache_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_fonts_cache_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t user_fonts_cache_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_fonts_cache_t:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_fonts_cache_t:dir { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_fonts_cache_t:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_fonts_cache_t:file { getattr relabelfrom relabelto };
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_fonts_config_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t user_fonts_config_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_fonts_config_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wm_t user_fonts_config_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_fonts_config_t:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_fonts_config_t:dir { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wm_t user_fonts_config_t:dir { getattr search open };
#line 47
	allow test_noopen_wm_t user_fonts_config_t:file { getattr relabelfrom relabelto };
#line 47

#line 47

#line 47
	 	
#line 47
##### end xserver_role(test_noopen_r,test_noopen_wm_t) depth: 3
#line 47
 	
#line 47
		 	 	
#line 47
##### begin xserver_manage_core_devices(test_noopen_wm_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type xserver_t, root_xdrawable_t, xevent_t;
#line 47
		class x_device { getattr setattr use read write getfocus setfocus bell force_cursor freeze grab manage list_property get_property set_property add remove create destroy };
#line 47
		class x_pointer { getattr setattr use read write getfocus setfocus bell force_cursor freeze grab manage list_property get_property set_property add remove create destroy };
#line 47
		class x_keyboard { getattr setattr use read write getfocus setfocus bell force_cursor freeze grab manage list_property get_property set_property add remove create destroy };
#line 47
		class x_screen { getattr setattr hide_cursor show_cursor saver_getattr saver_setattr saver_hide saver_show };
#line 47
		class x_drawable { manage };
#line 47
		attribute x_domain;
#line 47
		class x_drawable { create destroy read write blend getattr setattr list_child add_child remove_child list_property get_property set_property manage override show hide send receive };
#line 47
		class x_resource { read write };
#line 47
		class x_synthetic_event { send receive };
#line 47
		class x_cursor { create destroy read write getattr setattr use };
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wm_t xserver_t:{ x_device x_pointer x_keyboard } *;
#line 47
	allow test_noopen_wm_t xserver_t:{ x_screen } setattr;
#line 47
	
#line 47
	allow test_noopen_wm_t x_domain:x_cursor { create destroy read write getattr setattr use };
#line 47
	allow test_noopen_wm_t x_domain:x_drawable { create destroy read write blend getattr setattr list_child add_child remove_child list_property get_property set_property manage override show hide send receive };
#line 47
	allow test_noopen_wm_t x_domain:x_resource { read write };
#line 47
	allow test_noopen_wm_t root_xdrawable_t:x_drawable { create destroy read write blend getattr setattr list_child add_child remove_child list_property get_property set_property manage override show hide send receive };
#line 47
	allow test_noopen_wm_t xevent_t:x_synthetic_event { send receive };
#line 47

#line 47
	 	
#line 47
##### end xserver_manage_core_devices(test_noopen_wm_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47
 	 	
#line 47
##### end wm_role_template(test_noopen,test_noopen_r,test_noopen_t) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin policykit_role(test_noopen_r,test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin policykit_run_auth(test_noopen_usertype,test_noopen_r) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type policykit_auth_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin policykit_domtrans_auth(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type policykit_auth_t, policykit_auth_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_usertype policykit_auth_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_usertype policykit_auth_t:process transition;
#line 47
#	dontaudit test_noopen_usertype policykit_auth_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_usertype policykit_auth_exec_t:process policykit_auth_t;
#line 47

#line 47

#line 47
	allow policykit_auth_t test_noopen_usertype:fd use;
#line 47
	allow policykit_auth_t test_noopen_usertype:fifo_file { getattr read write append ioctl lock };
#line 47
	allow policykit_auth_t test_noopen_usertype:process sigchld;
#line 47

#line 47

#line 47
	 	
#line 47
##### end policykit_domtrans_auth(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	role test_noopen_r types policykit_auth_t;
#line 47

#line 47
	allow test_noopen_usertype policykit_auth_t:process signal;
#line 47
	
#line 47
	allow policykit_auth_t test_noopen_usertype:dir { getattr search open read lock ioctl };
#line 47
	allow policykit_auth_t test_noopen_usertype:file { open { getattr read ioctl lock } };
#line 47
	allow policykit_auth_t test_noopen_usertype:lnk_file { getattr read };
#line 47
	allow policykit_auth_t test_noopen_usertype:process getattr;
#line 47

#line 47

#line 47
	 	
#line 47
##### end policykit_run_auth(test_noopen_usertype,test_noopen_r) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin policykit_run_grant(test_noopen_usertype,test_noopen_r) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type policykit_grant_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin policykit_domtrans_grant(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type policykit_grant_t, policykit_grant_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_usertype policykit_grant_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_usertype policykit_grant_t:process transition;
#line 47
#	dontaudit test_noopen_usertype policykit_grant_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_usertype policykit_grant_exec_t:process policykit_grant_t;
#line 47

#line 47

#line 47
	allow policykit_grant_t test_noopen_usertype:fd use;
#line 47
	allow policykit_grant_t test_noopen_usertype:fifo_file { getattr read write append ioctl lock };
#line 47
	allow policykit_grant_t test_noopen_usertype:process sigchld;
#line 47

#line 47

#line 47
	 	
#line 47
##### end policykit_domtrans_grant(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	role test_noopen_r types policykit_grant_t;
#line 47

#line 47
	allow test_noopen_usertype policykit_grant_t:process signal;
#line 47

#line 47
	
#line 47
	allow policykit_grant_t test_noopen_usertype:dir { getattr search open read lock ioctl };
#line 47
	allow policykit_grant_t test_noopen_usertype:file { open { getattr read ioctl lock } };
#line 47
	allow policykit_grant_t test_noopen_usertype:lnk_file { getattr read };
#line 47
	allow policykit_grant_t test_noopen_usertype:process getattr;
#line 47

#line 47

#line 47
	 	
#line 47
##### end policykit_run_grant(test_noopen_usertype,test_noopen_r) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin policykit_read_lib(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type policykit_var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var_lib(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_lib_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_var_lib(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype policykit_var_lib_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype policykit_var_lib_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		# Broken placement
#line 47
		 	 	
#line 47
##### begin cron_read_system_job_lib_files(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type system_cronjob_var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var_lib(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_lib_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_var_lib(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype system_cronjob_var_lib_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype system_cronjob_var_lib_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end cron_read_system_job_lib_files(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	 	
#line 47
##### end policykit_read_lib(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin policykit_read_reload(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type policykit_reload_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var_lib(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_lib_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_var_lib(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype policykit_reload_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype policykit_reload_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end policykit_read_reload(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin policykit_dbus_chat(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type policykit_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow policykit_t test_noopen_usertype:dir { getattr search open read lock ioctl };
#line 47
	allow policykit_t test_noopen_usertype:file { open { getattr read ioctl lock } };
#line 47
	allow policykit_t test_noopen_usertype:lnk_file { getattr read };
#line 47
	allow policykit_t test_noopen_usertype:process getattr;
#line 47

#line 47

#line 47
	allow test_noopen_usertype policykit_t:dbus send_msg;
#line 47
	allow policykit_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end policykit_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
 	 	
#line 47
##### end policykit_role(test_noopen_r,test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin pulseaudio_role(test_noopen_r,test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
        attribute pulseaudio_tmpfsfile;
#line 47
		type pulseaudio_t, pulseaudio_exec_t, pulseaudio_tmpfs_t;
#line 47
		class dbus { acquire_svc send_msg };
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	role test_noopen_r types pulseaudio_t;
#line 47

#line 47
	# Transition from the user domain to the derived domain.
#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_usertype pulseaudio_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_usertype pulseaudio_t:process transition;
#line 47
#	dontaudit test_noopen_usertype pulseaudio_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_usertype pulseaudio_exec_t:process pulseaudio_t;
#line 47

#line 47

#line 47
	allow pulseaudio_t test_noopen_usertype:fd use;
#line 47
	allow pulseaudio_t test_noopen_usertype:fifo_file { getattr read write append ioctl lock };
#line 47
	allow pulseaudio_t test_noopen_usertype:process sigchld;
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype pulseaudio_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_usertype pulseaudio_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_usertype pulseaudio_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype pulseaudio_t:process getattr;
#line 47

#line 47

#line 47
	allow pulseaudio_t test_noopen_usertype:process { signal signull };
#line 47
	allow test_noopen_usertype pulseaudio_t:process { signal signull sigkill };
#line 47
	
#line 47
	allow pulseaudio_t test_noopen_usertype:dir { getattr search open read lock ioctl };
#line 47
	allow pulseaudio_t test_noopen_usertype:file { open { getattr read ioctl lock } };
#line 47
	allow pulseaudio_t test_noopen_usertype:lnk_file { getattr read };
#line 47
	allow pulseaudio_t test_noopen_usertype:process getattr;
#line 47

#line 47

#line 47
	allow pulseaudio_t test_noopen_usertype:unix_stream_socket connectto;
#line 47
	allow test_noopen_usertype pulseaudio_t:unix_stream_socket connectto;
#line 47

#line 47
	allow test_noopen_usertype { pulseaudio_tmpfs_t pulseaudio_tmpfsfile }:dir { { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl } { getattr relabelfrom relabelto } };
#line 47
	allow test_noopen_usertype { pulseaudio_tmpfs_t pulseaudio_tmpfsfile }:file { { create open getattr setattr read write append rename link unlink ioctl lock } { getattr relabelfrom relabelto } };
#line 47

#line 47
	 	 	
#line 47
##### begin userdom_manage_tmp_role(test_noopen_r,pulseaudio_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute user_tmp_type;
#line 47
		type user_tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	role test_noopen_r types user_tmp_t;
#line 47

#line 47
	 	 	
#line 47
##### begin files_poly_member_tmp(pulseaudio_t,user_tmp_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	type_member pulseaudio_t tmp_t:dir user_tmp_t;
#line 47

#line 47
	 	
#line 47
##### end files_poly_member_tmp(pulseaudio_t,user_tmp_t) depth: 4
#line 47
 	
#line 47

#line 47
	allow pulseaudio_t user_tmp_type:dir mounton;
#line 47
	
#line 47
	allow pulseaudio_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow pulseaudio_t user_tmp_type:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	
#line 47
	allow pulseaudio_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow pulseaudio_t user_tmp_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow pulseaudio_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow pulseaudio_t user_tmp_type:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow pulseaudio_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow pulseaudio_t user_tmp_type:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 47

#line 47
	
#line 47
	allow pulseaudio_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow pulseaudio_t user_tmp_type:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	 	 	
#line 47
##### begin files_tmp_filetrans(pulseaudio_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow pulseaudio_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition pulseaudio_t tmp_t:{ dir file lnk_file sock_file fifo_file } user_tmp_t ;
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_tmp_filetrans(pulseaudio_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 4
#line 47
 	
#line 47
     	 	
#line 47
##### begin fs_tmpfs_filetrans(pulseaudio_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow user_tmp_t tmpfs_t:filesystem associate;
#line 47
	
#line 47
	allow pulseaudio_t tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition pulseaudio_t tmpfs_t:{ dir file lnk_file sock_file fifo_file } user_tmp_t ;
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_tmpfs_filetrans(pulseaudio_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow pulseaudio_t user_tmp_type:dir { getattr search open };
#line 47
	allow pulseaudio_t user_tmp_type:dir { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow pulseaudio_t user_tmp_type:dir { getattr search open };
#line 47
	allow pulseaudio_t user_tmp_type:file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow pulseaudio_t user_tmp_type:dir { getattr search open };
#line 47
	allow pulseaudio_t user_tmp_type:lnk_file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow pulseaudio_t user_tmp_type:dir { getattr search open };
#line 47
	allow pulseaudio_t user_tmp_type:sock_file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow pulseaudio_t user_tmp_type:dir { getattr search open };
#line 47
	allow pulseaudio_t user_tmp_type:fifo_file { getattr relabelfrom relabelto };
#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_manage_tmp_role(test_noopen_r,pulseaudio_t) depth: 3
#line 47
 	
#line 47

#line 47
	allow test_noopen_usertype pulseaudio_t:dbus send_msg;
#line 47
	allow pulseaudio_t test_noopen_usertype:dbus { acquire_svc send_msg };
#line 47

#line 47
	 	
#line 47
##### end pulseaudio_role(test_noopen_r,test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin pulseaudio_filetrans_admin_home_content(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type pulseaudio_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin userdom_admin_home_dir_filetrans(test_noopen_usertype,pulseaudio_home_t,dir,".pulse") depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type admin_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype admin_home_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype admin_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_usertype admin_home_t:dir pulseaudio_home_t ".pulse";
#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_admin_home_dir_filetrans(test_noopen_usertype,pulseaudio_home_t,dir,".pulse") depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin userdom_admin_home_dir_filetrans(test_noopen_usertype,pulseaudio_home_t,file,".pulse-cookie") depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type admin_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype admin_home_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype admin_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_usertype admin_home_t:file pulseaudio_home_t ".pulse-cookie";
#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_admin_home_dir_filetrans(test_noopen_usertype,pulseaudio_home_t,file,".pulse-cookie") depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin userdom_admin_home_dir_filetrans(test_noopen_usertype,pulseaudio_home_t,file,".esd_auth") depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type admin_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype admin_home_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype admin_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_usertype admin_home_t:file pulseaudio_home_t ".esd_auth";
#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_admin_home_dir_filetrans(test_noopen_usertype,pulseaudio_home_t,file,".esd_auth") depth: 3
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end pulseaudio_filetrans_admin_home_content(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin rtkit_scheduled(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type rtkit_daemon_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow rtkit_daemon_t test_noopen_usertype:process { getsched setsched };
#line 47

#line 47
	 	 	
#line 47
##### begin kernel_search_proc(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type proc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype proc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype proc_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end kernel_search_proc(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow rtkit_daemon_t test_noopen_usertype:dir { getattr search open read lock ioctl };
#line 47
	allow rtkit_daemon_t test_noopen_usertype:file { open { getattr read ioctl lock } };
#line 47
	allow rtkit_daemon_t test_noopen_usertype:lnk_file { getattr read };
#line 47
	allow rtkit_daemon_t test_noopen_usertype:process getattr;
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin rtkit_daemon_dbus_chat(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type rtkit_daemon_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype rtkit_daemon_t:dbus send_msg;
#line 47
	allow rtkit_daemon_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end rtkit_daemon_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	 	
#line 47
##### end rtkit_scheduled(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin systemd_filetrans_home_content(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type systemd_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin gnome_data_filetrans(test_noopen_usertype,systemd_home_t,dir,"systemd") depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type data_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype data_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_usertype data_home_t:dir systemd_home_t "systemd";
#line 47

#line 47
	 	 	
#line 47
##### begin gnome_search_gconf(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type gconf_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype gconf_home_t:dir { getattr search open };
#line 47
	 	 	
#line 47
##### begin userdom_search_user_home_dirs(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_dir_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype user_home_dir_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype user_home_dir_t:lnk_file { getattr read };
#line 47
	 	 	
#line 47
##### begin files_search_home(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype home_root_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_search_home(test_noopen_usertype) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_search_user_home_dirs(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end gnome_search_gconf(test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end gnome_data_filetrans(test_noopen_usertype,systemd_home_t,dir,"systemd") depth: 3
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	 	
#line 47
##### end systemd_filetrans_home_content(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin setroubleshoot_dontaudit_stream_connect(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type setroubleshootd_t, setroubleshoot_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_t setroubleshoot_var_run_t:sock_file { open { getattr read write append } };
#line 47
	dontaudit test_noopen_t setroubleshootd_t:unix_stream_socket connectto;
#line 47

#line 47
	 	
#line 47
##### end setroubleshoot_dontaudit_stream_connect(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin udev_read_db(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin udev_read_pid_files(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type udev_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_list_all_dev_nodes(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype device_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_list_all_dev_nodes(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	allow test_noopen_usertype udev_var_run_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype udev_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype udev_var_run_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype udev_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype udev_var_run_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end udev_read_pid_files(test_noopen_usertype) depth: 3
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end udev_read_db(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin xserver_xdm_ioctl_log(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type xdm_log_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t xdm_log_t:file ioctl;
#line 47

#line 47
	 	
#line 47
##### end xserver_xdm_ioctl_log(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47
 	 	
#line 47
##### end userdom_restricted_xwindows_user_template(test_noopen) depth: 1
#line 47
 	
#line 47
	 	 	
#line 47
##### begin userdom_common_user_template(test_noopen) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute unpriv_userdomain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin userdom_basic_networking(test_noopen_usertype) depth: 3
#line 47
 	
#line 47

#line 47
	allow test_noopen_usertype self:tcp_socket { { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } } listen accept };
#line 47
	allow test_noopen_usertype self:udp_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 47

#line 47
	 	 	
#line 47
##### begin corenet_tcp_sendrecv_generic_if(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type netif_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype netif_t:netif { tcp_send tcp_recv egress ingress };
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_sendrecv_generic_if(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_udp_sendrecv_generic_if(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_udp_send_generic_if(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type netif_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype netif_t:netif { udp_send egress };
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_send_generic_if(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_udp_receive_generic_if(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type netif_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype netif_t:netif { udp_recv ingress };
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_receive_generic_if(test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_sendrecv_generic_if(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_tcp_sendrecv_generic_node(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type node_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype node_t:node { tcp_send tcp_recv sendto recvfrom };
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_sendrecv_generic_node(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_udp_sendrecv_generic_node(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_udp_send_generic_node(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type node_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype node_t:node { udp_send sendto };
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_send_generic_node(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_udp_receive_generic_node(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type node_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype node_t:node { udp_recv recvfrom };
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_receive_generic_node(test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_sendrecv_generic_node(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_tcp_sendrecv_all_ports(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute port_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype port_type:tcp_socket { send_msg recv_msg };
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_sendrecv_all_ports(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_udp_sendrecv_all_ports(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_udp_send_all_ports(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute port_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype port_type:udp_socket send_msg;
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_send_all_ports(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_udp_receive_all_ports(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute port_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype port_type:udp_socket recv_msg;
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_receive_all_ports(test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_sendrecv_all_ports(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_tcp_connect_all_ports(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute port_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype port_type:tcp_socket name_connect;
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_connect_all_ports(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_sendrecv_all_client_packets(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_send_all_client_packets(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute client_packet_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype client_packet_type:packet send;
#line 47

#line 47
	 	
#line 47
##### end corenet_send_all_client_packets(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_receive_all_client_packets(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute client_packet_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype client_packet_type:packet recv;
#line 47

#line 47
	 	
#line 47
##### end corenet_receive_all_client_packets(test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corenet_sendrecv_all_client_packets(test_noopen_usertype) depth: 3
#line 47
 	
#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin init_tcp_recvfrom_all_daemons(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute daemon;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corenet_tcp_recvfrom_labeled(test_noopen_usertype,daemon) depth: 5
#line 47
 	
#line 47
	allow { test_noopen_usertype daemon } self:association sendto;
#line 47
	allow test_noopen_usertype daemon:{ association tcp_socket } recvfrom;
#line 47
	allow daemon test_noopen_usertype:{ association tcp_socket } recvfrom;
#line 47

#line 47
	allow test_noopen_usertype daemon:peer recv;
#line 47
	allow daemon test_noopen_usertype:peer recv;
#line 47

#line 47
	# allow receiving packets from MLS-only peers using NetLabel
#line 47
	 	 	
#line 47
##### begin corenet_tcp_recvfrom_netlabel(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type netlabel_peer_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype netlabel_peer_t:peer recv;
#line 47
	allow test_noopen_usertype netlabel_peer_t:tcp_socket recvfrom;
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_recvfrom_netlabel(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_tcp_recvfrom_netlabel(daemon) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type netlabel_peer_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow daemon netlabel_peer_t:peer recv;
#line 47
	allow daemon netlabel_peer_t:tcp_socket recvfrom;
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_recvfrom_netlabel(daemon) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_recvfrom_labeled(test_noopen_usertype,daemon) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end init_tcp_recvfrom_all_daemons(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
		 	 	
#line 47
##### begin init_udp_recvfrom_all_daemons(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute daemon;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	 	 	
#line 47
##### begin corenet_udp_recvfrom_labeled(test_noopen_usertype,daemon) depth: 5
#line 47
 	
#line 47
	allow daemon self:association sendto;
#line 47
	allow test_noopen_usertype daemon:{ association udp_socket } recvfrom;
#line 47

#line 47
	allow test_noopen_usertype daemon:peer recv;
#line 47

#line 47
	# allow receiving packets from MLS-only peers using NetLabel
#line 47
	 	 	
#line 47
##### begin corenet_udp_recvfrom_netlabel(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type netlabel_peer_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype netlabel_peer_t:peer recv;
#line 47
	allow test_noopen_usertype netlabel_peer_t:udp_socket recvfrom;
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_recvfrom_netlabel(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_recvfrom_labeled(test_noopen_usertype,daemon) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end init_udp_recvfrom_all_daemons(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin ipsec_match_default_spd(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type ipsec_spd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype ipsec_spd_t:association polmatch;
#line 47
	allow test_noopen_usertype self:association sendto;
#line 47
	allow test_noopen_usertype self:peer recv;
#line 47

#line 47
	 	
#line 47
##### end ipsec_match_default_spd(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_basic_networking(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_all_recvfrom_netlabel(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute netlabel_peer_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t netlabel_peer_type;
#line 47

#line 47
	 	
#line 47
##### end corenet_all_recvfrom_netlabel(test_noopen_t) depth: 2
#line 47
 	
#line 47

#line 47
	##############################
#line 47
	#
#line 47
	# User domain Local policy
#line 47
	#
#line 47
	allow test_noopen_t self:packet_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 47

#line 47
	# evolution and gnome-session try to create a netlink socket
#line 47
	dontaudit test_noopen_t self:netlink_socket { create ioctl read getattr write setattr append bind connect getopt setopt shutdown };
#line 47
	dontaudit test_noopen_t self:netlink_route_socket { create ioctl read getattr write setattr append bind connect getopt setopt shutdown nlmsg_read nlmsg_write };
#line 47
	allow test_noopen_t self:netlink_kobject_uevent_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 47
	allow test_noopen_t self:socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 47

#line 47
	allow test_noopen_usertype unpriv_userdomain:fd use;
#line 47

#line 47
	 	 	
#line 47
##### begin kernel_read_system_state(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute kernel_system_state_reader;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t kernel_system_state_reader;
#line 47

#line 47
	 	
#line 47
##### end kernel_read_system_state(test_noopen_t) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin kernel_read_network_state(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type proc_t, proc_net_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype { proc_t proc_net_t }:dir { getattr search open };
#line 47
	allow test_noopen_usertype proc_net_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype { proc_t proc_net_t }:dir { getattr search open };
#line 47
	allow test_noopen_usertype proc_net_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype proc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype proc_net_t:dir { getattr search open read lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end kernel_read_network_state(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin kernel_read_software_raid_state(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type proc_t, proc_mdstat_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype proc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype proc_mdstat_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype proc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype proc_t:dir { getattr search open read lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end kernel_read_software_raid_state(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin kernel_read_net_sysctls(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type proc_t, sysctl_t, sysctl_net_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype { proc_t sysctl_t sysctl_net_t }:dir { getattr search open };
#line 47
	allow test_noopen_usertype sysctl_net_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype { proc_t sysctl_t sysctl_net_t }:dir { getattr search open };
#line 47
	allow test_noopen_usertype sysctl_net_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype { proc_t sysctl_t }:dir { getattr search open };
#line 47
	allow test_noopen_usertype sysctl_net_t:dir { getattr search open read lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end kernel_read_net_sysctls(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
     	 	
#line 47
##### begin kernel_read_afs_state(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type proc_t, proc_afs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype proc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype proc_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype proc_afs_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype proc_afs_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end kernel_read_afs_state(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	# Very permissive allowing every domain to see every type:
#line 47
	 	 	
#line 47
##### begin kernel_get_sysvipc_info(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type kernel_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype kernel_t:system ipc_info;
#line 47

#line 47
	 	
#line 47
##### end kernel_get_sysvipc_info(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	# Find CDROM devices:
#line 47
	 	 	
#line 47
##### begin kernel_read_device_sysctls(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type proc_t, sysctl_t, sysctl_dev_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype { proc_t sysctl_t sysctl_dev_t }:dir { getattr search open };
#line 47
	allow test_noopen_usertype sysctl_dev_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype { proc_t sysctl_t }:dir { getattr search open };
#line 47
	allow test_noopen_usertype sysctl_dev_t:dir { getattr search open read lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end kernel_read_device_sysctls(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin kernel_request_load_module(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type kernel_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype kernel_t:system module_request;
#line 47

#line 47
	 	
#line 47
##### end kernel_request_load_module(test_noopen_usertype) depth: 2
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin corenet_udp_bind_generic_node(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type node_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype node_t:udp_socket node_bind;
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_bind_generic_node(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_udp_bind_generic_port(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type port_t, unreserved_port_t, ephemeral_port_t;
#line 47
		attribute defined_port_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype { port_t unreserved_port_t ephemeral_port_t }:udp_socket name_bind;
#line 47
	dontaudit test_noopen_usertype defined_port_type:udp_socket name_bind;
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_bind_generic_port(test_noopen_usertype) depth: 2
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin dev_read_rand(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t, random_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype random_device_t:chr_file { getattr open read lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_read_rand(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_write_sound(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t, sound_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype sound_device_t:chr_file { getattr open write append lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_write_sound(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_read_sound(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t, sound_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype sound_device_t:chr_file { getattr open read lock ioctl };
#line 47

#line 47
	allow test_noopen_usertype sound_device_t:chr_file map;
#line 47

#line 47
	 	
#line 47
##### end dev_read_sound(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_read_sound_mixer(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t, sound_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype sound_device_t:chr_file { getattr open read lock ioctl };
#line 47

#line 47
	allow test_noopen_usertype sound_device_t:chr_file map;
#line 47

#line 47
	 	
#line 47
##### end dev_read_sound_mixer(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_write_sound_mixer(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t, sound_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype sound_device_t:chr_file { getattr open write append lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_write_sound_mixer(test_noopen_usertype) depth: 2
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin files_exec_etc_files(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype etc_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype etc_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_exec_etc_files(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_search_locks(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_lock_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	allow test_noopen_usertype var_lock_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_lock_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_locks(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	# Check to see if cdrom is mounted
#line 47
	 	 	
#line 47
##### begin files_search_mnt(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type mnt_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype mnt_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_mnt(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	# cjp: perhaps should cut back on file reads:
#line 47
	 	 	
#line 47
##### begin files_read_var_files(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_read_var_files(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_read_var_symlinks(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_read_var_symlinks(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_read_generic_spool(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_spool_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_spool_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_spool_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_spool_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_read_generic_spool(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_read_var_lib_files(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_lib_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype { var_t var_lib_t }:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_lib_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_read_var_lib_files(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	# Stat lost+found.
#line 47
	 	 	
#line 47
##### begin files_getattr_lost_found_dirs(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type lost_found_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype lost_found_t:dir getattr;
#line 47

#line 47
	 	
#line 47
##### end files_getattr_lost_found_dirs(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_read_config_files(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute configfile;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype configfile:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype configfile:dir { getattr search open };
#line 47
	allow test_noopen_usertype configfile:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype configfile:dir { getattr search open };
#line 47
	allow test_noopen_usertype configfile:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_read_config_files(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin fs_read_noxattr_fs_files(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute noxattrfs;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype noxattrfs:dir { getattr search open };
#line 47
	allow test_noopen_usertype noxattrfs:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_read_noxattr_fs_files(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin fs_read_noxattr_fs_symlinks(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute noxattrfs;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype noxattrfs:dir { getattr search open };
#line 47
	allow test_noopen_usertype noxattrfs:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_read_noxattr_fs_symlinks(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin fs_rw_cgroup_files(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cgroup_t;
#line 47

#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype cgroup_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype cgroup_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype cgroup_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype cgroup_t:file { open { getattr read write append ioctl lock } };
#line 47

#line 47
	 	 	
#line 47
##### begin fs_search_tmpfs(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype tmpfs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_tmpfs(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_search_sysfs(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype sysfs_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype sysfs_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_search_sysfs(test_noopen_usertype) depth: 3
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end fs_rw_cgroup_files(test_noopen_usertype) depth: 2
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin application_getattr_socket(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
    
#line 47
	
#line 47
		require {
#line 47
			
#line 47
        attribute application_domain_type;
#line 47
    
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
    allow test_noopen_usertype application_domain_type:{ tcp_socket udp_socket rawip_socket netlink_socket packet_socket unix_stream_socket unix_dgram_socket appletalk_socket netlink_route_socket netlink_firewall_socket netlink_tcpdiag_socket netlink_nflog_socket netlink_xfrm_socket netlink_selinux_socket netlink_audit_socket netlink_ip6fw_socket netlink_dnrt_socket netlink_kobject_uevent_socket tun_socket netlink_iscsi_socket netlink_fib_lookup_socket netlink_connector_socket netlink_netfilter_socket netlink_generic_socket netlink_scsitransport_socket netlink_rdma_socket netlink_crypto_socket sctp_socket icmp_socket ax25_socket ipx_socket netrom_socket atmpvc_socket x25_socket rose_socket decnet_socket atmsvc_socket rds_socket irda_socket pppox_socket llc_socket can_socket tipc_socket bluetooth_socket iucv_socket rxrpc_socket isdn_socket phonet_socket ieee802154_socket caif_socket alg_socket nfc_socket vsock_socket kcm_socket qipcrtr_socket smc_socket bridge_socket dccp_socket ib_socket mpls_socket } getattr;
#line 47

#line 47
	 	
#line 47
##### end application_getattr_socket(test_noopen_usertype) depth: 2
#line 47
 	
#line 47

#line 47

#line 47
    
#line 47

#line 47
	 	 	
#line 47
##### begin logging_send_syslog_msg(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute syslog_client_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t syslog_client_type;
#line 47

#line 47
	 	
#line 47
##### end logging_send_syslog_msg(test_noopen_t) depth: 2
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin selinux_get_enforce_mode(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type security_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_search_sysfs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_search_sysfs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin selinux_get_fs_mount(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type security_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t security_t:lnk_file { getattr read };
#line 47
	 	 	
#line 47
##### begin dev_getattr_sysfs_fs(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t sysfs_t:filesystem getattr;
#line 47

#line 47
	 	
#line 47
##### end dev_getattr_sysfs_fs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_search_sysfs(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_search_sysfs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	# starting in libselinux 2.0.5, init_selinuxmnt() will
#line 47
	# attempt to short circuit by checking if SELINUXMNT
#line 47
	# (/selinux) is already a selinuxfs
#line 47
	allow test_noopen_t security_t:filesystem getattr;
#line 47

#line 47
	# read /proc/filesystems to see if selinuxfs is supported
#line 47
	# then read /proc/self/mount to see where selinuxfs is mounted
#line 47
	 	 	
#line 47
##### begin kernel_read_system_state(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute kernel_system_state_reader;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t kernel_system_state_reader;
#line 47

#line 47
	 	
#line 47
##### end kernel_read_system_state(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end selinux_get_fs_mount(test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_t security_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t security_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_t security_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end selinux_get_enforce_mode(test_noopen_t) depth: 2
#line 47
 	
#line 47

#line 47
	# cjp: some of this probably can be removed
#line 47
	 	 	
#line 47
##### begin selinux_get_fs_mount(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type security_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t security_t:lnk_file { getattr read };
#line 47
	 	 	
#line 47
##### begin dev_getattr_sysfs_fs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t sysfs_t:filesystem getattr;
#line 47

#line 47
	 	
#line 47
##### end dev_getattr_sysfs_fs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_search_sysfs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_search_sysfs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	# starting in libselinux 2.0.5, init_selinuxmnt() will
#line 47
	# attempt to short circuit by checking if SELINUXMNT
#line 47
	# (/selinux) is already a selinuxfs
#line 47
	allow test_noopen_t security_t:filesystem getattr;
#line 47

#line 47
	# read /proc/filesystems to see if selinuxfs is supported
#line 47
	# then read /proc/self/mount to see where selinuxfs is mounted
#line 47
	 	 	
#line 47
##### begin kernel_read_system_state(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute kernel_system_state_reader;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_t kernel_system_state_reader;
#line 47

#line 47
	 	
#line 47
##### end kernel_read_system_state(test_noopen_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end selinux_get_fs_mount(test_noopen_t) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin selinux_validate_context(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type security_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_getattr_sysfs_fs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t sysfs_t:filesystem getattr;
#line 47

#line 47
	 	
#line 47
##### end dev_getattr_sysfs_fs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_search_sysfs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_search_sysfs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_t security_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t security_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t security_t:file { map { open { getattr read write append ioctl lock } } };
#line 47
	allow test_noopen_t security_t:security check_context;
#line 47

#line 47
	 	
#line 47
##### end selinux_validate_context(test_noopen_t) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin selinux_compute_access_vector(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type security_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_getattr_sysfs_fs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t sysfs_t:filesystem getattr;
#line 47

#line 47
	 	
#line 47
##### end dev_getattr_sysfs_fs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_search_sysfs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_search_sysfs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_t security_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t security_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t security_t:file { open { getattr read write append ioctl lock } };
#line 47
	allow test_noopen_t security_t:security compute_av;
#line 47

#line 47
	 	
#line 47
##### end selinux_compute_access_vector(test_noopen_t) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin selinux_compute_create_context(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type security_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_getattr_sysfs_fs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t sysfs_t:filesystem getattr;
#line 47

#line 47
	 	
#line 47
##### end dev_getattr_sysfs_fs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_search_sysfs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_search_sysfs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_t security_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t security_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t security_t:file { open { getattr read write append ioctl lock } };
#line 47
	allow test_noopen_t security_t:security compute_create;
#line 47

#line 47
	 	
#line 47
##### end selinux_compute_create_context(test_noopen_t) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin selinux_compute_relabel_context(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type security_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_getattr_sysfs_fs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t sysfs_t:filesystem getattr;
#line 47

#line 47
	 	
#line 47
##### end dev_getattr_sysfs_fs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_search_sysfs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_search_sysfs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_t security_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t security_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t security_t:file { open { getattr read write append ioctl lock } };
#line 47
	allow test_noopen_t security_t:security compute_relabel;
#line 47

#line 47
	 	
#line 47
##### end selinux_compute_relabel_context(test_noopen_t) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin selinux_compute_user_contexts(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type security_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_getattr_sysfs_fs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t sysfs_t:filesystem getattr;
#line 47

#line 47
	 	
#line 47
##### end dev_getattr_sysfs_fs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin dev_search_sysfs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sysfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47
	allow test_noopen_t sysfs_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_search_sysfs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_t security_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t security_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t security_t:file { open { getattr read write append ioctl lock } };
#line 47
	allow test_noopen_t security_t:security compute_user;
#line 47

#line 47
	 	
#line 47
##### end selinux_compute_user_contexts(test_noopen_t) depth: 2
#line 47
 	
#line 47

#line 47
	# for eject
#line 47
	 	 	
#line 47
##### begin storage_getattr_fixed_disk_dev(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type fixed_disk_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_list_all_dev_nodes(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype device_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_list_all_dev_nodes(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	allow test_noopen_usertype fixed_disk_device_t:blk_file getattr;
#line 47

#line 47
	 	
#line 47
##### end storage_getattr_fixed_disk_dev(test_noopen_usertype) depth: 2
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin auth_read_login_records(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type wtmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin logging_search_logs(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_log_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_var(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	allow test_noopen_usertype var_log_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end logging_search_logs(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	allow test_noopen_usertype wtmp_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end auth_read_login_records(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin auth_run_pam_timestamp(test_noopen_t,test_noopen_r) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type pam_timestamp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin auth_domtrans_pam_timestamp(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type pam_timestamp_t, pam_timestamp_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t pam_timestamp_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t pam_timestamp_t:process transition;
#line 47
#	dontaudit test_noopen_t pam_timestamp_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t pam_timestamp_exec_t:process pam_timestamp_t;
#line 47

#line 47

#line 47
	allow pam_timestamp_t test_noopen_t:fd use;
#line 47
	allow pam_timestamp_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow pam_timestamp_t test_noopen_t:process sigchld;
#line 47

#line 47

#line 47
	 	
#line 47
##### end auth_domtrans_pam_timestamp(test_noopen_t) depth: 3
#line 47
 	
#line 47
	role test_noopen_r types pam_timestamp_t;
#line 47

#line 47
	 	
#line 47
##### end auth_run_pam_timestamp(test_noopen_t,test_noopen_r) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin auth_run_utempter(test_noopen_t,test_noopen_r) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type utempter_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin auth_domtrans_utempter(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type utempter_t, utempter_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t utempter_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t utempter_t:process transition;
#line 47
#	dontaudit test_noopen_t utempter_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t utempter_exec_t:process utempter_t;
#line 47

#line 47

#line 47
	allow utempter_t test_noopen_t:fd use;
#line 47
	allow utempter_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow utempter_t test_noopen_t:process sigchld;
#line 47

#line 47

#line 47
	 	
#line 47
##### end auth_domtrans_utempter(test_noopen_t) depth: 3
#line 47
 	
#line 47
	role test_noopen_r types utempter_t;
#line 47

#line 47
	 	
#line 47
##### end auth_run_utempter(test_noopen_t,test_noopen_r) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin auth_filetrans_admin_home_content(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type auth_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin userdom_admin_home_dir_filetrans(test_noopen_t,auth_home_t,file,".google_authenticator") depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type admin_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t admin_home_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_t admin_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_t admin_home_t:file auth_home_t ".google_authenticator";
#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_admin_home_dir_filetrans(test_noopen_t,auth_home_t,file,".google_authenticator") depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin userdom_admin_home_dir_filetrans(test_noopen_t,auth_home_t,file,".google_authenticator~") depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type admin_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t admin_home_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_t admin_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_t admin_home_t:file auth_home_t ".google_authenticator~";
#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_admin_home_dir_filetrans(test_noopen_t,auth_home_t,file,".google_authenticator~") depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin userdom_admin_home_dir_filetrans(test_noopen_t,auth_home_t,dir,".yubico") depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type admin_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t admin_home_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_t admin_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_t admin_home_t:dir auth_home_t ".yubico";
#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_admin_home_dir_filetrans(test_noopen_t,auth_home_t,dir,".yubico") depth: 3
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end auth_filetrans_admin_home_content(test_noopen_t) depth: 2
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin init_read_utmp(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type initrc_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_list_pids(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open read lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_list_pids(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	allow test_noopen_usertype initrc_var_run_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end init_read_utmp(test_noopen_usertype) depth: 2
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin seutil_read_file_contexts(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type selinux_config_t, default_context_t, file_context_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_etc(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_etc(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	allow test_noopen_usertype { selinux_config_t default_context_t }:dir { getattr search open };
#line 47
	
#line 47
	allow test_noopen_usertype file_context_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype file_context_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype file_context_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype file_context_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype file_context_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype file_context_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_usertype file_context_t:file map;
#line 47

#line 47
	 	
#line 47
##### end seutil_read_file_contexts(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin seutil_read_default_contexts(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type selinux_config_t, default_context_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_etc(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_etc(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	allow test_noopen_usertype selinux_config_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype default_context_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype default_context_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype default_context_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end seutil_read_default_contexts(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin seutil_run_newrole(test_noopen_t,test_noopen_r) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type newrole_t;
#line 47
		#attribute_role newrole_roles;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	#seutil_domtrans_newrole(test_noopen_t)
#line 47
	#roleattribute test_noopen_r newrole_roles;
#line 47

#line 47
	 	 	
#line 47
##### begin seutil_domtrans_newrole(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type newrole_t, newrole_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_usr(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t usr_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_usr(test_noopen_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_search_bin(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_read_bin_symlinks(test_noopen_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_read_bin_symlinks(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_search_bin(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t newrole_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t newrole_t:process transition;
#line 47
#	dontaudit test_noopen_t newrole_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t newrole_exec_t:process newrole_t;
#line 47

#line 47

#line 47
	allow newrole_t test_noopen_t:fd use;
#line 47
	allow newrole_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow newrole_t test_noopen_t:process sigchld;
#line 47

#line 47

#line 47
	 	
#line 47
##### end seutil_domtrans_newrole(test_noopen_t) depth: 3
#line 47
 	
#line 47
        role test_noopen_r types newrole_t;
#line 47

#line 47
         	 	
#line 47
##### begin auth_run_upd_passwd(newrole_t,test_noopen_r) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type updpwd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin auth_domtrans_upd_passwd(newrole_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type updpwd_t, updpwd_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow newrole_t updpwd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow newrole_t updpwd_t:process transition;
#line 47
#	dontaudit newrole_t updpwd_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition newrole_t updpwd_exec_t:process updpwd_t;
#line 47

#line 47

#line 47
	allow updpwd_t newrole_t:fd use;
#line 47
	allow updpwd_t newrole_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow updpwd_t newrole_t:process sigchld;
#line 47

#line 47
	 	 	
#line 47
##### begin auth_dontaudit_read_shadow(newrole_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type shadow_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit newrole_t shadow_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end auth_dontaudit_read_shadow(newrole_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end auth_domtrans_upd_passwd(newrole_t) depth: 4
#line 47
 	
#line 47
	role test_noopen_r types updpwd_t;
#line 47

#line 47
	 	
#line 47
##### end auth_run_upd_passwd(newrole_t,test_noopen_r) depth: 3
#line 47
 	
#line 47

#line 47
        
#line 47
	optional {
#line 47
		
#line 47
                 	 	
#line 47
##### begin namespace_init_run(newrole_t,test_noopen_r) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type namespace_init_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin namespace_init_domtrans(newrole_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type namespace_init_t, namespace_init_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow newrole_t namespace_init_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow newrole_t namespace_init_t:process transition;
#line 47
#	dontaudit newrole_t namespace_init_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition newrole_t namespace_init_exec_t:process namespace_init_t;
#line 47

#line 47

#line 47
	allow namespace_init_t newrole_t:fd use;
#line 47
	allow namespace_init_t newrole_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow namespace_init_t newrole_t:process sigchld;
#line 47

#line 47

#line 47
	 	
#line 47
##### end namespace_init_domtrans(newrole_t) depth: 4
#line 47
 	
#line 47
	role test_noopen_r types namespace_init_t;
#line 47

#line 47
	 	 	
#line 47
##### begin seutil_run_setfiles(namespace_init_t,test_noopen_r) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type setfiles_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin seutil_domtrans_setfiles(namespace_init_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type setfiles_t, setfiles_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_usr(namespace_init_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow namespace_init_t usr_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_usr(namespace_init_t) depth: 6
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_search_bin(namespace_init_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_read_bin_symlinks(namespace_init_t) depth: 8
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow namespace_init_t bin_t:dir { getattr search open };
#line 47
	allow namespace_init_t bin_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_read_bin_symlinks(namespace_init_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	allow namespace_init_t bin_t:dir { getattr search open };
#line 47
	allow namespace_init_t bin_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_search_bin(namespace_init_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
	
#line 47
	allow namespace_init_t setfiles_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow namespace_init_t setfiles_t:process transition;
#line 47
#	dontaudit namespace_init_t setfiles_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition namespace_init_t setfiles_exec_t:process setfiles_t;
#line 47

#line 47

#line 47
	allow setfiles_t namespace_init_t:fd use;
#line 47
	allow setfiles_t namespace_init_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow setfiles_t namespace_init_t:process sigchld;
#line 47

#line 47
    allow namespace_init_t setfiles_exec_t:file map;
#line 47

#line 47
	 	
#line 47
##### end seutil_domtrans_setfiles(namespace_init_t) depth: 5
#line 47
 	
#line 47
	role test_noopen_r types setfiles_t;
#line 47

#line 47
	 	
#line 47
##### end seutil_run_setfiles(namespace_init_t,test_noopen_r) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end namespace_init_run(newrole_t,test_noopen_r) depth: 3
#line 47
 	
#line 47
        
#line 47
	} # end optional
#line 47

#line 47

#line 47

#line 47
	 	
#line 47
##### end seutil_run_newrole(test_noopen_t,test_noopen_r) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin seutil_exec_checkpolicy(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type checkpolicy_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_usr(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t usr_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_usr(test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_search_bin(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_read_bin_symlinks(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_read_bin_symlinks(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_search_bin(test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_t checkpolicy_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47

#line 47
	 	
#line 47
##### end seutil_exec_checkpolicy(test_noopen_t) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin seutil_exec_setfiles(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type setfiles_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_usr(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype usr_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_usr(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_search_bin(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_read_bin_symlinks(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype bin_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype bin_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_read_bin_symlinks(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype bin_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype bin_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_search_bin(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	allow test_noopen_usertype setfiles_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47

#line 47
	 	
#line 47
##### end seutil_exec_setfiles(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	# for when the network connection is killed
#line 47
	# this is needed when a login role can change
#line 47
	# to this one.
#line 47
	 	 	
#line 47
##### begin seutil_dontaudit_signal_newrole(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type newrole_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_t newrole_t:process signal;
#line 47

#line 47
	 	
#line 47
##### end seutil_dontaudit_signal_newrole(test_noopen_t) depth: 2
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin term_getattr_all_ttys(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tty_device_t;
#line 47
		attribute ttynode;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_list_all_dev_nodes(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t device_t:dir { getattr search open };
#line 47
	allow test_noopen_t device_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_t device_t:dir { getattr search open };
#line 47
	allow test_noopen_t device_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_list_all_dev_nodes(test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_t ttynode:chr_file getattr;
#line 47
	allow test_noopen_t tty_device_t:chr_file getattr;
#line 47

#line 47
	 	
#line 47
##### end term_getattr_all_ttys(test_noopen_t) depth: 2
#line 47
 	
#line 47

#line 47
    
#line 47
	optional {
#line 47
		
#line 47
         	 	
#line 47
##### begin afs_read_config(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type afs_config_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t afs_config_t:dir { getattr search open };
#line 47
	allow test_noopen_t afs_config_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end afs_read_config(test_noopen_t) depth: 2
#line 47
 	
#line 47
    
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		# Allow graphical boot to check battery lifespan
#line 47
		 	 	
#line 47
##### begin apm_stream_connect(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type apmd_t, apmd_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype apmd_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype apmd_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype apmd_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end apm_stream_connect(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin chrome_role(test_noopen_r,test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin chrome_role_notrans(test_noopen_r,test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type chrome_sandbox_t;
#line 47
		type chrome_sandbox_tmpfs_t;
#line 47
		type chrome_sandbox_nacl_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	role test_noopen_r types chrome_sandbox_t;
#line 47
	role test_noopen_r types chrome_sandbox_nacl_t;
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype chrome_sandbox_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_usertype chrome_sandbox_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_usertype chrome_sandbox_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype chrome_sandbox_t:process getattr;
#line 47

#line 47
	allow test_noopen_usertype chrome_sandbox_t:process { sigchld sigkill sigstop signull signal };
#line 47

#line 47
	allow chrome_sandbox_t test_noopen_usertype:unix_dgram_socket { read write };
#line 47
	allow test_noopen_usertype chrome_sandbox_t:unix_dgram_socket { read write };
#line 47
	allow chrome_sandbox_t test_noopen_usertype:unix_stream_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 47
	allow chrome_sandbox_t test_noopen_usertype:udp_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };;
#line 47
	allow chrome_sandbox_nacl_t test_noopen_usertype:unix_stream_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 47
	allow test_noopen_usertype chrome_sandbox_nacl_t:unix_stream_socket { getattr read write };
#line 47
	allow test_noopen_usertype chrome_sandbox_t:unix_stream_socket { getattr read write };
#line 47

#line 47
	allow test_noopen_usertype chrome_sandbox_t:shm { associate getattr read write lock unix_read unix_write };
#line 47

#line 47
	allow test_noopen_usertype chrome_sandbox_tmpfs_t:file { open { getattr read write append ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end chrome_role_notrans(test_noopen_r,test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin chrome_domtrans_sandbox(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type chrome_sandbox_t, chrome_sandbox_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_usertype chrome_sandbox_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_usertype chrome_sandbox_t:process transition;
#line 47
#	dontaudit test_noopen_usertype chrome_sandbox_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_usertype chrome_sandbox_exec_t:process chrome_sandbox_t;
#line 47

#line 47

#line 47
	allow chrome_sandbox_t test_noopen_usertype:fd use;
#line 47
	allow chrome_sandbox_t test_noopen_usertype:fifo_file { getattr read write append ioctl lock };
#line 47
	allow chrome_sandbox_t test_noopen_usertype:process sigchld;
#line 47

#line 47
	
#line 47
	allow chrome_sandbox_t test_noopen_usertype:dir { getattr search open read lock ioctl };
#line 47
	allow chrome_sandbox_t test_noopen_usertype:file { open { getattr read ioctl lock } };
#line 47
	allow chrome_sandbox_t test_noopen_usertype:lnk_file { getattr read };
#line 47
	allow chrome_sandbox_t test_noopen_usertype:process getattr;
#line 47

#line 47

#line 47
	allow test_noopen_usertype chrome_sandbox_t:fd use;
#line 47

#line 47
	dontaudit chrome_sandbox_t test_noopen_usertype:{ tcp_socket udp_socket rawip_socket netlink_socket packet_socket unix_stream_socket unix_dgram_socket appletalk_socket netlink_route_socket netlink_firewall_socket netlink_tcpdiag_socket netlink_nflog_socket netlink_xfrm_socket netlink_selinux_socket netlink_audit_socket netlink_ip6fw_socket netlink_dnrt_socket netlink_kobject_uevent_socket tun_socket netlink_iscsi_socket netlink_fib_lookup_socket netlink_connector_socket netlink_netfilter_socket netlink_generic_socket netlink_scsitransport_socket netlink_rdma_socket netlink_crypto_socket sctp_socket icmp_socket ax25_socket ipx_socket netrom_socket atmpvc_socket x25_socket rose_socket decnet_socket atmsvc_socket rds_socket irda_socket pppox_socket llc_socket can_socket tipc_socket bluetooth_socket iucv_socket rxrpc_socket isdn_socket phonet_socket ieee802154_socket caif_socket alg_socket nfc_socket vsock_socket kcm_socket qipcrtr_socket smc_socket bridge_socket dccp_socket ib_socket mpls_socket } getattr;
#line 47
	allow chrome_sandbox_t test_noopen_usertype:unix_stream_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 47

#line 47
	
#line 47
		 	 	
#line 47
##### begin fs_dontaudit_rw_anon_inodefs_files(chrome_sandbox_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type anon_inodefs_t;
#line 47

#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit chrome_sandbox_t anon_inodefs_t:file { open { getattr read write append ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end fs_dontaudit_rw_anon_inodefs_files(chrome_sandbox_t) depth: 4
#line 47
 	
#line 47
	
#line 47

#line 47
	 	
#line 47
##### end chrome_domtrans_sandbox(test_noopen_usertype) depth: 3
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end chrome_role(test_noopen_r,test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin canna_stream_connect(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type canna_t, canna_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype canna_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype canna_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype canna_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end canna_stream_connect(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin colord_read_lib_files(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type colord_var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var_lib(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_lib_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_var_lib(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype colord_var_lib_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype colord_var_lib_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end colord_read_lib_files(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin dbus_system_bus_client(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type system_dbusd_t, system_dbusd_t;
#line 47
		type system_dbusd_var_run_t, system_dbusd_var_lib_t;
#line 47
		class dbus send_msg;
#line 47
		attribute dbusd_unconfined;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	# SE-DBus specific permissions
#line 47
	allow test_noopen_usertype { system_dbusd_t self }:dbus send_msg;
#line 47
	allow { system_dbusd_t dbusd_unconfined } test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype system_dbusd_var_lib_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype system_dbusd_var_lib_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var_lib(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_lib_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_var_lib(test_noopen_usertype) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin dev_read_urand(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t, urandom_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype urandom_device_t:chr_file { getattr open read lock ioctl };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_read_urand(test_noopen_usertype) depth: 3
#line 47
 	
#line 47

#line 47
	# For connecting to the bus
#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype system_dbusd_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype system_dbusd_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype system_dbusd_t:unix_stream_socket connectto;
#line 47

#line 47
	 	 	
#line 47
##### begin dbus_read_config(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type dbusd_etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype dbusd_etc_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_usertype dbusd_etc_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end dbus_read_config(test_noopen_usertype) depth: 3
#line 47
 	
#line 47

#line 47
    
#line 47
	optional {
#line 47
		
#line 47
         	 	
#line 47
##### begin unconfined_server_dbus_chat(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type unconfined_service_t;
#line 47
        class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
        allow test_noopen_usertype unconfined_service_t:dbus send_msg;
#line 47
        allow unconfined_service_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end unconfined_server_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
    
#line 47
	}
#line 47

#line 47

#line 47
	 	
#line 47
##### end dbus_system_bus_client(test_noopen_usertype) depth: 2
#line 47
 	
#line 47

#line 47
		allow test_noopen_usertype test_noopen_usertype:dbus  send_msg;
#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin avahi_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type avahi_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype avahi_t:dbus send_msg;
#line 47
	allow avahi_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end avahi_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin bluetooth_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bluetooth_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype bluetooth_t:dbus send_msg;
#line 47
	allow bluetooth_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end bluetooth_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin consolekit_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type consolekit_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype consolekit_t:dbus send_msg;
#line 47
	allow consolekit_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end consolekit_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
			 	 	
#line 47
##### begin consolekit_read_log(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type consolekit_log_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype consolekit_log_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype consolekit_log_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	 	 	
#line 47
##### begin logging_search_logs(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_log_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_var(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	allow test_noopen_usertype var_log_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end logging_search_logs(test_noopen_usertype) depth: 3
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end consolekit_read_log(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin devicekit_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type devicekit_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype devicekit_t:dbus send_msg;
#line 47
	allow devicekit_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end devicekit_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
			 	 	
#line 47
##### begin devicekit_dbus_chat_power(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type devicekit_power_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype devicekit_power_t:dbus send_msg;
#line 47
	allow devicekit_power_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end devicekit_dbus_chat_power(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
			 	 	
#line 47
##### begin devicekit_dbus_chat_disk(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type devicekit_disk_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype devicekit_disk_t:dbus send_msg;
#line 47
	allow devicekit_disk_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end devicekit_dbus_chat_disk(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin evolution_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type evolution_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype evolution_t:dbus send_msg;
#line 47
	allow evolution_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end evolution_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
			 	 	
#line 47
##### begin evolution_alarm_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type evolution_alarm_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype evolution_alarm_t:dbus send_msg;
#line 47
	allow evolution_alarm_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end evolution_alarm_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
        
#line 47
	optional {
#line 47
		
#line 47
             	 	
#line 47
##### begin firewalld_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type firewalld_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype firewalld_t:dbus send_msg;
#line 47
	allow firewalld_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end firewalld_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
        
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin geoclue_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
        
#line 47
	
#line 47
		require {
#line 47
			
#line 47
                type geoclue_t;
#line 47
                class dbus send_msg;
#line 47
        
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
        allow test_noopen_usertype geoclue_t:dbus send_msg;
#line 47
        allow geoclue_t test_noopen_usertype:dbus send_msg;
#line 47
	    
#line 47
	allow geoclue_t test_noopen_usertype:dir { getattr search open read lock ioctl };
#line 47
	allow geoclue_t test_noopen_usertype:file { open { getattr read ioctl lock } };
#line 47
	allow geoclue_t test_noopen_usertype:lnk_file { getattr read };
#line 47
	allow geoclue_t test_noopen_usertype:process getattr;
#line 47

#line 47

#line 47
	 	
#line 47
##### end geoclue_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin gnome_dbus_chat_gconfdefault(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type gconfdefaultsm_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype gconfdefaultsm_t:dbus send_msg;
#line 47
	allow gconfdefaultsm_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end gnome_dbus_chat_gconfdefault(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin hal_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type hald_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype hald_t:dbus send_msg;
#line 47
	allow hald_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end hal_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin hwloc_exec_dhwd(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type hwloc_dhwd_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t hwloc_dhwd_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47

#line 47
	 	
#line 47
##### end hwloc_exec_dhwd(test_noopen_t) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin hwloc_read_runtime_files(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type hwloc_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_t var_t:dir { getattr search open };
#line 47
	allow test_noopen_t var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t hwloc_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_t hwloc_var_run_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end hwloc_read_runtime_files(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin kde_dbus_chat_backlighthelper(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
        
#line 47
	
#line 47
		require {
#line 47
			
#line 47
                type kdebacklighthelper_t;
#line 47
                class dbus send_msg;
#line 47
        
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype kdebacklighthelper_t:dbus send_msg;
#line 47
        allow kdebacklighthelper_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end kde_dbus_chat_backlighthelper(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
        
#line 47
	optional {
#line 47
		
#line 47
             	 	
#line 47
##### begin memcached_stream_connect(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type memcached_t, memcached_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype memcached_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype memcached_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype memcached_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end memcached_stream_connect(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
        
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin modemmanager_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type modemmanager_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype modemmanager_t:dbus send_msg;
#line 47
	allow modemmanager_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end modemmanager_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin networkmanager_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type NetworkManager_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype NetworkManager_t:dbus send_msg;
#line 47
	allow NetworkManager_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end networkmanager_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
			 	 	
#line 47
##### begin networkmanager_read_lib_files(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type NetworkManager_var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var_lib(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_lib_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_var_lib(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype NetworkManager_var_lib_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype NetworkManager_var_lib_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype NetworkManager_var_lib_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype NetworkManager_var_lib_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	allow test_noopen_usertype NetworkManager_var_lib_t:file map;
#line 47

#line 47
	 	
#line 47
##### end networkmanager_read_lib_files(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin policykit_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type policykit_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow policykit_t test_noopen_usertype:dir { getattr search open read lock ioctl };
#line 47
	allow policykit_t test_noopen_usertype:file { open { getattr read ioctl lock } };
#line 47
	allow policykit_t test_noopen_usertype:lnk_file { getattr read };
#line 47
	allow policykit_t test_noopen_usertype:process getattr;
#line 47

#line 47

#line 47
	allow test_noopen_usertype policykit_t:dbus send_msg;
#line 47
	allow policykit_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end policykit_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47

#line 47
		
#line 47
	optional {
#line 47
		
#line 47
			 	 	
#line 47
##### begin vpn_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type vpnc_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype vpnc_t:dbus send_msg;
#line 47
	allow vpnc_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end vpn_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin git_role(test_noopen_r,test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute_role git_session_roles;
#line 47
		type git_session_t, gitd_exec_t, git_user_content_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	########################################
#line 47
	#
#line 47
	# Declarations
#line 47
	#
#line 47

#line 47
	roleattribute test_noopen_r git_session_roles;
#line 47

#line 47
	########################################
#line 47
	#
#line 47
	# Policy
#line 47
	#
#line 47

#line 47
	allow test_noopen_t git_user_content_t:dir { { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl } { getattr relabelfrom relabelto } };
#line 47
	allow test_noopen_t git_user_content_t:file { { getattr open map read execute ioctl execute_no_trans } { create open getattr setattr read write append rename link unlink ioctl lock } { getattr relabelfrom relabelto } };
#line 47
	 	 	
#line 47
##### begin userdom_user_home_dir_filetrans(test_noopen_t,git_user_content_t,dir,"public_git") depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_dir_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_t user_home_dir_t:dir git_user_content_t "public_git";
#line 47

#line 47
	 	 	
#line 47
##### begin files_search_home(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t home_root_t:dir { getattr search open };
#line 47
	allow test_noopen_t home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_search_home(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_user_home_dir_filetrans(test_noopen_t,git_user_content_t,dir,"public_git") depth: 3
#line 47
 	
#line 47

#line 47
	allow test_noopen_t git_session_t:process { sigchld sigkill sigstop signull signal };
#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool deny_ptrace;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (deny_ptrace) {
#line 47
		
#line 47
	} else {
#line 47
		
#line 47
		allow test_noopen_t git_session_t:process ptrace;
#line 47
	
#line 47
	}
#line 47

#line 47
	
#line 47
	allow test_noopen_t git_session_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t git_session_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_t git_session_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t git_session_t:process getattr;
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool git_session_users;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (git_session_users) {
#line 47
		
#line 47
		
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t gitd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t git_session_t:process transition;
#line 47
#	dontaudit test_noopen_t git_session_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t gitd_exec_t:process git_session_t;
#line 47

#line 47

#line 47
	allow git_session_t test_noopen_t:fd use;
#line 47
	allow git_session_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow git_session_t test_noopen_t:process sigchld;
#line 47

#line 47
	
#line 47
	} else {
#line 47
		
#line 47
		allow test_noopen_t gitd_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47
	
#line 47
	}
#line 47

#line 47
 	 	
#line 47
##### end git_role(test_noopen_r,test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin inetd_use_fds(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type inetd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype inetd_t:fd use;
#line 47

#line 47
	 	
#line 47
##### end inetd_use_fds(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin inetd_rw_tcp_sockets(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type inetd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype inetd_t:tcp_socket { { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } listen accept };
#line 47

#line 47
	 	
#line 47
##### end inetd_rw_tcp_sockets(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin inn_read_config(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type innd_etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_etc(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_etc(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	allow test_noopen_usertype innd_etc_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_usertype innd_etc_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_usertype innd_etc_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end inn_read_config(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin inn_read_news_lib(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type innd_var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var_lib(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_lib_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_var_lib(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	allow test_noopen_usertype innd_var_lib_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_usertype innd_var_lib_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end inn_read_news_lib(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin inn_read_news_spool(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type news_spool_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_spool(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_spool_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_spool_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_spool(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	allow test_noopen_usertype news_spool_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_usertype news_spool_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_usertype news_spool_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end inn_read_news_spool(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin lircd_stream_connect(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type lircd_var_run_t, lircd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype lircd_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype lircd_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype lircd_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end lircd_stream_connect(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin locate_read_lib_files(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type locate_var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var_lib(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t var_t:dir { getattr search open };
#line 47
	allow test_noopen_t var_lib_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_var_lib(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t locate_var_lib_t:dir { getattr search open };
#line 47
	allow test_noopen_t locate_var_lib_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	allow test_noopen_t locate_var_lib_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end locate_read_lib_files(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin mpd_manage_user_data_content(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type mpd_user_data_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin userdom_search_user_home_dirs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_dir_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t user_home_dir_t:dir { getattr search open };
#line 47
	allow test_noopen_t user_home_dir_t:lnk_file { getattr read };
#line 47
	 	 	
#line 47
##### begin files_search_home(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t home_root_t:dir { getattr search open };
#line 47
	allow test_noopen_t home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_search_home(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_search_user_home_dirs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_t mpd_user_data_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47
	allow test_noopen_t mpd_user_data_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47
	allow test_noopen_t mpd_user_data_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	 	
#line 47
##### end mpd_manage_user_data_content(test_noopen_t) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin mpd_relabel_user_data_content(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type mpd_user_data_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin userdom_search_user_home_dirs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_dir_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t user_home_dir_t:dir { getattr search open };
#line 47
	allow test_noopen_t user_home_dir_t:lnk_file { getattr read };
#line 47
	 	 	
#line 47
##### begin files_search_home(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t home_root_t:dir { getattr search open };
#line 47
	allow test_noopen_t home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_search_home(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_search_user_home_dirs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_t mpd_user_data_t:dir { getattr relabelfrom relabelto };
#line 47
	allow test_noopen_t mpd_user_data_t:file { getattr relabelfrom relabelto };
#line 47
	allow test_noopen_t mpd_user_data_t:lnk_file { getattr relabelfrom relabelto };
#line 47

#line 47
	 	
#line 47
##### end mpd_relabel_user_data_content(test_noopen_t) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin mpd_stream_connect(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type mpd_t, mpd_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_t var_t:dir { getattr search open };
#line 47
	allow test_noopen_t var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t mpd_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_t mpd_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_t mpd_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end mpd_stream_connect(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	# for running depmod as part of the kernel packaging process
#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin modutils_read_module_config(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type modules_conf_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	# This file type can be in /etc or
#line 47
	# /lib(64)?/modules
#line 47
	 	 	
#line 47
##### begin files_search_etc(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_etc(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_search_boot(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type boot_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype boot_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_boot(test_noopen_usertype) depth: 3
#line 47
 	
#line 47

#line 47
	allow test_noopen_usertype modules_conf_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_usertype modules_conf_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_usertype modules_conf_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end modutils_read_module_config(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin mta_rw_spool(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type mail_spool_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_spool(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_spool_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_spool_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_spool(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	allow test_noopen_usertype mail_spool_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_usertype mail_spool_t:file { setattr };
#line 47
	
#line 47
	allow test_noopen_usertype mail_spool_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_usertype mail_spool_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype mail_spool_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype mail_spool_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end mta_rw_spool(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin mta_manage_queue(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type mqueue_spool_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_spool(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_spool_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_spool_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_spool(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype mqueue_spool_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_usertype mqueue_spool_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype mqueue_spool_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_usertype mqueue_spool_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end mta_manage_queue(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool selinuxuser_mysql_connect_enabled;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (selinuxuser_mysql_connect_enabled) {
#line 47
		
#line 47
			 	 	
#line 47
##### begin mysql_stream_connect(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type mysqld_t, mysqld_var_run_t, mysqld_db_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_t var_t:dir { getattr search open };
#line 47
	allow test_noopen_t var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t mysqld_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_t mysqld_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_t mysqld_t:unix_stream_socket connectto;
#line 47

#line 47
	
#line 47
	allow test_noopen_t mysqld_db_t:dir { getattr search open };
#line 47
	allow test_noopen_t mysqld_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_t mysqld_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end mysql_stream_connect(test_noopen_t) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin oident_manage_user_content(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type oidentd_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin userdom_search_user_home_dirs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_dir_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t user_home_dir_t:dir { getattr search open };
#line 47
	allow test_noopen_t user_home_dir_t:lnk_file { getattr read };
#line 47
	 	 	
#line 47
##### begin files_search_home(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t home_root_t:dir { getattr search open };
#line 47
	allow test_noopen_t home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_search_home(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_search_user_home_dirs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_t oidentd_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	 	
#line 47
##### end oident_manage_user_content(test_noopen_t) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin oident_relabel_user_content(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type oidentd_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin userdom_search_user_home_dirs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_dir_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t user_home_dir_t:dir { getattr search open };
#line 47
	allow test_noopen_t user_home_dir_t:lnk_file { getattr read };
#line 47
	 	 	
#line 47
##### begin files_search_home(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t home_root_t:dir { getattr search open };
#line 47
	allow test_noopen_t home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_search_home(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_search_user_home_dirs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_t oidentd_home_t:file { getattr relabelfrom relabelto };
#line 47

#line 47
	 	
#line 47
##### end oident_relabel_user_content(test_noopen_t) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin oident_home_filetrans_oidentd_home(test_noopen_t,file,".oidentd.conf") depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type oidentd_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin userdom_user_home_dir_filetrans(test_noopen_t,oidentd_home_t,file,".oidentd.conf") depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_dir_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_t user_home_dir_t:file oidentd_home_t ".oidentd.conf";
#line 47

#line 47
	 	 	
#line 47
##### begin files_search_home(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t home_root_t:dir { getattr search open };
#line 47
	allow test_noopen_t home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_search_home(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_user_home_dir_filetrans(test_noopen_t,oidentd_home_t,file,".oidentd.conf") depth: 3
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end oident_home_filetrans_oidentd_home(test_noopen_t,file,".oidentd.conf") depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		# to allow monitoring of pcmcia status
#line 47
		 	 	
#line 47
##### begin pcmcia_read_pid(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cardmgr_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype cardmgr_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype cardmgr_var_run_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end pcmcia_read_pid(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin pcscd_read_pid_files(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type pcscd_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_t var_t:dir { getattr search open };
#line 47
	allow test_noopen_t var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t pcscd_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_t pcscd_var_run_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end pcscd_read_pid_files(test_noopen_t) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin pcscd_stream_connect(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type pcscd_t, pcscd_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_t var_t:dir { getattr search open };
#line 47
	allow test_noopen_t var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t pcscd_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_t pcscd_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_t pcscd_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end pcscd_stream_connect(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool selinuxuser_postgresql_connect_enabled;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (selinuxuser_postgresql_connect_enabled) {
#line 47
		
#line 47
			 	 	
#line 47
##### begin postgresql_stream_connect(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type postgresql_t, postgresql_var_run_t, postgresql_tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype { postgresql_var_run_t postgresql_tmp_t }:dir { getattr search open };
#line 47
	allow test_noopen_usertype { postgresql_var_run_t postgresql_tmp_t }:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype postgresql_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_search_tmp(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin fs_search_tmpfs(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype tmpfs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_tmpfs(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype tmp_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_usertype tmp_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_tmp(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype { postgresql_var_run_t postgresql_tmp_t }:dir { getattr search open };
#line 47
	allow test_noopen_usertype { postgresql_var_run_t postgresql_tmp_t }:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype postgresql_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end postgresql_stream_connect(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
			 	 	
#line 47
##### begin postgresql_tcp_connect(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type postgresql_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corenet_tcp_recvfrom_labeled(test_noopen_usertype,postgresql_t) depth: 4
#line 47
 	
#line 47
	allow { test_noopen_usertype postgresql_t } self:association sendto;
#line 47
	allow test_noopen_usertype postgresql_t:{ association tcp_socket } recvfrom;
#line 47
	allow postgresql_t test_noopen_usertype:{ association tcp_socket } recvfrom;
#line 47

#line 47
	allow test_noopen_usertype postgresql_t:peer recv;
#line 47
	allow postgresql_t test_noopen_usertype:peer recv;
#line 47

#line 47
	# allow receiving packets from MLS-only peers using NetLabel
#line 47
	 	 	
#line 47
##### begin corenet_tcp_recvfrom_netlabel(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type netlabel_peer_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype netlabel_peer_t:peer recv;
#line 47
	allow test_noopen_usertype netlabel_peer_t:tcp_socket recvfrom;
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_recvfrom_netlabel(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_tcp_recvfrom_netlabel(postgresql_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type netlabel_peer_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow postgresql_t netlabel_peer_t:peer recv;
#line 47
	allow postgresql_t netlabel_peer_t:tcp_socket recvfrom;
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_recvfrom_netlabel(postgresql_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_recvfrom_labeled(test_noopen_usertype,postgresql_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_tcp_sendrecv_postgresql_port(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type postgresql_port_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype postgresql_port_t:tcp_socket { send_msg recv_msg };
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_sendrecv_postgresql_port(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_tcp_connect_postgresql_port(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type postgresql_port_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype postgresql_port_t:tcp_socket name_connect;
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_connect_postgresql_port(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_sendrecv_postgresql_client_packets(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_send_postgresql_client_packets(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type postgresql_client_packet_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype postgresql_client_packet_t:packet send;
#line 47

#line 47
	 	
#line 47
##### end corenet_send_postgresql_client_packets(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_receive_postgresql_client_packets(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type postgresql_client_packet_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype postgresql_client_packet_t:packet recv;
#line 47

#line 47
	 	
#line 47
##### end corenet_receive_postgresql_client_packets(test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corenet_sendrecv_postgresql_client_packets(test_noopen_usertype) depth: 3
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end postgresql_tcp_connect(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin ppp_manage_home_files(test_noopen_t) depth: 3
#line 47
 	
#line 47
    
#line 47
	
#line 47
		require {
#line 47
			
#line 47
        type ppp_home_t;
#line 47
    
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin userdom_search_user_home_dirs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_dir_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t user_home_dir_t:dir { getattr search open };
#line 47
	allow test_noopen_t user_home_dir_t:lnk_file { getattr read };
#line 47
	 	 	
#line 47
##### begin files_search_home(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t home_root_t:dir { getattr search open };
#line 47
	allow test_noopen_t home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_search_home(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_search_user_home_dirs(test_noopen_t) depth: 3
#line 47
 	
#line 47
    allow test_noopen_t ppp_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	 	
#line 47
##### end ppp_manage_home_files(test_noopen_t) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin ppp_relabel_home_files(test_noopen_t) depth: 3
#line 47
 	
#line 47
    
#line 47
	
#line 47
		require {
#line 47
			
#line 47
        type ppp_home_t;
#line 47
    
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin userdom_search_user_home_dirs(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_dir_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t user_home_dir_t:dir { getattr search open };
#line 47
	allow test_noopen_t user_home_dir_t:lnk_file { getattr read };
#line 47
	 	 	
#line 47
##### begin files_search_home(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t home_root_t:dir { getattr search open };
#line 47
	allow test_noopen_t home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_search_home(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_search_user_home_dirs(test_noopen_t) depth: 3
#line 47
 	
#line 47
    allow test_noopen_t ppp_home_t:file { getattr relabelfrom relabelto };
#line 47

#line 47
	 	
#line 47
##### end ppp_relabel_home_files(test_noopen_t) depth: 2
#line 47
 	
#line 47
		 	 	
#line 47
##### begin ppp_home_filetrans_ppp_home(test_noopen_t,file,".ppprc") depth: 3
#line 47
 	
#line 47
    
#line 47
	
#line 47
		require {
#line 47
			
#line 47
        type ppp_home_t;
#line 47
    
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin userdom_user_home_dir_filetrans(test_noopen_t,ppp_home_t,file,".ppprc") depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_dir_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_t user_home_dir_t:file ppp_home_t ".ppprc";
#line 47

#line 47
	 	 	
#line 47
##### begin files_search_home(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t home_root_t:dir { getattr search open };
#line 47
	allow test_noopen_t home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_search_home(test_noopen_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_user_home_dir_filetrans(test_noopen_t,ppp_home_t,file,".ppprc") depth: 3
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end ppp_home_filetrans_ppp_home(test_noopen_t,file,".ppprc") depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin resmgr_stream_connect(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type resmgrd_var_run_t, resmgrd_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype resmgrd_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype resmgrd_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype resmgrd_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end resmgr_stream_connect(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin rpc_dontaudit_getattr_exports(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type exports_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	dontaudit test_noopen_usertype exports_t:file { getattr };
#line 47

#line 47
	 	
#line 47
##### end rpc_dontaudit_getattr_exports(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin rpcbind_stream_connect(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type rpcbind_t, rpcbind_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype rpcbind_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype rpcbind_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype rpcbind_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end rpcbind_stream_connect(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin samba_stream_connect_winbind(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type samba_var_t, winbind_t, winbind_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin samba_search_pid(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type smbd_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	allow test_noopen_usertype smbd_var_run_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end samba_search_pid(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	allow test_noopen_usertype samba_var_t:dir { getattr search open };
#line 47
	
#line 47
	allow test_noopen_usertype winbind_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype winbind_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype winbind_t:unix_stream_socket connectto;
#line 47

#line 47
	 	 	
#line 47
##### begin samba_read_config(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type samba_etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_etc(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type etc_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype etc_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_etc(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype samba_etc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype samba_etc_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype samba_etc_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype samba_etc_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end samba_read_config(test_noopen_usertype) depth: 3
#line 47
 	
#line 47

#line 47
	
#line 47
		
#line 47
	
#line 47
		require {
#line 47
			
#line 47
			type winbind_tmp_t;
#line 47
		
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
		# the default for the socket is (poorly named):
#line 47
		# /tmp/.winbindd/pipe
#line 47
		 	 	
#line 47
##### begin files_search_tmp(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin fs_search_tmpfs(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype tmpfs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_tmpfs(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype tmp_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_usertype tmp_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_tmp(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
		
#line 47
	allow test_noopen_usertype winbind_tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype winbind_tmp_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype winbind_t:unix_stream_socket connectto;
#line 47

#line 47
	
#line 47

#line 47
	 	
#line 47
##### end samba_stream_connect_winbind(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin sandbox_transition(test_noopen_usertype,test_noopen_r) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute sandbox_domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin sandbox_dyntransition(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute sandbox_domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype sandbox_domain:process dyntransition;
#line 47

#line 47
	 	
#line 47
##### end sandbox_dyntransition(test_noopen_usertype) depth: 3
#line 47
 	 #885288
#line 47
    allow test_noopen_usertype sandbox_domain:process transition;
#line 47
    dontaudit test_noopen_usertype sandbox_domain:process { noatsecure siginh rlimitinh };
#line 47

#line 47
    role test_noopen_r types sandbox_domain;
#line 47

#line 47
    allow sandbox_domain test_noopen_usertype:process { sigchld signull };
#line 47
    allow sandbox_domain test_noopen_usertype:fifo_file { getattr read write append ioctl lock };
#line 47

#line 47
    dontaudit sandbox_domain test_noopen_usertype:process signal;
#line 47
    dontaudit sandbox_domain test_noopen_usertype:key { link read search view };
#line 47
    dontaudit sandbox_domain test_noopen_usertype:unix_stream_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 47

#line 47
	 	
#line 47
##### end sandbox_transition(test_noopen_usertype,test_noopen_r) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin seunshare_role_template(test_noopen,test_noopen_r,test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute seunshare_domain;
#line 47
		type seunshare_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	type test_noopen_seunshare_t, seunshare_domain;
#line 47
	 	 	
#line 47
##### begin application_domain(test_noopen_seunshare_t,seunshare_exec_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin application_type(test_noopen_seunshare_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute application_domain_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_seunshare_t application_domain_type;
#line 47

#line 47
	# start with basic domain
#line 47
	 	 	
#line 47
##### begin domain_type(test_noopen_seunshare_t) depth: 6
#line 47
 	
#line 47
	# start with basic domain
#line 47
	 	 	
#line 47
##### begin domain_base_type(test_noopen_seunshare_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_seunshare_t domain;
#line 47

#line 47
	 	
#line 47
##### end domain_base_type(test_noopen_seunshare_t) depth: 6
#line 47
 	
#line 47

#line 47
	# Only way to get corenet_unlabeled packets disabled to work
#line 47
	 	 	
#line 47
##### begin corenet_all_recvfrom_unlabeled(test_noopen_seunshare_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
                attribute corenet_unlabeled_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	typeattribute test_noopen_seunshare_t corenet_unlabeled_type;
#line 47

#line 47
	 	
#line 47
##### end corenet_all_recvfrom_unlabeled(test_noopen_seunshare_t) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end domain_type(test_noopen_seunshare_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end application_type(test_noopen_seunshare_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin application_executable_file(seunshare_exec_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute application_exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute seunshare_exec_t application_exec_type;
#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_executable_file(seunshare_exec_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute seunshare_exec_t exec_type;
#line 47

#line 47
	 	 	
#line 47
##### begin files_type(seunshare_exec_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute seunshare_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 47

#line 47
	 	
#line 47
##### end files_type(seunshare_exec_t) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corecmd_executable_file(seunshare_exec_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end application_executable_file(seunshare_exec_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin domain_entry_file(test_noopen_seunshare_t,seunshare_exec_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute entry_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_seunshare_t seunshare_exec_t:file entrypoint;
#line 47
	allow test_noopen_seunshare_t seunshare_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 47

#line 47
	typeattribute seunshare_exec_t entry_type;
#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_executable_file(seunshare_exec_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute seunshare_exec_t exec_type;
#line 47

#line 47
	 	 	
#line 47
##### begin files_type(seunshare_exec_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute seunshare_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 47

#line 47
	 	
#line 47
##### end files_type(seunshare_exec_t) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corecmd_executable_file(seunshare_exec_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end domain_entry_file(test_noopen_seunshare_t,seunshare_exec_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end application_domain(test_noopen_seunshare_t,seunshare_exec_t) depth: 3
#line 47
 	
#line 47
	role test_noopen_r types test_noopen_seunshare_t;
#line 47

#line 47
	 	 	
#line 47
##### begin kernel_read_system_state(test_noopen_seunshare_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute kernel_system_state_reader;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_seunshare_t kernel_system_state_reader;
#line 47

#line 47
	 	
#line 47
##### end kernel_read_system_state(test_noopen_seunshare_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin auth_use_nsswitch(test_noopen_seunshare_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute nsswitch_domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_seunshare_t nsswitch_domain;
#line 47

#line 47
	 	 	
#line 47
##### begin corenet_all_recvfrom_netlabel(test_noopen_seunshare_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute netlabel_peer_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_seunshare_t netlabel_peer_type;
#line 47

#line 47
	 	
#line 47
##### end corenet_all_recvfrom_netlabel(test_noopen_seunshare_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end auth_use_nsswitch(test_noopen_seunshare_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin logging_send_syslog_msg(test_noopen_seunshare_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute syslog_client_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_seunshare_t syslog_client_type;
#line 47

#line 47
	 	
#line 47
##### end logging_send_syslog_msg(test_noopen_seunshare_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin mls_process_set_level(test_noopen_seunshare_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute mlsprocsetsl;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_seunshare_t mlsprocsetsl;
#line 47

#line 47
	 	
#line 47
##### end mls_process_set_level(test_noopen_seunshare_t) depth: 3
#line 47
 	
#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t seunshare_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t test_noopen_seunshare_t:process transition;
#line 47
#	dontaudit test_noopen_t test_noopen_seunshare_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t seunshare_exec_t:process test_noopen_seunshare_t;
#line 47

#line 47

#line 47
	allow test_noopen_seunshare_t test_noopen_t:fd use;
#line 47
	allow test_noopen_seunshare_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow test_noopen_seunshare_t test_noopen_t:process sigchld;
#line 47

#line 47
	allow test_noopen_seunshare_t test_noopen_t:unix_stream_socket getattr;
#line 47

#line 47
	# part of sandboxX.pp
#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin sandbox_x_transition(test_noopen_seunshare_t,test_noopen_r) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type sandbox_xserver_t;
#line 47
		type sandbox_file_t;
#line 47
		attribute sandbox_x_domain;
#line 47
		attribute sandbox_tmpfs_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_seunshare_t sandbox_x_domain:process { { sigchld sigkill sigstop signull signal } transition };
#line 47
	allow test_noopen_seunshare_t sandbox_x_domain:process dyntransition;
#line 47
	dontaudit test_noopen_seunshare_t sandbox_x_domain:process { noatsecure siginh rlimitinh };
#line 47
	allow sandbox_x_domain test_noopen_seunshare_t:process { sigchld signull };
#line 47
	allow { sandbox_x_domain sandbox_xserver_t } test_noopen_seunshare_t:fd use;
#line 47
	role test_noopen_r types sandbox_x_domain;
#line 47
	role test_noopen_r types sandbox_xserver_t;
#line 47
	allow test_noopen_seunshare_t sandbox_xserver_t:process { sigchld sigkill sigstop signull signal };
#line 47
	dontaudit sandbox_xserver_t test_noopen_seunshare_t:fifo_file { getattr read write append ioctl lock };
#line 47
	dontaudit sandbox_xserver_t test_noopen_seunshare_t:tcp_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 47
	dontaudit sandbox_xserver_t test_noopen_seunshare_t:udp_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 47
	allow sandbox_xserver_t test_noopen_seunshare_t:unix_stream_socket { connectto { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 47
	dontaudit sandbox_xserver_t test_noopen_seunshare_t:file read;
#line 47
	allow sandbox_x_domain sandbox_x_domain:process signal;
#line 47
	# Dontaudit leaked file descriptors
#line 47
	dontaudit sandbox_x_domain test_noopen_seunshare_t:key { link read search view };
#line 47
	dontaudit sandbox_x_domain test_noopen_seunshare_t:fifo_file { read write };
#line 47
	dontaudit sandbox_x_domain test_noopen_seunshare_t:tcp_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 47
	dontaudit sandbox_x_domain test_noopen_seunshare_t:udp_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 47
	dontaudit sandbox_x_domain test_noopen_seunshare_t:unix_stream_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 47
	dontaudit sandbox_x_domain test_noopen_seunshare_t:process { signal sigkill };
#line 47
	
#line 47
	allow test_noopen_seunshare_t sandbox_tmpfs_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47
	dontaudit test_noopen_seunshare_t sandbox_tmpfs_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	allow test_noopen_seunshare_t sandbox_file_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:filesystem getattr;
#line 47
	
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47
;
#line 47
	
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47
;
#line 47
	
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 47
;
#line 47
	
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47
;
#line 47
	
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 47
;
#line 47
	
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:dir { getattr search open };
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:dir { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:dir { getattr search open };
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:dir { getattr search open };
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:lnk_file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:dir { getattr search open };
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:fifo_file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:dir { getattr search open };
#line 47
	allow test_noopen_seunshare_t sandbox_file_t:sock_file { getattr relabelfrom relabelto };
#line 47

#line 47

#line 47
	 	
#line 47
##### end sandbox_x_transition(test_noopen_seunshare_t,test_noopen_r) depth: 3
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	# part of sandbox.pp
#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin sandbox_transition(test_noopen_seunshare_t,test_noopen_r) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute sandbox_domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin sandbox_dyntransition(test_noopen_seunshare_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute sandbox_domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_seunshare_t sandbox_domain:process dyntransition;
#line 47

#line 47
	 	
#line 47
##### end sandbox_dyntransition(test_noopen_seunshare_t) depth: 4
#line 47
 	 #885288
#line 47
    allow test_noopen_seunshare_t sandbox_domain:process transition;
#line 47
    dontaudit test_noopen_seunshare_t sandbox_domain:process { noatsecure siginh rlimitinh };
#line 47

#line 47
    role test_noopen_r types sandbox_domain;
#line 47

#line 47
    allow sandbox_domain test_noopen_seunshare_t:process { sigchld signull };
#line 47
    allow sandbox_domain test_noopen_seunshare_t:fifo_file { getattr read write append ioctl lock };
#line 47

#line 47
    dontaudit sandbox_domain test_noopen_seunshare_t:process signal;
#line 47
    dontaudit sandbox_domain test_noopen_seunshare_t:key { link read search view };
#line 47
    dontaudit sandbox_domain test_noopen_seunshare_t:unix_stream_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 47

#line 47
	 	
#line 47
##### end sandbox_transition(test_noopen_seunshare_t,test_noopen_r) depth: 3
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t test_noopen_seunshare_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t test_noopen_seunshare_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_t test_noopen_seunshare_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t test_noopen_seunshare_t:process getattr;
#line 47

#line 47
	dontaudit test_noopen_seunshare_t test_noopen_t:file read;
#line 47
	allow test_noopen_t test_noopen_seunshare_t:process { sigchld sigkill sigstop signull signal };
#line 47
	allow test_noopen_t test_noopen_seunshare_t:fd use;
#line 47

#line 47
	allow test_noopen_seunshare_t test_noopen_t:process transition;
#line 47
	dontaudit test_noopen_seunshare_t test_noopen_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_bin_domtrans(test_noopen_seunshare_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_bin_spec_domtrans(test_noopen_seunshare_t,test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_seunshare_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_seunshare_t bin_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_seunshare_t bin_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_seunshare_t test_noopen_t:process transition;
#line 47
#	dontaudit test_noopen_seunshare_t test_noopen_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_seunshare_t usr_t:dir { getattr search open };
#line 47
	allow test_noopen_seunshare_t usr_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_seunshare_t usr_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_seunshare_t test_noopen_t:process transition;
#line 47
#	dontaudit test_noopen_seunshare_t test_noopen_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_bin_spec_domtrans(test_noopen_seunshare_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	type_transition test_noopen_seunshare_t bin_t:process test_noopen_t;
#line 47
	type_transition test_noopen_seunshare_t usr_t:process test_noopen_t;
#line 47

#line 47
	 	
#line 47
##### end corecmd_bin_domtrans(test_noopen_seunshare_t,test_noopen_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_shell_domtrans(test_noopen_seunshare_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type shell_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_shell_spec_domtrans(test_noopen_seunshare_t,test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t, shell_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_seunshare_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_seunshare_t bin_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_seunshare_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_seunshare_t bin_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_seunshare_t shell_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_seunshare_t test_noopen_t:process transition;
#line 47
#	dontaudit test_noopen_seunshare_t test_noopen_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_shell_spec_domtrans(test_noopen_seunshare_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	type_transition test_noopen_seunshare_t shell_exec_t:process test_noopen_t;
#line 47

#line 47
	 	
#line 47
##### end corecmd_shell_domtrans(test_noopen_seunshare_t,test_noopen_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end seunshare_role_template(test_noopen,test_noopen_r,test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin slrnpull_search_spool(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type slrnpull_spool_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_spool(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_spool_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_spool_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_spool(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	allow test_noopen_usertype slrnpull_spool_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end slrnpull_search_spool(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin thumb_role(test_noopen_r,test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type thumb_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin thumb_run(test_noopen_usertype,test_noopen_r) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type thumb_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin thumb_domtrans(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type thumb_t, thumb_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_search_bin(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_read_bin_symlinks(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype bin_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype bin_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_read_bin_symlinks(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype bin_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype bin_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_search_bin(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_usertype thumb_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_usertype thumb_t:process transition;
#line 47
#	dontaudit test_noopen_usertype thumb_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_usertype thumb_exec_t:process thumb_t;
#line 47

#line 47

#line 47
	allow thumb_t test_noopen_usertype:fd use;
#line 47
	allow thumb_t test_noopen_usertype:fifo_file { getattr read write append ioctl lock };
#line 47
	allow thumb_t test_noopen_usertype:process sigchld;
#line 47

#line 47
	dontaudit thumb_t test_noopen_usertype:unix_stream_socket { getattr read write };
#line 47

#line 47
	 	
#line 47
##### end thumb_domtrans(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin thumb_nnp_domtrans(test_noopen_usertype) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type thumb_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype thumb_t:process2 { nnp_transition nosuid_transition };
#line 47

#line 47

#line 47
	 	
#line 47
##### end thumb_nnp_domtrans(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
	role test_noopen_r types thumb_t;
#line 47

#line 47
	allow test_noopen_usertype thumb_t:process { sigchld sigkill sigstop signull signal };
#line 47

#line 47
	dontaudit thumb_t test_noopen_usertype:dir { getattr search open read lock ioctl };
#line 47
	dontaudit thumb_t test_noopen_usertype:file { open { getattr read ioctl lock } };
#line 47
	dontaudit thumb_t test_noopen_usertype:unix_stream_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 47
    
#line 47
    allow thumb_t test_noopen_usertype:shm { associate getattr setattr create destroy read write lock unix_read unix_write };
#line 47
	allow thumb_t test_noopen_usertype:sem { associate getattr setattr create destroy read write unix_read unix_write };
#line 47

#line 47
	 	
#line 47
##### end thumb_run(test_noopen_usertype,test_noopen_r) depth: 3
#line 47
 	
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype thumb_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_usertype thumb_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_usertype thumb_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype thumb_t:process getattr;
#line 47

#line 47
	allow thumb_t test_noopen_usertype:unix_stream_socket connectto;
#line 47

#line 47
	 	 	
#line 47
##### begin thumb_dbus_chat(test_noopen_usertype) depth: 4
#line 47
 	
#line 47
        
#line 47
	
#line 47
		require {
#line 47
			
#line 47
                type thumb_t;
#line 47
                class dbus send_msg;
#line 47
        
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
        allow test_noopen_usertype thumb_t:dbus send_msg;
#line 47
        allow thumb_t test_noopen_usertype:dbus send_msg;
#line 47
	
#line 47
	allow thumb_t test_noopen_usertype:dir { getattr search open read lock ioctl };
#line 47
	allow thumb_t test_noopen_usertype:file { open { getattr read ioctl lock } };
#line 47
	allow thumb_t test_noopen_usertype:lnk_file { getattr read };
#line 47
	allow thumb_t test_noopen_usertype:process getattr;
#line 47

#line 47

#line 47
	 	
#line 47
##### end thumb_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin thumb_filetrans_home_content(test_noopen_usertype) depth: 4
#line 47
 	
#line 47

#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type thumb_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin userdom_user_home_dir_filetrans(test_noopen_usertype,thumb_home_t,dir,".thumbnails") depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_dir_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_usertype user_home_dir_t:dir thumb_home_t ".thumbnails";
#line 47

#line 47
	 	 	
#line 47
##### begin files_search_home(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype home_root_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_search_home(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_user_home_dir_filetrans(test_noopen_usertype,thumb_home_t,dir,".thumbnails") depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin userdom_user_home_dir_filetrans(test_noopen_usertype,thumb_home_t,file,"missfont.log") depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_dir_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype user_home_dir_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_usertype user_home_dir_t:file thumb_home_t "missfont.log";
#line 47

#line 47
	 	 	
#line 47
##### begin files_search_home(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype home_root_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_search_home(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_user_home_dir_filetrans(test_noopen_usertype,thumb_home_t,file,"missfont.log") depth: 4
#line 47
 	
#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin gnome_cache_filetrans(test_noopen_usertype,thumb_home_t,dir,"thumbnails") depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cache_home_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype cache_home_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_usertype cache_home_t:dir thumb_home_t "thumbnails";
#line 47

#line 47
	 	 	
#line 47
##### begin userdom_search_user_home_dirs(test_noopen_usertype) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_dir_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype user_home_dir_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype user_home_dir_t:lnk_file { getattr read };
#line 47
	 	 	
#line 47
##### begin files_search_home(test_noopen_usertype) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype home_root_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_search_home(test_noopen_usertype) depth: 6
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end userdom_search_user_home_dirs(test_noopen_usertype) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end gnome_cache_filetrans(test_noopen_usertype,thumb_home_t,dir,"thumbnails") depth: 4
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	 	
#line 47
##### end thumb_filetrans_home_content(test_noopen_usertype) depth: 3
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end thumb_role(test_noopen_r,test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47
 	 	
#line 47
##### end userdom_common_user_template(test_noopen) depth: 1
#line 47
 	
#line 47

#line 47
	##############################
#line 47
	#
#line 47
	# Local policy
#line 47
	#
#line 47
	allow test_noopen_t self:capability { setgid chown fowner };
#line 47
    allow test_noopen_t self:bluetooth_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 47
    allow test_noopen_t self:alg_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 47
    allow test_noopen_t self:dccp_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 47
    allow test_noopen_t self:netlink_tcpdiag_socket { { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } } nlmsg_read nlmsg_write };
#line 47
    dontaudit test_noopen_t self:capability { setuid };
#line 47
    dontaudit test_noopen_t self:netlink_selinux_socket { create { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } };
#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_exec_chroot(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type chroot_exec_t;
#line 47
        type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_t chroot_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47
	allow test_noopen_t self:capability sys_chroot;
#line 47

#line 47
	 	
#line 47
##### end corecmd_exec_chroot(test_noopen_t) depth: 1
#line 47
 	
#line 47

#line 47
	# port access is audited even if dac would not have allowed it, so dontaudit it here
#line 47
#	corenet_dontaudit_tcp_bind_all_reserved_ports(test_noopen_t)
#line 47
	# Need the following rule to allow users to run vpnc
#line 47
	 	 	
#line 47
##### begin corenet_tcp_bind_xserver_port(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type xserver_port_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t xserver_port_t:tcp_socket name_bind;
#line 47
	allow test_noopen_t self:capability net_bind_service;
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_bind_xserver_port(test_noopen_t) depth: 1
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corenet_tcp_bind_generic_node(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type node_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype node_t:tcp_socket node_bind;
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_bind_generic_node(test_noopen_usertype) depth: 1
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin storage_rw_fuse(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type fuse_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t fuse_device_t:chr_file { open { getattr read write append ioctl lock } };
#line 47

#line 47
	 	
#line 47
##### end storage_rw_fuse(test_noopen_t) depth: 1
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin files_exec_usr_files(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t usr_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_t usr_t:dir { getattr search open };
#line 47
	allow test_noopen_t usr_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47

#line 47
	
#line 47
	allow test_noopen_t usr_t:dir { getattr search open };
#line 47
	allow test_noopen_t usr_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_exec_usr_files(test_noopen_t) depth: 1
#line 47
 	
#line 47
   # cjp: why?
#line 47
	 	 	
#line 47
##### begin files_read_kernel_symbol_table(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type boot_t, system_map_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t boot_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_t boot_t:dir { getattr search open };
#line 47
	allow test_noopen_t system_map_t:file { open { getattr read ioctl lock } };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_read_kernel_symbol_table(test_noopen_t) depth: 1
#line 47
 	
#line 47

#line 47
	
#line 47
		 	 	
#line 47
##### begin fs_exec_noxattr(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute noxattrfs;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t noxattrfs:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47

#line 47
	 	
#line 47
##### end fs_exec_noxattr(test_noopen_t) depth: 1
#line 47
 	
#line 47

#line 47
		
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool selinuxuser_rw_noexattrfile;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (selinuxuser_rw_noexattrfile) {
#line 47
		
#line 47
			 	 	
#line 47
##### begin fs_manage_noxattr_fs_files(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute noxattrfs;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t noxattrfs:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_t noxattrfs:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_noxattr_fs_files(test_noopen_t) depth: 1
#line 47
 	
#line 47
			 	 	
#line 47
##### begin fs_manage_noxattr_fs_dirs(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute noxattrfs;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t noxattrfs:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end fs_manage_noxattr_fs_dirs(test_noopen_t) depth: 1
#line 47
 	
#line 47
			# Write floppies
#line 47
			 	 	
#line 47
##### begin storage_raw_read_removable_device(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type removable_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_list_all_dev_nodes(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t device_t:dir { getattr search open };
#line 47
	allow test_noopen_t device_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_t device_t:dir { getattr search open };
#line 47
	allow test_noopen_t device_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_list_all_dev_nodes(test_noopen_t) depth: 2
#line 47
 	
#line 47
	allow test_noopen_t removable_device_t:blk_file { getattr open read lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end storage_raw_read_removable_device(test_noopen_t) depth: 1
#line 47
 	
#line 47
			 	 	
#line 47
##### begin storage_raw_write_removable_device(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type removable_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_list_all_dev_nodes(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t device_t:dir { getattr search open };
#line 47
	allow test_noopen_t device_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_t device_t:dir { getattr search open };
#line 47
	allow test_noopen_t device_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_list_all_dev_nodes(test_noopen_t) depth: 2
#line 47
 	
#line 47
	allow test_noopen_t removable_device_t:blk_file { getattr open write append lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end storage_raw_write_removable_device(test_noopen_t) depth: 1
#line 47
 	
#line 47
		
#line 47
	} else {
#line 47
		
#line 47
			 	 	
#line 47
##### begin storage_raw_read_removable_device(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type removable_device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_list_all_dev_nodes(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t device_t:dir { getattr search open };
#line 47
	allow test_noopen_t device_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_t device_t:dir { getattr search open };
#line 47
	allow test_noopen_t device_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_list_all_dev_nodes(test_noopen_t) depth: 2
#line 47
 	
#line 47
	allow test_noopen_t removable_device_t:blk_file { getattr open read lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end storage_raw_read_removable_device(test_noopen_t) depth: 1
#line 47
 	
#line 47
		
#line 47
	}
#line 47

#line 47
	
#line 47

#line 47
	 	 	
#line 47
##### begin miscfiles_read_hwdata(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type hwdata_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype hwdata_t:dir { getattr search open read lock ioctl };
#line 47
	
#line 47
	allow test_noopen_usertype hwdata_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype hwdata_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype hwdata_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype hwdata_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end miscfiles_read_hwdata(test_noopen_usertype) depth: 1
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin fs_mounton_fusefs(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type fusefs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype fusefs_t:dir mounton;
#line 47

#line 47
	 	
#line 47
##### end fs_mounton_fusefs(test_noopen_usertype) depth: 1
#line 47
 	
#line 47

#line 47
	# Allow users to run TCP servers (bind to ports and accept connection from
#line 47
	# the same domain and outside users) disabling this forces FTP passive mode
#line 47
	# and may change other protocols
#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool selinuxuser_share_music;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (selinuxuser_share_music) {
#line 47
		
#line 47
		 	 	
#line 47
##### begin corenet_tcp_bind_daap_port(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type daap_port_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype daap_port_t:tcp_socket name_bind;
#line 47
	
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_bind_daap_port(test_noopen_usertype) depth: 1
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool selinuxuser_tcp_server;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (selinuxuser_tcp_server) {
#line 47
		
#line 47
		 	 	
#line 47
##### begin corenet_tcp_bind_all_unreserved_ports(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute unreserved_port_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype unreserved_port_type:tcp_socket name_bind;
#line 47

#line 47
	 	
#line 47
##### end corenet_tcp_bind_all_unreserved_ports(test_noopen_usertype) depth: 1
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool selinuxuser_udp_server;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (selinuxuser_udp_server) {
#line 47
		
#line 47
		 	 	
#line 47
##### begin corenet_udp_bind_all_unreserved_ports(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute unreserved_port_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype unreserved_port_type:udp_socket name_bind;
#line 47

#line 47
	 	
#line 47
##### end corenet_udp_bind_all_unreserved_ports(test_noopen_usertype) depth: 1
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin cdrecord_role(test_noopen_r,test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute_role cdrecord_roles;
#line 47
		type cdrecord_t, cdrecord_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	roleattribute test_noopen_r cdrecord_roles;
#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t cdrecord_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t cdrecord_t:process transition;
#line 47
#	dontaudit test_noopen_t cdrecord_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t cdrecord_exec_t:process cdrecord_t;
#line 47

#line 47

#line 47
	allow cdrecord_t test_noopen_t:fd use;
#line 47
	allow cdrecord_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow cdrecord_t test_noopen_t:process sigchld;
#line 47

#line 47

#line 47
	allow cdrecord_t test_noopen_t:unix_stream_socket { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown };
#line 47

#line 47
	allow test_noopen_t cdrecord_t:process { sigchld sigkill sigstop signull signal };
#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool deny_ptrace;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (deny_ptrace) {
#line 47
		
#line 47
	} else {
#line 47
		
#line 47
		allow test_noopen_t cdrecord_t:process ptrace;
#line 47
	
#line 47
	}
#line 47

#line 47
	
#line 47
	allow test_noopen_t cdrecord_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t cdrecord_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_t cdrecord_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t cdrecord_t:process getattr;
#line 47

#line 47

#line 47
	 	
#line 47
##### end cdrecord_role(test_noopen_r,test_noopen_t) depth: 1
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin cron_role(test_noopen_r,test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cronjob_t, crontab_t, crontab_exec_t;
#line 47
		type user_cron_spool_t, crond_t;
#line 47
        bool cron_userdomain_transition;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
    ##############################
#line 47
    #
#line 47
    # Declarations
#line 47
    #
#line 47

#line 47
	role test_noopen_r types { cronjob_t crontab_t };
#line 47

#line 47
    ##############################
#line 47
    #
#line 47
    # Local policy
#line 47
    #
#line 47

#line 47
	# Transition from the user domain to the derived domain.
#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t crontab_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t crontab_t:process transition;
#line 47
#	dontaudit test_noopen_t crontab_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t crontab_exec_t:process crontab_t;
#line 47

#line 47

#line 47
	allow crontab_t test_noopen_t:fd use;
#line 47
	allow crontab_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow crontab_t test_noopen_t:process sigchld;
#line 47

#line 47

#line 47
	dontaudit crond_t test_noopen_t:process { noatsecure siginh rlimitinh };
#line 47
	allow test_noopen_t crond_t:process sigchld;
#line 47

#line 47
    allow test_noopen_t user_cron_spool_t:file { getattr read write ioctl };
#line 47

#line 47
	# crontab shows up in user ps
#line 47
	allow test_noopen_t crontab_t:process { sigchld sigkill sigstop signull signal };
#line 47
	
#line 47
	allow test_noopen_t crontab_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t crontab_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_t crontab_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t crontab_t:process getattr;
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool deny_ptrace;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (deny_ptrace) {
#line 47
		
#line 47
	} else {
#line 47
		
#line 47
		allow test_noopen_t crontab_t:process ptrace;
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	# Run helper programs as the user domain
#line 47
	#corecmd_bin_domtrans(crontab_t, test_noopen_t)
#line 47
	#corecmd_shell_domtrans(crontab_t, test_noopen_t)
#line 47
	 	 	
#line 47
##### begin corecmd_exec_bin(crontab_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow crontab_t bin_t:dir { getattr search open };
#line 47
	allow crontab_t bin_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow crontab_t bin_t:dir { getattr search open };
#line 47
	allow crontab_t bin_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	allow crontab_t bin_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47

#line 47
	
#line 47
		 	 	
#line 47
##### begin files_exec_all_base_ro_files(crontab_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute base_ro_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow crontab_t base_ro_file_type:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47

#line 47
	 	
#line 47
##### end files_exec_all_base_ro_files(crontab_t) depth: 3
#line 47
 	
#line 47
	
#line 47

#line 47
	 	
#line 47
##### end corecmd_exec_bin(crontab_t) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin corecmd_exec_shell(crontab_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t, shell_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow crontab_t bin_t:dir { getattr search open };
#line 47
	allow crontab_t bin_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow crontab_t bin_t:dir { getattr search open };
#line 47
	allow crontab_t bin_t:lnk_file { getattr read };
#line 47

#line 47
	allow crontab_t shell_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock execute_no_trans };
#line 47

#line 47
	 	
#line 47
##### end corecmd_exec_shell(crontab_t) depth: 2
#line 47
 	
#line 47

#line 47
    
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool cron_userdomain_transition;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (cron_userdomain_transition) {
#line 47
		
#line 47
        allow crond_t test_noopen_t:process transition;
#line 47
        allow crond_t test_noopen_t:fd use;
#line 47
        allow crond_t test_noopen_t:key { create link read search setattr view write } ;
#line 47

#line 47
	    # needs to be authorized SELinux context for cron
#line 47
	    allow test_noopen_t user_cron_spool_t:file entrypoint;
#line 47
        allow test_noopen_t crond_t:fifo_file { open { getattr read write append ioctl lock } };
#line 47

#line 47
        allow test_noopen_t cronjob_t:process { { sigchld sigkill sigstop signull signal } };
#line 47

#line 47
        
#line 47
	allow test_noopen_t cronjob_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_t cronjob_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_t cronjob_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t cronjob_t:process getattr;
#line 47

#line 47
    
#line 47
	} else {
#line 47
		
#line 47
        dontaudit crond_t test_noopen_t:process transition;
#line 47
        dontaudit crond_t test_noopen_t:fd use;
#line 47
        dontaudit crond_t test_noopen_t:key { create link read search setattr view write } ;
#line 47

#line 47
        dontaudit test_noopen_t user_cron_spool_t:file entrypoint;
#line 47

#line 47
        dontaudit test_noopen_t crond_t:fifo_file { open { getattr read write append ioctl lock } };
#line 47

#line 47
        dontaudit test_noopen_t cronjob_t:process { { sigchld sigkill sigstop signull signal } };
#line 47
    
#line 47
	}
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		
#line 47
	
#line 47
		require {
#line 47
			
#line 47
			class dbus send_msg;
#line 47
		
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
		 	 	
#line 47
##### begin dbus_stub(cronjob_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type system_dbusd_t;
#line 47
		class dbus { acquire_svc send_msg };
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	
#line 47
##### end dbus_stub(cronjob_t) depth: 2
#line 47
 	
#line 47

#line 47
		allow cronjob_t test_noopen_t:dbus send_msg;
#line 47
	
#line 47
	}
#line 47
		
#line 47

#line 47
	 	
#line 47
##### end cron_role(test_noopen_r,test_noopen_t) depth: 1
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
         	 	
#line 47
##### begin games_manage_data_files(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type games_data_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var_lib(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_lib_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype var_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype var_lib_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_var_lib(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype games_data_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_usertype games_data_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end games_manage_data_files(test_noopen_usertype) depth: 1
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin gpg_role(test_noopen_r,test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
        attribute_role gpg_roles, gpg_agent_roles, gpg_helper_roles, gpg_pinentry_roles;
#line 47
		type gpg_t, gpg_exec_t;
#line 47
		type gpg_agent_t, gpg_agent_exec_t;
#line 47
		type gpg_agent_tmp_t;
#line 47
		type gpg_helper_t, gpg_pinentry_t;
#line 47
		type gpg_pinentry_tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
    roleattribute test_noopen_r gpg_roles;
#line 47
    roleattribute test_noopen_r gpg_agent_roles;
#line 47
    roleattribute test_noopen_r gpg_helper_roles;
#line 47
    roleattribute test_noopen_r gpg_pinentry_roles;
#line 47

#line 47
	# transition from the userdomain to the derived domain
#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_usertype gpg_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_usertype gpg_t:process transition;
#line 47
#	dontaudit test_noopen_usertype gpg_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_usertype gpg_exec_t:process gpg_t;
#line 47

#line 47

#line 47
	allow gpg_t test_noopen_usertype:fd use;
#line 47
	allow gpg_t test_noopen_usertype:fifo_file { getattr read write append ioctl lock };
#line 47
	allow gpg_t test_noopen_usertype:process sigchld;
#line 47

#line 47

#line 47
	# allow ps to show gpg
#line 47
	
#line 47
	allow test_noopen_usertype gpg_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_usertype gpg_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_usertype gpg_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype gpg_t:process getattr;
#line 47

#line 47
	allow test_noopen_usertype gpg_t:process { signull sigstop signal sigkill };
#line 47

#line 47
	# communicate with the user
#line 47
	allow gpg_helper_t test_noopen_usertype:fd use;
#line 47
	allow gpg_helper_t test_noopen_usertype:fifo_file write;
#line 47

#line 47
	# allow ps to show gpg-agent
#line 47
	
#line 47
	allow test_noopen_usertype gpg_agent_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_usertype gpg_agent_t:file { open { getattr read ioctl lock } };
#line 47
	allow test_noopen_usertype gpg_agent_t:lnk_file { getattr read };
#line 47
	allow test_noopen_usertype gpg_agent_t:process getattr;
#line 47

#line 47

#line 47
	# Allow the user shell to signal the gpg-agent program.
#line 47
	allow test_noopen_usertype gpg_agent_t:process { signal sigkill };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype gpg_agent_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_usertype gpg_agent_tmp_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype gpg_agent_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_usertype gpg_agent_tmp_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype gpg_agent_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_usertype gpg_agent_tmp_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 47

#line 47
	 	 	
#line 47
##### begin files_tmp_filetrans(gpg_agent_t,gpg_agent_tmp_t,{ file sock_file dir }) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow gpg_agent_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition gpg_agent_t tmp_t:{ file sock_file dir } gpg_agent_tmp_t ;
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_tmp_filetrans(gpg_agent_t,gpg_agent_tmp_t,{ file sock_file dir }) depth: 2
#line 47
 	
#line 47

#line 47
	# Transition from the user domain to the agent domain.
#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_usertype gpg_agent_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_usertype gpg_agent_t:process transition;
#line 47
#	dontaudit test_noopen_usertype gpg_agent_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_usertype gpg_agent_exec_t:process gpg_agent_t;
#line 47

#line 47

#line 47
	allow gpg_agent_t test_noopen_usertype:fd use;
#line 47
	allow gpg_agent_t test_noopen_usertype:fifo_file { getattr read write append ioctl lock };
#line 47
	allow gpg_agent_t test_noopen_usertype:process sigchld;
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype gpg_pinentry_tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_usertype gpg_pinentry_tmp_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype gpg_pinentry_tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype gpg_pinentry_tmp_t:sock_file { getattr relabelfrom relabelto };
#line 47

#line 47

#line 47
	allow gpg_pinentry_t test_noopen_usertype:fifo_file { read write };
#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin gpg_pinentry_dbus_chat(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type gpg_pinentry_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_usertype gpg_pinentry_t:dbus send_msg;
#line 47
	allow gpg_pinentry_t test_noopen_usertype:dbus send_msg;
#line 47

#line 47
	 	
#line 47
##### end gpg_pinentry_dbus_chat(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	allow test_noopen_usertype gpg_agent_t:unix_stream_socket { { ioctl read getattr lock write setattr append bind connect getopt setopt shutdown } connectto };
#line 47
	
#line 47
		#Leaked File Descriptors
#line 47
		dontaudit gpg_t test_noopen_usertype:fifo_file { open { getattr read write append ioctl lock } };
#line 47
		dontaudit gpg_agent_t test_noopen_usertype:fifo_file { open { getattr read write append ioctl lock } };
#line 47
	
#line 47

#line 47
	 	
#line 47
##### end gpg_role(test_noopen_r,test_noopen_usertype) depth: 1
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin systemd_dbus_chat_timedated(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type systemd_timedated_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t systemd_timedated_t:dbus send_msg;
#line 47
	allow systemd_timedated_t test_noopen_t:dbus send_msg;
#line 47
	
#line 47
	allow systemd_timedated_t test_noopen_t:dir { getattr search open read lock ioctl };
#line 47
	allow systemd_timedated_t test_noopen_t:file { open { getattr read ioctl lock } };
#line 47
	allow systemd_timedated_t test_noopen_t:lnk_file { getattr read };
#line 47
	allow systemd_timedated_t test_noopen_t:process getattr;
#line 47

#line 47

#line 47
	 	
#line 47
##### end systemd_dbus_chat_timedated(test_noopen_t) depth: 1
#line 47
 	
#line 47
		 	 	
#line 47
##### begin systemd_dbus_chat_hostnamed(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type systemd_hostnamed_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t systemd_hostnamed_t:dbus send_msg;
#line 47
	allow systemd_hostnamed_t test_noopen_t:dbus send_msg;
#line 47
	
#line 47
	allow systemd_hostnamed_t test_noopen_t:dir { getattr search open read lock ioctl };
#line 47
	allow systemd_hostnamed_t test_noopen_t:file { open { getattr read ioctl lock } };
#line 47
	allow systemd_hostnamed_t test_noopen_t:lnk_file { getattr read };
#line 47
	allow systemd_hostnamed_t test_noopen_t:process getattr;
#line 47

#line 47

#line 47
	 	
#line 47
##### end systemd_dbus_chat_hostnamed(test_noopen_t) depth: 1
#line 47
 	
#line 47
		 	 	
#line 47
##### begin systemd_dbus_chat_localed(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type systemd_localed_t;
#line 47
		class dbus send_msg;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t systemd_localed_t:dbus send_msg;
#line 47
	allow systemd_localed_t test_noopen_t:dbus send_msg;
#line 47
	
#line 47
	allow systemd_localed_t test_noopen_t:dir { getattr search open read lock ioctl };
#line 47
	allow systemd_localed_t test_noopen_t:file { open { getattr read ioctl lock } };
#line 47
	allow systemd_localed_t test_noopen_t:lnk_file { getattr read };
#line 47
	allow systemd_localed_t test_noopen_t:process getattr;
#line 47

#line 47

#line 47
	 	
#line 47
##### end systemd_dbus_chat_localed(test_noopen_t) depth: 1
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin gpm_stream_connect(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type gpmctl_t, gpm_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin dev_list_all_dev_nodes(test_noopen_usertype) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type device_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open read lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_usertype device_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype device_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end dev_list_all_dev_nodes(test_noopen_usertype) depth: 2
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_usertype gpmctl_t:dir { getattr search open };
#line 47
	allow test_noopen_usertype gpmctl_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_usertype gpm_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end gpm_stream_connect(test_noopen_usertype) depth: 1
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin mount_run_fusermount(test_noopen_t,test_noopen_r) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type mount_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin mount_domtrans_fusermount(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type mount_t, fusermount_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t fusermount_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t mount_t:process transition;
#line 47
#	dontaudit test_noopen_t mount_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t fusermount_exec_t:process mount_t;
#line 47

#line 47

#line 47
	allow mount_t test_noopen_t:fd use;
#line 47
	allow mount_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow mount_t test_noopen_t:process sigchld;
#line 47

#line 47
	
#line 47
	allow mount_t test_noopen_t:dir { getattr search open read lock ioctl };
#line 47
	allow mount_t test_noopen_t:file { open { getattr read ioctl lock } };
#line 47
	allow mount_t test_noopen_t:lnk_file { getattr read };
#line 47
	allow mount_t test_noopen_t:process getattr;
#line 47

#line 47

#line 47
	allow mount_t test_noopen_t:unix_stream_socket { read write };
#line 47
	allow test_noopen_t mount_t:fd use;
#line 47

#line 47
	 	
#line 47
##### end mount_domtrans_fusermount(test_noopen_t) depth: 2
#line 47
 	
#line 47
	role test_noopen_r types mount_t;
#line 47

#line 47
	 	 	
#line 47
##### begin fstools_run(mount_t,test_noopen_r) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type fsadm_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin fstools_domtrans(mount_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type fsadm_t, fsadm_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_search_bin(mount_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_read_bin_symlinks(mount_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow mount_t bin_t:dir { getattr search open };
#line 47
	allow mount_t bin_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_read_bin_symlinks(mount_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow mount_t bin_t:dir { getattr search open };
#line 47
	allow mount_t bin_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_search_bin(mount_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
	
#line 47
	allow mount_t fsadm_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow mount_t fsadm_t:process transition;
#line 47
#	dontaudit mount_t fsadm_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition mount_t fsadm_exec_t:process fsadm_t;
#line 47

#line 47

#line 47
	allow fsadm_t mount_t:fd use;
#line 47
	allow fsadm_t mount_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow fsadm_t mount_t:process sigchld;
#line 47

#line 47

#line 47
	 	
#line 47
##### end fstools_domtrans(mount_t) depth: 3
#line 47
 	
#line 47
	role test_noopen_r types fsadm_t;
#line 47

#line 47
	 	
#line 47
##### end fstools_run(mount_t,test_noopen_r) depth: 2
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end mount_run_fusermount(test_noopen_t,test_noopen_r) depth: 1
#line 47
 	
#line 47
		 	 	
#line 47
##### begin mount_read_pid_files(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type mount_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t mount_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_t mount_var_run_t:file { open { getattr read ioctl lock } };
#line 47

#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_t var_t:dir { getattr search open };
#line 47
	allow test_noopen_t var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_t) depth: 2
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end mount_read_pid_files(test_noopen_t) depth: 1
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin wine_role_template(test_noopen,test_noopen_r,test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type wine_t;
#line 47
		attribute wine_domain;
#line 47
		type wine_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	type test_noopen_wine_t, wine_domain;
#line 47
	 	 	
#line 47
##### begin domain_type(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
	# start with basic domain
#line 47
	 	 	
#line 47
##### begin domain_base_type(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wine_t domain;
#line 47

#line 47
	 	
#line 47
##### end domain_base_type(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47

#line 47
	# Only way to get corenet_unlabeled packets disabled to work
#line 47
	 	 	
#line 47
##### begin corenet_all_recvfrom_unlabeled(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
                attribute corenet_unlabeled_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	typeattribute test_noopen_wine_t corenet_unlabeled_type;
#line 47

#line 47
	 	
#line 47
##### end corenet_all_recvfrom_unlabeled(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end domain_type(test_noopen_wine_t) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin domain_entry_file(test_noopen_wine_t,wine_exec_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute entry_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wine_t wine_exec_t:file entrypoint;
#line 47
	allow test_noopen_wine_t wine_exec_t:file { { getattr open map read execute ioctl execute_no_trans } ioctl lock };
#line 47

#line 47
	typeattribute wine_exec_t entry_type;
#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_executable_file(wine_exec_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute exec_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute wine_exec_t exec_type;
#line 47

#line 47
	 	 	
#line 47
##### begin files_type(wine_exec_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute file_type, non_security_file_type, non_auth_file_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute wine_exec_t file_type, non_security_file_type, non_auth_file_type;
#line 47

#line 47
	 	
#line 47
##### end files_type(wine_exec_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end corecmd_executable_file(wine_exec_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end domain_entry_file(test_noopen_wine_t,wine_exec_t) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin ubac_constrained(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute ubac_constrained_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wine_t ubac_constrained_type;
#line 47

#line 47
	 	
#line 47
##### end ubac_constrained(test_noopen_wine_t) depth: 2
#line 47
 	
#line 47
	role test_noopen_r types test_noopen_wine_t;
#line 47
	allow test_noopen_t test_noopen_wine_t:process { getattr noatsecure { sigchld sigkill sigstop signull signal } };
#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t wine_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t test_noopen_wine_t:process transition;
#line 47
#	dontaudit test_noopen_t test_noopen_wine_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t wine_exec_t:process test_noopen_wine_t;
#line 47

#line 47

#line 47
	allow test_noopen_wine_t test_noopen_t:fd use;
#line 47
	allow test_noopen_wine_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow test_noopen_wine_t test_noopen_t:process sigchld;
#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_bin_domtrans(test_noopen_wine_t,test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_bin_spec_domtrans(test_noopen_wine_t,test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
		type usr_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_wine_t bin_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t bin_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_wine_t test_noopen_t:process transition;
#line 47
#	dontaudit test_noopen_wine_t test_noopen_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t usr_t:dir { getattr search open };
#line 47
	allow test_noopen_wine_t usr_t:lnk_file { getattr read };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t usr_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_wine_t test_noopen_t:process transition;
#line 47
#	dontaudit test_noopen_wine_t test_noopen_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_bin_spec_domtrans(test_noopen_wine_t,test_noopen_t) depth: 3
#line 47
 	
#line 47
	type_transition test_noopen_wine_t bin_t:process test_noopen_t;
#line 47
	type_transition test_noopen_wine_t usr_t:process test_noopen_t;
#line 47

#line 47
	 	
#line 47
##### end corecmd_bin_domtrans(test_noopen_wine_t,test_noopen_t) depth: 2
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin userdom_unpriv_usertype(test_noopen,test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute unpriv_userdomain, userdomain;
#line 47
		attribute test_noopen_usertype;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	typeattribute test_noopen_wine_t  test_noopen_usertype;
#line 47
	typeattribute test_noopen_wine_t  unpriv_userdomain;
#line 47
	typeattribute test_noopen_wine_t  userdomain;
#line 47
	
#line 47
	 	 	
#line 47
##### begin auth_use_nsswitch(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute nsswitch_domain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wine_t nsswitch_domain;
#line 47

#line 47
	 	 	
#line 47
##### begin corenet_all_recvfrom_netlabel(test_noopen_wine_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute netlabel_peer_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wine_t netlabel_peer_type;
#line 47

#line 47
	 	
#line 47
##### end corenet_all_recvfrom_netlabel(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end auth_use_nsswitch(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
	 	 	
#line 47
##### begin ubac_constrained(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute ubac_constrained_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wine_t ubac_constrained_type;
#line 47

#line 47
	 	
#line 47
##### end ubac_constrained(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
 	 	
#line 47
##### end userdom_unpriv_usertype(test_noopen,test_noopen_wine_t) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin userdom_manage_tmp_role(test_noopen_r,test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute user_tmp_type;
#line 47
		type user_tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	role test_noopen_r types user_tmp_t;
#line 47

#line 47
	 	 	
#line 47
##### begin files_poly_member_tmp(test_noopen_wine_t,user_tmp_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	type_member test_noopen_wine_t tmp_t:dir user_tmp_t;
#line 47

#line 47
	 	
#line 47
##### end files_poly_member_tmp(test_noopen_wine_t,user_tmp_t) depth: 3
#line 47
 	
#line 47

#line 47
	allow test_noopen_wine_t user_tmp_type:dir mounton;
#line 47
	
#line 47
	allow test_noopen_wine_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t user_tmp_type:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t user_tmp_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t user_tmp_type:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t user_tmp_type:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_tmp_type:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t user_tmp_type:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	 	 	
#line 47
##### begin files_tmp_filetrans(test_noopen_wine_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t tmp_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_wine_t tmp_t:{ dir file lnk_file sock_file fifo_file } user_tmp_t ;
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_tmp_filetrans(test_noopen_wine_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 3
#line 47
 	
#line 47
     	 	
#line 47
##### begin fs_tmpfs_filetrans(test_noopen_wine_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow user_tmp_t tmpfs_t:filesystem associate;
#line 47
	
#line 47
	allow test_noopen_wine_t tmpfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	type_transition test_noopen_wine_t tmpfs_t:{ dir file lnk_file sock_file fifo_file } user_tmp_t ;
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_tmpfs_filetrans(test_noopen_wine_t,user_tmp_t,{ dir file lnk_file sock_file fifo_file }) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_wine_t user_tmp_type:dir { getattr search open };
#line 47
	allow test_noopen_wine_t user_tmp_type:dir { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_tmp_type:dir { getattr search open };
#line 47
	allow test_noopen_wine_t user_tmp_type:file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_tmp_type:dir { getattr search open };
#line 47
	allow test_noopen_wine_t user_tmp_type:lnk_file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_tmp_type:dir { getattr search open };
#line 47
	allow test_noopen_wine_t user_tmp_type:sock_file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_tmp_type:dir { getattr search open };
#line 47
	allow test_noopen_wine_t user_tmp_type:fifo_file { getattr relabelfrom relabelto };
#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_manage_tmp_role(test_noopen_r,test_noopen_wine_t) depth: 2
#line 47
 	
#line 47
	 	 	
#line 47
##### begin userdom_manage_home_role(test_noopen_r ,test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_home_t, user_home_dir_t;
#line 47
		attribute user_home_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	role test_noopen_r  types { user_home_type user_home_dir_t };
#line 47

#line 47
	##############################
#line 47
	#
#line 47
	# Domain access to home dir
#line 47
	#
#line 47

#line 47
	type_member test_noopen_wine_t user_home_dir_t:dir user_home_dir_t;
#line 47

#line 47
	# full control of the home directory
#line 47
	allow test_noopen_wine_t user_home_t:dir mounton;
#line 47
	allow test_noopen_wine_t user_home_t:file entrypoint;
#line 47

#line 47
	allow test_noopen_wine_t user_home_type:{ dir file lnk_file sock_file fifo_file chr_file blk_file } { relabelto relabelfrom };
#line 47
	allow test_noopen_wine_t user_home_dir_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_wine_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t user_home_type:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t user_home_type:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t user_home_type:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t user_home_type:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t { user_home_dir_t user_home_type }:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t user_home_type:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 47
	allow test_noopen_wine_t user_home_type:dir { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 47
	allow test_noopen_wine_t user_home_type:file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 47
	allow test_noopen_wine_t user_home_type:lnk_file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 47
	allow test_noopen_wine_t user_home_type:sock_file { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t { user_home_dir_t user_home_type }:dir { getattr search open };
#line 47
	allow test_noopen_wine_t user_home_type:fifo_file { getattr relabelfrom relabelto };
#line 47

#line 47
	 	 	
#line 47
##### begin userdom_filetrans_home_content(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
	        attribute userdom_filetrans_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wine_t  userdom_filetrans_type;
#line 47

#line 47
	 	
#line 47
##### end userdom_filetrans_home_content(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin files_list_home(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type home_root_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wine_t home_root_t:dir { getattr search open read lock ioctl };
#line 47
	allow test_noopen_wine_t home_root_t:lnk_file { getattr read };
#line 47

#line 47
	 	
#line 47
##### end files_list_home(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47

#line 47
	# cjp: this should probably be removed:
#line 47
	allow test_noopen_wine_t user_home_dir_t:dir { { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl } { getattr relabelfrom relabelto } };
#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool use_nfs_home_dirs;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (use_nfs_home_dirs) {
#line 47
		
#line 47
		 	 	
#line 47
##### begin fs_mount_nfs(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wine_t nfs_t:filesystem mount;
#line 47

#line 47
	 	
#line 47
##### end fs_mount_nfs(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_mounton_nfs(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wine_t nfs_t:dir mounton;
#line 47

#line 47
	 	
#line 47
##### end fs_mounton_nfs(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_nfs_dirs(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin fs_search_auto_mountpoints(test_noopen_wine_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type autofs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wine_t autofs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_auto_mountpoints(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	allow test_noopen_wine_t nfs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end fs_manage_nfs_dirs(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_nfs_files(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin fs_search_auto_mountpoints(test_noopen_wine_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type autofs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wine_t autofs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_auto_mountpoints(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_wine_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t nfs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_nfs_files(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_nfs_symlinks(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin fs_search_auto_mountpoints(test_noopen_wine_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type autofs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wine_t autofs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_auto_mountpoints(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_wine_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t nfs_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_nfs_symlinks(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_nfs_named_sockets(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t nfs_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_nfs_named_sockets(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_nfs_named_pipes(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type nfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t nfs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t nfs_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_nfs_named_pipes(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool use_samba_home_dirs;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (use_samba_home_dirs) {
#line 47
		
#line 47
		 	 	
#line 47
##### begin fs_mount_cifs(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wine_t cifs_t:filesystem mount;
#line 47

#line 47
	 	
#line 47
##### end fs_mount_cifs(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_mounton_cifs(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wine_t cifs_t:dir mounton;
#line 47

#line 47
	 	
#line 47
##### end fs_mounton_cifs(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_cifs_dirs(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wine_t cifs_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	 	
#line 47
##### end fs_manage_cifs_dirs(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_cifs_files(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t cifs_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_cifs_files(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_cifs_symlinks(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t cifs_t:lnk_file { create getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_cifs_symlinks(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_cifs_named_sockets(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t cifs_t:sock_file { create open getattr setattr read write rename link unlink ioctl lock append };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_cifs_named_sockets(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
		 	 	
#line 47
##### begin fs_manage_cifs_named_pipes(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type cifs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t cifs_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t cifs_t:fifo_file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47

#line 47
	 	
#line 47
##### end fs_manage_cifs_named_pipes(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_manage_home_role(test_noopen_r ,test_noopen_wine_t) depth: 2
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin domain_mmap_low(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute mmap_low_domain_type;
#line 47
		bool mmap_low_allowed;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wine_t mmap_low_domain_type;
#line 47

#line 47
	if ( mmap_low_allowed ) {
#line 47
		allow test_noopen_wine_t self:memprotect mmap_zero;
#line 47
	}
#line 47

#line 47
	 	
#line 47
##### end domain_mmap_low(test_noopen_wine_t) depth: 2
#line 47
 	
#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin xserver_role(test_noopen_r,test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type iceauth_home_t, xserver_t, xserver_tmpfs_t, xauth_home_t;
#line 47
		type user_fonts_t, user_fonts_cache_t, user_fonts_config_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin xserver_restricted_role(test_noopen_r,test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type xauth_t, iceauth_t;
#line 47
		attribute dridomain, x_userdomain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	role test_noopen_r types { xauth_t iceauth_t };
#line 47
	typeattribute test_noopen_wine_t x_userdomain, dridomain;
#line 47

#line 47
	 	 	
#line 47
##### begin xserver_common_x_domain_template(user,test_noopen_wine_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type root_xdrawable_t, xdm_t, xserver_t;
#line 47
		type xproperty_t, user_xproperty_t;
#line 47
		type xevent_t, client_xevent_t;
#line 47
		type input_xevent_t, user_input_xevent_t;
#line 47

#line 47
		attribute x_domain, input_xevent_type;
#line 47
		attribute xdrawable_type, xcolormap_type;
#line 47

#line 47
		class x_drawable { create destroy read write blend getattr setattr list_child add_child remove_child list_property get_property set_property manage override show hide send receive };
#line 47
		class x_property { create destroy read write append getattr setattr };
#line 47
		class x_event { send receive };
#line 47
		class x_synthetic_event { send receive };
#line 47
		class x_client destroy;
#line 47
		class x_server manage;
#line 47
		class x_screen { saver_setattr saver_hide saver_show show_cursor hide_cursor };
#line 47
		class x_pointer { get_property set_property manage };
#line 47
		class x_keyboard { read manage freeze };
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	##############################
#line 47
	#
#line 47
	# Local Policy
#line 47
	#
#line 47

#line 47
	# Type attributes
#line 47
	typeattribute test_noopen_wine_t x_domain;
#line 47
	typeattribute test_noopen_wine_t xdrawable_type, xcolormap_type;
#line 47

#line 47
	# X Properties
#line 47
	# disable property transitions for the time being.
#line 47
#	type_transition test_noopen_wine_t xproperty_t:x_property user_xproperty_t;
#line 47

#line 47
	# X Windows
#line 47
	# new windows have the domain type
#line 47
	type_transition test_noopen_wine_t root_xdrawable_t:x_drawable test_noopen_wine_t;
#line 47

#line 47
	# X Input
#line 47
	# distinguish input events
#line 47
	type_transition test_noopen_wine_t input_xevent_t:x_event user_input_xevent_t;
#line 47
	# can send own events
#line 47
	allow test_noopen_wine_t user_input_xevent_t:{ x_event x_synthetic_event } send;
#line 47
	# can receive own events
#line 47
	allow test_noopen_wine_t user_input_xevent_t:{ x_event x_synthetic_event } receive;
#line 47
	# can receive default events
#line 47
	allow test_noopen_wine_t client_xevent_t:{ x_event x_synthetic_event } receive;
#line 47
	allow test_noopen_wine_t xevent_t:{ x_event x_synthetic_event } { send receive };
#line 47
	# dont audit send failures
#line 47
	dontaudit test_noopen_wine_t input_xevent_type:x_event send;
#line 47

#line 47
	allow test_noopen_wine_t xdm_t:x_drawable { hide read add_child manage };
#line 47
	allow test_noopen_wine_t xdm_t:x_client destroy;
#line 47

#line 47
	allow test_noopen_wine_t root_xdrawable_t:x_drawable write;
#line 47
	allow test_noopen_wine_t xserver_t:x_server manage;
#line 47
	allow test_noopen_wine_t xserver_t:x_screen { show_cursor hide_cursor saver_setattr saver_hide saver_show };
#line 47
	allow test_noopen_wine_t xserver_t:x_pointer { get_property set_property manage };
#line 47
	allow test_noopen_wine_t xserver_t:x_keyboard { read manage freeze };
#line 47
 	 	
#line 47
##### end xserver_common_x_domain_template(user,test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin xserver_stream_connect_xdm(test_noopen_wine_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type xdm_t, xdm_var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_tmp(test_noopen_wine_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmp_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin fs_search_tmpfs(test_noopen_wine_t) depth: 7
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type tmpfs_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wine_t tmpfs_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end fs_search_tmpfs(test_noopen_wine_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_wine_t tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_wine_t tmp_t:lnk_file { getattr read };
#line 47

#line 47
	allow test_noopen_wine_t tmp_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_tmp(test_noopen_wine_t) depth: 5
#line 47
 	
#line 47
	 	 	
#line 47
##### begin files_search_pids(test_noopen_wine_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_wine_t var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_wine_t var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_wine_t var_t:dir { getattr search open };
#line 47
	allow test_noopen_wine_t var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_wine_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_wine_t { xdm_var_run_t }:dir { getattr search open };
#line 47
	allow test_noopen_wine_t { xdm_var_run_t }:sock_file { getattr write open append };
#line 47
	allow test_noopen_wine_t xdm_t:unix_stream_socket connectto;
#line 47

#line 47
     	 	
#line 47
##### begin userdom_stream_connect(test_noopen_wine_t) depth: 6
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type user_tmp_t;
#line 47
		attribute userdomain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_tmp_t:dir { getattr search open };
#line 47
	allow test_noopen_wine_t user_tmp_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_wine_t userdomain:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end userdom_stream_connect(test_noopen_wine_t) depth: 5
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end xserver_stream_connect_xdm(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	 	 	
#line 47
##### begin xserver_xdm_append_log(test_noopen_wine_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type xdm_log_t;
#line 47
		attribute xdmhomewriter;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wine_t xdmhomewriter;
#line 47
	allow test_noopen_wine_t xdm_log_t:file { getattr append };
#line 47

#line 47
	 	
#line 47
##### end xserver_xdm_append_log(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	 	
#line 47
##### begin xserver_dri_domain(test_noopen_wine_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute dridomain;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wine_t dridomain;
#line 47

#line 47
	 	
#line 47
##### end xserver_dri_domain(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end xserver_restricted_role(test_noopen_r,test_noopen_wine_t) depth: 3
#line 47
 	
#line 47

#line 47
	# Communicate via System V shared memory.
#line 47
	allow test_noopen_wine_t xserver_t:shm { associate getattr read write lock unix_read unix_write };
#line 47
	allow test_noopen_wine_t xserver_tmpfs_t:file { open { getattr read write append ioctl lock } };
#line 47

#line 47
	allow test_noopen_wine_t iceauth_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47
	allow test_noopen_wine_t iceauth_home_t:file { getattr relabelfrom relabelto };
#line 47

#line 47
	allow test_noopen_wine_t xauth_home_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47
	allow test_noopen_wine_t xauth_home_t:file { getattr relabelfrom relabelto };
#line 47

#line 47
	 	 	
#line 47
##### begin mls_xwin_read_to_clearance(test_noopen_wine_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute mlsxwinreadtoclr;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	typeattribute test_noopen_wine_t mlsxwinreadtoclr;
#line 47

#line 47
	 	
#line 47
##### end mls_xwin_read_to_clearance(test_noopen_wine_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_wine_t user_fonts_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t user_fonts_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_fonts_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t user_fonts_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	allow test_noopen_wine_t user_fonts_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_wine_t user_fonts_t:dir { getattr search open };
#line 47
	allow test_noopen_wine_t user_fonts_t:dir { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_fonts_t:dir { getattr search open };
#line 47
	allow test_noopen_wine_t user_fonts_t:file { getattr relabelfrom relabelto };
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_fonts_cache_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t user_fonts_cache_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_fonts_cache_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t user_fonts_cache_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_fonts_cache_t:dir { getattr search open };
#line 47
	allow test_noopen_wine_t user_fonts_cache_t:dir { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_fonts_cache_t:dir { getattr search open };
#line 47
	allow test_noopen_wine_t user_fonts_cache_t:file { getattr relabelfrom relabelto };
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_fonts_config_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t user_fonts_config_t:dir { create open getattr setattr read write link unlink rename search add_name remove_name reparent rmdir lock ioctl };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_fonts_config_t:dir { open read getattr lock search ioctl add_name remove_name write };
#line 47
	allow test_noopen_wine_t user_fonts_config_t:file { create open getattr setattr read write append rename link unlink ioctl lock };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_fonts_config_t:dir { getattr search open };
#line 47
	allow test_noopen_wine_t user_fonts_config_t:dir { getattr relabelfrom relabelto };
#line 47

#line 47
	
#line 47
	allow test_noopen_wine_t user_fonts_config_t:dir { getattr search open };
#line 47
	allow test_noopen_wine_t user_fonts_config_t:file { getattr relabelfrom relabelto };
#line 47

#line 47

#line 47
	 	
#line 47
##### end xserver_role(test_noopen_r,test_noopen_wine_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47
 	 	
#line 47
##### end wine_role_template(test_noopen,test_noopen_r,test_noopen_t) depth: 1
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin postfix_run_postdrop(test_noopen_t,test_noopen_r) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type postfix_postdrop_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin postfix_domtrans_postdrop(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type postfix_postdrop_t, postfix_postdrop_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t postfix_postdrop_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t postfix_postdrop_t:process transition;
#line 47
#	dontaudit test_noopen_t postfix_postdrop_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t postfix_postdrop_exec_t:process postfix_postdrop_t;
#line 47

#line 47

#line 47
	allow postfix_postdrop_t test_noopen_t:fd use;
#line 47
	allow postfix_postdrop_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow postfix_postdrop_t test_noopen_t:process sigchld;
#line 47

#line 47
    allow test_noopen_t postfix_postdrop_exec_t:file map;
#line 47

#line 47
	 	
#line 47
##### end postfix_domtrans_postdrop(test_noopen_t) depth: 2
#line 47
 	
#line 47
	role test_noopen_r types postfix_postdrop_t;
#line 47
	allow postfix_postdrop_t test_noopen_t:unix_stream_socket { read write getattr };
#line 47

#line 47
	 	
#line 47
##### end postfix_run_postdrop(test_noopen_t,test_noopen_r) depth: 1
#line 47
 	
#line 47
		 	 	
#line 47
##### begin postfix_search_spool(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute postfix_spool_type;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t postfix_spool_type:dir { getattr search open };
#line 47
	 	 	
#line 47
##### begin files_search_spool(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_spool_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t var_t:dir { getattr search open };
#line 47
	allow test_noopen_t var_spool_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_spool(test_noopen_t) depth: 2
#line 47
 	
#line 47

#line 47
	 	
#line 47
##### end postfix_search_spool(test_noopen_t) depth: 1
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	# Run pppd in pppd_t by default for user
#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin ppp_run_cond(test_noopen_t,test_noopen_r) depth: 2
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		attribute_role pppd_roles;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	roleattribute test_noopen_r pppd_roles;
#line 47

#line 47
	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		
#line 47
bool pppd_for_user;
#line 47

#line 47
  
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47
	if (pppd_for_user) {
#line 47
		
#line 47
		 	 	
#line 47
##### begin ppp_domtrans(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type pppd_t, pppd_exec_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_search_bin(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin corecmd_read_bin_symlinks(test_noopen_t) depth: 5
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type bin_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:lnk_file { getattr read };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_read_bin_symlinks(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47
	allow test_noopen_t bin_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end corecmd_search_bin(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
	
#line 47
	allow test_noopen_t pppd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 47
	allow test_noopen_t pppd_t:process transition;
#line 47
#	dontaudit test_noopen_t pppd_t:process { noatsecure siginh rlimitinh };
#line 47

#line 47
	type_transition test_noopen_t pppd_exec_t:process pppd_t;
#line 47

#line 47

#line 47
	allow pppd_t test_noopen_t:fd use;
#line 47
	allow pppd_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 47
	allow pppd_t test_noopen_t:process sigchld;
#line 47

#line 47

#line 47
	 	
#line 47
##### end ppp_domtrans(test_noopen_t) depth: 2
#line 47
 	
#line 47
	
#line 47
	}
#line 47

#line 47

#line 47
	 	
#line 47
##### end ppp_run_cond(test_noopen_t,test_noopen_r) depth: 1
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47

#line 47
	
#line 47
	optional {
#line 47
		
#line 47
		 	 	
#line 47
##### begin vdagent_getattr_log(test_noopen_t) depth: 2
#line 47
 	
#line 47
    
#line 47
	
#line 47
		require {
#line 47
			
#line 47
        type vdagent_log_t;
#line 47
    
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
     	 	
#line 47
##### begin logging_search_logs(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_log_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	 	 	
#line 47
##### begin files_search_var(test_noopen_t) depth: 4
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t var_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end files_search_var(test_noopen_t) depth: 3
#line 47
 	
#line 47
	allow test_noopen_t var_log_t:dir { getattr search open };
#line 47

#line 47
	 	
#line 47
##### end logging_search_logs(test_noopen_t) depth: 2
#line 47
 	
#line 47
    allow test_noopen_t vdagent_log_t:file { getattr };
#line 47

#line 47
	 	
#line 47
##### end vdagent_getattr_log(test_noopen_t) depth: 1
#line 47
 	
#line 47
		 	 	
#line 47
##### begin vdagent_getattr_exec_files(test_noopen_t) depth: 2
#line 47
 	
#line 47
    
#line 47
	
#line 47
		require {
#line 47
			
#line 47
        type vdagent_exec_t;
#line 47
    
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t vdagent_exec_t:file { getattr };
#line 47

#line 47
	 	
#line 47
##### end vdagent_getattr_exec_files(test_noopen_t) depth: 1
#line 47
 	
#line 47
		 	 	
#line 47
##### begin vdagent_stream_connect(test_noopen_t) depth: 2
#line 47
 	
#line 47
        
#line 47
	
#line 47
		require {
#line 47
			
#line 47
                type vdagent_var_run_t, vdagent_t;
#line 47
        
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
         	 	
#line 47
##### begin files_search_pids(test_noopen_t) depth: 3
#line 47
 	
#line 47
	
#line 47
	
#line 47
		require {
#line 47
			
#line 47
		type var_t, var_run_t;
#line 47
	
#line 47
		} # end require
#line 47
	
#line 47

#line 47

#line 47
	allow test_noopen_t var_t:lnk_file { getattr read };
#line 47
	allow test_noopen_t var_run_t:lnk_file { getattr read };
#line 47
	
#line 47
	allow test_noopen_t var_t:dir { getattr search open };
#line 47
	allow test_noopen_t var_run_t:dir { getattr search open };
#line 47

#line 47

#line 47
	 	
#line 47
##### end files_search_pids(test_noopen_t) depth: 2
#line 47
 	
#line 47
        
#line 47
	allow test_noopen_t vdagent_var_run_t:dir { getattr search open };
#line 47
	allow test_noopen_t vdagent_var_run_t:sock_file { getattr write open append };
#line 47
	allow test_noopen_t vdagent_t:unix_stream_socket connectto;
#line 47

#line 47

#line 47
	 	
#line 47
##### end vdagent_stream_connect(test_noopen_t) depth: 1
#line 47
 	
#line 47
	
#line 47
	} # end optional
#line 47

#line 47
 	 	
#line 47
##### end userdom_unpriv_user_template(test_noopen) depth: 0
#line 47
 	;

#allow test_noopen_t test_open_file_t:file { getattr };

#  Policy needed to hook it into the test harness
role lspp_test_r types test_open_t;
allow test_open_t lspp_harness_t:fd use;
allow test_open_t lspp_harness_t:process sigchld;
allow test_open_t lspp_harness_t:fifo_file write;

role lspp_test_r types test_noopen_t;
allow test_noopen_t lspp_harness_t:fd use;
allow test_noopen_t lspp_harness_t:process sigchld;
allow test_noopen_t lspp_harness_t:fifo_file write;

 	 	
#line 62
##### begin seutil_run_newrole(test_open_t,lspp_test_r,{ ttynode ptynode }) depth: 1
#line 62
 	
#line 62
	
#line 62
	
#line 62
		require {
#line 62
			
#line 62
		type newrole_t;
#line 62
		#attribute_role newrole_roles;
#line 62
	
#line 62
		} # end require
#line 62
	
#line 62

#line 62

#line 62
	#seutil_domtrans_newrole(test_open_t)
#line 62
	#roleattribute lspp_test_r newrole_roles;
#line 62

#line 62
	 	 	
#line 62
##### begin seutil_domtrans_newrole(test_open_t) depth: 2
#line 62
 	
#line 62
	
#line 62
	
#line 62
		require {
#line 62
			
#line 62
		type newrole_t, newrole_exec_t;
#line 62
	
#line 62
		} # end require
#line 62
	
#line 62

#line 62

#line 62
	 	 	
#line 62
##### begin files_search_usr(test_open_t) depth: 3
#line 62
 	
#line 62
	
#line 62
	
#line 62
		require {
#line 62
			
#line 62
		type usr_t;
#line 62
	
#line 62
		} # end require
#line 62
	
#line 62

#line 62

#line 62
	allow test_open_t usr_t:dir { getattr search open };
#line 62

#line 62
	 	
#line 62
##### end files_search_usr(test_open_t) depth: 2
#line 62
 	
#line 62
	 	 	
#line 62
##### begin corecmd_search_bin(test_open_t) depth: 3
#line 62
 	
#line 62
	
#line 62
	
#line 62
		require {
#line 62
			
#line 62
		type bin_t;
#line 62
	
#line 62
		} # end require
#line 62
	
#line 62

#line 62

#line 62
	 	 	
#line 62
##### begin corecmd_read_bin_symlinks(test_open_t) depth: 4
#line 62
 	
#line 62
	
#line 62
	
#line 62
		require {
#line 62
			
#line 62
		type bin_t;
#line 62
	
#line 62
		} # end require
#line 62
	
#line 62

#line 62

#line 62
	
#line 62
	allow test_open_t bin_t:dir { getattr search open };
#line 62
	allow test_open_t bin_t:lnk_file { getattr read };
#line 62

#line 62

#line 62
	 	
#line 62
##### end corecmd_read_bin_symlinks(test_open_t) depth: 3
#line 62
 	
#line 62
	
#line 62
	allow test_open_t bin_t:dir { getattr search open };
#line 62
	allow test_open_t bin_t:dir { getattr search open };
#line 62

#line 62

#line 62
	 	
#line 62
##### end corecmd_search_bin(test_open_t) depth: 2
#line 62
 	
#line 62
	
#line 62
	
#line 62
	
#line 62
	allow test_open_t newrole_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 62
	allow test_open_t newrole_t:process transition;
#line 62
#	dontaudit test_open_t newrole_t:process { noatsecure siginh rlimitinh };
#line 62

#line 62
	type_transition test_open_t newrole_exec_t:process newrole_t;
#line 62

#line 62

#line 62
	allow newrole_t test_open_t:fd use;
#line 62
	allow newrole_t test_open_t:fifo_file { getattr read write append ioctl lock };
#line 62
	allow newrole_t test_open_t:process sigchld;
#line 62

#line 62

#line 62
	 	
#line 62
##### end seutil_domtrans_newrole(test_open_t) depth: 1
#line 62
 	
#line 62
        role lspp_test_r types newrole_t;
#line 62

#line 62
         	 	
#line 62
##### begin auth_run_upd_passwd(newrole_t,lspp_test_r) depth: 2
#line 62
 	
#line 62
	
#line 62
	
#line 62
		require {
#line 62
			
#line 62
		type updpwd_t;
#line 62
	
#line 62
		} # end require
#line 62
	
#line 62

#line 62

#line 62
	 	 	
#line 62
##### begin auth_domtrans_upd_passwd(newrole_t) depth: 3
#line 62
 	
#line 62
	
#line 62
	
#line 62
		require {
#line 62
			
#line 62
		type updpwd_t, updpwd_exec_t;
#line 62
	
#line 62
		} # end require
#line 62
	
#line 62

#line 62

#line 62
	
#line 62
	
#line 62
	
#line 62
	allow newrole_t updpwd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 62
	allow newrole_t updpwd_t:process transition;
#line 62
#	dontaudit newrole_t updpwd_t:process { noatsecure siginh rlimitinh };
#line 62

#line 62
	type_transition newrole_t updpwd_exec_t:process updpwd_t;
#line 62

#line 62

#line 62
	allow updpwd_t newrole_t:fd use;
#line 62
	allow updpwd_t newrole_t:fifo_file { getattr read write append ioctl lock };
#line 62
	allow updpwd_t newrole_t:process sigchld;
#line 62

#line 62
	 	 	
#line 62
##### begin auth_dontaudit_read_shadow(newrole_t) depth: 4
#line 62
 	
#line 62
	
#line 62
	
#line 62
		require {
#line 62
			
#line 62
		type shadow_t;
#line 62
	
#line 62
		} # end require
#line 62
	
#line 62

#line 62

#line 62
	dontaudit newrole_t shadow_t:file { open { getattr read ioctl lock } };
#line 62

#line 62
	 	
#line 62
##### end auth_dontaudit_read_shadow(newrole_t) depth: 3
#line 62
 	
#line 62

#line 62
	 	
#line 62
##### end auth_domtrans_upd_passwd(newrole_t) depth: 2
#line 62
 	
#line 62
	role lspp_test_r types updpwd_t;
#line 62

#line 62
	 	
#line 62
##### end auth_run_upd_passwd(newrole_t,lspp_test_r) depth: 1
#line 62
 	
#line 62

#line 62
        
#line 62
	optional {
#line 62
		
#line 62
                 	 	
#line 62
##### begin namespace_init_run(newrole_t,lspp_test_r) depth: 2
#line 62
 	
#line 62
	
#line 62
	
#line 62
		require {
#line 62
			
#line 62
		type namespace_init_t;
#line 62
	
#line 62
		} # end require
#line 62
	
#line 62

#line 62

#line 62
	 	 	
#line 62
##### begin namespace_init_domtrans(newrole_t) depth: 3
#line 62
 	
#line 62
	
#line 62
	
#line 62
		require {
#line 62
			
#line 62
		type namespace_init_t, namespace_init_exec_t;
#line 62
	
#line 62
		} # end require
#line 62
	
#line 62

#line 62

#line 62
	
#line 62
	
#line 62
	
#line 62
	allow newrole_t namespace_init_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 62
	allow newrole_t namespace_init_t:process transition;
#line 62
#	dontaudit newrole_t namespace_init_t:process { noatsecure siginh rlimitinh };
#line 62

#line 62
	type_transition newrole_t namespace_init_exec_t:process namespace_init_t;
#line 62

#line 62

#line 62
	allow namespace_init_t newrole_t:fd use;
#line 62
	allow namespace_init_t newrole_t:fifo_file { getattr read write append ioctl lock };
#line 62
	allow namespace_init_t newrole_t:process sigchld;
#line 62

#line 62

#line 62
	 	
#line 62
##### end namespace_init_domtrans(newrole_t) depth: 2
#line 62
 	
#line 62
	role lspp_test_r types namespace_init_t;
#line 62

#line 62
	 	 	
#line 62
##### begin seutil_run_setfiles(namespace_init_t,lspp_test_r) depth: 3
#line 62
 	
#line 62
	
#line 62
	
#line 62
		require {
#line 62
			
#line 62
		type setfiles_t;
#line 62
	
#line 62
		} # end require
#line 62
	
#line 62

#line 62

#line 62
	 	 	
#line 62
##### begin seutil_domtrans_setfiles(namespace_init_t) depth: 4
#line 62
 	
#line 62
	
#line 62
	
#line 62
		require {
#line 62
			
#line 62
		type setfiles_t, setfiles_exec_t;
#line 62
	
#line 62
		} # end require
#line 62
	
#line 62

#line 62

#line 62
	 	 	
#line 62
##### begin files_search_usr(namespace_init_t) depth: 5
#line 62
 	
#line 62
	
#line 62
	
#line 62
		require {
#line 62
			
#line 62
		type usr_t;
#line 62
	
#line 62
		} # end require
#line 62
	
#line 62

#line 62

#line 62
	allow namespace_init_t usr_t:dir { getattr search open };
#line 62

#line 62
	 	
#line 62
##### end files_search_usr(namespace_init_t) depth: 4
#line 62
 	
#line 62
	 	 	
#line 62
##### begin corecmd_search_bin(namespace_init_t) depth: 5
#line 62
 	
#line 62
	
#line 62
	
#line 62
		require {
#line 62
			
#line 62
		type bin_t;
#line 62
	
#line 62
		} # end require
#line 62
	
#line 62

#line 62

#line 62
	 	 	
#line 62
##### begin corecmd_read_bin_symlinks(namespace_init_t) depth: 6
#line 62
 	
#line 62
	
#line 62
	
#line 62
		require {
#line 62
			
#line 62
		type bin_t;
#line 62
	
#line 62
		} # end require
#line 62
	
#line 62

#line 62

#line 62
	
#line 62
	allow namespace_init_t bin_t:dir { getattr search open };
#line 62
	allow namespace_init_t bin_t:lnk_file { getattr read };
#line 62

#line 62

#line 62
	 	
#line 62
##### end corecmd_read_bin_symlinks(namespace_init_t) depth: 5
#line 62
 	
#line 62
	
#line 62
	allow namespace_init_t bin_t:dir { getattr search open };
#line 62
	allow namespace_init_t bin_t:dir { getattr search open };
#line 62

#line 62

#line 62
	 	
#line 62
##### end corecmd_search_bin(namespace_init_t) depth: 4
#line 62
 	
#line 62
	
#line 62
	
#line 62
	
#line 62
	allow namespace_init_t setfiles_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 62
	allow namespace_init_t setfiles_t:process transition;
#line 62
#	dontaudit namespace_init_t setfiles_t:process { noatsecure siginh rlimitinh };
#line 62

#line 62
	type_transition namespace_init_t setfiles_exec_t:process setfiles_t;
#line 62

#line 62

#line 62
	allow setfiles_t namespace_init_t:fd use;
#line 62
	allow setfiles_t namespace_init_t:fifo_file { getattr read write append ioctl lock };
#line 62
	allow setfiles_t namespace_init_t:process sigchld;
#line 62

#line 62
    allow namespace_init_t setfiles_exec_t:file map;
#line 62

#line 62
	 	
#line 62
##### end seutil_domtrans_setfiles(namespace_init_t) depth: 3
#line 62
 	
#line 62
	role lspp_test_r types setfiles_t;
#line 62

#line 62
	 	
#line 62
##### end seutil_run_setfiles(namespace_init_t,lspp_test_r) depth: 2
#line 62
 	
#line 62

#line 62
	 	
#line 62
##### end namespace_init_run(newrole_t,lspp_test_r) depth: 1
#line 62
 	
#line 62
        
#line 62
	} # end optional
#line 62

#line 62

#line 62

#line 62
	 	
#line 62
##### end seutil_run_newrole(test_open_t,lspp_test_r,{ ttynode ptynode }) depth: 0
#line 62
 	
 	 	
#line 63
##### begin seutil_run_newrole(test_noopen_t,lspp_test_r,{ ttynode ptynode }) depth: 1
#line 63
 	
#line 63
	
#line 63
	
#line 63
		require {
#line 63
			
#line 63
		type newrole_t;
#line 63
		#attribute_role newrole_roles;
#line 63
	
#line 63
		} # end require
#line 63
	
#line 63

#line 63

#line 63
	#seutil_domtrans_newrole(test_noopen_t)
#line 63
	#roleattribute lspp_test_r newrole_roles;
#line 63

#line 63
	 	 	
#line 63
##### begin seutil_domtrans_newrole(test_noopen_t) depth: 2
#line 63
 	
#line 63
	
#line 63
	
#line 63
		require {
#line 63
			
#line 63
		type newrole_t, newrole_exec_t;
#line 63
	
#line 63
		} # end require
#line 63
	
#line 63

#line 63

#line 63
	 	 	
#line 63
##### begin files_search_usr(test_noopen_t) depth: 3
#line 63
 	
#line 63
	
#line 63
	
#line 63
		require {
#line 63
			
#line 63
		type usr_t;
#line 63
	
#line 63
		} # end require
#line 63
	
#line 63

#line 63

#line 63
	allow test_noopen_t usr_t:dir { getattr search open };
#line 63

#line 63
	 	
#line 63
##### end files_search_usr(test_noopen_t) depth: 2
#line 63
 	
#line 63
	 	 	
#line 63
##### begin corecmd_search_bin(test_noopen_t) depth: 3
#line 63
 	
#line 63
	
#line 63
	
#line 63
		require {
#line 63
			
#line 63
		type bin_t;
#line 63
	
#line 63
		} # end require
#line 63
	
#line 63

#line 63

#line 63
	 	 	
#line 63
##### begin corecmd_read_bin_symlinks(test_noopen_t) depth: 4
#line 63
 	
#line 63
	
#line 63
	
#line 63
		require {
#line 63
			
#line 63
		type bin_t;
#line 63
	
#line 63
		} # end require
#line 63
	
#line 63

#line 63

#line 63
	
#line 63
	allow test_noopen_t bin_t:dir { getattr search open };
#line 63
	allow test_noopen_t bin_t:lnk_file { getattr read };
#line 63

#line 63

#line 63
	 	
#line 63
##### end corecmd_read_bin_symlinks(test_noopen_t) depth: 3
#line 63
 	
#line 63
	
#line 63
	allow test_noopen_t bin_t:dir { getattr search open };
#line 63
	allow test_noopen_t bin_t:dir { getattr search open };
#line 63

#line 63

#line 63
	 	
#line 63
##### end corecmd_search_bin(test_noopen_t) depth: 2
#line 63
 	
#line 63
	
#line 63
	
#line 63
	
#line 63
	allow test_noopen_t newrole_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 63
	allow test_noopen_t newrole_t:process transition;
#line 63
#	dontaudit test_noopen_t newrole_t:process { noatsecure siginh rlimitinh };
#line 63

#line 63
	type_transition test_noopen_t newrole_exec_t:process newrole_t;
#line 63

#line 63

#line 63
	allow newrole_t test_noopen_t:fd use;
#line 63
	allow newrole_t test_noopen_t:fifo_file { getattr read write append ioctl lock };
#line 63
	allow newrole_t test_noopen_t:process sigchld;
#line 63

#line 63

#line 63
	 	
#line 63
##### end seutil_domtrans_newrole(test_noopen_t) depth: 1
#line 63
 	
#line 63
        role lspp_test_r types newrole_t;
#line 63

#line 63
         	 	
#line 63
##### begin auth_run_upd_passwd(newrole_t,lspp_test_r) depth: 2
#line 63
 	
#line 63
	
#line 63
	
#line 63
		require {
#line 63
			
#line 63
		type updpwd_t;
#line 63
	
#line 63
		} # end require
#line 63
	
#line 63

#line 63

#line 63
	 	 	
#line 63
##### begin auth_domtrans_upd_passwd(newrole_t) depth: 3
#line 63
 	
#line 63
	
#line 63
	
#line 63
		require {
#line 63
			
#line 63
		type updpwd_t, updpwd_exec_t;
#line 63
	
#line 63
		} # end require
#line 63
	
#line 63

#line 63

#line 63
	
#line 63
	
#line 63
	
#line 63
	allow newrole_t updpwd_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 63
	allow newrole_t updpwd_t:process transition;
#line 63
#	dontaudit newrole_t updpwd_t:process { noatsecure siginh rlimitinh };
#line 63

#line 63
	type_transition newrole_t updpwd_exec_t:process updpwd_t;
#line 63

#line 63

#line 63
	allow updpwd_t newrole_t:fd use;
#line 63
	allow updpwd_t newrole_t:fifo_file { getattr read write append ioctl lock };
#line 63
	allow updpwd_t newrole_t:process sigchld;
#line 63

#line 63
	 	 	
#line 63
##### begin auth_dontaudit_read_shadow(newrole_t) depth: 4
#line 63
 	
#line 63
	
#line 63
	
#line 63
		require {
#line 63
			
#line 63
		type shadow_t;
#line 63
	
#line 63
		} # end require
#line 63
	
#line 63

#line 63

#line 63
	dontaudit newrole_t shadow_t:file { open { getattr read ioctl lock } };
#line 63

#line 63
	 	
#line 63
##### end auth_dontaudit_read_shadow(newrole_t) depth: 3
#line 63
 	
#line 63

#line 63
	 	
#line 63
##### end auth_domtrans_upd_passwd(newrole_t) depth: 2
#line 63
 	
#line 63
	role lspp_test_r types updpwd_t;
#line 63

#line 63
	 	
#line 63
##### end auth_run_upd_passwd(newrole_t,lspp_test_r) depth: 1
#line 63
 	
#line 63

#line 63
        
#line 63
	optional {
#line 63
		
#line 63
                 	 	
#line 63
##### begin namespace_init_run(newrole_t,lspp_test_r) depth: 2
#line 63
 	
#line 63
	
#line 63
	
#line 63
		require {
#line 63
			
#line 63
		type namespace_init_t;
#line 63
	
#line 63
		} # end require
#line 63
	
#line 63

#line 63

#line 63
	 	 	
#line 63
##### begin namespace_init_domtrans(newrole_t) depth: 3
#line 63
 	
#line 63
	
#line 63
	
#line 63
		require {
#line 63
			
#line 63
		type namespace_init_t, namespace_init_exec_t;
#line 63
	
#line 63
		} # end require
#line 63
	
#line 63

#line 63

#line 63
	
#line 63
	
#line 63
	
#line 63
	allow newrole_t namespace_init_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 63
	allow newrole_t namespace_init_t:process transition;
#line 63
#	dontaudit newrole_t namespace_init_t:process { noatsecure siginh rlimitinh };
#line 63

#line 63
	type_transition newrole_t namespace_init_exec_t:process namespace_init_t;
#line 63

#line 63

#line 63
	allow namespace_init_t newrole_t:fd use;
#line 63
	allow namespace_init_t newrole_t:fifo_file { getattr read write append ioctl lock };
#line 63
	allow namespace_init_t newrole_t:process sigchld;
#line 63

#line 63

#line 63
	 	
#line 63
##### end namespace_init_domtrans(newrole_t) depth: 2
#line 63
 	
#line 63
	role lspp_test_r types namespace_init_t;
#line 63

#line 63
	 	 	
#line 63
##### begin seutil_run_setfiles(namespace_init_t,lspp_test_r) depth: 3
#line 63
 	
#line 63
	
#line 63
	
#line 63
		require {
#line 63
			
#line 63
		type setfiles_t;
#line 63
	
#line 63
		} # end require
#line 63
	
#line 63

#line 63

#line 63
	 	 	
#line 63
##### begin seutil_domtrans_setfiles(namespace_init_t) depth: 4
#line 63
 	
#line 63
	
#line 63
	
#line 63
		require {
#line 63
			
#line 63
		type setfiles_t, setfiles_exec_t;
#line 63
	
#line 63
		} # end require
#line 63
	
#line 63

#line 63

#line 63
	 	 	
#line 63
##### begin files_search_usr(namespace_init_t) depth: 5
#line 63
 	
#line 63
	
#line 63
	
#line 63
		require {
#line 63
			
#line 63
		type usr_t;
#line 63
	
#line 63
		} # end require
#line 63
	
#line 63

#line 63

#line 63
	allow namespace_init_t usr_t:dir { getattr search open };
#line 63

#line 63
	 	
#line 63
##### end files_search_usr(namespace_init_t) depth: 4
#line 63
 	
#line 63
	 	 	
#line 63
##### begin corecmd_search_bin(namespace_init_t) depth: 5
#line 63
 	
#line 63
	
#line 63
	
#line 63
		require {
#line 63
			
#line 63
		type bin_t;
#line 63
	
#line 63
		} # end require
#line 63
	
#line 63

#line 63

#line 63
	 	 	
#line 63
##### begin corecmd_read_bin_symlinks(namespace_init_t) depth: 6
#line 63
 	
#line 63
	
#line 63
	
#line 63
		require {
#line 63
			
#line 63
		type bin_t;
#line 63
	
#line 63
		} # end require
#line 63
	
#line 63

#line 63

#line 63
	
#line 63
	allow namespace_init_t bin_t:dir { getattr search open };
#line 63
	allow namespace_init_t bin_t:lnk_file { getattr read };
#line 63

#line 63

#line 63
	 	
#line 63
##### end corecmd_read_bin_symlinks(namespace_init_t) depth: 5
#line 63
 	
#line 63
	
#line 63
	allow namespace_init_t bin_t:dir { getattr search open };
#line 63
	allow namespace_init_t bin_t:dir { getattr search open };
#line 63

#line 63

#line 63
	 	
#line 63
##### end corecmd_search_bin(namespace_init_t) depth: 4
#line 63
 	
#line 63
	
#line 63
	
#line 63
	
#line 63
	allow namespace_init_t setfiles_exec_t:file { getattr open map read execute ioctl execute_no_trans };
#line 63
	allow namespace_init_t setfiles_t:process transition;
#line 63
#	dontaudit namespace_init_t setfiles_t:process { noatsecure siginh rlimitinh };
#line 63

#line 63
	type_transition namespace_init_t setfiles_exec_t:process setfiles_t;
#line 63

#line 63

#line 63
	allow setfiles_t namespace_init_t:fd use;
#line 63
	allow setfiles_t namespace_init_t:fifo_file { getattr read write append ioctl lock };
#line 63
	allow setfiles_t namespace_init_t:process sigchld;
#line 63

#line 63
    allow namespace_init_t setfiles_exec_t:file map;
#line 63

#line 63
	 	
#line 63
##### end seutil_domtrans_setfiles(namespace_init_t) depth: 3
#line 63
 	
#line 63
	role lspp_test_r types setfiles_t;
#line 63

#line 63
	 	
#line 63
##### end seutil_run_setfiles(namespace_init_t,lspp_test_r) depth: 2
#line 63
 	
#line 63

#line 63
	 	
#line 63
##### end namespace_init_run(newrole_t,lspp_test_r) depth: 1
#line 63
 	
#line 63
        
#line 63
	} # end optional
#line 63

#line 63

#line 63

#line 63
	 	
#line 63
##### end seutil_run_newrole(test_noopen_t,lspp_test_r,{ ttynode ptynode }) depth: 0
#line 63
 	
 	 	
#line 64
##### begin term_use_all_terms(test_open_t) depth: 1
#line 64
 	
#line 64
	
#line 64
	
#line 64
		require {
#line 64
			
#line 64
		attribute ttynode, ptynode;
#line 64
		type console_device_t, devpts_t, tty_device_t;
#line 64
	
#line 64
		} # end require
#line 64
	
#line 64

#line 64

#line 64
	 	 	
#line 64
##### begin dev_list_all_dev_nodes(test_open_t) depth: 2
#line 64
 	
#line 64
	
#line 64
	
#line 64
		require {
#line 64
			
#line 64
		type device_t;
#line 64
	
#line 64
		} # end require
#line 64
	
#line 64

#line 64

#line 64
	
#line 64
	allow test_open_t device_t:dir { getattr search open };
#line 64
	allow test_open_t device_t:dir { getattr search open read lock ioctl };
#line 64

#line 64
	
#line 64
	allow test_open_t device_t:dir { getattr search open };
#line 64
	allow test_open_t device_t:lnk_file { getattr read };
#line 64

#line 64

#line 64
	 	
#line 64
##### end dev_list_all_dev_nodes(test_open_t) depth: 1
#line 64
 	
#line 64
	allow test_open_t devpts_t:dir { getattr search open read lock ioctl };
#line 64
	allow test_open_t { devpts_t console_device_t tty_device_t ttynode ptynode }:chr_file { open { getattr read write append ioctl lock } };
#line 64

#line 64
	 	
#line 64
##### end term_use_all_terms(test_open_t) depth: 0
#line 64
 	
 	 	
#line 65
##### begin term_use_all_terms(test_noopen_t) depth: 1
#line 65
 	
#line 65
	
#line 65
	
#line 65
		require {
#line 65
			
#line 65
		attribute ttynode, ptynode;
#line 65
		type console_device_t, devpts_t, tty_device_t;
#line 65
	
#line 65
		} # end require
#line 65
	
#line 65

#line 65

#line 65
	 	 	
#line 65
##### begin dev_list_all_dev_nodes(test_noopen_t) depth: 2
#line 65
 	
#line 65
	
#line 65
	
#line 65
		require {
#line 65
			
#line 65
		type device_t;
#line 65
	
#line 65
		} # end require
#line 65
	
#line 65

#line 65

#line 65
	
#line 65
	allow test_noopen_t device_t:dir { getattr search open };
#line 65
	allow test_noopen_t device_t:dir { getattr search open read lock ioctl };
#line 65

#line 65
	
#line 65
	allow test_noopen_t device_t:dir { getattr search open };
#line 65
	allow test_noopen_t device_t:lnk_file { getattr read };
#line 65

#line 65

#line 65
	 	
#line 65
##### end dev_list_all_dev_nodes(test_noopen_t) depth: 1
#line 65
 	
#line 65
	allow test_noopen_t devpts_t:dir { getattr search open read lock ioctl };
#line 65
	allow test_noopen_t { devpts_t console_device_t tty_device_t ttynode ptynode }:chr_file { open { getattr read write append ioctl lock } };
#line 65

#line 65
	 	
#line 65
##### end term_use_all_terms(test_noopen_t) depth: 0
#line 65
 	
allow unlabeled_t lspp_harness_t:process sigchld;

