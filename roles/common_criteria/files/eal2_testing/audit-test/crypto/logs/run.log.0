Log file started Tue Jun  8 16:22:47 CEST 2021
Adding group testuser
Adding user testuser
Adding group testadmin
Adding user testadmin
Testcase                                                                                                   Result
--------                                                                                                   ------
[0] cryptsetup_access                                                                                       FAIL 
        Failed check on hash spec
--- begin output -----------------------------------------------------------
rotate_audit_logs: Attempting to rotate using USR1
+ create_loop_device
+ LOOPSIZE=100
+ '[' x '!=' x ']'
+ '[' x '!=' x ']'
++ mktemp
+ LOOPFILE=/tmp/tmp.kVuhQ4X3Bu
+ dd if=/dev/zero of=/tmp/tmp.kVuhQ4X3Bu bs=1M count=100
100+0 records in
100+0 records out
104857600 bytes (105 MB) copied, 0.163892 s, 640 MB/s
+ losetup /dev/loop1 /tmp/tmp.kVuhQ4X3Bu
+ prepend_cleanup remove_loop_device
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	remove_loop_device
	    rm -f "$tmp1" "$tmp2" "$localtmp"
    }'
+ create_luks 'kc3%a9?cF]Xffd'
+ expect -c '
		set timeout 120
		spawn cryptsetup luksFormat /dev/loop1
		expect {Are you sure} {send "YES\r"}
		expect {Enter} {send "kc3%a9?cF]Xffd\r"}
		expect {Verify} {send "kc3%a9?cF]Xffd\r"}
		expect eof
	'
spawn cryptsetup luksFormat /dev/loop1

WARNING!
========
This will overwrite data on /dev/loop1 irrevocably.

Are you sure? (Type uppercase yes): YES
Enter passphrase for /tmp/tmp.kVuhQ4X3Bu: 
Verify passphrase: 
++ cat /proc/sys/crypto/fips_enabled
+ '[' x0 = x1 ']'
+ check_luks 1
+ '[' x1 = x ']'
++ mktemp
+ TMP=/tmp/tmp.HThh74QwMO
+ cryptsetup luksDump /dev/loop1
+ egrep 'Cipher name.*aes' /tmp/tmp.HThh74QwMO
Cipher name:   	aes
+ egrep 'Cipher mode.*(cbc-essiv:sha256|xts-plain64)' /tmp/tmp.HThh74QwMO
Cipher mode:   	xts-plain64
+ egrep 'Hash spec.*sha1' /tmp/tmp.HThh74QwMO
+ exit_fail 'Failed check on hash spec'
+ [[ -n Failed check on hash spec ]]
+ printf '\nexit_fail: %s\n' 'Failed check on hash spec'

exit_fail: Failed check on hash spec
+ exit 1
+ test_cleanup
+ remove_loop_device
+ '[' x '!=' x ']'
+ umount /dev/loop1
umount: /dev/loop1: not mounted
++ losetup /dev/loop1
++ sed 's|.*(\(/.*\))|\1|g'
+ LOOPFILE=/tmp/tmp.kVuhQ4X3Bu
+ losetup -d /dev/loop1
+ rm -f /tmp/tmp.kVuhQ4X3Bu
+ rm -f /tmp/tmp.2p2mZaqVX0 /tmp/tmp.wA6zyrzNsx /usr/local/eal4_testing/audit-test/tmp.2103e4N2EY
+ exit

augrok output
-------------
perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
	LANGUAGE = (unset),
	LC_ALL = (unset),
	LC_CTYPE = "UTF-8",
	LANG = "en_GB.UTF-8"
    are supported and installed on your system.
perl: warning: Falling back to the standard locale ("C").
Argument "enabled 1\nfailure 1\npid 6534\nrate_limit 0\nbacklog_li..." isn't numeric in numeric eq (==) at /usr/local/eal4_testing/audit-test/utils/augrok line 1208.
--- end output -------------------------------------------------------------

