
Started:                         Tue Jun 29 11:26:22 CEST 2021
Kernel:                          3.10.0-1127.8.2.el7.x86_64
Architecture:                    x86_64
Mode:                            64
Hostname:                        rhv.atsec.com
Profile:                         capp
selinux-policy version:          selinux-policy-3.13.1-266.el7.noarch

SELinux status:                 enabled
SELinuxfs mount:                /sys/fs/selinux
SELinux root directory:         /etc/selinux
Loaded policy name:             targeted
Current mode:                   enforcing
Mode from config file:          enforcing
Policy MLS status:              enabled
Policy deny_unknown status:     allowed
Max kernel policy version:      31

Log file started Tue Jun 29 11:26:22 CEST 2021
Adding group testuser
Adding user testuser
Adding group testadmin
Adding user testadmin
Testcase                                                                                      Result
--------                                                                                      ------
[0] test_auditctl_rule_subj.bash                                                               PASS 
--- begin output -----------------------------------------------------------
Domain KVM-Guest-1 destroyed

Domain KVM-Guest-2 destroyed

Domain KVM-Guest-1 started

Domain KVM-Guest-2 started

++ mktemp test_auditctl_rule_subj_trueXXXX
+ true_file=test_auditctl_rule_subj_trueTl9G
+ append_cleanup 'rm -f test_auditctl_rule_subj_trueTl9G'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp"
	rm -f test_auditctl_rule_subj_trueTl9G
    }'
+ rm -f test_auditctl_rule_subj_trueTl9G
+ cp -p /bin/true test_auditctl_rule_subj_trueTl9G
+ for label in '$labels'
++ echo system_u:system_r:svirt_t:s0:c188,c441
++ awk 'BEGIN { FS = ":" } ; { print $4 ":" $5 }'
+ levl=s0:c188,c441
++ awk 'BEGIN { FS = ":" } ; { print $4 }'
++ echo system_u:system_r:svirt_t:s0:c188,c441
+ subj_sen=s0
++ echo system_u:system_r:svirt_t:s0:c188,c441
++ awk 'BEGIN { FS = ":" } ; { print $5 }'
+ subj_clr=c188,c441
+ append_cleanup 'auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c188,c441'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    rm -f test_auditctl_rule_subj_trueTl9G
	auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c188,c441
    }'
+ append_cleanup 'auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c188,c441'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    rm -f test_auditctl_rule_subj_trueTl9G;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c188,c441
	auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c188,c441
    }'
+ append_cleanup 'auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c188,c441'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    rm -f test_auditctl_rule_subj_trueTl9G;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c188,c441
	auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c188,c441
    }'
+ append_cleanup 'auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c188,c441'
++ sed '1,3d;$d'
++ type test_cleanup
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    rm -f test_auditctl_rule_subj_trueTl9G;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c188,c441
	auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c188,c441
    }'
+ auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c188,c441
Error sending delete rule data request (No such file or directory)
+ auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c188,c441
Error sending delete rule data request (No such file or directory)
+ auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c188,c441
Error sending delete rule data request (No such file or directory)
+ auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c188,c441
Error sending delete rule data request (No such file or directory)
+ auditctl -a exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c188,c441
+ auditctl -a exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c188,c441
+ auditctl -a exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c188,c441
+ auditctl -a exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c188,c441
+ runcon -l s0:c188,c441 ./test_auditctl_rule_subj_trueTl9G
++ id -Z
++ awk 'BEGIN { FS = ":" } ; { print $1 ":" $2 ":" $3 }'
+ subj=unconfined_u:unconfined_r:unconfined_t
+ subj=unconfined_u:unconfined_r:unconfined_t:s0:c188,c441
+ expression=subj==unconfined_u:unconfined_r:unconfined_t:s0:c188,c441
++ augrok -c --seek 0 subj==unconfined_u:unconfined_r:unconfined_t:s0:c188,c441
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
1 -eq 0 ]]
./test_auditctl_rule_subj.bash: line 61: [[: HHHHHHHHHHHHHHHHHHHH 
1: syntax error in expression (error token is "1")
+ for label in '$labels'
++ echo system_u:system_r:svirt_t:s0:c266,c358
++ awk 'BEGIN { FS = ":" } ; { print $4 ":" $5 }'
+ levl=s0:c266,c358
++ echo system_u:system_r:svirt_t:s0:c266,c358
++ awk 'BEGIN { FS = ":" } ; { print $4 }'
+ subj_sen=s0
++ echo system_u:system_r:svirt_t:s0:c266,c358
++ awk 'BEGIN { FS = ":" } ; { print $5 }'
+ subj_clr=c266,c358
+ append_cleanup 'auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c266,c358'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    rm -f test_auditctl_rule_subj_trueTl9G;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c188,c441
	auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c266,c358
    }'
+ append_cleanup 'auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c266,c358'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    rm -f test_auditctl_rule_subj_trueTl9G;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c188,c441;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c266,c358
	auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c266,c358
    }'
+ append_cleanup 'auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c266,c358'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    rm -f test_auditctl_rule_subj_trueTl9G;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c188,c441;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c266,c358;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c266,c358
	auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c266,c358
    }'
+ append_cleanup 'auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c266,c358'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    rm -f test_auditctl_rule_subj_trueTl9G;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c188,c441;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c266,c358;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c266,c358;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c266,c358
	auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c266,c358
    }'
+ auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c266,c358
Error sending delete rule data request (No such file or directory)
+ auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c266,c358
Error sending delete rule data request (No such file or directory)
+ auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c266,c358
Error sending delete rule data request (No such file or directory)
+ auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c266,c358
Error sending delete rule data request (No such file or directory)
+ auditctl -a exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c266,c358
+ auditctl -a exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c266,c358
+ auditctl -a exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c266,c358
+ auditctl -a exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c266,c358
+ runcon -l s0:c266,c358 ./test_auditctl_rule_subj_trueTl9G
++ id -Z
++ awk 'BEGIN { FS = ":" } ; { print $1 ":" $2 ":" $3 }'
+ subj=unconfined_u:unconfined_r:unconfined_t
+ subj=unconfined_u:unconfined_r:unconfined_t:s0:c266,c358
+ expression=subj==unconfined_u:unconfined_r:unconfined_t:s0:c266,c358
++ augrok -c --seek 0 subj==unconfined_u:unconfined_r:unconfined_t:s0:c266,c358
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
0 -eq 0 ]]
./test_auditctl_rule_subj.bash: line 61: [[: HHHHHHHHHHHHHHHHHHHH 
0: syntax error in expression (error token is "0")
+ for label in '$labels'
++ echo unconfined_u:unconfined_r:svirt_t:s0:c802,c1022
++ awk 'BEGIN { FS = ":" } ; { print $4 ":" $5 }'
+ levl=s0:c802,c1022
++ awk 'BEGIN { FS = ":" } ; { print $4 }'
++ echo unconfined_u:unconfined_r:svirt_t:s0:c802,c1022
+ subj_sen=s0
++ echo unconfined_u:unconfined_r:svirt_t:s0:c802,c1022
++ awk 'BEGIN { FS = ":" } ; { print $5 }'
+ subj_clr=c802,c1022
+ append_cleanup 'auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c802,c1022'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    rm -f test_auditctl_rule_subj_trueTl9G;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c188,c441;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c266,c358;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c266,c358;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c266,c358;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c266,c358
	auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c802,c1022
    }'
+ append_cleanup 'auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c802,c1022'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    rm -f test_auditctl_rule_subj_trueTl9G;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c188,c441;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c266,c358;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c266,c358;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c266,c358;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c266,c358;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c802,c1022
	auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c802,c1022
    }'
+ append_cleanup 'auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c802,c1022'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    rm -f test_auditctl_rule_subj_trueTl9G;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c188,c441;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c266,c358;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c266,c358;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c266,c358;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c266,c358;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c802,c1022;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c802,c1022
	auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c802,c1022
    }'
+ append_cleanup 'auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c802,c1022'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    rm -f test_auditctl_rule_subj_trueTl9G;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c188,c441;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c188,c441;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c188,c441;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c266,c358;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c266,c358;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c266,c358;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c266,c358;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c802,c1022;
    auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c802,c1022;
    auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c802,c1022
	auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c802,c1022
    }'
+ auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c802,c1022
Error sending delete rule data request (No such file or directory)
+ auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c802,c1022
Error sending delete rule data request (No such file or directory)
+ auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c802,c1022
Error sending delete rule data request (No such file or directory)
+ auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c802,c1022
Error sending delete rule data request (No such file or directory)
+ auditctl -a exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c802,c1022
+ auditctl -a exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c802,c1022
+ auditctl -a exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c802,c1022
+ auditctl -a exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c802,c1022
+ runcon -l s0:c802,c1022 ./test_auditctl_rule_subj_trueTl9G
++ id -Z
++ awk 'BEGIN { FS = ":" } ; { print $1 ":" $2 ":" $3 }'
+ subj=unconfined_u:unconfined_r:unconfined_t
+ subj=unconfined_u:unconfined_r:unconfined_t:s0:c802,c1022
+ expression=subj==unconfined_u:unconfined_r:unconfined_t:s0:c802,c1022
++ augrok -c --seek 0 subj==unconfined_u:unconfined_r:unconfined_t:s0:c802,c1022
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
0 -eq 0 ]]
./test_auditctl_rule_subj.bash: line 61: [[: HHHHHHHHHHHHHHHHHHHH 
0: syntax error in expression (error token is "0")
+ exit_pass
+ [[ -n '' ]]
+ exit 0
+ test_cleanup
+ rm -f /tmp/tmp.qU80v37KXe /tmp/tmp.Pg9RWbWJkL /usr/local/eal2_testing/audit-test/tmp.d1Lik9wpki
+ rm -f test_auditctl_rule_subj_trueTl9G
+ auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c188,c441
+ auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c188,c441
+ auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c188,c441
+ auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c188,c441
+ auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c266,c358
+ auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c266,c358
+ auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c266,c358
+ auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c266,c358
+ auditctl -d exit,always -F arch=b32 -S close -S open -F subj_clr=s0:c802,c1022
+ auditctl -d exit,always -F arch=b64 -S close -S open -F subj_clr=s0:c802,c1022
+ auditctl -d exit,always -F arch=b32 -S close -S open -F subj_sen=s0,subj_clr=c802,c1022
+ auditctl -d exit,always -F arch=b64 -S close -S open -F subj_sen=s0,subj_clr=c802,c1022
+ exit
--- end output -------------------------------------------------------------


Testcase                                                                                      Result
--------                                                                                      ------
[1] test_auditctl_rule_obj.bash                                                                PASS 
--- begin output -----------------------------------------------------------
Domain KVM-Guest-1 destroyed

Domain KVM-Guest-2 destroyed

Domain KVM-Guest-1 started

Domain KVM-Guest-2 started

+ filename=/var/lib/libvirt/images/testresource.img
+ append_cleanup 'rm -f /var/lib/libvirt/images/testresource.img'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp"
	rm -f /var/lib/libvirt/images/testresource.img
    }'
+ rm -f /var/lib/libvirt/images/testresource.img
+ qemu-img create /var/lib/libvirt/images/testresource.img 8G
Formatting '/var/lib/libvirt/images/testresource.img', fmt=raw size=8589934592
+ for context in '$contexts'
++ echo system_u:object_r:svirt_image_t:s0:c150,c980
++ awk 'BEGIN { FS = ":" } ; { print $4 ":" $5 }'
+ levl=s0:c150,c980
+ append_cleanup 'auditctl -d exit,always -F arch=b32 -S close -S open -F obj_lev_high=s0:c150,c980'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    rm -f /var/lib/libvirt/images/testresource.img
	auditctl -d exit,always -F arch=b32 -S close -S open -F obj_lev_high=s0:c150,c980
    }'
+ append_cleanup 'auditctl -d exit,always -F arch=b64 -S close -S open -F obj_lev_high=s0:c150,c980'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    rm -f /var/lib/libvirt/images/testresource.img;
    auditctl -d exit,always -F arch=b32 -S close -S open -F obj_lev_high=s0:c150,c980
	auditctl -d exit,always -F arch=b64 -S close -S open -F obj_lev_high=s0:c150,c980
    }'
+ auditctl -d exit,always -F arch=b32 -S close -S open -F obj_lev_high=s0:c150,c980
Error sending delete rule data request (No such file or directory)
+ auditctl -d exit,always -F arch=b64 -S close -S open -F obj_lev_high=s0:c150,c980
Error sending delete rule data request (No such file or directory)
+ auditctl -a exit,always -F arch=b32 -S close -S open -F obj_lev_high=s0:c150,c980
+ auditctl -a exit,always -F arch=b64 -S close -S open -F obj_lev_high=s0:c150,c980
+ chcon system_u:object_r:svirt_image_t:s0:c150,c980 /var/lib/libvirt/images/testresource.img
+ qemu-img info /var/lib/libvirt/images/testresource.img
image: /var/lib/libvirt/images/testresource.img
file format: raw
virtual size: 8.0G (8589934592 bytes)
disk size: 0
+ expression=obj==system_u:object_r:svirt_image_t:s0:c150,c980
++ augrok -c --seek 28073 obj==system_u:object_r:svirt_image_t:s0:c150,c980
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
0 -eq 0 ]]
./test_auditctl_rule_obj.bash: line 51: [[: HHHHHHHHHHHHHHHHHHHH 
0: syntax error in expression (error token is "0")
+ for context in '$contexts'
++ echo system_u:object_r:svirt_image_t:s0:c628,c889
++ awk 'BEGIN { FS = ":" } ; { print $4 ":" $5 }'
+ levl=s0:c628,c889
+ append_cleanup 'auditctl -d exit,always -F arch=b32 -S close -S open -F obj_lev_high=s0:c628,c889'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    rm -f /var/lib/libvirt/images/testresource.img;
    auditctl -d exit,always -F arch=b32 -S close -S open -F obj_lev_high=s0:c150,c980;
    auditctl -d exit,always -F arch=b64 -S close -S open -F obj_lev_high=s0:c150,c980
	auditctl -d exit,always -F arch=b32 -S close -S open -F obj_lev_high=s0:c628,c889
    }'
+ append_cleanup 'auditctl -d exit,always -F arch=b64 -S close -S open -F obj_lev_high=s0:c628,c889'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    rm -f /var/lib/libvirt/images/testresource.img;
    auditctl -d exit,always -F arch=b32 -S close -S open -F obj_lev_high=s0:c150,c980;
    auditctl -d exit,always -F arch=b64 -S close -S open -F obj_lev_high=s0:c150,c980;
    auditctl -d exit,always -F arch=b32 -S close -S open -F obj_lev_high=s0:c628,c889
	auditctl -d exit,always -F arch=b64 -S close -S open -F obj_lev_high=s0:c628,c889
    }'
+ auditctl -d exit,always -F arch=b32 -S close -S open -F obj_lev_high=s0:c628,c889
Error sending delete rule data request (No such file or directory)
+ auditctl -d exit,always -F arch=b64 -S close -S open -F obj_lev_high=s0:c628,c889
Error sending delete rule data request (No such file or directory)
+ auditctl -a exit,always -F arch=b32 -S close -S open -F obj_lev_high=s0:c628,c889
+ auditctl -a exit,always -F arch=b64 -S close -S open -F obj_lev_high=s0:c628,c889
+ chcon system_u:object_r:svirt_image_t:s0:c628,c889 /var/lib/libvirt/images/testresource.img
+ qemu-img info /var/lib/libvirt/images/testresource.img
image: /var/lib/libvirt/images/testresource.img
file format: raw
virtual size: 8.0G (8589934592 bytes)
disk size: 0
+ expression=obj==system_u:object_r:svirt_image_t:s0:c628,c889
++ augrok -c --seek 28073 obj==system_u:object_r:svirt_image_t:s0:c628,c889
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
0 -eq 0 ]]
./test_auditctl_rule_obj.bash: line 51: [[: HHHHHHHHHHHHHHHHHHHH 
0: syntax error in expression (error token is "0")
+ exit_pass
+ [[ -n '' ]]
+ exit 0
+ test_cleanup
+ rm -f /tmp/tmp.kVQLOqrCXA /tmp/tmp.PuUTelXFiZ /usr/local/eal2_testing/audit-test/tmp.WyJoExzEUU
+ rm -f /var/lib/libvirt/images/testresource.img
+ auditctl -d exit,always -F arch=b32 -S close -S open -F obj_lev_high=s0:c150,c980
+ auditctl -d exit,always -F arch=b64 -S close -S open -F obj_lev_high=s0:c150,c980
+ auditctl -d exit,always -F arch=b32 -S close -S open -F obj_lev_high=s0:c628,c889
+ auditctl -d exit,always -F arch=b64 -S close -S open -F obj_lev_high=s0:c628,c889
+ exit
--- end output -------------------------------------------------------------


Testcase                                                                                      Result
--------                                                                                      ------
[2] test_libvirt_label_match.bash                                                              PASS 
--- begin output -----------------------------------------------------------
Domain KVM-Guest-1 destroyed

Domain KVM-Guest-2 destroyed

Domain KVM-Guest-1 started

Domain KVM-Guest-2 started

++ seq 1 2
+ for i in '$(seq $first $last)'
++ eval 'echo $kvm_guest_1_label_levl'
+++ echo s0:c439,c618
++ eval 'echo $kvm_guest_1_context_levl'
+++ echo s0:c439,c618
+ [[ s0:c439,c618 != s0:c439,c618 ]]
+ for i in '$(seq $first $last)'
++ eval 'echo $kvm_guest_2_label_levl'
+++ echo s0:c273,c840
++ eval 'echo $kvm_guest_2_context_levl'
+++ echo s0:c273,c840
+ [[ s0:c273,c840 != s0:c273,c840 ]]
+ exit_pass
+ [[ -n '' ]]
+ exit 0
+ test_cleanup
+ rm -f /tmp/tmp.51nOl9IzIC /tmp/tmp.S286z2PZgf /usr/local/eal2_testing/audit-test/tmp.6cK1lCxSQu
+ exit
--- end output -------------------------------------------------------------


Testcase                                                                                      Result
--------                                                                                      ------
[3] test_libvirt_label_process_unique.bash                                                     PASS 
--- begin output -----------------------------------------------------------
Domain KVM-Guest-1 destroyed

Domain KVM-Guest-2 destroyed

Domain KVM-Guest-1 started

Domain KVM-Guest-2 started

++ echo 'system_u:system_r:svirt_t:s0:c118,c941
system_u:system_r:svirt_t:s0:c205,c904
unconfined_u:unconfined_r:svirt_t:s0:c802,c1022'
++ uniq -u
+ unique_labels='system_u:system_r:svirt_t:s0:c118,c941
system_u:system_r:svirt_t:s0:c205,c904
unconfined_u:unconfined_r:svirt_t:s0:c802,c1022'
++ echo 'system_u:system_r:svirt_t:s0:c118,c941
system_u:system_r:svirt_t:s0:c205,c904
unconfined_u:unconfined_r:svirt_t:s0:c802,c1022'
++ wc -l
++ uniq -u
+ unique_labels_count=3
+ [[ 3 -eq 0 ]]
++ echo 'system_u:system_r:svirt_t:s0:c118,c941
system_u:system_r:svirt_t:s0:c205,c904
unconfined_u:unconfined_r:svirt_t:s0:c802,c1022'
++ uniq -d
+ repeated_labels=
++ echo 'system_u:system_r:svirt_t:s0:c118,c941
system_u:system_r:svirt_t:s0:c205,c904
unconfined_u:unconfined_r:svirt_t:s0:c802,c1022'
++ uniq -d
++ wc -l
+ repeated_labels_count=0
+ [[ 0 -ne 0 ]]
+ exit_pass
+ [[ -n '' ]]
+ exit 0
+ test_cleanup
+ rm -f /tmp/tmp.BW98xoKt6q /tmp/tmp.Ex85SJHfVu /usr/local/eal2_testing/audit-test/tmp.tNxxmUTqUW
+ exit
--- end output -------------------------------------------------------------


Testcase                                                                                      Result
--------                                                                                      ------
[4] test_libvirt_label_resource_unique.bash                                                    PASS 
--- begin output -----------------------------------------------------------
Domain KVM-Guest-1 destroyed

Domain KVM-Guest-2 destroyed

Domain KVM-Guest-1 started

Domain KVM-Guest-2 started

++ echo 'system_u:object_r:svirt_image_t:s0:c146,c659
system_u:object_r:svirt_image_t:s0:c480,c801'
++ sort
++ uniq -u
+ unique_contexts='system_u:object_r:svirt_image_t:s0:c146,c659
system_u:object_r:svirt_image_t:s0:c480,c801'
++ echo 'system_u:object_r:svirt_image_t:s0:c146,c659
system_u:object_r:svirt_image_t:s0:c480,c801'
++ uniq -u
++ sort
++ wc -l
+ unique_contexts_count=2
+ [[ 2 -eq 0 ]]
++ echo 'system_u:object_r:svirt_image_t:s0:c146,c659
system_u:object_r:svirt_image_t:s0:c480,c801'
++ sort
++ uniq -d
+ repeated_contexts=
++ sort
++ wc -l
++ uniq -d
++ echo 'system_u:object_r:svirt_image_t:s0:c146,c659
system_u:object_r:svirt_image_t:s0:c480,c801'
+ repeated_contexts_count=0
+ [[ 0 -ne 0 ]]
+ exit_pass
+ [[ -n '' ]]
+ exit 0
+ test_cleanup
+ rm -f /tmp/tmp.OLLEYNXWXK /tmp/tmp.3SmM3mYGFW /usr/local/eal2_testing/audit-test/tmp.e6y36XpoCY
+ exit
--- end output -------------------------------------------------------------


Testcase                                                                                      Result
--------                                                                                      ------
[5] test_selinux_trans_from_qemu.bash                                                          PASS 
--- begin output -----------------------------------------------------------
Domain KVM-Guest-1 destroyed

Domain KVM-Guest-2 destroyed

Domain KVM-Guest-1 started

Domain KVM-Guest-2 started

++ sesearch -s qemu_t -c process -p transition --allow
./test_selinux_trans_from_qemu.bash: line 30: sesearch: command not found
+ allowed=
++ echo ''
++ grep -E '^.*allow'
+ allowed=
++ echo ''
++ awk '{ print $3 }'
+ allowed=
++ echo ''
++ sed /lspp_harness_t/d
+ allowed=
++ echo ''
++ wc -l
+ allowed_count=1
+ [[ 1 -eq 0 ]]
+ exit_pass
+ [[ -n '' ]]
+ exit 0
+ test_cleanup
+ rm -f /tmp/tmp.V6ujMecWRc /tmp/tmp.YgOjpzj7M7 /usr/local/eal2_testing/audit-test/tmp.jCewhQkg6o
+ exit
--- end output -------------------------------------------------------------


Testcase                                                                                      Result
--------                                                                                      ------
[6] test_selinux_trans_from_svirt.bash                                                         PASS 
--- begin output -----------------------------------------------------------
Domain KVM-Guest-1 destroyed

Domain KVM-Guest-2 destroyed

Domain KVM-Guest-1 started

Domain KVM-Guest-2 started

++ sesearch -s svirt_t -c process -p transition --allow
./test_selinux_trans_from_svirt.bash: line 30: sesearch: command not found
+ allowed=
++ echo ''
++ grep -E '^.*allow'
+ allowed=
++ echo ''
++ awk '{ print $3 }'
+ allowed=
++ echo ''
++ sed /lspp_harness_t/d
+ allowed=
++ echo ''
++ wc -l
+ allowed_count=1
+ [[ 1 -eq 0 ]]
+ exit_pass
+ [[ -n '' ]]
+ exit 0
+ test_cleanup
+ rm -f /tmp/tmp.r5mxCX8SVD /tmp/tmp.CGl0uRU6do /usr/local/eal2_testing/audit-test/tmp.MTvRbxONDc
+ exit
--- end output -------------------------------------------------------------


Testcase                                                                                      Result
--------                                                                                      ------
[7] test_selinux_trans_to_qemu.bash                                                            PASS 
--- begin output -----------------------------------------------------------
Domain KVM-Guest-1 destroyed

Domain KVM-Guest-2 destroyed

Domain KVM-Guest-1 started

Domain KVM-Guest-2 started

++ sesearch -t qemu_t -c process -p transition --allow
./test_selinux_trans_to_qemu.bash: line 30: sesearch: command not found
+ allowed=
++ echo ''
++ grep -E '^.*allow'
+ allowed=
++ echo ''
++ awk '{ print $2 }'
+ allowed=
++ echo ''
++ sed /lspp_harness_t/d
+ allowed=
++ echo ''
++ wc -l
+ allowed_count=1
+ [[ 1 -eq 0 ]]
+ exit_pass
+ [[ -n '' ]]
+ exit 0
+ test_cleanup
+ rm -f /tmp/tmp.I73Obom6o4 /tmp/tmp.NUqrWJKcN1 /usr/local/eal2_testing/audit-test/tmp.l73WyfcYRe
+ exit
--- end output -------------------------------------------------------------


Testcase                                                                                      Result
--------                                                                                      ------
[8] test_selinux_trans_to_svirt.bash                                                           PASS 
--- begin output -----------------------------------------------------------
Domain KVM-Guest-1 destroyed

Domain KVM-Guest-2 destroyed

Domain KVM-Guest-1 started

Domain KVM-Guest-2 started

++ sesearch -t svirt_t -c process -p transition --allow
./test_selinux_trans_to_svirt.bash: line 30: sesearch: command not found
+ allowed=
++ echo ''
++ grep -E '^.*allow'
+ allowed=
++ echo ''
++ awk '{ print $2 }'
+ allowed=
++ echo ''
++ sed /lspp_harness_t/d
+ allowed=
++ echo ''
++ wc -l
+ allowed_count=1
+ [[ 1 -eq 0 ]]
+ exit_pass
+ [[ -n '' ]]
+ exit 0
+ test_cleanup
+ rm -f /tmp/tmp.8ojpfLzwKr /tmp/tmp.7p30jn4CV4 /usr/local/eal2_testing/audit-test/tmp.AHX2zBywpN
+ exit
--- end output -------------------------------------------------------------


Testcase                                                                                      Result
--------                                                                                      ------
[9] test_selinux_attr_virt_domain.bash                                                         PASS 
--- begin output -----------------------------------------------------------
Domain KVM-Guest-1 destroyed

Domain KVM-Guest-2 destroyed

Domain KVM-Guest-1 started

Domain KVM-Guest-2 started

++ seinfo -avirt_domain -x
./test_selinux_attr_virt_domain.bash: line 30: seinfo: command not found
+ types=
++ echo ''
++ sed /virt_domain/d
+ types=
++ echo ''
++ wc -l
+ types_count=1
+ [[ 1 -eq 0 ]]
+ exit_pass
+ [[ -n '' ]]
+ exit 0
+ test_cleanup
+ rm -f /tmp/tmp.atTrgE9YyR /tmp/tmp.fY6bhnfZah /usr/local/eal2_testing/audit-test/tmp.u7UcoUHgr4
+ exit
--- end output -------------------------------------------------------------


Testcase                                                                                      Result
--------                                                                                      ------
[10] test_selinux_attr_virt_image_type.bash                                                    PASS 
--- begin output -----------------------------------------------------------
Domain KVM-Guest-1 destroyed

Domain KVM-Guest-2 destroyed

Domain KVM-Guest-1 started

Domain KVM-Guest-2 started

++ seinfo -avirt_image_type -x
./test_selinux_attr_virt_image_type.bash: line 30: seinfo: command not found
+ types=
++ echo ''
++ sed /virt_image_type/d
+ types=
++ echo ''
++ wc -l
+ types_count=1
+ [[ 1 -eq 0 ]]
+ exit_pass
+ [[ -n '' ]]
+ exit 0
+ test_cleanup
+ rm -f /tmp/tmp.jhQfap81qu /tmp/tmp.KAP3yXdWki /usr/local/eal2_testing/audit-test/tmp.1gxWP9sro3
+ exit
--- end output -------------------------------------------------------------


Testcase                                                                                      Result
--------                                                                                      ------
[11] test_network_export_other_source_ip.exp                                                   PASS 
--- begin output -----------------------------------------------------------
Domain KVM-Guest-1 destroyed

Domain KVM-Guest-2 destroyed

Domain KVM-Guest-1 started

Domain KVM-Guest-2 started

spawn ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null root@192.168.129.129
Warning: Permanently added '192.168.129.129' (ECDSA) to the list of known hosts.
root@192.168.129.129's password: 
]0;root@localhost:~[?1034h[root@localhost ~]# ping -c 5 -I 192.168.128.128 192.168.129.1
bind: Cannot assign requested address
]0;root@localhost:~[root@localhost ~]# echo $?
2
]0;root@localhost:~[root@localhost ~]# ping -c 5 -I 192.168.129.129 192.168.129.1
PING 192.168.129.1 (192.168.129.1) from 192.168.129.129 : 56(84) bytes of data.
64 bytes from 192.168.129.1: icmp_seq=1 ttl=64 time=0.144 ms
64 bytes from 192.168.129.1: icmp_seq=2 ttl=64 time=0.164 ms
64 bytes from 192.168.129.1: icmp_seq=3 ttl=64 time=0.096 ms
64 bytes from 192.168.129.1: icmp_seq=4 ttl=64 time=0.099 ms
64 bytes from 192.168.129.1: icmp_seq=5 ttl=64 time=0.105 ms

--- 192.168.129.1 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4000ms
rtt min/avg/max/mdev = 0.096/0.121/0.164/0.029 ms
]0;root@localhost:~[root@localhost ~]# echo $?
0
]0;root@localhost:~[root@localhost ~]# 
--- end output -------------------------------------------------------------


Testcase                                                                                      Result
--------                                                                                      ------
[12] test_network_export_source_ip.bash                                                        PASS 
--- begin output -----------------------------------------------------------
Domain KVM-Guest-1 destroyed

Domain KVM-Guest-2 destroyed

Domain KVM-Guest-1 started

Domain KVM-Guest-2 started

+ append_cleanup 'iptables-save | xtables_empty | iptables-restore'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp"
	iptables-save | xtables_empty | iptables-restore
    }'
++ seq 1 2
+ for i in '$(seq $first $last)'
+ iptables-save
+ xtables_empty
+ iptables-restore
+ sed 's/DROP/ACCEPT/ ; s/\[[0-9]*:[0-9]*\]/\[0:0\]/'
+ grep -e '^\*' -e '^:[^ ]* [^-]' -e '^COMMIT$'
+ eval 'ping -c 5 -I $kvm_guest_1_hostaddr $kvm_guest_1_hostaddr'
++ ping -c 5 -I 192.168.128.1 192.168.128.1
PING 192.168.128.1 (192.168.128.1) from 192.168.128.1 : 56(84) bytes of data.
64 bytes from 192.168.128.1: icmp_seq=1 ttl=64 time=0.080 ms
64 bytes from 192.168.128.1: icmp_seq=2 ttl=64 time=0.073 ms
64 bytes from 192.168.128.1: icmp_seq=3 ttl=64 time=0.066 ms
64 bytes from 192.168.128.1: icmp_seq=4 ttl=64 time=0.029 ms
64 bytes from 192.168.128.1: icmp_seq=5 ttl=64 time=0.082 ms

--- 192.168.128.1 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 3999ms
rtt min/avg/max/mdev = 0.029/0.066/0.082/0.019 ms
+ [[ 0 -ne 0 ]]
++ seq 1 5
+ for i in '$(seq 1 $kvm_guest_timeout)'
+ eval 'ping -c 5 -I $kvm_guest_1_hostaddr $kvm_guest_1_addr'
++ ping -c 5 -I 192.168.128.1 192.168.128.128
PING 192.168.128.128 (192.168.128.128) from 192.168.128.1 : 56(84) bytes of data.

--- 192.168.128.128 ping statistics ---
5 packets transmitted, 0 received, 100% packet loss, time 4000ms

+ [[ 1 -eq 0 ]]
+ sleep 60
+ for i in '$(seq 1 $kvm_guest_timeout)'
+ eval 'ping -c 5 -I $kvm_guest_2_hostaddr $kvm_guest_2_addr'
++ ping -c 5 -I 192.168.129.1 192.168.129.129
PING 192.168.129.129 (192.168.129.129) from 192.168.129.1 : 56(84) bytes of data.
64 bytes from 192.168.129.129: icmp_seq=1 ttl=64 time=0.243 ms
64 bytes from 192.168.129.129: icmp_seq=2 ttl=64 time=0.133 ms
64 bytes from 192.168.129.129: icmp_seq=3 ttl=64 time=0.150 ms
64 bytes from 192.168.129.129: icmp_seq=4 ttl=64 time=0.122 ms
64 bytes from 192.168.129.129: icmp_seq=5 ttl=64 time=0.173 ms

--- 192.168.129.129 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 3999ms
rtt min/avg/max/mdev = 0.122/0.164/0.243/0.043 ms
+ [[ 0 -eq 0 ]]
+ break
++ tr -cd 0-9A-Za-z
++ head -c 27
+ log_prefix=QrO24SwsvTe11DmR2LZuDPZpo0M
+ eval 'iptables -A INPUT -s $kvm_guest_2_addr -p icmp --icmp-type echo-reply -j LOG --log-level=1 --log-prefix="QrO24SwsvTe11DmR2LZuDPZpo0M: "'
++ iptables -A INPUT -s 192.168.129.129 -p icmp --icmp-type echo-reply -j LOG --log-level=1 '--log-prefix=QrO24SwsvTe11DmR2LZuDPZpo0M: '
+ eval 'iptables -A INPUT -s $kvm_guest_2_addr -p icmp --icmp-type echo-reply -j DROP'
++ iptables -A INPUT -s 192.168.129.129 -p icmp --icmp-type echo-reply -j DROP
+ eval 'ping -c 5 -I $kvm_guest_2_hostaddr $kvm_guest_2_hostaddr'
++ ping -c 5 -I 192.168.129.1 192.168.129.1
PING 192.168.129.1 (192.168.129.1) from 192.168.129.1 : 56(84) bytes of data.
64 bytes from 192.168.129.1: icmp_seq=1 ttl=64 time=0.096 ms
64 bytes from 192.168.129.1: icmp_seq=2 ttl=64 time=0.033 ms
64 bytes from 192.168.129.1: icmp_seq=3 ttl=64 time=0.068 ms
64 bytes from 192.168.129.1: icmp_seq=4 ttl=64 time=0.025 ms
64 bytes from 192.168.129.1: icmp_seq=5 ttl=64 time=0.023 ms

--- 192.168.129.1 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4000ms
rtt min/avg/max/mdev = 0.023/0.049/0.096/0.028 ms
+ [[ 0 -ne 0 ]]
+ eval 'ping -c 5 -I $kvm_guest_2_hostaddr $kvm_guest_2_addr'
++ ping -c 5 -I 192.168.129.1 192.168.129.129
PING 192.168.129.129 (192.168.129.129) from 192.168.129.1 : 56(84) bytes of data.

--- 192.168.129.129 ping statistics ---
5 packets transmitted, 0 received, 100% packet loss, time 3999ms

+ [[ 1 -eq 0 ]]
++ eval 'grep -c -E "QrO24SwsvTe11DmR2LZuDPZpo0M: .* SRC=$kvm_guest_2_addr" /var/log/messages'
+++ grep -c -E 'QrO24SwsvTe11DmR2LZuDPZpo0M: .* SRC=192.168.129.129' /var/log/messages
+ log_count=5
+ [[ 5 -eq 0 ]]
+ for i in '$(seq $first $last)'
+ iptables-save
+ xtables_empty
+ iptables-restore
+ grep -e '^\*' -e '^:[^ ]* [^-]' -e '^COMMIT$'
+ sed 's/DROP/ACCEPT/ ; s/\[[0-9]*:[0-9]*\]/\[0:0\]/'
+ eval 'ping -c 5 -I $kvm_guest_2_hostaddr $kvm_guest_2_hostaddr'
++ ping -c 5 -I 192.168.129.1 192.168.129.1
PING 192.168.129.1 (192.168.129.1) from 192.168.129.1 : 56(84) bytes of data.
64 bytes from 192.168.129.1: icmp_seq=1 ttl=64 time=0.095 ms
64 bytes from 192.168.129.1: icmp_seq=2 ttl=64 time=0.026 ms
64 bytes from 192.168.129.1: icmp_seq=3 ttl=64 time=0.019 ms
64 bytes from 192.168.129.1: icmp_seq=4 ttl=64 time=0.020 ms
64 bytes from 192.168.129.1: icmp_seq=5 ttl=64 time=0.019 ms

--- 192.168.129.1 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4000ms
rtt min/avg/max/mdev = 0.019/0.035/0.095/0.030 ms
+ [[ 0 -ne 0 ]]
++ seq 1 5
+ for i in '$(seq 1 $kvm_guest_timeout)'
+ eval 'ping -c 5 -I $kvm_guest_1_hostaddr $kvm_guest_1_addr'
++ ping -c 5 -I 192.168.128.1 192.168.128.128
PING 192.168.128.128 (192.168.128.128) from 192.168.128.1 : 56(84) bytes of data.
64 bytes from 192.168.128.128: icmp_seq=1 ttl=64 time=0.262 ms
64 bytes from 192.168.128.128: icmp_seq=2 ttl=64 time=0.086 ms
64 bytes from 192.168.128.128: icmp_seq=3 ttl=64 time=0.090 ms
64 bytes from 192.168.128.128: icmp_seq=4 ttl=64 time=0.152 ms
64 bytes from 192.168.128.128: icmp_seq=5 ttl=64 time=0.106 ms

--- 192.168.128.128 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 4000ms
rtt min/avg/max/mdev = 0.086/0.139/0.262/0.066 ms
+ [[ 0 -eq 0 ]]
+ break
++ tr -cd 0-9A-Za-z
++ head -c 27
+ log_prefix=tRh2vb2rCFXMGkmDG3m68EzcG8H
+ eval 'iptables -A INPUT -s $kvm_guest_1_addr -p icmp --icmp-type echo-reply -j LOG --log-level=1 --log-prefix="tRh2vb2rCFXMGkmDG3m68EzcG8H: "'
++ iptables -A INPUT -s 192.168.128.128 -p icmp --icmp-type echo-reply -j LOG --log-level=1 '--log-prefix=tRh2vb2rCFXMGkmDG3m68EzcG8H: '
+ eval 'iptables -A INPUT -s $kvm_guest_1_addr -p icmp --icmp-type echo-reply -j DROP'
++ iptables -A INPUT -s 192.168.128.128 -p icmp --icmp-type echo-reply -j DROP
+ eval 'ping -c 5 -I $kvm_guest_1_hostaddr $kvm_guest_1_hostaddr'
++ ping -c 5 -I 192.168.128.1 192.168.128.1
PING 192.168.128.1 (192.168.128.1) from 192.168.128.1 : 56(84) bytes of data.
64 bytes from 192.168.128.1: icmp_seq=1 ttl=64 time=0.073 ms
64 bytes from 192.168.128.1: icmp_seq=2 ttl=64 time=0.026 ms
64 bytes from 192.168.128.1: icmp_seq=3 ttl=64 time=0.021 ms
64 bytes from 192.168.128.1: icmp_seq=4 ttl=64 time=0.020 ms
64 bytes from 192.168.128.1: icmp_seq=5 ttl=64 time=0.019 ms

--- 192.168.128.1 ping statistics ---
5 packets transmitted, 5 received, 0% packet loss, time 3999ms
rtt min/avg/max/mdev = 0.019/0.031/0.073/0.021 ms
+ [[ 0 -ne 0 ]]
+ eval 'ping -c 5 -I $kvm_guest_1_hostaddr $kvm_guest_1_addr'
++ ping -c 5 -I 192.168.128.1 192.168.128.128
PING 192.168.128.128 (192.168.128.128) from 192.168.128.1 : 56(84) bytes of data.

--- 192.168.128.128 ping statistics ---
5 packets transmitted, 0 received, 100% packet loss, time 3999ms

+ [[ 1 -eq 0 ]]
++ eval 'grep -c -E "tRh2vb2rCFXMGkmDG3m68EzcG8H: .* SRC=$kvm_guest_1_addr" /var/log/messages'
+++ grep -c -E 'tRh2vb2rCFXMGkmDG3m68EzcG8H: .* SRC=192.168.128.128' /var/log/messages
+ log_count=5
+ [[ 5 -eq 0 ]]
+ exit_pass
+ [[ -n '' ]]
+ exit 0
+ test_cleanup
+ rm -f /tmp/tmp.u7ROyp21D4 /tmp/tmp.Aj17SwVes0 /usr/local/eal2_testing/audit-test/tmp.vTopSb74HH
+ iptables-save
+ xtables_empty
+ iptables-restore
+ grep -e '^\*' -e '^:[^ ]* [^-]' -e '^COMMIT$'
+ sed 's/DROP/ACCEPT/ ; s/\[[0-9]*:[0-9]*\]/\[0:0\]/'
+ exit
--- end output -------------------------------------------------------------


Testcase                                                                                      Result
--------                                                                                      ------
[13] test_selinux_ipc_signals.bash                                                             PASS 
--- begin output -----------------------------------------------------------
Domain KVM-Guest-1 destroyed

Domain KVM-Guest-2 destroyed

Domain KVM-Guest-1 started

Domain KVM-Guest-2 started

++ echo '11105
11177
28455'
++ wc -l
+ pids_count=3
++ mktemp test_selinux_ipc_signals_killXXXXXX
+ kill_file=test_selinux_ipc_signals_killeBdbQA
+ append_cleanup 'rm -f test_selinux_ipc_signals_killeBdbQA'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp"
	rm -f test_selinux_ipc_signals_killeBdbQA
    }'
+ rm -f test_selinux_ipc_signals_killeBdbQA
+ cp -p /bin/kill test_selinux_ipc_signals_killeBdbQA
+ chcon -t qemu_exec_t test_selinux_ipc_signals_killeBdbQA
+ for pid in '$pids'
++ stat -c %s /var/log/audit/audit.log
+ offset=350472
+ runcon -t svirt_t -- ./test_selinux_ipc_signals_killeBdbQA -9 11105
test_selinux_ipc_signals_killeBdbQA: sending signal to 11105 failed: Operation not permitted
+ [[ 1 -eq 0 ]]
+ expression='type==AVC and extra_text=~denied and comm=~test_selinux.* and scontext=~svirt_t'
++ augrok -c --seek 350472 type==AVC and 'extra_text=~denied' and 'comm=~test_selinux.*' and 'scontext=~svirt_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
1 -eq 0 ]]
./test_selinux_ipc_signals.bash: line 54: [[: HHHHHHHHHHHHHHHHHHHH 
1: syntax error in expression (error token is "1")
+ expression='type==SYSCALL and syscall==62 and success==no and a1==9 and comm=~test_selinux.* and subj=~svirt_t'
++ augrok -c --seek 350472 type==SYSCALL and syscall==62 and success==no and a1==9 and 'comm=~test_selinux.*' and 'subj=~svirt_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
1 -eq 0 ]]
./test_selinux_ipc_signals.bash: line 60: [[: HHHHHHHHHHHHHHHHHHHH 
1: syntax error in expression (error token is "1")
+ runcon -t svirt_t -- ./test_selinux_ipc_signals_killeBdbQA -19 11105
test_selinux_ipc_signals_killeBdbQA: sending signal to 11105 failed: Operation not permitted
+ [[ 1 -eq 0 ]]
+ expression='type==AVC and extra_text=~denied and comm=~test_selinux.* and scontext=~svirt_t'
++ augrok -c --seek 350472 type==AVC and 'extra_text=~denied' and 'comm=~test_selinux.*' and 'scontext=~svirt_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
2 -lt 2 ]]
./test_selinux_ipc_signals.bash: line 72: [[: HHHHHHHHHHHHHHHHHHHH 
2: syntax error in expression (error token is "2")
+ expression='type==SYSCALL and syscall==62 and success==no and a1==13 and comm=~test_selinux.* and subj=~svirt_t'
++ augrok -c --seek 350472 type==SYSCALL and syscall==62 and success==no and a1==13 and 'comm=~test_selinux.*' and 'subj=~svirt_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
1 -eq 0 ]]
./test_selinux_ipc_signals.bash: line 78: [[: HHHHHHHHHHHHHHHHHHHH 
1: syntax error in expression (error token is "1")
+ for pid in '$pids'
++ stat -c %s /var/log/audit/audit.log
+ offset=352116
+ runcon -t svirt_t -- ./test_selinux_ipc_signals_killeBdbQA -9 11177
test_selinux_ipc_signals_killeBdbQA: sending signal to 11177 failed: Operation not permitted
+ [[ 1 -eq 0 ]]
+ expression='type==AVC and extra_text=~denied and comm=~test_selinux.* and scontext=~svirt_t'
++ augrok -c --seek 352116 type==AVC and 'extra_text=~denied' and 'comm=~test_selinux.*' and 'scontext=~svirt_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
1 -eq 0 ]]
./test_selinux_ipc_signals.bash: line 54: [[: HHHHHHHHHHHHHHHHHHHH 
1: syntax error in expression (error token is "1")
+ expression='type==SYSCALL and syscall==62 and success==no and a1==9 and comm=~test_selinux.* and subj=~svirt_t'
++ augrok -c --seek 352116 type==SYSCALL and syscall==62 and success==no and a1==9 and 'comm=~test_selinux.*' and 'subj=~svirt_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
1 -eq 0 ]]
./test_selinux_ipc_signals.bash: line 60: [[: HHHHHHHHHHHHHHHHHHHH 
1: syntax error in expression (error token is "1")
+ runcon -t svirt_t -- ./test_selinux_ipc_signals_killeBdbQA -19 11177
test_selinux_ipc_signals_killeBdbQA: sending signal to 11177 failed: Operation not permitted
+ [[ 1 -eq 0 ]]
+ expression='type==AVC and extra_text=~denied and comm=~test_selinux.* and scontext=~svirt_t'
++ augrok -c --seek 352116 type==AVC and 'extra_text=~denied' and 'comm=~test_selinux.*' and 'scontext=~svirt_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
2 -lt 2 ]]
./test_selinux_ipc_signals.bash: line 72: [[: HHHHHHHHHHHHHHHHHHHH 
2: syntax error in expression (error token is "2")
+ expression='type==SYSCALL and syscall==62 and success==no and a1==13 and comm=~test_selinux.* and subj=~svirt_t'
++ augrok -c --seek 352116 type==SYSCALL and syscall==62 and success==no and a1==13 and 'comm=~test_selinux.*' and 'subj=~svirt_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
1 -eq 0 ]]
./test_selinux_ipc_signals.bash: line 78: [[: HHHHHHHHHHHHHHHHHHHH 
1: syntax error in expression (error token is "1")
+ for pid in '$pids'
++ stat -c %s /var/log/audit/audit.log
+ offset=353760
+ runcon -t svirt_t -- ./test_selinux_ipc_signals_killeBdbQA -9 28455
test_selinux_ipc_signals_killeBdbQA: sending signal to 28455 failed: Operation not permitted
+ [[ 1 -eq 0 ]]
+ expression='type==AVC and extra_text=~denied and comm=~test_selinux.* and scontext=~svirt_t'
++ augrok -c --seek 353760 type==AVC and 'extra_text=~denied' and 'comm=~test_selinux.*' and 'scontext=~svirt_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
1 -eq 0 ]]
./test_selinux_ipc_signals.bash: line 54: [[: HHHHHHHHHHHHHHHHHHHH 
1: syntax error in expression (error token is "1")
+ expression='type==SYSCALL and syscall==62 and success==no and a1==9 and comm=~test_selinux.* and subj=~svirt_t'
++ augrok -c --seek 353760 type==SYSCALL and syscall==62 and success==no and a1==9 and 'comm=~test_selinux.*' and 'subj=~svirt_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
1 -eq 0 ]]
./test_selinux_ipc_signals.bash: line 60: [[: HHHHHHHHHHHHHHHHHHHH 
1: syntax error in expression (error token is "1")
+ runcon -t svirt_t -- ./test_selinux_ipc_signals_killeBdbQA -19 28455
test_selinux_ipc_signals_killeBdbQA: sending signal to 28455 failed: Operation not permitted
+ [[ 1 -eq 0 ]]
+ expression='type==AVC and extra_text=~denied and comm=~test_selinux.* and scontext=~svirt_t'
++ augrok -c --seek 353760 type==AVC and 'extra_text=~denied' and 'comm=~test_selinux.*' and 'scontext=~svirt_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
2 -lt 2 ]]
./test_selinux_ipc_signals.bash: line 72: [[: HHHHHHHHHHHHHHHHHHHH 
2: syntax error in expression (error token is "2")
+ expression='type==SYSCALL and syscall==62 and success==no and a1==13 and comm=~test_selinux.* and subj=~svirt_t'
++ augrok -c --seek 353760 type==SYSCALL and syscall==62 and success==no and a1==13 and 'comm=~test_selinux.*' and 'subj=~svirt_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
1 -eq 0 ]]
./test_selinux_ipc_signals.bash: line 78: [[: HHHHHHHHHHHHHHHHHHHH 
1: syntax error in expression (error token is "1")
++ ps -C qemu-kvm -o pid=
++ wc -l
+ _pids_count=3
+ [[ 3 -ne 3 ]]
+ exit_pass
+ [[ -n '' ]]
+ exit 0
+ test_cleanup
+ rm -f /tmp/tmp.JI7ypohXkA /tmp/tmp.IzS5zPJFOH /usr/local/eal2_testing/audit-test/tmp.taYnMNbT7N
+ rm -f test_selinux_ipc_signals_killeBdbQA
+ exit
--- end output -------------------------------------------------------------


Testcase                                                                                      Result
--------                                                                                      ------
[14] test_network_import_other_dest_ip.exp                                                     PASS 
--- begin output -----------------------------------------------------------
Domain KVM-Guest-1 destroyed

Domain KVM-Guest-2 destroyed

Domain KVM-Guest-1 started

Domain KVM-Guest-2 started

spawn ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null root@192.168.129.129
Warning: Permanently added '192.168.129.129' (ECDSA) to the list of known hosts.
root@192.168.129.129's password: 
Last login: Tue Jun 29 07:41:32 2021 from gateway
]0;root@localhost:~[?1034h[root@localhost ~]# iptables -A INPUT -s 192.168.128.1 -p icmp --icmp-type echo-reply -j LOG --log-l evel=1 --log-prefix="20210629134513: "
]0;root@localhost:~[root@localhost ~]# grep -c -E "20210629134513: .* SRC=$kvm_guest_1_addr" /var/log/messages
0
]0;root@localhost:~[root@localhost ~]# 
--- end output -------------------------------------------------------------


Testcase                                                                                      Result
--------                                                                                      ------
[15] test_selinux_chcon_resource.bash                                                          PASS 
--- begin output -----------------------------------------------------------
Domain KVM-Guest-1 destroyed

Domain KVM-Guest-2 destroyed

Domain KVM-Guest-1 started

Domain KVM-Guest-2 started

+ append_cleanup 'killall -9 -u testuser1; userdel -fr testuser1'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp"
	killall -9 -u testuser1; userdel -fr testuser1
    }'
+ append_cleanup 'groupdel testuser1'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    killall -9 -u testuser1;
    userdel -fr testuser1
	groupdel testuser1
    }'
+ userdel -fr testuser1
userdel: user 'testuser1' does not exist
+ groupdel testuser1
groupdel: group 'testuser1' does not exist
+ useradd testuser1 -G libvirt
+ [[ 0 -ne 0 ]]
+ append_cleanup 'killall -9 -u testuser2; userdel -fr testuser2'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    killall -9 -u testuser1;
    userdel -fr testuser1;
    groupdel testuser1
	killall -9 -u testuser2; userdel -fr testuser2
    }'
+ append_cleanup 'groupdel testuser2'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    killall -9 -u testuser1;
    userdel -fr testuser1;
    groupdel testuser1;
    killall -9 -u testuser2;
    userdel -fr testuser2
	groupdel testuser2
    }'
+ userdel -fr testuser2
userdel: user 'testuser2' does not exist
+ groupdel testuser2
groupdel: group 'testuser2' does not exist
+ useradd testuser2
+ [[ 0 -ne 0 ]]
++ seq 1 2
+ for i in '$(seq $first $last)'
++ stat -c %s /var/log/audit/audit.log
+ offset=409000
+ [[ capp == lspp ]]
+ eval 'runcon -u system_u -r system_r -t initrc_t -- runcon -t virtd_t --         runcon -t qemu_t -- chcon -l s0:c1,c3 /var/lib/libvirt/images/KVM-Guest-1.img'
++ runcon -u system_u -r system_r -t initrc_t -- runcon -t virtd_t -- runcon -t qemu_t -- chcon -l s0:c1,c3 /var/lib/libvirt/images/KVM-Guest-1.img
runcon: runcon: Permission denied
+ [[ 126 -eq 0 ]]
+ expression='type==AVC and extra_text=~denied and comm==runcon and scontext=~(qemu_t|svirt_t)'
++ augrok -c --seek 409000 type==AVC and 'extra_text=~denied' and comm==runcon and 'scontext=~(qemu_t|svirt_t)'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
0 -eq 0 ]]
./test_selinux_chcon_resource.bash: line 70: [[: HHHHHHHHHHHHHHHHHHHH 
0: syntax error in expression (error token is "0")
+ [[ capp == lspp ]]
+ expression='type==SYSCALL syscall==59 and success==no and comm==runcon and subj=~virtd_t'
++ augrok -c --seek 409000 type==SYSCALL syscall==59 and success==no and comm==runcon and 'subj=~virtd_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
0 -eq 0 ]]
./test_selinux_chcon_resource.bash: line 80: [[: HHHHHHHHHHHHHHHHHHHH 
0: syntax error in expression (error token is "0")
++ stat -c %s /var/log/audit/audit.log
+ offset=410754
+ [[ capp == lspp ]]
+ eval 'runcon -u system_u -r system_r -t initrc_t -- runcon -t virtd_t --         runcon -t svirt_t -- chcon -l s0:c1,c3 /var/lib/libvirt/images/KVM-Guest-1.img'
++ runcon -u system_u -r system_r -t initrc_t -- runcon -t virtd_t -- runcon -t svirt_t -- chcon -l s0:c1,c3 /var/lib/libvirt/images/KVM-Guest-1.img
runcon: runcon: Permission denied
+ [[ 126 -eq 0 ]]
+ expression='type==AVC and extra_text=~denied and comm==runcon and scontext=~svirt_t'
++ augrok -c --seek 410754 type==AVC and 'extra_text=~denied' and comm==runcon and 'scontext=~svirt_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
0 -eq 0 ]]
./test_selinux_chcon_resource.bash: line 102: [[: HHHHHHHHHHHHHHHHHHHH 
0: syntax error in expression (error token is "0")
+ [[ capp == lspp ]]
+ expression='type==SYSCALL syscall==59 and success==no and comm==runcon and subj=~virtd_t'
++ augrok -c --seek 410754 type==SYSCALL syscall==59 and success==no and comm==runcon and 'subj=~virtd_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
0 -eq 0 ]]
./test_selinux_chcon_resource.bash: line 112: [[: HHHHHHHHHHHHHHHHHHHH 
0: syntax error in expression (error token is "0")
+ eval '/bin/su - testuser1 -c "chcon -l s0:c1,c3 $kvm_guest_1_resource"'
++ /bin/su - testuser1 -c 'chcon -l s0:c1,c3 /var/lib/libvirt/images/KVM-Guest-1.img'
chcon: failed to change context of ‘/var/lib/libvirt/images/KVM-Guest-1.img’ to ‘system_u:object_r:svirt_image_t:s0:c1,c3’: Operation not permitted
+ [[ 1 -eq 0 ]]
+ eval '/bin/su - testuser2 -c "chcon -l s0:c1,c3 $kvm_guest_1_resource"'
++ /bin/su - testuser2 -c 'chcon -l s0:c1,c3 /var/lib/libvirt/images/KVM-Guest-1.img'
chcon: failed to change context of ‘/var/lib/libvirt/images/KVM-Guest-1.img’ to ‘system_u:object_r:svirt_image_t:s0:c1,c3’: Operation not permitted
+ [[ 1 -eq 0 ]]
+ for i in '$(seq $first $last)'
++ stat -c %s /var/log/audit/audit.log
+ offset=414852
+ [[ capp == lspp ]]
+ eval 'runcon -u system_u -r system_r -t initrc_t -- runcon -t virtd_t --         runcon -t qemu_t -- chcon -l s0:c1,c3 /var/lib/libvirt/images/KVM-Guest-1.img'
++ runcon -u system_u -r system_r -t initrc_t -- runcon -t virtd_t -- runcon -t qemu_t -- chcon -l s0:c1,c3 /var/lib/libvirt/images/KVM-Guest-1.img
runcon: runcon: Permission denied
+ [[ 126 -eq 0 ]]
+ expression='type==AVC and extra_text=~denied and comm==runcon and scontext=~(qemu_t|svirt_t)'
++ augrok -c --seek 414852 type==AVC and 'extra_text=~denied' and comm==runcon and 'scontext=~(qemu_t|svirt_t)'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
0 -eq 0 ]]
./test_selinux_chcon_resource.bash: line 70: [[: HHHHHHHHHHHHHHHHHHHH 
0: syntax error in expression (error token is "0")
+ [[ capp == lspp ]]
+ expression='type==SYSCALL syscall==59 and success==no and comm==runcon and subj=~virtd_t'
++ augrok -c --seek 414852 type==SYSCALL syscall==59 and success==no and comm==runcon and 'subj=~virtd_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
0 -eq 0 ]]
./test_selinux_chcon_resource.bash: line 80: [[: HHHHHHHHHHHHHHHHHHHH 
0: syntax error in expression (error token is "0")
++ stat -c %s /var/log/audit/audit.log
+ offset=416690
+ [[ capp == lspp ]]
+ eval 'runcon -u system_u -r system_r -t initrc_t -- runcon -t virtd_t --         runcon -t svirt_t -- chcon -l s0:c1,c3 /var/lib/libvirt/images/KVM-Guest-1.img'
++ runcon -u system_u -r system_r -t initrc_t -- runcon -t virtd_t -- runcon -t svirt_t -- chcon -l s0:c1,c3 /var/lib/libvirt/images/KVM-Guest-1.img
runcon: runcon: Permission denied
+ [[ 126 -eq 0 ]]
+ expression='type==AVC and extra_text=~denied and comm==runcon and scontext=~svirt_t'
++ augrok -c --seek 416690 type==AVC and 'extra_text=~denied' and comm==runcon and 'scontext=~svirt_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
0 -eq 0 ]]
./test_selinux_chcon_resource.bash: line 102: [[: HHHHHHHHHHHHHHHHHHHH 
0: syntax error in expression (error token is "0")
+ [[ capp == lspp ]]
+ expression='type==SYSCALL syscall==59 and success==no and comm==runcon and subj=~virtd_t'
++ augrok -c --seek 416690 type==SYSCALL syscall==59 and success==no and comm==runcon and 'subj=~virtd_t'
Use of uninitialized value $config in open at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Use of uninitialized value $config in concatenation (.) or string at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
Can't open  at /usr/local/eal2_testing/audit-test/utils/augrok line 209.
+ [[ HHHHHHHHHHHHHHHHHHHH 
0 -eq 0 ]]
./test_selinux_chcon_resource.bash: line 112: [[: HHHHHHHHHHHHHHHHHHHH 
0: syntax error in expression (error token is "0")
+ eval '/bin/su - testuser1 -c "chcon -l s0:c1,c3 $kvm_guest_2_resource"'
++ /bin/su - testuser1 -c 'chcon -l s0:c1,c3 /var/lib/libvirt/images/KVM-Guest-2.img'
chcon: failed to change context of ‘/var/lib/libvirt/images/KVM-Guest-2.img’ to ‘system_u:object_r:svirt_image_t:s0:c1,c3’: Operation not permitted
+ [[ 1 -eq 0 ]]
+ eval '/bin/su - testuser2 -c "chcon -l s0:c1,c3 $kvm_guest_2_resource"'
++ /bin/su - testuser2 -c 'chcon -l s0:c1,c3 /var/lib/libvirt/images/KVM-Guest-2.img'
chcon: failed to change context of ‘/var/lib/libvirt/images/KVM-Guest-2.img’ to ‘system_u:object_r:svirt_image_t:s0:c1,c3’: Operation not permitted
+ [[ 1 -eq 0 ]]
+ exit_pass
+ [[ -n '' ]]
+ exit 0
+ test_cleanup
+ rm -f /tmp/tmp.lmZeFqCdg4 /tmp/tmp.0hz2ga4aDL /usr/local/eal2_testing/audit-test/tmp.8o2UIrR3iY
+ killall -9 -u testuser1
+ userdel -fr testuser1
+ groupdel testuser1
groupdel: group 'testuser1' does not exist
+ killall -9 -u testuser2
+ userdel -fr testuser2
+ groupdel testuser2
groupdel: group 'testuser2' does not exist
+ exit
--- end output -------------------------------------------------------------


Testcase                                                                                      Result
--------                                                                                      ------
[16] test_libvirt_access.bash                                                                  PASS 
--- begin output -----------------------------------------------------------
Domain KVM-Guest-1 destroyed

Domain KVM-Guest-2 destroyed

Domain KVM-Guest-1 started

Domain KVM-Guest-2 started

+ append_cleanup 'killall -9 -u testuser1; userdel -fr -Z testuser1'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp"
	killall -9 -u testuser1; userdel -fr -Z testuser1
    }'
+ append_cleanup 'groupdel testuser1'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    killall -9 -u testuser1;
    userdel -fr -Z testuser1
	groupdel testuser1
    }'
+ userdel -fr -Z testuser1
userdel: user 'testuser1' does not exist
+ groupdel testuser1
groupdel: group 'testuser1' does not exist
+ useradd -Z staff_u testuser1 -G libvirt
+ [[ 0 -ne 0 ]]
+ append_cleanup 'killall -9 -u testuser2; userdel -fr -Z testuser2'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    killall -9 -u testuser1;
    userdel -fr -Z testuser1;
    groupdel testuser1
	killall -9 -u testuser2; userdel -fr -Z testuser2
    }'
+ append_cleanup 'groupdel testuser2'
++ type test_cleanup
++ sed '1,3d;$d'
+ eval 'function test_cleanup {
	    rm -f "$tmp1" "$tmp2" "$localtmp";
    killall -9 -u testuser1;
    userdel -fr -Z testuser1;
    groupdel testuser1;
    killall -9 -u testuser2;
    userdel -fr -Z testuser2
	groupdel testuser2
    }'
+ userdel -fr -Z testuser2
userdel: user 'testuser2' does not exist
+ groupdel testuser2
groupdel: group 'testuser2' does not exist
+ useradd -Z staff_u testuser2
+ [[ 0 -ne 0 ]]
+ virsh connect qemu+tls://rhv.atsec.com/system

+ [[ 0 -ne 0 ]]
+ /bin/su - testuser1 -c 'virsh connect qemu+tls://rhv.atsec.com/system'

+ [[ 0 -ne 0 ]]
+ /bin/su - testuser1 -c 'virsh connect qemu+tls://rhv.atsec.com/system --readonly'

+ [[ 0 -ne 0 ]]
+ /bin/su - testuser2 -c 'virsh connect qemu+tls://rhv.atsec.com/system'

+ [[ 0 -ne 0 ]]
+ /bin/su - testuser2 -c 'virsh connect qemu+tls://rhv.atsec.com/system --readonly'

+ [[ 0 -ne 0 ]]
+ exit_pass
+ [[ -n '' ]]
+ exit 0
+ test_cleanup
+ rm -f /tmp/tmp.DE5THof22w /tmp/tmp.DMUwe3ch4Z /usr/local/eal2_testing/audit-test/tmp.NPgnP1V4se
+ killall -9 -u testuser1
+ userdel -fr -Z testuser1
+ groupdel testuser1
groupdel: group 'testuser1' does not exist
+ killall -9 -u testuser2
+ userdel -fr -Z testuser2
+ groupdel testuser2
groupdel: group 'testuser2' does not exist
+ exit
--- end output -------------------------------------------------------------



  17 pass (100%)
   0 fail (0%)
   0 error (0%)
------------------
  17 total
Killing all processes for testuser
Removing user testuser
Removing group testuser
Killing all processes for testadmin
Removing user testadmin
Removing group testadmin
